<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[æŠ•èµ„ç†è´¢ç¬”è®°(ä¸‰)-ä»·å€¼æŠ•èµ„]]></title>
    <url>%2Ftouzi3.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. ç³»åˆ—æ–‡ç« ï¼šæŠ•èµ„ç†è´¢ç¬”è®°(ä¸€)-ä»€ä¹ˆæ˜¯èµ„äº§ç³»åˆ—æ–‡ç« ï¼šæŠ•èµ„ç†è´¢ç¬”è®°(äºŒ)-è®¤è¯†åŸºé‡‘ç³»åˆ—æ–‡ç« ï¼šæŠ•èµ„ç†è´¢ç¬”è®°(ä¸‰)-ä»·å€¼æŠ•èµ„ ä»€ä¹ˆæ˜¯ä»·å€¼æŠ•èµ„1.å…·å¤‡è¾¨è¯†ä»·å€¼çš„èƒ½åŠ›2.ä¿ç•™è¶³å¤Ÿçš„å®‰å…¨è¾¹é™…ï¼Œä»¥ä½ä»·ä¹°å…¥åªæœ‰å…·å¤‡è¿™ä¸¤ç‚¹æ‰ç®—æ˜¯ä»·å€¼æŠ•èµ„ è®¤è¯†ä¼˜ç§€è¡Œä¸šæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œè‚¡ç¥¨è¦èƒ½é•¿æœŸä¸Šæ¶¨ï¼Œå¿…é¡»æ˜¯å› ä¸ºè¿™å®¶å…¬å¸èƒ½é•¿æœŸç›ˆåˆ©ï¼Œé‚£ä¹ˆï¼Œæœ‰å“ªäº›è¡Œä¸šèƒ½å¤©ç”Ÿèµšé’±å‘¢ï¼Œä¸»è¦æœ‰å¦‚ä¸‹å‡ ä¸ªï¼š1.åŒ»è¯è¡Œä¸š2.å¿…é¡»æ¶ˆè´¹è¡Œä¸š3.å¯é€‰æ¶ˆè´¹è¡Œä¸š å¦‚ä½•ç»™è‚¡ç¥¨ä¼°å€¼ä¸€ä¸ªè‚¡ç¥¨çš„ä¼°å€¼æ˜¯é€šè¿‡ä¼°å€¼æŒ‡æ ‡æ¥å®Œæˆçš„åŸºæœ¬çš„æœ‰3ä¸ªï¼šå¸‚ç›ˆç‡ï¼Œå¸‚å‡€ç‡ï¼Œè‚¡æ¯ç‡ï¼Œæ­¤å¤–è¿˜æœ‰ä¸¤ç§ï¼šç›ˆåˆ©æ”¶ç›Šç‡ï¼ŒPEG å¸‚ç›ˆç‡ç®€ç§°PEï¼Œè®¡ç®—å…¬å¼ä¸ºï¼šå…¬å¸å¸‚å€¼/å…¬å¸ç›ˆåˆ©ï¼Œé€šå¸¸æ¥è¯´ï¼ŒPEè¶Šä½ï¼ŒæŠ•èµ„ä»·å€¼è¶Šé«˜ å¸‚å‡€ç‡ç®€ç§°PBï¼Œè®¡ç®—å…¬å¼ä¸ºï¼šå…¬å¸å¸‚å€¼/å…¬å¸å‡€èµ„äº§ï¼Œé€šå¸¸æ¥è¯´ï¼ŒPBè¶Šä½ï¼ŒæŠ•èµ„ä»·å€¼è¶Šé«˜ è‚¡æ¯ç‡ç®€ç§°DPï¼Œè®¡ç®—å…¬å¼ä¸ºï¼šå…¬å¸åˆ†çº¢/å…¬å¸å¸‚å€¼ï¼Œé€šå¸¸æ¥è¯´ï¼ŒDPè¶Šé«˜ï¼ŒæŠ•èµ„ä»·å€¼è¶Šé«˜ ç›ˆåˆ©æ”¶ç›Šç‡ç®€ç§°EPï¼Œè®¡ç®—å…¬å¼ä¸ºï¼šå…¬å¸ç›ˆåˆ©/å…¬å¸å¸‚å€¼ï¼Œé€šå¸¸æ¥è¯´ï¼ŒEPè¶Šé«˜ï¼ŒæŠ•èµ„ä»·å€¼è¶Šé«˜ PEGPEGæ˜¯æŠ«å¾—.æ—å¥‡ä½¿ç”¨çš„ä¸€ç§ä¼°å€¼æŒ‡æ ‡ï¼Œè®¡ç®—å…¬å¼ä¸ºï¼šå¸‚ç›ˆç‡/å…¬å¸çš„é¢„æœŸç›ˆåˆ©å¢é€Ÿï¼Œä½†æ˜¯å…¬å¸çš„é¢„æœŸç›ˆåˆ©å¢é€Ÿå±äºäººä¸ºåˆ¤æ–­ï¼Œæœ‰ä¸€å®šçš„è¯¯å·®ã€‚é€šå¸¸æ¥è¯´ï¼ŒPEGè¶Šä½ï¼ŒæŠ•èµ„ä»·å€¼è¶Šé«˜ åšæ ¼å…¬å¼çº¦ç¿°.åšæ ¼æ˜¯æŒ‡æ•°åŸºé‡‘ä¹‹çˆ¶ï¼Œä»¥ä¸Šçš„ä¼°å€¼æŒ‡æ ‡å¯¹ç›ˆåˆ©é«˜é€Ÿå¢é•¿ï¼Œç›ˆåˆ©å˜åŒ–å¿«çš„å“ç§ä¸æ˜¯å¾ˆé€‚ç”¨ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨çº¦ç¿°.åšæ ¼çš„åšæ ¼å…¬å¼æ¥è¿›è¡Œä¼°å€¼å…¬å¼ï¼šæŒ‡æ•°åŸºé‡‘çš„æœªæ¥å¹´å¤åˆæ”¶ç›Šç‡ = æŠ•èµ„åˆæœŸè‚¡æ¯ç‡+å¹´å¸‚ç›ˆç‡å˜åŒ–ç‡+å¹´ç›ˆåˆ©å˜åŒ–ç‡ ä¸¾ä¾‹ï¼šä»2006-2016å¹´ï¼Œå¦‚æœè€ƒè™‘åˆ†çº¢ï¼Œæ²ªæ·±300æŒ‡æ•°ä¸Šæ¶¨äº†çº¦3å€å·¦å³ï¼Œå®é™…æŠ•èµ„å¹´å¤åˆæ”¶ç›Šç‡å¤§çº¦ä¸º11.7%2006å¹´ï¼Œæ²ªæ·±300è‚¡æ¯ç‡çº¦ä¸º1.86%ï¼Œ2006å¹´-2016å¹´æŒ‡æ•°åŸºé‡‘å¸‚ç›ˆç‡ä»19.71ä¸‹é™åˆ°äº†13.17ï¼Œæ‰€ä»¥è®¡ç®—å¹´å¸‚ç›ˆç‡å˜åŒ–ç‡çš„å…¬å¼ä¸ºï¼š19.71Ã—ï¼ˆ1+xï¼‰çš„10æ¬¡æ–¹ = 13.17ï¼Œå¾—å‡ºx = -4%,æ‰€ä»¥å¹´å¸‚ç›ˆç‡å˜åŒ–ç‡ä¸º-4%ã€‚2006å¹´-2016å¹´æŒ‡æ•°åŸºé‡‘çš„ç›ˆåˆ©å¢é•¿äº†383%ï¼Œå¹´ç›ˆåˆ©å˜åŒ–ç‡åˆ™ä¸ºï¼š1Ã—ï¼ˆ1+xï¼‰çš„10æ¬¡æ–¹ = 383%ï¼Œå¾—å‡ºx = 14.4%,æ‰€ä»¥ï¼Œæ ¹æ®åšæ ¼å…¬å¼ï¼Œæ²ªæ·±300åŸºé‡‘çš„æœªæ¥å¹´å¤åˆæ”¶ç›Šç‡åˆ™ä¸ºï¼š1.86%+ï¼ˆ-4%ï¼‰+14.4% = 12.26%ï¼Œæ‰£é™¤è¿™10å¹´çš„æ‰‹ç»­è´¹ç­‰çº¦ç­‰äº11.7% æ€»ç»“å¦‚ä½•æŠ•èµ„æ‰èƒ½è·å¾—æ¯”è¾ƒå¥½çš„æ”¶ç›Šï¼š1.é€‰æ‹©å¥½çš„å“ç§2.é€¢ä½ä¹°å…¥ï¼Œå¹¶åˆ¶å®šå¥½çš„æ­¢ç›ˆè®¡åˆ’(é‡è¦)3.é€‰æ‹©ä½è´¹ç‡çš„å“ç§4.ä½ä¼°å¤šæŠ•ï¼Œé«˜ä¼°å°‘æŠ•5.é•¿æœŸæŒæœ‰ã€‚å¦‚æœæŒæœ‰å°‘äº7ä¸ªå·¥ä½œæ—¥ï¼Œä¸€èˆ¬éœ€è¦æ”¯ä»˜1.5%çš„èµé‡‘ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€å¥½æ˜¯é•¿æœŸæŒæœ‰6.ä¸è¦ä¸€æ¬¡æ€§å…¨éƒ¨ä¹°å…¥ï¼Œæœ€å¥½åˆ†æ®µå®šæŠ•ï¼Œè¿™æ ·èƒ½åˆ†æ•£é£é™©]]></content>
      <categories>
        <category>æŠ•èµ„ç†è´¢</category>
      </categories>
      <tags>
        <tag>æŠ•èµ„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æŠ•èµ„ç†è´¢ç¬”è®°(äºŒ)-è®¤è¯†åŸºé‡‘]]></title>
    <url>%2Ftouzi2.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. ç³»åˆ—æ–‡ç« ï¼šæŠ•èµ„ç†è´¢ç¬”è®°(ä¸€)-ä»€ä¹ˆæ˜¯èµ„äº§ç³»åˆ—æ–‡ç« ï¼šæŠ•èµ„ç†è´¢ç¬”è®°(äºŒ)-è®¤è¯†åŸºé‡‘ç³»åˆ—æ–‡ç« ï¼šæŠ•èµ„ç†è´¢ç¬”è®°(ä¸‰)-ä»·å€¼æŠ•èµ„ åŸºé‡‘çš„æ¦‚å¿µåŸºé‡‘æ˜¯ä¸€ç§æŠ•èµ„å·¥å…·ï¼Œæˆ‘ä»¬å°†é’±é›†ä¸­åœ¨ä¸€èµ·ï¼Œäº¤ç»™ä¸“ä¸šçš„åŸºé‡‘å…¬å¸æ‰“ç†ï¼Œè¿™å°±æ˜¯åŸºé‡‘ã€‚è€Œæˆ‘ä»¬ä¸€èˆ¬æŠ•èµ„çš„åŸºé‡‘å±äºå…¬å‹ŸåŸºé‡‘ã€‚ åŸºé‡‘çš„ä¼˜ç‚¹1.æœ‰ä¸“ä¸šçš„åŸºé‡‘ç»ç†å¸®æˆ‘ä»¬æ‰“ç†ï¼Œä¸ç”¨æˆ‘ä»¬åœ¨ä¸Šç­æ—¶é—´ä¸“é—¨ç›¯ç›˜ï¼Œçœæ—¶çœåŠ›2.èƒ½åˆ†æ•£é£é™©ï¼ŒåŸºé‡‘æ˜¯è´­ä¹°å‡ åæˆ–ä¸Šç™¾åªï¼Œå¦‚æœå•ç‹¬æŠ•èµ„è‚¡ç¥¨ï¼Œé£é™©è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ åŸºé‡‘ç§ç±»è´§å¸åŸºé‡‘æœ€å¸¸è§çš„å°±æ˜¯ä½™é¢å®ï¼Œä¸»è¦æŠ•èµ„çš„æ˜¯é“¶è¡Œå­˜æ¬¾ï¼ŒçŸ­æœŸå€ºåˆ¸ç­‰ç‰¹ç‚¹ï¼šé£é™©ä½ï¼Œçµæ´»ï¼ŒåŸºæœ¬ä¸ä¼šäºæŸä½†æ”¶ç›Šä¹Ÿä½ å€ºåˆ¸åŸºé‡‘å¦‚æœä¸€ä¸ªåŸºé‡‘çš„80%éƒ½æ˜¯ä¹°çš„å€ºåˆ¸ï¼Œé‚£è¿™ä¸ªå°±æ˜¯å€ºåˆ¸åŸºé‡‘,ä¸»è¦æŠ•èµ„çš„æ˜¯å›½å€ºï¼Œè‚¡å€ºç­‰å„ç§å€ºåˆ¸ç‰¹ç‚¹ï¼šé£é™©ä¸­ç­‰ï¼Œæ”¶ç›Šä¸­ç­‰ï¼Œå¯èƒ½äºæŸ è‚¡ç¥¨åŸºé‡‘å¦‚æœä¸€ä¸ªåŸºé‡‘çš„80%éƒ½æ˜¯ä¹°çš„è‚¡ç¥¨ï¼Œé‚£è¿™ä¸ªå°±æ˜¯è‚¡ç¥¨åŸºé‡‘,ä¸»è¦æŠ•èµ„çš„æ˜¯è‚¡ç¥¨ç‰¹ç‚¹ï¼šé«˜æ”¶ç›Šï¼Œé«˜é£é™© æŠ•èµ„å‘¨æœŸè´§å¸å’Œå€ºåˆ¸é€‚åˆçŸ­æœŸæŒæœ‰ï¼Œè€Œè‚¡ç¥¨åŸºé‡‘é€‚åˆé•¿æœŸæŒæœ‰ï¼Œä¸€èˆ¬3-5å¹´ä»¥ä¸Šï¼Œæ‰€ä»¥éœ€è¦ç”¨é•¿æœŸä¸éœ€è¦ä½¿ç”¨çš„èµ„é‡‘æ¥æŠ•èµ„ï¼Œå¹¶ä¸”ä¸è¦è¿‡äºè®¡è¾ƒçŸ­æœŸçš„äºæŸå¾—å¤± æŒ‡æ•°åŸºé‡‘æ¦‚å¿µä¸€ç§ç‰¹æ®Šçš„è‚¡ç¥¨åŸºé‡‘ï¼ŒæŒ‡æ•°æ˜¯æŒ‡ä¸€ç§é€‰è‚¡è§„åˆ™ï¼Œä¾‹å¦‚æ²ªæ·±300æŒ‡æ•°å°±æ˜¯æŒ‡ä»Aè‚¡ä¸­é€‰å–300åªæœ€å¤§è§„æ¨¡çš„è‚¡ç¥¨ä½œä¸ºæŒ‡æ•°è¿½è¸ªï¼Œä¸å…¶ä»–çš„è‚¡ç¥¨åŸºé‡‘ä¸åŒçš„æ˜¯ï¼ŒæŒ‡æ•°åŸºé‡‘æ˜¯æŒ‰ç…§æŒ‡æ•°è§„åˆ™æ¥é€‰æ‹©è‚¡ç¥¨ï¼Œè€Œä¸»åŠ¨å‹çš„è‚¡ç¥¨åŸºé‡‘æ˜¯åŸºé‡‘ç»ç†æ¥é€‰æ‹©è‚¡ç¥¨,è€Œæˆ‘ä»¬ä¸€èˆ¬æ— æ³•åˆ¤æ–­è¿™ä¸ªåŸºé‡‘ç»ç†çš„é€‰è‚¡èƒ½åŠ›ï¼Œæ‰€ä»¥ä½¿ç”¨æŒ‡æ•°æ˜¯æœ€ç¨³å¦¥çš„æ–¹æ³•åŸºé‡‘æŠ•èµ„é—¨æ§›ä¹Ÿæ¯”è¾ƒä½ï¼Œ10å…ƒèµ·æŠ• å¦‚ä½•è·åˆ©1.ä½ä»·ä¹°å…¥ï¼Œé«˜ä»·å–å‡º2.ä¾é åˆ†çº¢ï¼Œæ— éœ€å–å‡º å¸¸è§çš„æŒ‡æ•°1.ä¸Šè¯50ï¼šä¸Šæµ·è¯åˆ¸äº¤æ˜“æ‰€æŒ‘é€‰äº†è§„æ¨¡æœ€å¤§çš„50å®¶ä¼ä¸šï¼Œå±äºå¤§ç›˜è‚¡2.æ²ªæ·±300ï¼šè§„æ¨¡æœ€å¤§çš„300å®¶ä¼ä¸šï¼ŒåŒ…æ‹¬å¤§ä¸­å‹ä¼ä¸š3.ä¸­è¯500ï¼šè§„æ¨¡å¤„äº301-800çš„ä¼ä¸šï¼Œå±äºæŠ•èµ„ä¸­å°å‹ä¼ä¸š4.çº¢åˆ©æŒ‡æ•°ï¼šæŠ•èµ„é«˜åˆ†çº¢ä¼ä¸šï¼Œåˆ†çº¢å°±æ˜¯æŠ•èµ„çš„ä¼ä¸šèµšé’±äº†ï¼Œå°±ä¼šæ‹¿å‡ºä¸€éƒ¨åˆ†æ¥å›é¦ˆè‚¡ä¸œ5.æ’ç”ŸæŒ‡æ•°ï¼šæŠ•èµ„é¦™æ¸¯ä¸Šå¸‚ä¼ä¸šçš„æŒ‡æ•°6.Hè‚¡æŒ‡æ•°ï¼šæŠ•èµ„é¦™æ¸¯ä¸Šå¸‚çš„å†…åœ°ä¼ä¸š Cç±»åŸºé‡‘ä¸Aç±»çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨ç”³è´­è´¹ç”¨ä¸Šï¼ŒCç±»å…ç”³è´­è´¹ä½†ç®¡ç†è´¹è´µï¼ŒAç±»éœ€è¦ç”³è´­è´¹ä½†ç®¡ç†è´¹ä¾¿å®œï¼Œæ‰€ä»¥ï¼Œ1å¹´ä»¥å†…çš„æŠ•èµ„ï¼ŒCç±»æ¯”Aç±»å¥½ï¼Œ1å¹´ä»¥ä¸Šï¼ŒAç±»æ¯”Cç±»å¥½ æŠ•èµ„æ¸ é“åˆ†ä¸ºåœºå†…æ¸ é“å’Œåœºå¤–æ¸ é“ï¼šåœºå†…æ˜¯é€šè¿‡ä¸Šäº¤æˆ–æ·±äº¤æ¥å®Œæˆäº¤æ˜“ï¼Œéœ€è¦å¼€é€šè¯åˆ¸è´¦æˆ·ï¼Œåœ¨è‚¡ç¥¨äº¤æ˜“å¹³å°ä¸Šå°±èƒ½äº¤æ˜“äº†ã€‚æˆ‘ä»¬å¸¸ç”¨è‚¡ç¥¨äº¤æ˜“å¹³å°æœ‰åŒèŠ±é¡ºï¼Œé›ªçƒç­‰ï¼Œåœ¨é‡Œé¢ç™»å…¥è¯åˆ¸è´¦æˆ·ï¼Œå°±èƒ½è´­ä¹°åœºå†…åŸºé‡‘äº†ï¼Œ åœºå¤–æ¸ é“ï¼šé€šè¿‡ç¬¬ä¸‰æ–¹è´­ä¹°ï¼Œä¾‹å¦‚é“¶è¡Œï¼Œç½‘ç»œå¹³å°ï¼Œæ˜¯é€šè¿‡ç”³è´­èµå›çš„æ–¹å¼æ¥è´­ä¹°ï¼Œå¸¸ç”¨çš„å¹³å°æœ‰ï¼šå¤©å¤©åŸºé‡‘ï¼Œè›‹å·åŸºé‡‘ç­‰ï¼Œç”³è´­æ˜¯éœ€è¦æœ‰ç”³è´­è´¹çš„ï¼Œä¸€èˆ¬ä»é“¶è¡Œä¹°æ˜¯ä¸æ‰“æŠ˜çš„ï¼Œè€Œä»ç½‘ç»œå¹³å°ä¸€èˆ¬è´¹ç‡éƒ½æ˜¯1æŠ˜å·¦å³ã€‚ åŒºåˆ«ï¼šåœºå†…çš„äº¤æ˜“è¿…é€Ÿï¼Œåˆ°è´¦å¿«ï¼Œå¹¶ä¸”è´­ä¹°çš„å‡€å€¼æ˜¯æŒ‰ç…§ä½ å½“æ—¶è´­ä¹°çš„å‡€å€¼æ¥è®¡ç®—çš„ï¼Œä½†æ˜¯åœºå†…çš„åŸºé‡‘æ•°é‡å°‘ï¼ŒæµåŠ¨æ€§è¾ƒå·®åœºå¤–çš„åŸºé‡‘ç§ç±»å¤šï¼Œä½†æ˜¯å‡€å€¼çš„è®¡ç®—æ˜¯æŒ‰ç…§3ç‚¹åæ”¶å¸‚çš„å‡€å€¼æ¥è®¡ç®—çš„ï¼Œå…·æœ‰äº¤æ˜“æ…¢ï¼Œåˆ°è´¦æ…¢çš„ç‰¹ç‚¹ æŠ•èµ„å»ºè®®æ–°æ‰‹å»ºè®®ä»åœºå¤–å¼€å§‹ï¼Œå…ˆäº†è§£åŸºé‡‘çš„äº¤æ˜“è§„åˆ™ï¼ŒæŒ‡æ•°çš„ç§ç±»å’Œå„é¡¹äº¤æ˜“è´¹ç”¨åå†è¿›è¡Œåœºå†…çš„æŠ•èµ„ã€‚åˆšä¸Šæ‰‹æœ€é‡è¦çš„ä¸æ˜¯ç›ˆåˆ©ï¼Œè€Œæ˜¯åŸ¹å…»å¿ƒæ€ï¼Œåšåˆ°ä¸‹è·Œä¸æ…Œï¼Œåªæœ‰ç»å†è¿‡ä¸€æ¬¡å®Œæ•´çš„å¾®ç¬‘æ›²çº¿æ‰èƒ½ä½“éªŒåˆ°æŠ•èµ„çš„é­…åŠ›æ‰€åœ¨]]></content>
      <categories>
        <category>æŠ•èµ„ç†è´¢</category>
      </categories>
      <tags>
        <tag>æŠ•èµ„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æŠ•èµ„ç†è´¢ç¬”è®°(ä¸€)-ä»€ä¹ˆæ˜¯èµ„äº§]]></title>
    <url>%2Ftouzi1.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. å¯¼è¯»ï¼šæ¥¼ä¸»ç¨‹åºå‘˜ï¼Œå­¦ä¹ äº†å¤§æ¦‚ä¸€å¹´å¤šçš„æŠ•èµ„ç†è´¢ï¼Œå­¦ä¹ äº†èºä¸é’‰çš„è¯¾ç¨‹ï¼ŒåŸºäºç¨‹åºå‘˜çš„æ€»ç»“ä¹ æƒ¯ï¼Œé‚ç¼–å†™äº†è¿™ä¸€ç³»åˆ—çš„ç¬”è®°ï¼Œå¦‚æœä½ ä¹Ÿæ˜¯æœˆè–ªæ—åˆæƒ³å­˜é’±çš„è¯ï¼Œè¿™ä¸€ç³»åˆ—ç¬”è®°ç›¸ä¿¡èƒ½è®©ä½ å—ç›ŠåŒªæµ… æ³¨:æ­¤ç³»åˆ—æ–‡ç« åªä½œä¸ºå‚é˜…ç”¨é€”ï¼Œä¸¥ç¦ç”¨ä½œå•†ä¸šç”¨é€”ï¼Œå¦‚å†…å®¹ä¸å•†ä¸šå†²çªï¼Œä¸€åˆ‡ç‰ˆæƒå½’åŸä½œè€…æ‰€æœ‰ç³»åˆ—æ–‡ç« ï¼šæŠ•èµ„ç†è´¢ç¬”è®°(ä¸€)-ä»€ä¹ˆæ˜¯èµ„äº§ç³»åˆ—æ–‡ç« ï¼šæŠ•èµ„ç†è´¢ç¬”è®°(äºŒ)-è®¤è¯†åŸºé‡‘ç³»åˆ—æ–‡ç« ï¼šæŠ•èµ„ç†è´¢ç¬”è®°(ä¸‰)-ä»·å€¼æŠ•èµ„ æˆä¸ºå¯Œäººçš„å…³é”®ï¼Œè®©é’±ç”Ÿé’±è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œæˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„å¯Œæœ‰æ˜¯æŒ‡ä»–èµ„äº§å¤šï¼Œåªæœ‰é€šè¿‡èµ„äº§ï¼Œæºæºä¸æ–­çš„äº§ç”Ÿç°é‡‘æµï¼Œä½ æ‰ä¼šè¶Šæ¥è¶Šå¯Œï¼Œè€Œç°é‡‘ä¸ç­‰äºèµ„äº§ï¼Œæˆ‘ä»¬éœ€è¦å°†ç°é‡‘ç½®æ¢ä¸ºåˆç†çš„èµ„äº§ï¼Œè¿™æ ·æ‰èƒ½è®©ä½ çš„ç°é‡‘äº§ç”Ÿä»·å€¼çš„æå‡ï¼Œä»è€Œè·å–æ›´å¤šçš„ç°é‡‘ï¼Œå¾ªç¯å¾€å¤ï¼Œæ‰èƒ½æ›´å®¹æ˜“æˆä¸ºå¯Œäººé‚£å“ªäº›æ‰æ˜¯èƒ½äº§ç”Ÿç°é‡‘æµçš„èµ„äº§å‘¢ï¼š1.è‚¡ç¥¨ç±»2.å€ºåˆ¸ç±»3.è´§å¸ç±»4.æˆ¿äº§ç±»5.äººåŠ›èµ„äº§ç±» ä»€ä¹ˆæ˜¯è´¢åŠ¡è‡ªç”±æ¦‚å¿µï¼šæŒæœ‰èƒ½äº§ç”Ÿç°é‡‘æµçš„èµ„äº§ï¼Œå½“æ¯å¹´çš„ç°é‡‘æµï¼Œå¯ä»¥è¦†ç›–å®¶åº­æ”¯å‡ºï¼Œå°±å¯ä»¥å®ç°è´¢åŠ¡è‡ªç”±ã€‚ éœ€è¦æŒæœ‰å¤šå°‘èµ„äº§æ‰èƒ½å«è´¢åŠ¡è‡ªç”±å‘¢? å¨å»‰.ç­æ ¹æœ‰ä¸ª%4æ³•åˆ™ï¼Œå‡è®¾é€šè¿‡æŠ•èµ„è‚¡ç¥¨ï¼Œæ¯å¹´ä»é€€ä¼‘é‡‘ä¸­æå–ä¸è¶…è¿‡4.2%çš„é‡‘é¢ç”¨äºæ”¯ä»˜ç”Ÿæ´»æ‰€éœ€ï¼Œé‚£åˆ°è‡ªå·±å»ä¸–ï¼Œé€€ä¼‘é‡‘éƒ½èŠ±ä¸å®Œã€‚æ‰€ä»¥å…¬å¼å¯ä»¥è¿™ä¹ˆè®¡ç®—ï¼šè´¢åŠ¡è‡ªç”±æ‰€éœ€æœ€å°‘èµ„äº§é‡ = å®¶åº­å¹´å¼€é”€/4% ä¸€äº›å¼€æºèŠ‚æµçš„æ–¹å¼èŠ‚æµï¼š1.è®°è´¦2.ç§Ÿä¾¿å®œçš„å…¬å¯“3.åŒºåˆ†æƒ³è¦å’Œå¿…è¦4.æ‹’ç»ä¿¡ç”¨å¡æ¶ˆè´¹5.ç»™æ¶ˆè´¹æ·»åŠ ç”Ÿå‘½æ ‡ç­¾6.æ‰¾ä»·å€¼è§‚æ¥è¿‘çš„å¦ä¸€åŠ å¼€æºï¼š1.æ¯”åˆ«äººæ›´åŠªåŠ›çš„å·¥ä½œï¼Œäº‰å–åŠ è–ª2.åˆ©ç”¨å·¥ä½œä¹‹å¤–çš„æ—¶é—´åšå‰¯ä¸šï¼Œæå‡è¢«åŠ¨æ”¶å…¥æ¥æº èµ„äº§çš„ç±»æ¯”ï¼Œä»€ä¹ˆèµ„äº§é•¿æœŸæ”¶ç›Šæ›´é«˜æ™®é€šäººèƒ½æ¥è§¦çš„èµ„äº§æœ‰äº”ç±»ï¼š1.è‚¡ç¥¨ç±»ï¼šè‚¡ç¥¨ï¼Œè‚¡ç¥¨åŸºé‡‘ï¼Œè‚¡ä»½åˆ¶å…¬å¸2.å€ºåˆ¸ç±»ï¼šå€ºåˆ¸,å€ºåˆ¸åŸºé‡‘ï¼Œå‚¨è“„ï¼Œç†è´¢äº§å“3.è´§å¸ç±»ï¼šè´§å¸åŸºé‡‘ï¼Œæ´»æœŸå‚¨è“„ï¼Œé€†å›è´­4.æˆ¿åœ°äº§ç±»ï¼šæˆ¿äº§ï¼Œæˆ¿åœ°äº§ä¿¡æ‰˜åŸºé‡‘5.äººåŠ›èµ„æºç±»ï¼šå·¥ä½œâ€¦.åƒæˆ‘ä»¬æ¥è§¦çš„æœ€å¤šçš„ä½™é¢å®å°±å±äºè´§å¸ç±»èµ„äº§4å’Œ5ä¸éœ€è¦è®¨è®ºï¼Œ123çš„æ”¶ç›Šä¸º1&gt;2&gt;3,è€Œé£é™©ç­‰çº§ä¹Ÿä¸º1&gt;2&gt;3 ä¸è¿›è¡ŒæŠ•èµ„ç†è´¢çš„åæœå¦‚æœä¸è¿›è¡Œç†è´¢ï¼Œæˆ‘ä»¬æ‰‹é‡Œçš„ç°é‡‘çš„è´­ä¹°åŠ›ä¼šéšç€é€šè´§è†¨èƒ€è€Œæ¯å¹´ä¸‹é™ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬æ‰€æŒæ¡çš„è´¢å¯Œä¹Ÿä¼šé€æ¸ç¼©æ°´!!]]></content>
      <categories>
        <category>æŠ•èµ„ç†è´¢</category>
      </categories>
      <tags>
        <tag>æŠ•èµ„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinä½¿ç”¨æŠ€å·§ä¸€-æ¥å£ä¸å‘½åå‚æ•°çš„ä¼˜é›…è¿ç”¨]]></title>
    <url>%2FKotlin%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E4%B8%80-%E6%8E%A5%E5%8F%A3%E4%B8%8E%E5%91%BD%E5%90%8D%E5%8F%82%E6%95%B0%E7%9A%84%E4%BC%98%E9%9B%85%E8%BF%90%E7%94%A8.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æ–‡ç« é¦–å‘äºæˆ‘çš„ç®€ä¹¦,æœ¬å¤„åªåšæ•´ç†å½’æ¡£ç”¨ æŠ›å‡ºé—®é¢˜çœ‹è¿‡æˆ‘çš„Kotlin-é«˜é˜¶å‡½æ•°çš„ä½¿ç”¨(äºŒ)éƒ½çŸ¥é“ï¼Œæˆ‘ä»¬çš„setOnClickListenerå¯ä»¥è¿™æ ·å†™ï¼š123view.setOnClickListener &#123;&#125; ä½†æ˜¯å½“æ¥å£æœ‰å¤šä¸ªå®ç°æ–¹æ³•çš„æ—¶å€™æˆ‘ä»¬å¯èƒ½å°±éœ€è¦è¿™æ ·å®ç°äº†ï¼š1234567891011edittext.addTextChangedListener(object :TextWatcher&#123; override fun afterTextChanged(s: Editable?) &#123; &#125; override fun beforeTextChanged(s: CharSequence?, start: Int, count: Int, after: Int) &#123; &#125; override fun onTextChanged(s: CharSequence?, start: Int, before: Int, count: Int) &#123; &#125; &#125;) é€šå¸¸æˆ‘ä»¬åªéœ€è¦åœ¨onTextChangedé‡Œæ‰§è¡Œä¸€äº›é€»è¾‘ï¼Œå…¶ä½™çš„æ–¹æ³•ç”¨ä¸åˆ°ï¼Œè¿™æ ·å°±æ˜¾å¾—å¾ˆä¸ä¼˜é›…äº†ï¼Œé‚£æœ‰æ²¡æœ‰åŠæ³•æ˜¾å¾—æ›´åŠ çš„ä¼˜é›…å‘¢,ç­”æ¡ˆè‚¯å®šæ˜¯æœ‰å“’~~~ è§£å†³é—®é¢˜1.ä½¿ç”¨æ‰©å±•å‡½æ•°å°è£…å¯¹åº”çš„æ–¹æ³•æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ‰©å±•æ–¹æ³•å†…éƒ¨å®ç°3ä¸ªæ–¹æ³•ï¼Œç„¶åè®©å…¶ä¸­ä¸€ä¸ªæ–¹æ³•invokeå‡ºå»ï¼Œå®ç°ä¹‹ååƒè¿™æ ·ï¼š123edittext.onTextChanged &#123; s, start, before, count -&gt; &#125; å®ç°ï¼š1234567891011121314fun EditText.onTextChanged(changed:(s: CharSequence?, start: Int, before: Int, count: Int)-&gt;Unit)&#123; addTextChangedListener(object : TextWatcher&#123; override fun afterTextChanged(s: Editable?) &#123; &#125; override fun beforeTextChanged(s: CharSequence?, start: Int, count: Int, after: Int) &#123; &#125; override fun onTextChanged(s: CharSequence?, start: Int, before: Int, count: Int) &#123; changed(s,start,before, count) &#125; &#125;)&#125; è¿™é‡Œæˆ‘å‡è®¾ä½ å·²ç»ç†è§£äº†æ‰©å±•å‡½æ•°çš„ä½¿ç”¨ï¼Œå¦‚æœçœ‹ä¸å¤ªæ‡‚ï¼Œå¯ä»¥å…ˆçœ‹çœ‹æˆ‘çš„è¿™ç¯‡æ–‡ç« Kotlin-é«˜é˜¶å‡½æ•°çš„ä½¿ç”¨(ä¸€) ä»£ç ä¸€ä¸‹å­æ¸…çˆ½èµ·æ¥äº†ï¼Œå¹¶ä¸”æˆ‘å¯ä»¥ä¸“æ³¨äºä¸€ä¸ªæ–¹æ³•é€»è¾‘çš„å®ç°ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œä¸‡ä¸€æˆ‘éœ€è¦åœ¨beforeTextChangedé‡Œå®ç°ä¸€äº›é€»è¾‘å‘¢ï¼Œä¸‡ä¸€æˆ‘æƒ³å®ç°å…¶ä»–çš„æ–¹æ³•å‘¢ï¼Œæœ‰äººä¼šè¯´æˆ‘å†ç”³æ˜ä¸€ä¸ªbeforeTextChangedçš„æ‰©å±•æ–¹æ³•å•Šï¼Œç„¶ååƒè¿™æ ·ï¼š123456 edittext.onTextChanged &#123; s, start, before, count -&gt;&#125;edittext.beforeTextChanged&#123;s, start, count, after-&gt;&#125; è¿™æ ·å†™å®é™…ä¸Šæ˜¯ç”³æ˜äº†ä¸¤ä¸ªç›‘å¬ï¼ŒonTextChangedæ˜¯ä¼šå¤±æ•ˆçš„ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ¡ˆpassã€‚æˆ‘ä»¬å¯ä»¥æƒ³åˆ°åœ¨ä¸€ä¸ªæ–¹æ³•é‡Œç”³æ˜å¤šä¸ªlambdaï¼Œè²Œä¼¼è§£å†³äº†é—®é¢˜ï¼Œäºæ˜¯å°±åƒè¿™æ ·ï¼š1234567edittext.addTextChangedListener(&#123; s -&gt; &#125;, &#123; s, start, count, after -&gt; &#125;, &#123; s, start, before, count-&gt; &#125;) å®ç°ï¼š1234567891011121314151617fun EditText.addTextChangedListener(after:(s: Editable?)-&gt;Unit,before:(s: CharSequence?, start: Int, count: Int, after: Int)-&gt;Unit, changed: (s: CharSequence?, start: Int, before: Int, count: Int) -&gt; Unit)&#123; addTextChangedListener(object : TextWatcher&#123; override fun afterTextChanged(s: Editable?) &#123; after(s) &#125; override fun beforeTextChanged(s: CharSequence?, start: Int, count: Int, after: Int) &#123; before(s, start, count, after) &#125; override fun onTextChanged(s: CharSequence?, start: Int, before: Int, count: Int) &#123; changed(s,start,before, count) &#125; &#125;)&#125; æˆ‘æ»´å¦ˆï¼Œè¿™å•¥è·Ÿå•¥ï¼Œè°è¦æ˜¯è¿™ä¹ˆå†™ä¼°è®¡å‡ºé—¨ä¼šè¢«æ‰“ã€‚å…¶å®è¿™ç§æ€è·¯æ˜¯å¯¹çš„ï¼Œä½†æ˜¯å¯èƒ½æ•²å‡ºæ¥çš„ä»£ç ä»–æœ‰è‡ªå·±çš„æƒ³æ³•â€¦.. 2.ä½¿ç”¨å‘½åå‚æ•°å’Œé»˜è®¤å€¼è§£å†³lambdaæ–¹æ³•åŒºåˆ†é—®é¢˜æˆ‘ä»¬çŸ¥é“ä¸Šé¢é‚£ç§å®ç°çš„ç¼ºç‚¹å°±æ˜¯æ–¹æ³•ä¸æ˜“åŒºåˆ†ï¼Œsoï¼Œæˆ‘ä»¬åªéœ€è¦åŠ å…¥ä¸€ä¸ªå‘½åå‚æ•°å°±è§£å†³é—®é¢˜å•¦ï¼š1234567891011edittext.addTextChangedListener( after = &#123; s -&gt; &#125;, before = &#123; s, start, count, after -&gt; &#125;, changed = &#123; s, start, before, count -&gt; &#125;) å®ç°ï¼š123456789101112131415161718inline fun EditText.addTextChangedListener(crossinline after:(s: Editable?)-&gt;Unit, crossinline before:(s: CharSequence?, start: Int, count: Int, after: Int)-&gt;Unit, crossinline changed: (s: CharSequence?, start: Int, before: Int, count: Int) -&gt; Unit)&#123; addTextChangedListener(object : TextWatcher&#123; override fun afterTextChanged(s: Editable?) &#123; after(s) &#125; override fun beforeTextChanged(s: CharSequence?, start: Int, count: Int, after: Int) &#123; before(s, start, count, after) &#125; override fun onTextChanged(s: CharSequence?, start: Int, before: Int, count: Int) &#123; changed(s,start,before, count) &#125; &#125;)&#125; ä½¿ç”¨crossinlineå…³é”®å­—æ¥è§„å®šå‘½åå‚æ•°ï¼Œä½†å¿…é¡»ç”³æ˜æ–¹æ³•ä¸ºinline,å…³äºå†…è”ï¼Œè¯¦è§å®˜æ–¹æ–‡æ¡£ è¿™æ ·çœ‹èµ·æ¥å°±æ¸…æ™°å¤šäº†ï¼Œæ¯ä¸ªlambdaå¯¹åº”ä»€ä¹ˆæ–¹æ³•ä¸€ç›®äº†ç„¶ï¼Œä½†æ˜¯ï¼Œå›åˆ°æˆ‘ä»¬æœ€åˆè¯´çš„ï¼Œæˆ‘ä»¬æœ‰æ—¶åªéœ€è¦å…¶ä¸­çš„ä¸€ä¸ªæ–¹æ³•çš„ï¼Œè¿™æ ·è¿˜æ˜¯è¦ç”³æ˜3ä¸ªæ–¹æ³•å‘€ï¼Œåˆ«æ€¥ï¼ŒåŠ ä¸ªé»˜è®¤å€¼æå®šï¼šå®ç°:12345678910111213141516171819202122inline fun EditText.addTextChangedListener(crossinline after:(s: Editable?)-&gt;Unit=&#123;&#125;, crossinline before:(s: CharSequence?, start: Int, count: Int, after: Int)-&gt;Unit=&#123; _, _, _, _ -&gt; &#125;, crossinline changed: (s: CharSequence?, start: Int, before: Int, count: Int) -&gt; Unit=&#123; _, _, _, _ -&gt; &#125;)&#123; addTextChangedListener(object : TextWatcher&#123; override fun afterTextChanged(s: Editable?) &#123; after(s) &#125; override fun beforeTextChanged(s: CharSequence?, start: Int, count: Int, after: Int) &#123; before(s, start, count, after) &#125; override fun onTextChanged(s: CharSequence?, start: Int, before: Int, count: Int) &#123; changed(s,start,before, count) &#125; &#125;)&#125; ä½¿ç”¨ï¼š12345edittext.addTextChangedListener( changed = &#123; s, start, before, count -&gt; &#125;) è¿™æ ·çœ‹èµ·æ¥å°±èˆ’æœå¤šäº†ï¼Œæ—¢è¾¾åˆ°äº†ç”³æ˜å•ä¸ªå¤šä¸ªå®ç°çš„çµæ´»é€‰æ‹©ï¼Œåˆè¾¾åˆ°äº†æ–¹æ³•åçš„å‘½ååŒºåˆ†ï¼Œæ„Ÿè§‰äººç”Ÿå·²ç»åˆ°è¾¾äº†å·…å³°æœ‰æœ¨æœ‰ï¼ï¼ æˆ‘ä»¬çŸ¥é“å¦‚æœæ–¹æ³•ç”³æ˜äº†é»˜è®¤å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°å¯ä»¥ä¸ç”³æ˜ï¼Œæˆ‘ä»¬æ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸ªç‰¹æ€§æ¥è¾¾åˆ°çš„æ•ˆæœ,å…³äºè¿™ä¸ªç‰¹æ€§ä¹Ÿå¯ä»¥ç”¨åˆ°æ¥å£ä¸Šï¼Œå½“æˆ‘ä»¬æœ‰äº›æ¥å£ä¸æƒ³è®©å®ƒæ¯æ¬¡éƒ½å®ç°ï¼Œå¯ä»¥åœ¨æ¥å£åé¢åŠ å…¥ä¸€ä¸ªè¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰è¿”å›å€¼å¯ä»¥è¿”å›ä¸€ä¸ªUnitï¼Œåƒè¿™æ ·ï¼š1234interface Test &#123; fun test1() = Unit fun test2()&#125; è¿™æ ·çš„è¯test2ä¸ºå¿…é¡»å®ç°ï¼Œtest1å°±å˜æˆäº†é€‰æ‹©å®ç° æ€»ç»“ï¼šç»è¿‡addTextChangedListenerçš„ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†æ‰©å±•å‡½æ•°ï¼Œæ¥å£ä¸å‘½åå‚æ•°çš„è¿ç”¨ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå»ºè®®è¯»è€…ä»¬å¯ä»¥å°†å¸¸ç”¨çš„ä¸€äº›æ¥å£å®ç°åšä¸€äº›å°è£…ï¼Œå…·ä½“é€‰æ‹©é‚£ç§æ–¹å¼è§†å®é™…æƒ…å†µè€Œå®šï¼Œå¦‚æœä½ ä¸ç»å¸¸çš„ä½¿ç”¨å®ƒï¼Œé‚£ä¹ˆå°±ä¸ç”¨å»ç‰¹æ„å»å°è£…å®ƒï¼Œä¸ç„¶ä¼šé€ æˆæ–¹æ³•è‡ƒè‚¿ã€‚ å…³äºæ–¹æ³•ä¸æ¥å£çš„å°è£…ï¼Œè¿˜æœ‰æ›´åŠ é«˜çº§çš„ç”¨æ³•ï¼Œå°±æ˜¯DSL,è¿™ç§æ–¹æ¡ˆåœ¨Ankoæ¡†æ¶ä¸­ä½¿ç”¨çš„éå¸¸é¢‘ç¹ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»ç ”ç©¶ä¸€ä¸‹]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[flutterè¸©å‘è®°å½•(æŒç»­æ›´æ–°ä¸­)]]></title>
    <url>%2Ffluttercaikengjilv.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æ–‡ç« é¦–å‘äºæˆ‘çš„ç®€ä¹¦,æœ¬å¤„åªåšæ•´ç†å½’æ¡£ç”¨ Flutterç¼–è¯‘é—®é¢˜1.Flutterç¼–è¯‘æ—¶ä¸€ç›´å¡åœ¨â€Resolving dependenciesâ€åŸå› ï¼šå›½å†…è¢«å¢™çš„åŸå›  è§£å†³æ–¹æ¡ˆ1ï¼šé…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼š PUB_HOSTED_URL-&gt;https://pub.flutter-io.cn FLUTTER_STORAGE_BASE_URL-&gt;https://storage.flutter-io.cnæœ€æ–°çš„å˜é‡åœ°å€è¯·è®¿é—®ï¼šhttps://flutter.io/community/china è§£å†³æ–¹æ¡ˆ2ï¼šåœ¨androidç›®å½•çš„build.gradleä¸‹æ·»åŠ é˜¿é‡Œé•œåƒä»£ç†ï¼š12345678910111213141516171819202122232425buildscript &#123; repositories &#123; maven &#123; url &apos;https://maven.aliyun.com/repository/google&apos; &#125; maven &#123; url &apos;https://maven.aliyun.com/repository/jcenter&apos; &#125; maven &#123; url &apos;https://maven.aliyun.com/repository/public&apos; &#125; maven &#123; url &apos;https://maven.aliyun.com/repository/gradle-plugin&apos; &#125; google() jcenter() &#125; dependencies &#123; classpath &apos;com.android.tools.build:gradle:3.2.1&apos; &#125;&#125;allprojects &#123; repositories &#123; maven &#123; url &apos;https://maven.aliyun.com/repository/google&apos; &#125; maven &#123; url &apos;https://maven.aliyun.com/repository/jcenter&apos; &#125; maven &#123; url &apos;https://maven.aliyun.com/repository/public&apos; &#125; maven &#123; url &apos;https://maven.aliyun.com/repository/gradle-plugin&apos; &#125; google() jcenter() &#125;&#125; è§£å†³æ–¹æ¡ˆ3ï¼šä½¿ç”¨ç¿»å¢™å·¥å…·æ„å»º 2.è¿è¡Œä¸€äº›å¼€æºçš„é¡¹ç›®ç¼–è¾‘æŠ¥é”™æç¤ºFinished with error: FormatException: Bad UTF-8 encoding 0xc3 (at offset 169)åŸå› ï¼šappçš„releaseç‰ˆæœ¬æ‰¾ä¸åˆ°keystoreæ–‡ä»¶è§£å†³æ–¹æ¡ˆï¼šæ‰¾åˆ°android-&gt;appç›®å½•ä¸‹çš„build.gradleï¼Œæ‰¾åˆ°buildTypes,ä¿®æ”¹releaseçš„signingConfigs.releaseä¸ºdebug:12345678buildTypes &#123; debug &#123; signingConfig signingConfigs.debug &#125; release &#123; signingConfig signingConfigs.debug &#125;&#125; æˆ–è€…è‡ªå·±é‡æ–°é…ç½®releaseçš„ç­¾å 3.ç¬¬ä¸€æ¬¡æ„å»ºFlutteré¡¹ç›®ä¸€ç›´å¡åœ¨Initializing gradleâ€¦ç»“åˆç½‘ä¸Šåšå®¢æ€»ç»“ï¼Œæœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆ1.ä¿®æ”¹é•œåƒåšå®¢åœ°å€:Flutter è¿è¡Œ ä¸€ç›´Initializing gradleâ€¦ï¼Œå’Œæ¨¡æ‹Ÿå™¨è¿è¡Œç™½å±é—®é¢˜ æœ¬äººæµ‹è¯•å‘ç°æ²¡æœ‰æ•ˆæœï¼Œäºæ˜¯æ‰¾åˆ°äº†ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆ,äº²æµ‹æœ‰æ•ˆ 2.ä¿®æ”¹gradleä¸‹è½½åœ°å€æ‰¾åˆ°é¡¹ç›®ä¸­çš„android-&gt;gradle-&gt;wrapper-&gt;gradle-wrapper.properties:123456#Fri Jun 23 08:50:38 CEST 2017distributionBase=GRADLE_USER_HOMEdistributionPath=wrapper/distszipStoreBase=GRADLE_USER_HOMEzipStorePath=wrapper/distsdistributionUrl=https\://services.gradle.org/distributions/gradle-4.10.2-all.zip ä¿®æ”¹distributionUrlï¼Œå¯ä»¥å…ˆçœ‹ä¸€ä¸‹ä½ æœ¬åœ°èƒ½è¿è¡Œçš„é¡¹ç›®çš„gradleçš„é…ç½®ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥ä¿®æ”¹ä¸º:1distributionUrl=https\://services.gradle.org/distributions/gradle-4.6-all.zip ä½ç‰ˆæœ¬æ˜¯ä¸è¡Œçš„ï¼Œflutteréœ€è¦çš„gradleç‰ˆæœ¬éœ€è¦4.6æˆ–æ›´é«˜æ‰è¡Œ,æ‰€ä»¥ä½ æœ¬åœ°å¦‚æœæ¯”è¿™ä¸ªä½ä¹Ÿéœ€è¦æ”¹æˆæ›´é«˜çš„ã€‚ æˆ‘çŒœæµ‹æ˜¯å› ä¸ºè¿™ä¸ªåœ°å€åœ¨æœ¬åœ°æ˜¯æ²¡æœ‰çš„ï¼Œæ‰€ä»¥éœ€è¦åˆ°gradleå®˜ç½‘ä¸Šå»ä¸‹è½½ï¼Œè€Œåœ¨ä¸­å›½ä¸‹è½½æ˜¯å·¨æ…¢çš„ï¼Œæ‰€ä»¥ä¼šä¸€ç›´å¡åœ¨é‚£é‡Œï¼Œå¦‚æœæ¢æˆæœ¬åœ°çš„å°±ä¸éœ€è¦å»ä¸‹è½½äº†ï¼Œç›´æ¥ä½¿ç”¨æœ¬åœ°çš„gradle,æ‰€ä»¥å°±å˜å¿«äº†ã€‚ Flutterå¼€å‘é—®é¢˜1.ä½¿ç”¨Navigator.push()è·³è½¬ç•Œé¢æŠ¥é”™ï¼š123&apos;Navigator operation requested with a context that does not include a Navigator.\n&apos;&apos;The context used to push or pop routes from the Navigator must be that of a &apos;&apos;widget that is a descendant of a Navigator widget.&apos; åŸå› ï¼šä¼ å…¥çš„contextä¸æ”¯æŒå †æ ˆç®¡ç†ï¼Œæ¯”å¦‚ä¸€ä¸ªç±»ç›´æ¥ç»§æ‰¿è‡ªStatelessWidgetæˆ–StatefulWidgetï¼Œè€Œå®ƒæœ¬èº«æˆ–çˆ¶ç±»æ²¡æœ‰å †æ ˆç®¡ç†åŠŸèƒ½ã€‚é‚£ä¹ˆè¿™ä¸ªç±»æ˜¯ä¸æ”¯æŒé¡µé¢è·³è½¬çš„ï¼Œæ‰€ä»¥å°±ä¼šæŠ¥é”™ã€‚è¦æŸ¥çœ‹æ˜¯å¦æ”¯æŒé¡µé¢è·³è½¬ï¼Œç›´æ¥è¿›å…¥æºç ï¼Œæ¯”å¦‚MaterialAppç±»ï¼Œå®ƒæ˜¯æ”¯æŒçš„ï¼Œé‚£ä¹ˆå®ƒçš„æºç é‡Œä¼šæœ‰å¯¹åº”çš„åŠŸèƒ½ä»‹ç»ï¼š1234567891011/// See also:////// * [Scaffold], which provides standard app elements like an [AppBar] and a [Drawer]./// * [Navigator], which is used to manage the app&apos;s stack of pages. //è¿™é‡Œåšäº†å¯¹åº”çš„ä»‹ç»/// * [MaterialPageRoute], which defines an app page that transitions in a material-specific way./// * [WidgetsApp], which defines the basic app elements but does not depend on the material library./// * The Flutter Internationalization Tutorial,/// &lt;https://flutter.io/tutorials/internationalization/&gt;.class MaterialApp extends StatefulWidget &#123; .....&#125; æ”¾ä¸€ä¸ªæŠ¥é”™çš„ä»£ç ï¼š1234567891011121314151617181920212223void main() =&gt; runApp(new MyApp());class MyApp extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return new MaterialApp( title: &apos;Welcome to Flutter&apos;, home: new Scaffold( body:Container( child: FlatButton(onPressed:()&#123; var push = Navigator.push(context,MaterialPageRoute(builder: (BuildContext context) &#123; return new OtherPager(&quot;æˆ‘æ˜¯ä»mainä¼ è¿‡å»çš„å€¼&quot;); &#125;)); push.then((value)&#123; print(&quot;æˆ‘æ˜¯ä»ä¸Šä¸ªé¡µé¢ä¼ é€’å›æ¥çš„å€¼$value&quot;); &#125;); &#125;, child:new Icon(Icons.build)), ) ) ); &#125;&#125; è¿™é‡Œçš„MyAppæ˜¯ç›´æ¥ç»§æ‰¿è‡ªStatelessWidgetçš„ï¼Œè€Œåœ¨runApp()ä¸­ç›´æ¥ä½¿ç”¨äº†å®ƒï¼Œå®ƒæ²¡æœ‰çˆ¶ç±»è€Œå®ƒæœ¬èº«ä¹Ÿä¸æ”¯æŒç•Œé¢çš„è·³è½¬ï¼Œæ‰€ä»¥ç”¨å®ƒçš„contextä¼ å…¥åˆ°Navigatorä¸­è‚¯å®šæ˜¯ä¼šæŠ¥é”™çš„è§£å†³æ–¹æ¡ˆä½¿ç”¨ä¸€ä¸ªæœ‰å †æ ˆç®¡ç†åŠŸèƒ½çš„çˆ¶ç±»å°†MyAppç±»åŒ…è£¹ï¼Œä½¿å…¶å…·æœ‰å †æ ˆè·³è½¬åŠŸèƒ½è§å¦‚ä¸‹ä»£ç ï¼š12345678910111213141516171819202122void main() =&gt; runApp(MaterialApp(home: MyApp()));class MyApp extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; // TODO: implement build return new Scaffold( body: Container( child: FlatButton( onPressed: () &#123; var push = Navigator.push(context, MaterialPageRoute(builder: (BuildContext context) &#123; return new OtherPager(&quot;æˆ‘æ˜¯ä»mainä¼ è¿‡å»çš„å€¼&quot;); &#125;)); push.then((value) &#123; print(&quot;æˆ‘æ˜¯ä»ä¸Šä¸ªé¡µé¢ä¼ é€’å›æ¥çš„å€¼$value&quot;); &#125;); &#125;, child: new Icon(Icons.build)), )); &#125;&#125; ä»£ç ä¸­å°†MaterialAppç§»å‡ºæ¥äº†ï¼Œç›´æ¥å°†MyAppåŒ…è£¹äº†ï¼Œé‚£ä¹ˆMyAppçš„contextå°±ç”Ÿæ•ˆäº†ï¼Œä»£ç ä¹Ÿä¸ä¼šæŠ¥é”™å•¦ã€‚ 2.åœ¨pubspec.yamlç”³æ˜æœ¬åœ°å›¾ç‰‡è·¯å¾„æŠ¥é”™é”™è¯¯ä¿¡æ¯ï¼š12345Error on line 29, column 4 of pubspec.yaml: Expected a key while parsing a block mapping. assets: ^pub get failed (65) åŸå› ï¼šæ ¼å¼ä¸å¯¹ï¼Œæ³¨æ„ç©ºæ ¼ï¼Œä¸ä¸Šé¢å¯¹é½,ç›´æ¥å°†åŸæ¥çš„å®˜æ–¹æ³¨é‡Šæ‰çš„è§£å¼€å°±ä¼šå‡ºç°è¿™ä¸ªé”™è¯¯ï¼Œåˆ«é—®æˆ‘æ€ä¹ˆçŸ¥é“çš„!!]]></content>
      <categories>
        <category>flutter</category>
      </categories>
      <tags>
        <tag>flutter</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[flutter_reduxæ¡†æ¶çš„ä½¿ç”¨]]></title>
    <url>%2Fflutter-redux%E6%A1%86%E6%9E%B6%E7%9A%84%E4%BD%BF%E7%94%A8.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æ–‡ç« é¦–å‘äºæˆ‘çš„ç®€ä¹¦,æœ¬å¤„åªåšæ•´ç†å½’æ¡£ç”¨ æ¡†æ¶ç®€ä»‹ä»¥åŠä½œç”¨flutter_reduxæ˜¯åŸºäºInheritedWidgetå°è£…çš„ç”¨äºWidgetæ ‘çš„æ•°æ®ä¼ é€’ä¸å…±äº«çš„çš„ä¸€å¥—æ¡†æ¶ï¼Œå®ƒèƒ½é«˜æ•ˆçš„å®Œæˆæ•°æ®å…±äº«ï¼Œè¿›è€Œè¾¾åˆ°uiåŠæ—¶æ›´æ–°ç­‰ç›®çš„ï¼Œä½¿ç”¨èµ·æ¥ç•¥æ˜¾å¤æ‚ï¼Œä¸€èˆ¬ä¸æ˜¯å¾ˆå¤šçš„æ•°æ®æ›´æ–°ä¸å»ºè®®ä½¿ç”¨ï¼Œç›´æ¥ç”¨InheritedWidgetå°±èƒ½è§£å†³ï¼Œå½“Widgetç»‘å®šçš„å¾ˆå¤šçš„æ—¶å€™ï¼Œä½¿ç”¨èµ·æ¥å°±ä¼šå¾ˆçˆ½äº†ã€‚ğŸŒ¼ å¼€å§‹ä½¿ç”¨æ‰“å¼€pubspec.yamlæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š1234dependencies: flutter: sdk: flutter flutter_redux: ^0.5.3 å…³äºç‰ˆæœ¬å¯å‰å¾€dartåº“æŸ¥çœ‹ï¼Œä¼ é€é—¨ï¼šflutter_redux ä½¿ç”¨æ­¥éª¤ï¼š1.æ–°å»ºä¸€ä¸ªæ•°æ®å…±äº«ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œé‡Œé¢ç”³æ˜éœ€è¦å…±äº«çš„æ•°æ®2.æ–°å»ºä¸€ä¸ªæšä¸¾ç”¨äºæ¶ˆæ¯å‘é€ä¸åŒºåˆ†3.ç”³æ˜ä¸€ä¸ªæ–¹æ³•ç”¨äºå¤„ç†æ•°æ®æ›´æ–°é€»è¾‘ä¸æ–°çš„æ•°æ®è¿”å›4.ç”³æ˜Storeç±»ï¼Œå°†æ­¥éª¤4çš„æ–¹æ³•æ”¾è¿›å»5.åœ¨éœ€è¦å…±äº«æ•°æ®çš„åœ°æ–¹ç”³æ˜StoreProviderè·Ÿå¸ƒå±€ï¼Œç»‘å®šStoreç±»6.ä½¿ç”¨StoreConnectorç±»æˆ–StoreBuilderå¤„ç†æ•°æ®é€»è¾‘ä¸Widgetäº¤äº’é€»è¾‘ æ³¨æ„äº‹é¡¹ï¼šä½¿ç”¨StoreConnectorè¦æ³¨æ„å‰é¢çš„æ³›å‹ç”³æ˜ï¼Œå…·ä½“ä½¿ç”¨çœ‹ä»¥ä¸‹ç¤ºä¾‹ä»£ç (æ¥è‡ªå®˜æ–¹ç¤ºä¾‹)ï¼Œæ­¤ç¤ºä¾‹å®ç°äº†ä¸€ä¸ªç‚¹å‡»æŒ‰é’®æ–‡æœ¬åŠ ä¸€çš„æ•ˆæœã€‚ ä»£ç åˆ†æ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import &apos;package:flutter/material.dart&apos;;import &apos;package:flutter_redux/flutter_redux.dart&apos;;import &apos;package:redux/redux.dart&apos;;void main() &#123; runApp(FlutterReduxApp());&#125;//æ­¥éª¤2ï¼Œç”¨äºåœ¨æ­¥éª¤ä¸‰ä¸­åšæ¶ˆæ¯åŒºåˆ†ä¸æ¶ˆæ¯å‘é€enum Action &#123; Increment &#125;//æ­¥éª¤1çš„æ•°æ®å…±äº«ç±»æ˜¯count,ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹//æ­¥éª¤3ï¼Œå¤„ç†æ•°æ®çš„æ›´æ–°é€»è¾‘ï¼Œæ­¤å¤„æ˜¯åšåŠ ä¸€æ“ä½œï¼Œæ³¨æ„éœ€è¦æŠŠæ–°çš„ç±»å‹è¿”å›int reducer(int count, action) &#123; if (action == Action.Increment) &#123; return count + 1; &#125; return count;&#125;class FlutterReduxApp extends StatelessWidget &#123; //æ­¥éª¤4 ç”³æ˜ä¸€ä¸ªstore,å¿…é¡»ä¼ å…¥ä¸€ä¸ªæ–¹æ³•è¿›å»ï¼Œå…¶ä½™çš„å‚æ•°é€‰å¡«ï¼Œè¿™é‡Œé€‰æ‹©åˆå§‹åŒ–ä¸€ä¸‹åŸºç¡€å‚æ•° final store = Store(reducer, initialState: 0); @override Widget build(BuildContext context) &#123; return StoreProvider( store: store, //ç»‘å®šstore child: MaterialApp( home: Scaffold( appBar: AppBar( title: Text(&quot;Title&quot;), ), body: Center( child: Column( mainAxisAlignment: MainAxisAlignment.center, children: &lt;Widget&gt;[ Text(&quot;You have pushed the button this many times:&quot;), //å½“éœ€è¦ä½¿ç”¨åˆ°å…±äº«æ•°æ®çš„æ—¶å€™ä½¿ç”¨StoreConnectoræ¥è·å–æ•°æ® StoreConnector&lt;int, String&gt;(builder: (context, value) &#123; return Text(value, style: Theme.of(context).textTheme.display1); &#125;, converter: (Store store) &#123; return store.state.toString(); &#125;) ], ), ), floatingActionButton: StoreConnector&lt;int, VoidCallback&gt;( converter: (Store store) &#123; return () =&gt; store.dispatch(Action.Increment); //å‘é€æ•°æ® &#125;, builder: (BuildContext context, VoidCallback callback) &#123; return FloatingActionButton( onPressed: callback, child: Icon(Icons.add)); &#125;, ), ), )); &#125;&#125; æºç ä¸­ä¸»è¦æ³¨æ„å¦‚ä¸‹åœ°æ–¹ï¼š1.StoreConnectorçš„ä½¿ç”¨StoreConnectorä¸»è¦æ˜¯èµ·ä¸€ä¸ªæ•°æ®è½¬åŒ–çš„ä½œç”¨ï¼Œå¯ä»¥åœ¨ç»„ä»¶èµ‹å€¼ä¹‹å‰åšä¸€äº›æ•°æ®è½¬åŒ–æ“ä½œï¼Œè€ŒStoreBuilderæ˜¯ç›´æ¥å°†å…±äº«çš„æ•°æ®èµ‹å€¼åœ¨ç»„ä»¶ä¸Šï¼Œå…·ä½“çš„é€‰æ‹©çœ‹éœ€æ±‚è€Œå®šã€‚StoreConnectoræœ‰ä¸¤ä¸ªæ³›å‹å‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æˆ‘ä»¬çš„åŸæœ¬çš„å…±äº«ç±»å‹ï¼Œç¬¬äºŒä¸ªæ˜¯æˆ‘ä»¬éœ€è¦è½¬æ¢çš„å‚æ•°ç±»å‹ï¼Œå®ƒå¯ä»¥æ˜¯ç±»ï¼Œæ–¹æ³•ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹ç­‰éƒ½å¯ä»¥å®ƒéœ€è¦ç”³æ˜ä¸¤ä¸ªæ–¹æ³•ï¼š converter èµ·æ•°æ®è½¬åŒ–ä½œç”¨ï¼Œä¾‹å¦‚æºç ä¸­ç”³æ˜äº†ä¸€ä¸ªStringç±»å‹çš„è½¬åŒ–å‚æ•°ï¼Œé‚£ä¹ˆconverterçš„è¿”å›å€¼å°±æ˜¯ä¸€ä¸ªStringç±»å‹ï¼Œè¿”å›å€¼ä¼šç›´æ¥ä¼ é€’åˆ°builderæ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ä¸­å»ã€‚ builder æ¥æ”¶æ•°æ®ï¼Œæ„å»ºWidgetäº¤äº’ï¼Œç¬¬ä¸€ä¸ªcontextä¸éœ€è¦è§£é‡Šï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯æˆ‘ä»¬ç”³æ˜çš„è½¬åŒ–å‚æ•°çš„è¿”å›å€¼ï¼Œè¿”å›å€¼ç±»å‹è§†ä¼ å…¥çš„æ³›å‹ç±»å‹è€Œå®šã€‚ ç»è¿‡ä»¥ä¸Šåˆ†æï¼Œéœ€è¦æ³¨æ„çš„å°±æ˜¯æ³›å‹çš„ç”³æ˜ä»¥åŠå®ƒçš„æ•°æ®æµå‘ï¼šStoreConnectorç”³æ˜ä¸€ä¸ªè½¬åŒ–ç±»å‹=&gt;converter è½¬åŒ–=&gt;builderæ–¹æ³•ä¸­æ¥æ”¶å¹¶ä½¿ç”¨ store.dispatch(Action.Increment);æ­¤æ–¹æ³•ç”¨æ¥é€šçŸ¥æ•°æ®çš„æ”¹å˜ä¸æ›´æ–° StoreBuilderä¸StoreConnectorä¸åŒï¼Œå®ƒåªéœ€è¦ç”³æ˜ä¸€ä¸ªå…±äº«æ•°æ®ç±»å‹çš„æ³›å‹ï¼Œåœ¨ä½¿ç”¨ä¸­ä¹Ÿåªæœ‰ä¸€ä¸ªbuilderå‚æ•°ï¼Œä½¿ç”¨æ–¹å¼ä¸StoreConnectorä¸€æ ·ï¼Œç¤ºä¾‹ï¼š12345return new StoreProvider( store: store, child: new StoreBuilder&lt;String&gt;(builder: (context, count) &#123; return new Text(count); );]]></content>
      <categories>
        <category>flutter</category>
      </categories>
      <tags>
        <tag>flutter</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Glideè®¾ç½®é»˜è®¤å›¾ç‰‡åsetImageBitmap,setImageResourceå¤±æ•ˆé—®é¢˜]]></title>
    <url>%2FGlide%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E5%9B%BE%E7%89%87%E5%90%8EsetImageBitmapsetImageResource%E5%A4%B1%E6%95%88%E9%97%AE%E9%A2%98.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æ–‡ç« é¦–å‘äºæˆ‘çš„ç®€ä¹¦,æœ¬å¤„åªåšæ•´ç†å½’æ¡£ç”¨ å¤ç°åœºæ™¯åœ¨é€‚é…å™¨ä¸­æ·»åŠ äº†ä¸€ä¸ªæ¡ä»¶ï¼Œpathä¸ºç©ºå°±å»åŠ è½½æœ¬åœ°å›¾ç‰‡ï¼Œä¸ä¸ºç©ºå°±ä½¿ç”¨Glideå»åŠ è½½å›¾ç‰‡ï¼Œä¼ªä»£ç å®ç°å¦‚ä¸‹ï¼š12345678@Override public void onBindViewHolder(ViewHolder holder, int position) &#123; if(path==null)&#123; imageView.setImageResource(R.drawable.my_image) &#125;else&#123; Glide.with(this).load(path).apply( RequestOptions().placeholder(R.drawable.place).error(R.drawable.error)).into(imageView) &#125; &#125; å’‹ä¸€çœ‹æ²¡å•¥é—®é¢˜,å½“pathä¸ºä¸€ä¸ªæ— æ•ˆåœ°å€çš„æ—¶å€™ï¼ŒimageViewä¼šæ˜¾ç¤ºerrorçš„å›¾ç‰‡ï¼Œä½†æ˜¯å½“pathä¸ºnullçš„æ—¶å€™ï¼Œå‘ç°imageViewæ²¡æœ‰æ˜¾ç¤ºmy_imageï¼Œè¿˜æ˜¯æ˜¾ç¤ºçš„errorå›¾ç‰‡ï¼Œæ‰“æ–­ç‚¹å‘ç°imageView.setImageResource(R.drawable.my_image)è¿™å¥ä»£ç æ˜¯æ‰§è¡Œäº†çš„ï¼Œä½†ä¸ºä»€ä¹ˆä¼šå¤±æ•ˆå‘¢ï¼Ÿ è§£å†³æ–¹æ¡ˆå…ˆæ¥è¯´ä¸€ä¸‹è§£å†³æ–¹æ¡ˆï¼Œå¦‚æœå¯¹å‡ºç°åŸå› (ä»æºç å±‚é¢åˆ†æ)æ„Ÿå…´è¶£å¯ä»¥ç»§ç»­å¾€ä¸‹çœ‹ 1.ä½¿ç”¨Glide.with(this).clear(imageView)å…³é—­å¤±è´¥é‡è¯•2.ä½¿ç”¨GlideåŠ è½½æœ¬åœ°å›¾ç‰‡,ä¸ä½¿ç”¨åŸç”ŸApi:1Glide.with(imageView).load(R.drawable.my_image).into(imageView) å‡ºç°åŸå› Glideå†…éƒ¨æœ‰åŠ è½½å¤±è´¥é‡è¯•æœºåˆ¶ï¼Œå½“ç¬¬ä¸€æ¬¡åŠ è½½å¤±è´¥ï¼Œé‡è¯•æœºåˆ¶å°±ä¼šå¯åŠ¨ï¼Œè¿™æ—¶imageView.setImageResource(R.drawable.my_image)ä¹ŸåŒæ­¥æ‰§è¡Œäº†ï¼Œä½†æ˜¯å½“é‡è¯•æœºåˆ¶æ‰§è¡Œå®Œæ¯•åï¼ŒGlideå‘ç°å›¾ç‰‡æœ€ç»ˆè¿˜æ˜¯åŠ è½½å¤±è´¥ï¼Œæ‰€ä»¥ä¼šå°†errorä¸­è®¾ç½®çš„å›¾ç‰‡åˆæ·»åŠ åˆ°imageViewä¸Šå»ï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯imageView.setImageResource(R.drawable.my_image)è¿™å¥ä»£ç å¤±æ•ˆäº†ï¼Œè€Œæ˜¯Glideåˆé‡æ–°è®¾ç½®äº†ä¸€éã€‚ æˆ‘ä»¬å¯ä»¥æ¥ç…ä¸€çœ¼æºç ï¼Œæˆ‘ä»¬çŸ¥é“å›¾ç‰‡åŠ è½½å¤±è´¥æ˜¯æœ‰ä¸€ä¸ªå›è°ƒçš„ï¼Œæ‰€ä»¥ä»å›è°ƒå…¥æ‰‹ï¼šå…ˆæ‰¾åˆ°RequestListenerå›è°ƒï¼š12345678910public interface RequestListener&lt;R&gt; &#123; boolean onLoadFailed( @Nullable GlideException e, Object model, Target&lt;R&gt; target, boolean isFirstResource); boolean onResourceReady( R resource, Object model, Target&lt;R&gt; target, DataSource dataSource, boolean isFirstResource);&#125; éšåæ‰¾åˆ°onLoadFailedå®ç°ç±»SingleRequest:123456789101112131415161718192021222324252627282930313233343536/** * A callback method that should never be invoked directly. */@Overridepublic void onLoadFailed(GlideException e) &#123; onLoadFailed(e, Log.WARN);&#125;private void onLoadFailed(GlideException e, int maxLogLevel) &#123; stateVerifier.throwIfRecycled(); int logLevel = glideContext.getLogLevel(); if (logLevel &lt;= maxLogLevel) &#123; Log.w(GLIDE_TAG, &quot;Load failed for &quot; + model + &quot; with size [&quot; + width + &quot;x&quot; + height + &quot;]&quot;, e); if (logLevel &lt;= Log.INFO) &#123; e.logRootCauses(GLIDE_TAG); &#125; &#125; loadStatus = null; status = Status.FAILED; isCallingCallbacks = true; try &#123; //TODO: what if this is a thumbnail request? if ((requestListener == null || !requestListener.onLoadFailed(e, model, target, isFirstReadyResource())) //å¯ä»¥çœ‹åˆ°listenceçš„æ¥å£è°ƒç”¨æ˜¯åœ¨è¿™é‡Œï¼Œè¿”å›å€¼å†³å®šäº†æ˜¯å¦å¾€ä¸‹è°ƒç”¨é€»è¾‘ &amp;&amp; (targetListener == null || !targetListener.onLoadFailed(e, model, target, isFirstReadyResource()))) &#123; setErrorPlaceholder(); &#125; &#125; finally &#123; isCallingCallbacks = false; &#125; notifyLoadFailed(); //è¿™é‡Œä¼šé‡è¯•ä¸€æ¬¡&#125; å¯ä»¥çœ‹åˆ°è¿™é‡Œä¼šå…ˆæœ‰ä¸€ä¸ªrequestListenerçš„æ¥å£è°ƒç”¨ï¼Œè¿™é‡ŒrequestListenerå…¶å®å°±æ˜¯æˆ‘ä»¬çš„listenceç›‘å¬åŠŸèƒ½ï¼š1234567891011Glide.with(imageView).load(url).listener(new RequestListener&lt;Drawable&gt;() &#123; @Override public boolean onLoadFailed(@Nullable GlideException e, Object model, Target&lt;Drawable&gt; target, boolean isFirstResource) &#123; return false; &#125; @Override public boolean onResourceReady(Drawable resource, Object model, Target&lt;Drawable&gt; target, DataSource dataSource, boolean isFirstResource) &#123; return false; &#125; &#125;) åªæœ‰è¿”å›falseæ‰ä¼šå»è°ƒç”¨setErrorPlaceholder()æ–¹æ³•ï¼Œçœ‹ä¸€ä¸‹ï¼š12345678910111213141516171819private void setErrorPlaceholder() &#123; if (!canNotifyStatusChanged()) &#123; return; &#125; Drawable error = null; if (model == null) &#123; error = getFallbackDrawable(); &#125; // Either the model isn&apos;t null, or there was no fallback drawable set. if (error == null) &#123; error = getErrorDrawable(); &#125; // The model isn&apos;t null, no fallback drawable was set or no error drawable was set. if (error == null) &#123; error = getPlaceholderDrawable(); &#125; target.onLoadFailed(error); //targetå°±æ˜¯æˆ‘ä»¬è®¾ç½®è¿›å»çš„ImageView&#125; åœ¨çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„onLoadFailedå®ç°ï¼š123456@Overridepublic void onLoadFailed(@Nullable Drawable errorDrawable) &#123; super.onLoadFailed(errorDrawable); setResourceInternal(null); setDrawable(errorDrawable);&#125; æ‰€ä»¥setErrorPlaceholderæ–¹æ³•çš„ä½œç”¨å°±æ˜¯æŠŠæˆ‘ä»¬è®¾ç½®çš„errorå›¾ç‰‡è®¾ç½®ç»™æˆ‘ä»¬æ”¾è¿›å»çš„ImageViewä¸Šæˆ‘ä»¬å›åˆ°onLoadFailedæ–¹æ³•ä¸­ï¼Œå‘ç°æœ€åè°ƒç”¨äº†notifyLoadFailed()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å¹²å˜›çš„å‘¢ï¼Œçœ‹ä¸€ä¸‹æºç ï¼š12345private void notifyLoadFailed() &#123; if (requestCoordinator != null) &#123; requestCoordinator.onRequestFailed(this); &#125;&#125; æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å®ƒçš„å®ç°,æ˜¯åœ¨ErrorRequestCoordinatorä¸­ï¼š12345678910if (!request.equals(error)) &#123; if (!error.isRunning()) &#123; error.begin(); &#125; return;&#125;if (parent != null) &#123; parent.onRequestFailed(this);&#125; æˆ‘ä»¬å‘ç°è°ƒç”¨äº†ä¸€ä¸ªç†Ÿæ‚‰çš„æ–¹æ³•ï¼Œbegin()ï¼Œç ”ç©¶è¿‡æºç çš„éƒ½çŸ¥é“ï¼ŒGlideéƒ½ä¼šåœ¨è¿™ä¸ªæ¥å£å®ç°å¼€å§‹å¼‚æ­¥åŠ è½½çš„æ–¹æ³•ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œåˆä¼šå»å¼€å§‹å¼‚æ­¥åŠ è½½å›¾ç‰‡ æ‰€ä»¥ï¼Œèµ°ä¸€åœˆä¸‹æ¥ï¼Œå¤§è‡´çš„æµç¨‹å°±æ˜¯è¿™æ ·å­ï¼šåœ¨SingleRequestç±»ä¸­å…ˆè°ƒç”¨beginå¼€å§‹å¼‚æ­¥åŠ è½½å›¾ç‰‡-&gt;åŠ è½½å¤±è´¥-&gt;onLoadFailed()-&gt;è°ƒç”¨notifyLoadFailed()æ–¹æ³•é‡è¯•(å†…éƒ¨ä¼šåˆ¤æ–­æ˜¯å¦éœ€è¦é‡è¯•)-&gt;éœ€è¦åŠ è½½é‡è¯•-&gt;begin]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç©è½¬Classä¹‹Classçš„å„ç§éªšæ“ä½œ(åå°„å°è£…å¿…çœ‹)]]></title>
    <url>%2Fandroidclassstudy.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æ–‡ç« é¦–å‘äºæˆ‘çš„ç®€ä¹¦,æœ¬å¤„åªåšæ•´ç†å½’æ¡£ç”¨ ç®€ä»‹Classç±»è¡¨ç¤ºæ­£åœ¨è¿è¡Œçš„Javaåº”ç”¨ç¨‹åºä¸­çš„ç±»å’Œæ¥å£ï¼Œæšä¸¾å’ŒåŸºæœ¬æ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­è·å–åˆ°ç±»çš„ä¸€åˆ‡ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬å­—æ®µï¼Œæ–¹æ³•ï¼Œåç§°ï¼Œçˆ¶ç±»ï¼Œæ¥å£ç­‰ å¸¸ç”¨æ–¹æ³•ä»‹ç»åç§°è·å–æ­¤ç±»æ–¹æ³•ç”¨äºè·å–ç±»çš„åç§°ä¿¡æ¯getName()æ–¹æ³• å¦‚æœæ˜¯ä¸€ä¸ªå®ä½“ç±»ï¼Œåˆ™ä¼šè¿”å›å®Œæ•´åŒ…åè·¯å¾„åç§°,ä¾‹å¦‚ä½äºcom.hj.testclassåŒ…ä¸‹çš„studentç±»ï¼Œåˆ™ä¼šè¿”å›com.hj.testclass.student å¦‚æœæ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹ï¼Œåˆ™è¿”å›å†…éƒ¨åµŒå¥—æ·±åº¦çš„ä¸€ä¸ªæˆ–å¤šä¸ªâ€[â€œå­—ç¬¦ï¼Œåé¢æ‹¼æ¥ä¸ŠåŸºæœ¬æ•°æ®ç±»å‹çš„äºŒè¿›åˆ¶åç§°,äºŒè¿›åˆ¶åç§°è¡¨å¦‚ä¸‹ï¼š Element Type Encoding boolean Z byte B char C class or interface Lclassname double D float F int I long J short S ç¤ºä¾‹ï¼š 123(new long[1][2][3]).getClass().getName()è¾“å‡º:[[[J å¦‚æœæ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œåˆ™ä¼šè¿”å›æ•°æ®ç±»å‹çš„å…³é”®å­—123byte.class.getName()è¾“å‡ºï¼šbyte getSimpleName()æ–¹æ³•è¿”å›æºä»£ç ä¸­ç»™å‡ºçš„åŸºç¡€ç±»çš„ç®€å•åç§°ã€‚ å¦‚æœåŸºç¡€ç±»æ˜¯åŒ¿åçš„ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚12345Student student = new Student();Class mClass = student.getClass();log(&quot;getSimpleName:&quot;+mClass.getSimpleName());è¾“å‡ºï¼šStudent getPackage()æ–¹æ³•è¿”å›åŒ…åä¿¡æ¯ æ³¨è§£ç›¸å…³å¯è·å–æ­¤ç±»æ˜¯å¦æ˜¯æ³¨è§£ï¼Œæ˜¯å¦åŒ…å«æŸæ³¨è§£å¹¶è·å–åˆ°å…¶å¯¹è±¡ï¼Œè·å–å…¨éƒ¨æ³¨è§£ æ–¹æ³• ä½œç”¨ getAnnotation(Class annotationClass) è·å–ä¼ å…¥çš„æ³¨è§£å¯¹è±¡ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›null getAnnotations() è¿”å›æ­¤ç±»ä¸Šçš„æ‰€æœ‰æ³¨è§£ getAnnotationsByType(Class annotationClass) è¿”å›ä¼ å…¥çš„æ³¨è§£å¯¹è±¡æ•°ç»„ï¼Œä¸getAnnotation()çš„åŒºåˆ«æ˜¯æ£€æµ‹ä¼ å…¥çš„æ³¨è§£æ˜¯å¦æ˜¯é‡å¤å…ƒç´  isAnnotation() åˆ¤æ–­è¿™ä¸ªç±»æ˜¯å¦æ˜¯ä¸€ä¸ªæ³¨è§£ç±» isAnnotationPresent(Class&lt;? extends Annotation&gt; annotationClass) æ˜¯å¦åŒ…å«ä¼ å…¥çš„æ³¨è§£ç±»,æ•ˆæœä¸getAnnotation()!=nullç›¸åŒ ä¸¾ä¸ªæ —å­ï¼šæ–°å»ºä¸€ä¸ªæ³¨è§£å¯¹è±¡ï¼š 1234567/** * Created by hj on 2019/1/10. * è¯´æ˜ï¼š */@Retention(RetentionPolicy.RUNTIME)public @interface MyAnnotation &#123;&#125; æ–°å»ºä¸€ä¸ªStudentå¹¶åŠ å…¥@MyAnnotationæ³¨è§£ï¼š12345678910111213141516171819202122232425262728/** * Created by hj on 2019/1/10. * è¯´æ˜ï¼š */@MyAnnotationpublic class Student&#123; public static void main(String[] args) &#123; Student student = new Student(); Class studentClass = student.getClass(); boolean isAnnotation = studentClass.isAnnotation(); log(studentClass.getSimpleName()+&quot;æ˜¯å¦æ˜¯æ³¨è§£ç±»:&quot;+isAnnotation); boolean isContainAnnotation = studentClass.isAnnotationPresent(MyAnnotation.class); log(studentClass.getSimpleName()+&quot;æ˜¯å¦åŒ…å«MyAnnotationæ³¨è§£ç±»:&quot;+isContainAnnotation); Annotation annotation = studentClass.getAnnotation(MyAnnotation.class); Annotation[] annotations = studentClass.getAnnotations(); if (annotation != null) &#123; log(&quot;è·å–æŒ‡å®šçš„MyAnnotationç±»:&quot;+annotation.toString()); &#125; if (annotations.length &gt; 0)&#123; log(&quot;è·å–æ³¨è§£é›†åˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ :&quot;+annotations[0].toString()); &#125; &#125; private static void log(String value) &#123; System.out.print(value); &#125;&#125; æ‰“å°ï¼š1234Studentæ˜¯å¦æ˜¯æ³¨è§£ç±»:falseStudentæ˜¯å¦åŒ…å«MyAnnotationæ³¨è§£ç±»:trueè·å–æŒ‡å®šçš„MyAnnotationç±»:@jie.com.imageoptimize.mclass.MyAnnotation()è·å–æ³¨è§£é›†åˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ :@jie.com.imageoptimize.mclass.MyAnnotation() æ„é€ æ–¹æ³•ç›¸å…³åœ¨ä»‹ç»æ„é€ æ–¹æ³•ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€ä¸ªç±»Constructor,å®ƒçš„ä½œç”¨æ˜¯æä¾›ä¸€ä¸ªç±»çš„å•ä¸ªæ„é€ æ–¹æ³•çš„ä¿¡æ¯è®¿é—®ï¼Œå¦‚æœä¸€ä¸ªç±»æœ‰ä¸¤ä¸ªæ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±ä¼šå¯¹åº”æœ‰ä¸¤ä¸ªConstructorç±»ï¼Œå®ƒå¯ä»¥ä½¿ç”¨newInstanceæ–¹æ³•æ¥è¿›è¡Œç±»çš„æ„é€ æ–¹æ³•å®ç°å¹¶è¿›è¡Œæ‰©å±•ï¼Œä½†å¦‚æœå‘ç”Ÿç¼©å°è½¬æ¢åˆ™ä¼šæŠ›å‡ºIllegalArgumentExceptionå¼‚å¸¸ï¼Œæ¯”å¦‚è¿™ä¸ªç±»æœ‰ä¸¤ä¸ªæ„é€ å‚æ•°å´åªä¼ å…¥ä¸€ä¸ªï¼Œå°±ä¼šæŠ›å¼‚å¸¸ã€‚è·å–Constructorä¿¡æ¯çš„æ–¹æ³•æœ‰ï¼š æ–¹æ³• ä½œç”¨ getConstructors() è¿”å›è¿™ä¸ªç±»çš„å…¬å…±æ„é€ å‡½æ•°çš„ Constructorå¯¹è±¡çš„æ•°ç»„ getConstructor(Class&lt;?&gt;..parameterTypes) ä¼ å…¥ä¸€ä¸ªæŒ‡å®šçš„å‚æ•°ç±»å‹æ¥è·å–ç‰¹å®šçš„å…¬å…±æ„é€ æ–¹æ³•ç±» getDeclaredConstructors() ä¸getConstructorsçš„åŒºåˆ«æ˜¯è¿”å›æ‰€æœ‰çš„æ„é€ æ–¹æ³•æ•°ç»„ï¼Œä¸é™äºpublic protected private getDeclaredConstructor(Class&lt;?&gt;..parameterTypes) ä¸getConstructorçš„åŒºåˆ«æ˜¯ä¼šè¿”å›æ‰€æœ‰ç±»å‹çš„æ„é€ æ–¹æ³• æ¥ä¸‹æ¥ä»‹ç»ä¸€ä¸‹Constructorç±»çš„newInstanceæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¯´ç™½äº†å°±æ˜¯æ‰§è¡Œæ„é€ å‡½æ•°çš„ï¼Œä½ ä¼ å…¥ä¸€ä¸ªå½“å‰æ„é€ å‡½æ•°çš„ç±»å‹çš„å€¼è¿›å»ï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œè¿™ä¸ªç±»çš„æ„é€ æ–¹æ³•ã€‚ä¸‹é¢ä¸¾ä¸€ä¸ªåå°„è°ƒç”¨æ„é€ æ–¹æ³•çš„æ —å­ï¼šæ–°å»ºä¸€ä¸ªStudentç±»ï¼Œåˆ†åˆ«æ·»åŠ ä¸¤ä¸ªç§æœ‰æ„é€ æ–¹æ³•ï¼Œä¸€ä¸ªå…¬æœ‰æ„é€ æ–¹æ³•ï¼Œå¹¶æ·»åŠ ä¸¤ä¸ªå‚æ•°ï¼Œåœ¨æ„é€ æ–¹æ³•å¤„æ‰§è¡Œæ‰“å°é€»è¾‘ï¼Œä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455/** * Created by hj on 2019/1/10. * è¯´æ˜ï¼š */public class Student &#123; private String name; private int age; private Student() &#123; &#125; public Student(String name) &#123; this.name = name; log(&quot;å…¬æœ‰æ„é€ æ–¹æ³•æ‰§è¡Œäº†ï¼Œæ‰“å°ä¼ å…¥çš„åç§°ä¸º:&quot;+name); &#125; private Student(int age)&#123; this.age = age; log(&quot;ç§æœ‰æ„é€ æ–¹æ³•æ‰§è¡Œäº†ï¼Œæ‰“å°ä¼ å…¥çš„å¹´é¾„ä¸º:&quot;+age); &#125; public static void main(String[] args) &#123; Student student = new Student(); Class mClass = student.getClass(); Constructor[] constructors = mClass.getConstructors(); log(&quot;è·å–&quot; + mClass.getSimpleName() + &quot;çš„å…¬å…±æ„é€ æ–¹æ³•æ•°é‡ä¸º:&quot; + constructors.length); try &#123; Constructor constructor = mClass.getConstructor(String.class); constructor.newInstance(&quot;å¼ ä¸‰&quot;); &#125; catch (NoSuchMethodException | IllegalAccessException | InstantiationException | InvocationTargetException e) &#123; e.printStackTrace(); &#125; Constructor[] declaredConstructors = mClass.getDeclaredConstructors(); log(&quot;è·å–&quot; + mClass.getSimpleName() + &quot;çš„æ‰€æœ‰æ„é€ æ–¹æ³•æ•°é‡ä¸º:&quot; + declaredConstructors.length); try &#123; Constructor constructor = mClass.getDeclaredConstructor(int.class); constructor.newInstance(18); &#125; catch (NoSuchMethodException | IllegalAccessException | InstantiationException | InvocationTargetException e) &#123; e.printStackTrace(); &#125; &#125; private static void log(String value) &#123; System.out.print(value); &#125;&#125; æ‰“å°ç»“æœå¦‚ä¸‹ï¼š1234è·å–Studentçš„å…¬å…±æ„é€ æ–¹æ³•æ•°é‡ä¸º:1å…¬æœ‰æ„é€ æ–¹æ³•æ‰§è¡Œäº†ï¼Œæ‰“å°ä¼ å…¥çš„åç§°ä¸º:å¼ ä¸‰è·å–Studentçš„æ‰€æœ‰æ„é€ æ–¹æ³•æ•°é‡ä¸º:3ç§æœ‰æ„é€ æ–¹æ³•æ‰§è¡Œäº†ï¼Œæ‰“å°ä¼ å…¥çš„å¹´é¾„ä¸º:18 æ€ä¹ˆæ ·ï¼Œåå°„è°ƒç”¨ç±»çš„æ„é€ æ–¹æ³•æŠ€èƒ½getåˆ°äº†å— å­—æ®µç›¸å…³æ­¤ç±»å‹æ–¹æ³•æ˜¯ç”¨çš„æœ€å¤šçš„ä¸€ç§ï¼Œå¸Œæœ›å°ä¼™ä¼´ä»¬å¯ä»¥ç†Ÿç»ƒæŒæ¡åœ¨ä»‹ç»å­—æ®µæ–¹æ³•ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€ä¸ªç±»Field,å®ƒç”¨äºä¿å­˜ï¼Œä¿®æ”¹å­—æ®µçš„ä¿¡æ¯ï¼Œç”šè‡³å¯ä»¥ä¿®æ”¹å­—æ®µçš„è®¿é—®æƒé™,å¸¸ç”¨çš„æ–¹æ³•å¦‚ä¸‹: æ–¹æ³• ä½œç”¨ getName() è·å–å­—æ®µåç§° get() ä¼ å…¥éœ€è¦è·å–çš„å€¼çš„ç±»çš„å¯¹è±¡ï¼Œè·å–è¯¥å­—æ®µçš„å€¼,è¿”å›objectç±»å‹ï¼Œä½¿ç”¨çš„æ—¶å€™éœ€è¦åšç±»å‹åˆ¤æ–­ getBoolean(),getInt()â€¦ è·å–æŒ‡å®šç±»å‹çš„å­—æ®µå€¼ set()ï¼ŒsetBoolean()â€¦ å°†æŒ‡å®šçš„ç±»çš„æŒ‡å®šå€¼è®¾ç½®ä¸ºæ–°å€¼ isAccessible() åˆ¤æ–­æ­¤å­—æ®µæ˜¯å¦æœ‰è®¿é—®æƒé™ setAccessible() è®¾ç½®å­—æ®µçš„æƒé™ï¼Œä¸ºtrueä»£è¡¨å¯ä»¥è®¿é—® æ¥ä¸‹æ¥å†æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨Classæ¥è·å–å­—æ®µä¿¡æ¯: æ–¹æ³• ä½œç”¨ getFields() è·å–æ‰€æœ‰çš„å…¬å…±å­—æ®µ getField() ä¼ å…¥å­—æ®µçš„åç§°ï¼Œè¿”å›å…¬å…±å­—æ®µå¯¹è±¡ getDeclaredFields() è·å–æ‰€æœ‰å­—æ®µï¼Œè¿”å›ä¸€ä¸ªFieldæ•°ç»„ getDeclaredField ä¼ å…¥å­—æ®µçš„åç§°ï¼Œè¿”å›å­—æ®µå¯¹è±¡,æ— è®¿é—®é™åˆ¶ ä¸‹é¢ä¸¾ä¸ªè·å–å­—æ®µåç§°å’Œå†…å®¹çš„ä¾‹å­ï¼Œå¹¶åˆ†äº«ä¸€ä¸ªå¸¸ç”¨çš„å¥—è·¯å†™æ³•ï¼Œä¸€èˆ¬çš„éƒ½å¯ä»¥æŒ‰ç…§è¿™ä¸ªå¥—è·¯æ¥å†™ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556/** * Created by hj on 2019/1/10. * è¯´æ˜ï¼š */public class Student &#123; public String name; private int age; public Student(String name, int age) &#123; this.name = name; this.age = age; &#125; public static void main(String[] args) &#123; Student student = new Student(&quot;å¼ ä¸‰&quot;, 18); setAllComponentsName(student); &#125; private static void setAllComponentsName(Object f) &#123; Field[] fields = f.getClass().getDeclaredFields(); for (Field field : fields) &#123; // å¯¹äºæ¯ä¸ªå±æ€§ï¼Œè·å–å±æ€§å String varName = field.getName(); try &#123; // è·å–åŸæ¥çš„è®¿é—®æ§åˆ¶æƒé™ boolean accessFlag = field.isAccessible(); // ä¿®æ”¹è®¿é—®æ§åˆ¶æƒé™ field.setAccessible(true); // è·å–åœ¨å¯¹è±¡fä¸­å±æ€§fields[i]å¯¹åº”çš„å¯¹è±¡ä¸­çš„å˜é‡ Object o = field.get(f); if (!&quot;&quot;.equals(varName)) &#123; //è¿™é‡Œå¯ä»¥å¤„ç†ç›¸å…³é€»è¾‘ if (o != null) &#123; if (o instanceof String) &#123; String value = (String) o; log(&quot;Stringç±»å‹å­—æ®µ:&quot; + value); &#125; else if (o instanceof Integer) &#123; int value = (int) o; log(&quot;intç±»å‹å­—æ®µ:&quot; + value); &#125; &#125; &#125; // æ¢å¤è®¿é—®æ§åˆ¶æƒé™ field.setAccessible(accessFlag); &#125; catch (IllegalArgumentException | IllegalAccessException ex) &#123; ex.printStackTrace(); &#125; &#125; &#125; private static void log(String value) &#123; System.out.print(value); &#125;&#125; æ‰“å°ç»“æœï¼š12Stringç±»å‹å­—æ®µ:å¼ ä¸‰intç±»å‹å­—æ®µ:18 ä¸€èˆ¬éƒ½æ˜¯å…ˆå°†æƒé™ä¿®æ”¹ä¸ºtrue,å†å»è¯»å–å­—æ®µå†…å®¹ï¼Œéšåè¿›è¡Œé€»è¾‘å¤„ç†ï¼Œæœ€åè®°å¾—å°†æƒé™æ”¹å›æ¥. æ–¹æ³•ç›¸å…³æ­¤ç±»å‹æ–¹æ³•ä¹Ÿæ˜¯ç”¨çš„æ¯”è¾ƒå¤šçš„ä¸€ç§ï¼Œæ˜¯åå°„è°ƒç”¨æ–¹æ³•çš„å…³é”®classä¸­å…³äºæ–¹æ³•çš„å°è£…éƒ½æ˜¯ç»™Methodç±»æ¥æ“ä½œçš„ï¼Œå®ƒå¯ä»¥è·å–ï¼Œä¿®æ”¹ï¼Œæ‰§è¡Œç±»çš„æ–¹æ³•ï¼Œæ ¸å¿ƒæ–¹æ³•å°±æ˜¯invoke()ï¼Œä½œç”¨æ˜¯æ‰§è¡Œæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦æ‰§è¡Œçš„æ–¹æ³•çš„ç±»å¯¹è±¡ï¼Œéšåæ˜¯éœ€è¦æ‰§è¡Œçš„æ–¹æ³•å‚æ•°å€¼ã€‚è·å–Methodå¯¹è±¡æœ‰å››ä¸ªæ–¹æ³•: æ–¹æ³• ä½œç”¨ getMethods() è·å–ç±»çš„æ‰€æœ‰å…¬å…±æ–¹æ³• getMethod() è·å–æŒ‡å®šå…¬å…±æ–¹æ³•ï¼Œä¼ å…¥ä¸€ä¸ªæ–¹æ³•çš„åç§°ä¸å‚æ•°çš„ç±»å‹ getDeclaredMethods() è·å–ç±»çš„æ‰€æœ‰æ–¹æ³• getDeclaredMethod() è·å–ç±»çš„æŒ‡å®šæ–¹æ³•ï¼Œä¼ å…¥å‚æ•°åŒgetMethod() ä¸¾ä¸ªä¾‹å­ï¼Œå°†æœ¬æ¥ä¸ºå¼ ä¸‰çš„åç§°ä¿®æ”¹ä¸ºæå››ï¼š 123456789101112131415161718192021222324252627282930313233343536/** * Created by hj on 2019/1/10. * è¯´æ˜ï¼š */public class Student &#123; public String name; private int age; public Student(String name, int age) &#123; this.name = name; this.age = age; &#125; private void setName(String name)&#123; this.name = name; log(&quot;è®¾ç½®çš„åç§°ä¸ºï¼š&quot;+name); &#125; public static void main(String[] args) &#123; Student student = new Student(&quot;å¼ ä¸‰&quot;, 18); Class mClass = student.getClass(); try &#123; Method method = mClass.getDeclaredMethod(&quot;setName&quot;,String.class); method.invoke(student,&quot;æå››&quot;); &#125; catch (NoSuchMethodException | IllegalAccessException | InvocationTargetException e) &#123; e.printStackTrace(); &#125; &#125; private static void log(String value) &#123; System.out.print(value); &#125;&#125; æ‰“å°ç»“æœ:1è®¾ç½®çš„åç§°ä¸ºï¼šæå›› åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒä¸Šé¢çš„Fieldç±»ï¼Œå…¶å®éƒ½æ˜¯å·®ä¸å¤šçš„ï¼Œä¸€é€šç™¾é€šã€‚ æŠ½è±¡,ç»§æ‰¿,æ¥å£,æ³›å‹ç›¸å…³æ­¤ç±»æ–¹æ³•è™½ç„¶ä¸å¸¸ç”¨åˆ°ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹èƒ½å‘æŒ¥æ„æƒ³ä¸åˆ°çš„ä½œç”¨ï¼Œåœ¨è®¸å¤šæ¡†æ¶çš„æºç ä¸­ä¹Ÿèƒ½çœ‹è§å®ƒä»¬çš„èº«å½±ï¼Œå¦‚Gsonçš„$Gson$Typesç±»,Retrofitçš„Utilç±»ç­‰ï¼Œæ¥è·Ÿæˆ‘å­¦ä¹ ä¸€ä¸‹æŠŠã€‚ æ³›å‹é¦–å…ˆè¯´è¯´è·å–ç±»çš„æ³›å‹è·å–ï¼Œå…ˆä»‹ç»ä¸€ä¸ªæ¥å£Type,å®ƒæ˜¯javaä¸­æ‰€æœ‰ç±»å‹çš„é€šç”¨æ¥å£ï¼Œç±»å‹åŒ…æ‹¬åŸå§‹ç±»å‹(class)ï¼Œå‚æ•°åŒ–ç±»å‹(ParameterizedType)ï¼Œæ•°ç»„ç±»å‹(GenericArrayType)ï¼Œç±»å‹å˜é‡(TypeVariable)å’ŒåŸºæœ¬æ•°æ®ç±»å‹ã€‚å†…éƒ¨å®ç°äº†ä¸€ä¸ªæ–¹æ³•getTypeName(),ç”¨äºè¿”å›ç±»å‹å‚æ•°ä¿¡æ¯ï¼ŒåŸºäºå®ƒå‘å¤–æ‰©å±•çš„æ¥å£æœ‰ï¼š ParameterizedTypeè¡¨ç¤ºä¸€ä¸ªå‚æ•°åŒ–ç±»å‹ï¼Œè¯´ç®€å•ç‚¹å°±æ˜¯å¸¦æœ‰å‚æ•°ç±»å‹çš„ç±»å‹ï¼Œå¦‚Collection ,å¦‚æœå¸¦æœ‰äº†ç±»å‹ï¼Œå¦‚Collectionï¼Œé‚£ä¹ˆå°±æ˜¯è¯´Stringå°†Collectionå‚æ•°åŒ– GenericArrayTypeè¡¨ç¤ºä¸€ä¸ªå‚æ•°åŒ–ç±»å‹æˆ–ç±»å‹å˜é‡çš„æ•°ç»„ç±»å‹ï¼Œç®€å•è¯´å°±æ˜¯æ³›å‹A[]æˆ–æ³›å‹æ•°ç»„T[] TypeVariableæ‰€æœ‰ç±»å‹å˜é‡çš„çˆ¶æ¥å£,ä¹Ÿå°±æ˜¯æˆ‘ä»¬å®šä¹‰æŠ½è±¡ç±»ä¸­çš„é‚£ç§K,Eç­‰æ³›å‹å˜é‡ï¼Œå¯ä»¥æ³›æŒ‡ä»»ä½•ç±» WildcardTypeè¡¨ç¤ºä¸€ä¸ªé€šé…ç¬¦è¡¨è¾¾ï¼Œä¾‹å¦‚?,? extends IntegerTypeå¯ä»¥é€šè¿‡classçš„getGenericInterfacesæˆ–getGenericSuperclass()æ–¹æ³•æ¥è·å–è¿™ä¹ˆè¯´æˆ–è®¸è¿˜æœ‰ç‚¹æŠ½è±¡ï¼ŒParameterizedTypeä¸TypeVariableçš„æ¦‚å¿µæˆ–è®¸è¿˜æ‹ä¸å¤ªæ¸…ã€‚ä¸‹é¢é€šè¿‡ç¤ºä¾‹æ¥åŠ æ·±ç†è§£å…ˆæ¥è¯´è¯´ParameterizedTypeä¸¾ä¸ªä¾‹å­ï¼Œå…ˆå£°æ˜ä¸€ä¸ªå¸¦æ³›å‹çš„è¶…ç±»Person 12345678910/** * Created by hj on 2019/1/10. * è¯´æ˜ï¼š */public class Person&lt;T&gt; &#123; public T feature;&#125; éšåå®šä¹‰ä¸€ä¸ªå®ä½“ç±»Feature1234567/** * Created by hj on 2019/1/10. * è¯´æ˜ï¼š */public class Feature &#123;&#125; æœ€åç”³æ˜ä¸€ä¸ªStudentå¹¶ç»§æ‰¿Person,å°†Featureä½œä¸ºTä¼ å…¥:123456789101112131415161718192021222324/** * Created by hj on 2019/1/10. * è¯´æ˜ï¼š */public class Student extends Person&lt;Feature&gt; &#123; public static void main(String[] args) &#123; Student student = new Student(); Class mClass = student.getClass(); Type type = mClass.getGenericSuperclass(); //è¿™é‡Œè·å–çš„typeä¸ºPerson&lt;Feature&gt;ï¼Œæ‰€ä»¥å±äºParameterizedType if (type instanceof ParameterizedType) &#123; //çˆ¶ç±»çš„æ³›å‹å¯èƒ½æœ‰å¤šä¸ªï¼Œè¿™é‡Œåªå†™äº†ä¸€ä¸ªï¼Œæ‰€ä»¥å–ç¬¬ä¸€ä¸ªå°±è¡Œäº†ï¼Œè¿™é‡Œæ˜¯å–Person&lt;Feature&gt;ä¸­çš„Feature Class tClass = (Class) ((ParameterizedType) type).getActualTypeArguments()[0]; log(tClass.getSimpleName()); &#125; &#125; private static void log(String value) &#123; System.out.print(value); &#125;&#125; å› ä¸ºClassç±»ä¹Ÿå®ç°äº†Typeæ¥å£ï¼Œæ‰€ä»¥æ˜¯å¯ä»¥å¼ºåˆ¶è½¬åŒ–çš„æ‰“å°ç»“æœå¦‚ä¸‹:1Feature å¯ä»¥çœ‹åˆ°åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œåªè¦æ˜¯Person&lt;&gt;ä¸­ä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªå‚æ•°ç±»å‹ï¼Œä¸ç®¡æ˜¯å®ä½“ç±»ï¼ŒStringéƒ½è¡Œï¼Œåªè¦æ˜¯å‚æ•°è€Œæ²¡æœ‰æ³›æŒ‡æ„ä¹‰ï¼Œé‚£ä¹ˆå®ƒå°±å±äºParameterizedTypeç±»å‹æ¥ä¸‹æ¥å°†ä»£ç ä¿®æ”¹ä¸€ä¸‹ï¼Œå°†Featureæ”¹ä¸ºT,ä¿®æ”¹è·å–é€»è¾‘ï¼š1234567891011121314151617181920212223242526/** * Created by hj on 2019/1/10. * è¯´æ˜ï¼š */public class Student&lt;T&gt; extends Person&lt;T&gt; &#123; public static void main(String[] args) &#123; Student student = new Student(); Class mClass = student.getClass(); Type type = mClass.getGenericSuperclass(); //æ­¤æ—¶è¿™é‡Œçš„typeä¸ºPerson&lt;T&gt;ï¼Œè€Œä¸æ˜¯Tï¼Œæ‰€ä»¥ä¾æ—§å±äºParameterizedType if (type instanceof ParameterizedType) &#123; //è¿™é‡Œæ˜¯ä»Person&lt;T&gt;ä¸­è·å–T Type childType = ((ParameterizedType)type).getActualTypeArguments()[0]; if (childType instanceof TypeVariable)&#123; log(((TypeVariable) childType).getName()); &#125; &#125; &#125; private static void log(String value) &#123; System.out.print(value); &#125;&#125; è¾“å‡ºåç§°ä¸º1T ä¸çŸ¥é“å°ä¼™ä¼´ä»¬æœ‰æ²¡æœ‰ç†è§£äº†ï¼Œå½“è·å–çš„ç±»å‹æ˜¯æ³›æŒ‡çš„ï¼Œå¦‚Tç­‰ï¼Œé‚£ä¹ˆå°±æ˜¯TypeVariableç±»å‹ï¼Œå½“ç±»å‹æ˜¯å‚æ•°ç±»å‹çš„ï¼Œä¾‹å¦‚ç”±å­ç±»ä¼ å…¥çš„ï¼Œå…·ä½“åŒ–çš„ï¼Œé‚£ä¹ˆå°±æ˜¯ParameterizedTypeç±»å‹ã€‚æ¥ä¸‹æ¥çš„GenericArrayTypeå’ŒWildcardTypeå°±æ¯”è¾ƒå¥½ç†è§£äº†ï¼Œå°†ä»¥ä¸Šç¤ºä¾‹ä¸­çš„Person&lt;T&gt;æ”¹ä¸ºPerson&lt;T[]&gt;ï¼Œå°†ç»“æœè¾“å‡ºï¼Œä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425/** * Created by hj on 2019/1/10. * è¯´æ˜ï¼š */public class Student&lt;T&gt; extends Person&lt;T[]&gt; &#123; public static void main(String[] args) &#123; Student student = new Student(); Class mClass = student.getClass(); Type type = mClass.getGenericSuperclass(); if (type instanceof ParameterizedType) &#123; //è¿™é‡Œè·å–åˆ°çš„ç±»å‹ä¸ºï¼šT[],æ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹ï¼Œæ‰€ä»¥æ˜¯GenericArrayType Type childType = ((ParameterizedType)type).getActualTypeArguments()[0]; if (childType instanceof GenericArrayType)&#123; log(childType.toString()); &#125; &#125; &#125; private static void log(String value) &#123; System.out.print(value); &#125;&#125; è¾“å‡ºåç§°ä¸ºï¼š1T[] WildcardTypeå°±ä¸æ¼”ç¤ºäº†ï¼Œå°†Tæ”¹ä¸ºå¸¦ï¼Ÿçš„ç±»å‹å°±å¯ä»¥äº†ï¼Œå¦‚æœå°è£…ç±»å‹å®åœ¨å¤ªå¤æ‚ï¼Œæ•™å¤§å®¶ä¸€ä¸ªæŠ€å·§ï¼Œæ‰“ä¸ªæ–­ç‚¹ï¼Œå•¥ç±»å‹éƒ½å¸®ä½ æ˜¾ç¤ºå‡ºæ¥äº†ã€‚ä¸€çœ‹å°±çŸ¥é“æ˜¯ParameterizedTypeç±»å‹äº†ï¼Œå“ˆå“ˆå“ˆï¼Œæºœä¸æºœã€‚ è¿™é‡Œç»™å°ä¼™ä¼´ä¸€ä¸ªä½œä¸šï¼šList&lt;? extends T&gt;[]ä¸­çš„List&lt;? extends T&gt;,? extends Tï¼ŒT ,List&lt;? extends T&gt;[]åˆ†åˆ«ä»£è¡¨ä»€ä¹ˆç±»å‹å‘¢ï¼Ÿ ç»§æ‰¿è·å–çˆ¶çº§ç±»ä½¿ç”¨Class.getSuperclass()æ–¹æ³•å³å¯è·å–çˆ¶ç±»çš„class æ¥å£è·å–æ¥å£ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œä¸€ä¸ªæ¥å£å®é™…ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªClassç±»ï¼Œé€šè¿‡getInterfaces()è·å–åˆ°ä¸€ä¸ªClassæ•°ç»„ï¼Œè€Œæ¥å£é‡Œå£°æ˜çš„æ–¹æ³•å¯ä»¥é€šè¿‡è·å–Methodçš„æ–¹å¼æ¥è·å–,ä¸¾ä¸ªæ —å­ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªMyInterfaceæ¥å£1234567/** * Created by hj on 2019/1/11. * è¯´æ˜ï¼š */public interface MyInterface &#123; void getName();&#125; åœ¨Studentç±»é‡Œå®ç°å¹¶è·å–ï¼š12345678910111213141516171819202122232425262728/** * Created by hj on 2019/1/10. * è¯´æ˜ï¼š */public class Student implements MyInterface&#123; public static void main(String[] args) &#123; Student student = new Student(); Class mClass = student.getClass(); Class interfaces = mClass.getInterfaces()[0]; try &#123; Method methods = interfaces.getMethod(&quot;getName&quot;,null); log(methods.getName()); &#125; catch (NoSuchMethodException e) &#123; e.printStackTrace(); &#125; &#125; private static void log(String value) &#123; System.out.print(value); &#125; @Override public void getName() &#123; &#125;&#125; æ‰“å°å‡ºæ–¹æ³•åä¸ºï¼š1getName æ€»ç»“åªè¦æ‹¿åˆ°Classç±»ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°å®ƒçš„çˆ¶ç±»ï¼Œæ¥å£ï¼Œæ–¹æ³•ï¼Œå­—æ®µï¼Œä»¥åŠæ³›å‹ï¼Œä»è€Œåšä¸€äº›è§£è€¦å°è£…ï¼Œæé«˜ç±»çš„è§£è€¦æ€§ã€‚æˆ–è€…åœ¨ä¸ä¿®æ”¹æºç çš„æƒ…å†µä¸‹æ‰§è¡Œæˆ–ä¿®æ”¹æºç ä¸­çš„æ–¹æ³•ï¼Œå­—æ®µï¼Œä»è€Œè¾¾åˆ°ç†æƒ³ä¸­çš„æ•ˆæœã€‚å°ä¼™ä¼´ä»¬å¿«å»ç»ƒä¹ ä¸€ä¸‹æŠŠã€‚]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidæ€§èƒ½ä¼˜åŒ–-å›¾ç‰‡ç¯‡]]></title>
    <url>%2FAndroid%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-%E5%9B%BE%E7%89%87%E7%AF%87.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æ–‡ç« é¦–å‘äºæˆ‘çš„ç®€ä¹¦,æœ¬å¤„åªåšæ•´ç†å½’æ¡£ç”¨ (1)drawableç›®å½•è¯¦è§£(mdpi,hdpi,xhdpi,xxhdpi,xxxhdpi)1.1ã€å›¾ç‰‡åœ¨å„ä¸ªç›®å½•ä¸­è¦å¦‚ä½•å­˜æ”¾ï¼Ÿï¼ˆå¿…é¡»ç†è§£ï¼‰androidçš„drawableç›®å½•æœ‰ï¼š drawable-ldpi(ä½å¯†åº¦) drawable-mdpi(ä¸­ç­‰å¯†åº¦) drawable-hdpi(é«˜å¯†åº¦) drawable-xhdpi(è¶…é«˜å¯†åº¦) drawable-xxhdpi(è¶…è¶…é«˜å¯†åº¦) drawable-xxxhdpi(è¶…è¶…è¶…é«˜å¯†åº¦) drawable-nohdpi(æ— ç¼©æ”¾) é»˜è®¤çš„drawable è€Œå®‰å“åŠ è½½å›¾ç‰‡çš„åŸç†æ˜¯æ ¹æ®æ‰‹æœºçš„å¯†åº¦(dpi)æ¥é€‰æ‹©ä¸åŒçš„æ–‡ä»¶å¤¹ä¸‹çš„å›¾ç‰‡,å¦‚æœæ²¡æœ‰ï¼Œå°±ä¼šä»åˆ«çš„å¯†åº¦æ–‡ä»¶å¤¹æ¥è·å–å›¾ç‰‡å¹¶æŒ‰ç…§ä¸€å®šæ¯”ä¾‹æ¥ç¼©æ”¾å±•ç¤ºå›¾ç‰‡ã€‚è·å–è®¾å¤‡å¯†åº¦çš„æ–¹æ³•ä¸ºï¼š12float xdpi = getResources().getDisplayMetrics().xdpi;float ydpi = getResources().getDisplayMetrics().ydpi; çŸ¥é“äº†dpi,å°±çŸ¥é“ä¼šå»å“ªä¸ªæ–‡ä»¶å¤¹è·å–å›¾ç‰‡äº†:| å¯¹åº”æ–‡ä»¶å¤¹ | å¯†åº¦èŒƒå›´ï¼ˆdpiï¼‰| ç¼©æ”¾æ¯”ä¾‹ || â€”â€”| â€”â€”| â€”â€”|| ldpi | 0~120 | 0.75 || mdpi |120~160 | 1(åŸºå‡†)|| hdpi |160~240 | 1.5 || xhdpi |240~320 | 2.0 || xxhdpi |320~480 | 3.0 || xxxhdpi |480~640 | 4.0|è€Œå½“å‰çš„ä¸»æµæœºå‹å¯†åº¦åŸºæœ¬éƒ½æ˜¯åœ¨320~480ä¹‹é—´ï¼Œä¸€èˆ¬æ”¾ä¸¤å¥—å›¾å°±å¤Ÿäº†ï¼Œä¸€å¥—æ”¾åˆ°xhdpi,ä¸€å¥—æ”¾åˆ°xxhdpi,é‚£ä¹ˆå¦‚æœæ˜¯ä¸€ä¸ªhdpiçš„æ‰‹æœºæ¥è¿è¡Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿå®‰å“æ˜¯æœ‰ä¸€å¥—å›¾ç‰‡åŒ¹é…è§„åˆ™çš„: ä¸€ä¸ªhdpiå¯†åº¦çš„æ‰‹æœºï¼Œè‚¯å®šæ˜¯å…ˆå»åŒ¹é…hdpiç›®å½•ä¸‹çš„å›¾ç‰‡ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆå°±ä¼šå‘ä¸Šçº§å»æŸ¥æ‰¾ï¼Œåˆ†åˆ«æ˜¯xhdpi-&gt;xxhdpi-&gt;xxxhdpi-&gt;nodpiï¼Œå¦‚æœéƒ½æ²¡æœ‰ï¼Œå°±ä¼šå¾€ä¸‹çº§ç›®å½•å»æŸ¥ï¼Œåˆ†åˆ«æ˜¯mdpi-&gt;ldpi,å¦‚æœè¿˜æ²¡æœ‰ï¼Œå°±ä¼šå»drawableç›®å½•å»æŸ¥æ‰¾ï¼Œå¦‚æœè¿˜æ²¡æœ‰ï¼å°±ä¼šå¼€å¯è‡ªæ¯æ¨¡å¼ï¼Œå˜£ï¼ï¼(resouse not found) 1.2ã€ç›¸åŒå›¾ç‰‡åœ¨ä¸åŒç›®å½•æ‰€å ç”¨èµ„æºåˆ†æ(äº†è§£å³å¯)ä¸çŸ¥é“æœ‰æ²¡æœ‰æœ‹å‹åšè¿‡è¿™æ ·ä¸€ä¸ªå®éªŒï¼ŒæŠŠä¸€ä¸ªxhdpiå¯†åº¦çš„å›¾ç‰‡æ”¾åˆ°xxhdpiå¯†åº¦çš„æ–‡ä»¶å¤¹ä¸­å»åŠ è½½ä¼šå‘ç”Ÿä»€ä¹ˆ,å®ƒæ‰€å çš„å†…å­˜ä¼šæœ‰åŒºåˆ«å—ï¼Ÿä¾‹å¦‚ä¸€ä¸ªåœ¨xhdpiä¸‹ä¸º200 200çš„å›¾ç‰‡ï¼Œxxhdpiå¯†åº¦ä¸‹ä¸º300 300,ä½†æ­¤æ—¶å›¾ç‰‡åªæœ‰200 200ï¼Œæ‰€ä»¥å®ƒä¼šæ”¾å¤§åˆ°300 300ï¼Œè¿™æ—¶å€™å›¾ç‰‡å°±ä¼šå‡ºç°æ¨¡ç³Šçš„æƒ…å†µäº†ï¼Œæ‰€ä»¥å¦‚æœä½ åœ¨é¡¹ç›®ä¸­å‘ç°å›¾ç‰‡æ¨¡ç³Šçš„æƒ…å†µå¯ä»¥æ£€æŸ¥ä¸‹å›¾ç‰‡çš„å°ºå¯¸æ˜¯å¦æ­£ç¡®ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥åšä¸€ä¸ªå®éªŒ,ä½¿ç”¨ä¸€ä¸ªåå«icon_database_xls 64 * 64 PNGçš„å›¾ç‰‡ï¼Œå°†å®ƒæ”¾åˆ°xhdpiç›®å½•ä¸­ï¼Œæ‰§è¡Œä¸‹é¢çš„ä»£ç è·å–å†…å­˜å ç”¨æƒ…å†µï¼š12Bitmap bitmap = BitmapFactory.decodeResource(getResources(),R.mipmap.icon_database_xls);Log.i(&quot;HJ&quot;,bitmap.getByteCount()+&quot;&quot;); ç»“æœå¦‚ä¸‹ï¼š12019-01-08 10:56:01.872 18507-18507/jie.com.imageoptimize I/HJ: 30976 æ¥ä¸‹æ¥å°†å›¾ç‰‡æ”¾åˆ°xxhdpiç›®å½•ä¸‹ï¼Œå†æ¬¡æ‰§è¡Œä»£ç :12019-01-08 10:56:32.123 18677-18677/jie.com.imageoptimize I/HJ: 13924 å¯ä»¥çœ‹åˆ°ç»“æœå·®è·å·¨å¤§,æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªå›¾ç‰‡çš„å†…å­˜å ç”¨å…¬å¼ä¸ºï¼šå›¾ç‰‡å†…å­˜å®½åº¦ å›¾ç‰‡å†…å­˜é«˜åº¦ æ¯åƒç´ å ç”¨çš„å†…å­˜ä½æ•°ï¼Œé‚£æˆ‘ä»¬çš„å†…å­˜å®½é«˜æ˜¯å¦‚ä½•è®¡ç®—çš„å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥è¿½è¸ªframeworkçš„æºç ï¼Œè·¯å¾„ä¸º/frameworks/base/core/jni/android/graphics/BitmapFactory.cpp,æ‰¾åˆ°doDecodeæ–¹æ³•ï¼š123456789101112131415161718192021222324252627282930313233static jobject doDecode(JNIEnv* env, std::unique_ptr&lt;SkStreamRewindable&gt; stream, jobject padding, jobject options) &#123; int sampleSize = 1; bool onlyDecodeSize = false; ... ... float scale = 1.0f; ... ... if (options != NULL) &#123; sampleSize = env-&gt;GetIntField(options, gOptions_sampleSizeFieldID); if (sampleSize &lt;= 0) &#123; sampleSize = 1; &#125; if (env-&gt;GetBooleanField(options, gOptions_justBoundsFieldID)) &#123; onlyDecodeSize = true; &#125; ... ... if (env-&gt;GetBooleanField(options, gOptions_scaledFieldID)) &#123; const int density = env-&gt;GetIntField(options, gOptions_densityFieldID); const int targetDensity = env-&gt;GetIntField(options, gOptions_targetDensityFieldID); const int screenDensity = env-&gt;GetIntField(options, gOptions_screenDensityFieldID); if (density != 0 &amp;&amp; targetDensity != 0 &amp;&amp; density != screenDensity) &#123; scale = (float) targetDensity / density; //ç¼©æ”¾æ¯”åœ¨è¿™é‡Œè®¡ç®—çš„ &#125; &#125; &#125; ... ... if (scale != 1.0f) &#123; willScale = true; scaledWidth = static_cast&lt;int&gt;(scaledWidth * scale + 0.5f); //å†…å­˜å®½åº¦è®¡ç®— scaledHeight = static_cast&lt;int&gt;(scaledHeight * scale + 0.5f); //å†…å­˜é«˜åº¦è®¡ç®— &#125; ä»¥ä¸Šæºç æ€»ç»“ä¸ºï¼šå†…å­˜å®½é«˜ = å›¾ç‰‡æœ¬èº«çš„å®½é«˜ * ï¼ˆè®¾å¤‡å¯†åº¦/ä½¿ç”¨çš„å¯†åº¦ï¼‰+ 0.5æ‰€ä»¥ï¼Œå†…å­˜çš„å ç”¨ä¸å›¾ç‰‡æ‰€åœ¨çš„å¯†åº¦ç›®å½•æ˜¯æœ‰å¯†åˆ‡å…³ç³»çš„ 1.3ã€ drawable-xxhdpiä¸mipmap-xxhdpiçš„åŒºåˆ«(äº†è§£å³å¯)ä»æ–°ç‰ˆAndroid studioå¼€å§‹ï¼Œç³»ç»Ÿä¼šé»˜è®¤ç»™æˆ‘ä»¬åˆ›å»ºmipmapæ–‡ä»¶å¤¹è€Œä¸æ˜¯drawable,å…ˆå‰æˆ‘ä¸€ç›´ä»¥ä¸ºè¿™ä¸ªç›®å½•åªæ˜¯æ”¾iconçš„(æµä¸‹äº†èœé€¼çš„å¿ƒé…¸æ³ªæ°´),åæ¥å‘ç°è¿™ä¸ªç›®å½•ä¸drawableéƒ½å¯ä»¥æ”¾å›¾ç‰‡ï¼Œè€Œä¸”è²Œä¼¼ä¹Ÿæ²¡æœ‰ä»»ä½•å·®åˆ«????ï¼Œä¸ºäº†å¼„æ¸…æ¥šï¼Œä¸Šç½‘æŸ¥äº†ä¸€ä¸‹ï¼Œå¤§æ„æ˜¯ä¼šå¯¹å›¾ç‰‡ç¼©æ”¾åšæ€§èƒ½ä¼˜åŒ–ï¼Œä¸è¿‡æˆ‘åœ¨å¹³å¸¸çš„ä½¿ç”¨ä¸­å¹¶æ²¡æœ‰å‘ç°æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼Œå¯èƒ½æ˜¯é«˜ç‰ˆæœ¬drawableä¹Ÿåšäº†ä¼˜åŒ–æŠŠï¼Œæ‰€ä»¥è¿™ä¸ªç®€å•äº†è§£ä¸€ä¸‹å³å¯ã€‚ (2)Bitmapä¼˜åŒ–è¯¦è§£2.1ã€åŸºç¡€çŸ¥è¯†å®‰å“çš„å›¾ç‰‡åŠ è½½éƒ½ä¼šå¯¹åº”åˆ°bitmapå¯¹è±¡,å½“bitmapå ç”¨çš„å†…å­˜è¿‡é«˜ï¼Œè¶…è¿‡äº†androidä¸ºappåˆ†é…çš„æœ€å¤§å†…å­˜ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šä¸å¼€å¿ƒï¼Œå®ƒå°±ä¼šOOMï¼Œæ‰€ä»¥æˆ‘ä»¬çš„å›¾ç‰‡ä¼˜åŒ–ï¼Œæœ¬è´¨å°±æ˜¯å†…å­˜ä¼˜åŒ–ã€‚æˆ‘ä»¬å¸¸ç”¨çš„å›¾ç‰‡æ ¼å¼ä¸€èˆ¬æœ‰ä¸‰ç§: JPEG ä¸€ç§æœ‰æŸå‹ç¼©æ ¼å¼ï¼Œä¸æ”¯æŒé€æ˜é€šé“,æ‰€ä»¥æœ‰é€æ˜èƒŒæ™¯éœ€æ±‚çš„å›¾ç‰‡ä¸è¦ç”¨jpegæ ¼å¼ï¼Œå®ƒä¼šå˜æˆé»‘è‰²ï¼Œä¼šå˜é»‘ï¼ï¼ï¼ï¼Œä¼šå˜é»‘ï¼ï¼ï¼ï¼Œä¼šå˜é»‘ï¼ï¼ï¼ PNG æ— æŸå‹ç¼©æ ¼å¼,æ”¯æŒé€æ˜é€šé“ WEBP åŒæ—¶æ”¯æŒæ— æŸå’Œæœ‰æŸå‹ç¼©æ ¼å¼ï¼Œç„¶è€Œå…¼å®¹æ€§è¾ƒå·®ï¼Œéœ€è¦é€‚é…åº“ å¯å‚è€ƒ:webp-android åœ¨ä»£ç ä¸­å¯ä»¥é€šè¿‡Bitmap.CompressFormatæ¥æŒ‡å®šç”Ÿæˆçš„å›¾ç‰‡æ ¼å¼bitmapè¿˜å¯ä»¥é…ç½®åƒç´ å ç”¨å­—èŠ‚æ•°ï¼ˆä¸€ä¸ªå­—èŠ‚å¯¹åº”8ä½ï¼‰ï¼Œè¿™ä¸å†…å­˜å ç”¨æ¯æ¯ç›¸å…³ï¼Œå¯¹åº”Bitmap.Configç±»ï¼š ALPHA_8 8ä½ALPHAé€šé“ï¼Œå³A=8ï¼Œä¸€ä¸ªåƒç´ å ç”¨ä¸€ä¸ªå­—èŠ‚ï¼Œå®ƒæ˜¯æ²¡æœ‰é¢œè‰²çš„ï¼Œåªæœ‰é€æ˜åº¦ ARGB_4444 16ä½ A=4,R=4,G=4,B=4,ä¸€ä¸ªåƒç´ å ç”¨å­—èŠ‚ = 4+4+4+4 = 16ä½ = 2ä¸ªå­—èŠ‚ ARGB_8888 32ä½ A=8,R=8,G=8,B=8,ä¸€ä¸ªåƒç´ å ç”¨å­—èŠ‚ = 8+8+8+8 = 32ä½ = 4ä¸ªå­—èŠ‚ RGB_565 16ä½ R=5,G=6,B=5,å› ä¸ºæ²¡æœ‰Aï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰é€æ˜åº¦ï¼Œè®¡ç®—åŒä¸Šä¹Ÿæ˜¯å ç”¨2ä¸ªå­—èŠ‚åƒå¹³å¸¸å¦‚æœæ²¡æœ‰é€æ˜åº¦è¦æ±‚ä½¿ç”¨RGB_565å³å¯2.2ã€ä¼˜åŒ–çš„æœ¬è´¨å‰é¢å·²ç»æåˆ°æˆ‘ä»¬çš„å›¾ç‰‡ä¼˜åŒ–å®é™…æ˜¯å†…å­˜çš„ä¼˜åŒ–ï¼Œè€Œæˆ‘ä»¬çš„å†…å­˜è®¡ç®—å…¬å¼æ˜¯ï¼šå†…å­˜å ç”¨å®½é«˜ç›¸ä¹˜ * æ¯åƒç´ å ç”¨çš„å†…å­˜ä½æ•°ï¼Œæ‰€ä»¥è¦ä¹ˆå°±å‡å°‘å›¾ç‰‡å†…å­˜å ç”¨å®½é«˜ï¼Œè¦ä¹ˆå°±å‡å°‘åƒç´ å ç”¨å†…å­˜æ•°ã€‚å‡å°‘åƒç´ å†…å­˜å ç”¨æ•°å¯ä»¥é€šè¿‡é…ç½®Bitmap.Configè§£å†³ï¼Œè€Œå‡å°‘å›¾ç‰‡å†…å­˜å ç”¨å®½é«˜ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹å¼ï¼š1.ç¼©å°å›¾ç‰‡å®é™…å®½é«˜ï¼Œç¼©å°åˆ°æ­£å¥½æ­£å¸¸å±•ç¤º2.åŒ¹é…åˆé€‚çš„åƒç´ å¯†åº¦æ­¤å¤–è¿˜èƒ½ä¸»åŠ¨å›æ”¶å ç”¨çš„å†…å­˜ä»è€Œç¼“è§£å†…å­˜ç´§å¼ çš„é—®é¢˜ã€‚2.3ã€ä¼˜åŒ–æ–¹å¼åˆ†æäº†ä¸€ä¸‹ä¼˜åŒ–çš„æœ¬è´¨é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹æ€§çš„ä½¿ç”¨ä»¥ä¸‹å‡ ç§æ–¹å¼æ¥è¿›è¡Œä¼˜åŒ–ï¼š1.é…ç½®BitmapConfigï¼ˆå‰é¢å·²ç»è®²åˆ°ï¼‰2.æ‹¿åˆ°ä¸€ä¸ªå›¾ç‰‡ï¼Œé€šè¿‡inJustDecodeBoundsä¸æ¶ˆè€—å†…å­˜æ‹¿åˆ°å›¾ç‰‡çš„å®½é«˜ï¼Œç„¶åä½¿ç”¨inSampleSizeæ¥è®¾ç½®å›¾ç‰‡çš„ç¼©æ”¾æ¯”ã€‚ç®€å•ç¤ºä¾‹ä»£ç :12345678910BitmapFactory.Options options = new BitmapFactory.Options();options.inJustDecodeBounds = true;BitmapFactory.decodeResource(getResources(),R.mipmap.icon_database_xls,options);Log.i(&quot;HJ&quot;,&quot;åˆå§‹å›¾ç‰‡å®½:&quot;+options.outWidth);Log.i(&quot;HJ&quot;,&quot;åˆå§‹å›¾ç‰‡é«˜:&quot;+options.outHeight);options.inSampleSize = 2;options.inJustDecodeBounds = false;BitmapFactory.decodeResource(getResources(),R.mipmap.icon_database_xls,options);Log.i(&quot;HJ&quot;,&quot;ç¼©æ”¾åå›¾ç‰‡å®½:&quot;+options.outWidth);Log.i(&quot;HJ&quot;,&quot;ç¼©æ”¾åå›¾ç‰‡é«˜:&quot;+options.outHeight); è¿è¡Œåï¼š12342019-01-08 17:07:50.935 25900-25900/jie.com.imageoptimize I/HJ: åˆå§‹å›¾ç‰‡å®½:642019-01-08 17:07:50.935 25900-25900/jie.com.imageoptimize I/HJ: åˆå§‹å›¾ç‰‡é«˜:642019-01-08 17:07:50.936 25900-25900/jie.com.imageoptimize I/HJ: ç¼©æ”¾åå›¾ç‰‡å®½:322019-01-08 17:07:50.937 25900-25900/jie.com.imageoptimize I/HJ: ç¼©æ”¾åå›¾ç‰‡é«˜:32 å¯ä»¥çœ‹åˆ°inSampleSizeè®¾ä¸º2ï¼Œå›¾ç‰‡çš„å®½å’Œé«˜éƒ½å˜æˆäº†åŸæ¥çš„ä¸€åŠï¼Œæ‰€ä»¥å¯å¾—ç¼©æ”¾å…¬å¼ä¸ºï¼šåŸå§‹å›¾ç‰‡å®½åº¦/inSampleSize = ç¼©æ”¾åçš„å›¾ç‰‡å®½åº¦ã€‚é«˜åº¦åŒç†ï¼Œæ‰€ä»¥å›¾ç‰‡çš„æ•´ä½“å¤§å°å˜ä¸ºäº†åŸæ¥çš„1/4ã€‚ 3.å‹ç¼©å›¾ç‰‡ï¼Œé™¤äº†å¤–éƒ¨å‹ç¼©ï¼Œå†…éƒ¨ä¹Ÿå¯ä»¥ä½¿ç”¨compress()æ¥å‹ç¼©å›¾ç‰‡ã€‚æˆ–è€…è‡ªå®šä¹‰å‹ç¼©ç®—æ³•ï¼Œä½¿ç”¨æ¯”è¾ƒå¹¿æ³›çš„æœ‰Lubanç®—æ³• compress()ç¤ºä¾‹ä»£ç ï¼š123Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.mipmap.icon_database_xls);ByteArrayOutputStream stream = new ByteArrayOutputStream();boolean compress = bitmap.compress(Bitmap.CompressFormat.PNG, 90, stream); ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦ç”Ÿæˆçš„å›¾ç‰‡æ ¼å¼ï¼Œç¬¬äºŒä¸ªæ˜¯å‹ç¼©ç™¾åˆ†æ¯”ï¼Œç¬¬ä¸‰ä¸ªæ˜¯ç”Ÿæˆçš„è¾“å‡ºæµå®¹å™¨ã€‚è¯·æ³¨æ„ï¼Œæ­¤æ–¹æ³•åªä¼šå‹ç¼©å›¾ç‰‡å¤§å°ï¼Œä½†æ˜¯å¹¶ä¸ä¼šå‡å°‘å†…å­˜å ç”¨ã€‚ 4.ä¸»åŠ¨é‡Šæ”¾å†…å­˜ï¼Œç»‘å®šæ§ä»¶ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨é”€æ¯çš„æ—¶å€™è°ƒç”¨recycler()æ–¹æ³•1234if(bitmap != null &amp;&amp; !bitmap.isRecycled())&#123; bitmap.recycle(); bitmap = null; &#125;]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2018å¹´ç»ˆæ€»ç»“]]></title>
    <url>%2F2018%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. å‰è¨€äººå•Šï¼Œæœ€æ€•ä¸€ç”Ÿç¢Œç¢Œæ— ä¸ºï¼Œä¸å…¶å¹³æ·¡ä¸­åº¦è¿‡ï¼Œä½•ä¸ä¸ºè‡ªå·±å®šä¸€ä¸ªå°ç›®æ ‡ï¼Œä½“éªŒå…ˆèµšä»–ä¸€ä¸ªäº¿çš„åˆºæ¿€æ¢¦æƒ³!!!! ä»Šå¹´æˆ‘æ€»ç»“èµ·æ¥å°±æ˜¯:è“„åŠ¿å¾…å‘ä¸è“„è°‹å·²ä¹…,å—¯ï¼Œåˆ†åˆ«å¯¹åº”2018ä¸2019ï¼Œè°‹ï¼Œæ˜¯æˆ‘è—åœ¨å¿ƒä¸­çš„ä¸€ä¸ªç›®æ ‡~ é¢è¯•çš„æ•…äº‹2018å¹´åˆï¼Œè€ƒäº†é©¾ç…§ï¼Œå›åˆ°äº†å®¶ä¹¡é•¿æ²™å¼€å§‹äº†é•¿æ²™å¼€å‘ä¹‹æ—…ï¼Œè®°å¾—å¹´åˆçš„æ—¶å€™æŠ•çš„ç¬¬ä¸€å®¶å…¬å¸å°±æ˜¯ç°åœ¨çš„è¿™å®¶å…¬å¸ï¼Œå½“æ—¶æ˜¯æŠ€æœ¯æ€»ç›‘é¢è¯•çš„æˆ‘ï¼Œå¯¹æˆ‘å°è±¡æŒºå¥½çš„ï¼Œå½“åœºå°±å†³å®šå½•ç”¨äº†æˆ‘ï¼Œé—®æˆ‘ä»€ä¹ˆæ—¶å€™å¯ä»¥è¿‡æ¥ä¸Šç­ï¼Œæˆ‘å› ä¸ºæ˜¯ç¬¬ä¸€æ¬¡åœ¨é•¿æ²™é¢è¯•ï¼Œå¯¹é•¿æ²™çš„å¤§æ¦‚è–ªèµ„çŠ¶å†µä»¥åŠäº’è”ç½‘å‘å±•æƒ…å†µå¹¶ä¸æ˜¯ç‰¹åˆ«çš„äº†è§£ï¼Œæ‰€ä»¥æˆ‘æ‰“ç®—å†å»å…¶ä»–å…¬å¸çœ‹çœ‹ï¼Œå¯¹æ•´ä½“éƒ½äº†è§£ä¸€ä¸‹ï¼Œæˆ‘è¯´3å¤©åæ¥ä¸Šç­ï¼Œè¿™ä¸‰å¤©é‡Œï¼Œæˆ‘å»äº†è“æ€ç§‘æŠ€ï¼Œä¸–ç•Œ500å¼ºä¼ä¸šï¼Œé¢è¯•å®˜çœ‹åˆ°æˆ‘åªæœ‰2å¹´ç»éªŒï¼Œè¿ä¸€ä¸ªæŠ€æœ¯é—®é¢˜éƒ½æ²¡é—®å°±è®©æˆ‘å›å»ç­‰é€šçŸ¥ï¼Œè¯´å®è¯æˆ‘æ˜¯æ¯”è¾ƒä¼¤å¿ƒçš„ï¼Œå› ä¸ºæˆ‘è§‰å¾—å·¥ä½œå¹´é™ä¸ç­‰äºæŠ€æœ¯ï¼Œå·¥ä½œå¹´é™é•¿ä¸ä¸€å®šæŠ€æœ¯å°±ä¼šå¥½ï¼Œèµ·ç å¯ä»¥è¯•ä¸€è¯•å•Šï¼Œå¯èƒ½è¿™æ˜¯å¤§å…¬å¸çš„ä¸€ä¸ªç¡¬æ€§æ ‡å‡†å§ï¼Œå“ï¼Œéƒ½æ²¡é¢†ç•¥è¿‡å¤§æµ·çš„æ³¢æ¶›æ±¹æ¶Œ,å°±è¢«æ‹æ­»åœ¨äº†æ²™æ»©ä¸Šã€‚éšåæˆ‘å»äº†ä¸€å®¶æ€»éƒ¨åœ¨åŒ—äº¬çš„é•¿æ²™åˆ†å…¬å¸ï¼Œæ˜¯åšæ™ºèƒ½åŒ–ç®¡ç†çš„ï¼Œé¢è¯•å®˜é—®äº†ä¸€äº›éå¸¸åŸºç¡€çš„é—®é¢˜ï¼Œç­”å®Œåç›´æ¥å’Œæ€»ç›‘è°ˆè–ªèµ„ï¼Œæ€»ç›‘è§‰å¾—æˆ‘è¦ä»·é«˜ï¼Œæˆ‘è¯´æˆ‘æœ€ä½è¦æ±‚å°±è¿™ä¸ªä»·ï¼Œä¸èƒ½å°‘ï¼Œéšåå°±GGäº†ï¼Œæˆ‘è§‰å¾—è¿™æˆ–è®¸å°±æ˜¯ä»–åœ¨é•¿æ²™å¼€åˆ†å…¬å¸çš„åŸå› å§ï¼Œæ‹›äººç›¸å¯¹äºåŒ—äº¬èƒ½èŠ‚çº¦æ›´å¤šçš„æˆæœ¬ï¼Œä½†ä½ è¿™ä»·æ ¼ä¹Ÿå‹å¾—å¤ªä½äº†å“â€¦é¢æ¥é¢å»æœ€åè¿˜æ˜¯ç¬¬ä¸€å®¶å…¬å¸æœ€æ»¡æ„ï¼Œäºæ˜¯ï¼Œæˆ‘æ¥åˆ°äº†ç°åœ¨çš„è¿™å®¶å…¬å¸â€”â€“é•¿æ²™å±…ç¾ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ï¼Œä¸»è¦æ˜¯åšå®¶å±…å»ºææ‹›å•†åŠ ç›Ÿçš„ï¼Œç°é‡‘æµéå¸¸çš„å……è¶³ï¼Œå…¬å¸ä¹ŸæŒºå¤§çš„ï¼Œæœ‰200å¤šå·äººï¼Œ4ä¸ªåŠå…¬åœºåœ°ã€‚ æ–°å…¬å¸çš„å¥‹æ–—æ•…äº‹å…¥èŒçš„ç¬¬ä¸€å¤©ï¼ŒæŠ€æœ¯æ€»ç›‘å°±æŠŠæˆ‘å«åˆ°ä¸€ä¸ªä¼šè®®å®¤è°ˆè¯ï¼Œæ€»ç›‘è¯´ï¼Œä½ æ˜¯è¿™å®¶å…¬å¸æ¥çš„ç¬¬ä¸€ä¸ªAndroidå¼€å‘ï¼Œå…¬å¸è®¡åˆ’åœ¨7æœˆä»½æ¨å‡ºä¸€æ¬¾app,è¦åœ¨å¹¿å·çš„å»ºåšä¼šä¸Šäº®ç›¸ï¼Œå¤©å•Šï¼Œé‚£å¯æ˜¯åå‡ ä¸‡äººéƒ½ä¼šæ¥å‚åŠ çš„å±•ä¼šï¼Œå¿…é¡»è¦ä¸‡æ— ä¸€å¤±ï¼Œé©¬è™ä¸å¾—ï¼Œå¯æ˜¯ï¼Œæ€»ç›‘é€æ¼ï¼Œç›®å‰å…¬å¸äº§å“ï¼Œæµ‹è¯•ï¼Œuiäººå‘˜è¿˜æ²¡æœ‰æ‹›åˆ°ä½â€¦â€¦emmmmmmm,æˆ‘æ‰¾ä¸åˆ°è¯­è¨€æ¥æè¿°æˆ‘å½“æ—¶çš„å¿ƒæƒ…ï¼Œä½†æ˜¯è¿™å®¶å…¬å¸ç»™æˆ‘çš„æ„Ÿè§‰è¿˜æ˜¯æŒºé è°±çš„ï¼Œä¸åƒæ˜¯é‚£ç§å‘äººçš„å…¬å¸ï¼Œæ‰€ä»¥æˆ‘æ‰¿è¯ºäº†è¦æ›¿å…¬å¸å¼€å‘å¥½è¿™ä¸€æ¬¾app. åˆ°äº†3æœˆä»½ï¼Œäººå‘˜æœç„¶é™†é™†ç»­ç»­éƒ½æ‰¾é½äº†ï¼Œäºæ˜¯å¼€å§‹å¹²æ´»ã€‚ä½œä¸ºä¸€æ¬¾ä»0å¼€å‘çš„app,å¹¶ä¸”å…¬å¸åœ¨è¿™æ–¹é¢æ²¡æœ‰ä»»ä½•çš„çŸ¥è¯†å‚¨å¤‡ï¼Œå¯ä»¥æƒ³è±¡éš¾åº¦è¿˜æ˜¯æœ‰çš„ï¼Œå¼€å‘ä¸€æ¬¾app,é¦–å…ˆç¬¬ä¸€ä»¶äº‹å°±æ˜¯æŠŠæ¶å­æ­èµ·æ¥ï¼ŒåŸæ¥å…¬å¸çš„appæ¶æ„æ˜¯ä¸èƒ½ç”¨çš„ï¼Œé¡¹ç›®å¤ªæ—§ï¼Œæ¡†æ¶å¤ªè€äº†ï¼Œæ‰€ä»¥åªèƒ½é è‡ªå·±æ­å»ºã€‚ é¦–å…ˆç¡®å®šçš„æ˜¯MVPæ¨¡å¼ï¼Œè¿™æ²¡çš„è·‘ï¼Œç„¶åæŠŠActivityç­‰çš„ä¸€äº›åŸºç±»å†™å¥½ï¼Œéšåå¼€å§‹å°è£…ç½‘ç»œè¯·æ±‚ï¼Œæœ¬æ¥è€ƒè™‘ä½¿ç”¨Retrofitï¼Œä½†æ˜¯è¿™æ¬¾æ¡†æ¶éœ€è¦å†æ¬¡å°è£…çš„ä¸œè¥¿è¿˜æ˜¯è›®å¤šçš„ï¼ŒåŸºäºå¿«é€Ÿå¼€å‘çš„åŸå› æˆ‘å°±ä½¿ç”¨äº†OkGoæ¡†æ¶ï¼Œå®ƒæŠŠæ‰€æœ‰çš„ä¸€åˆ‡éƒ½å¸®ä½ å°è£…å¥½äº†ï¼Œæˆ‘åœ¨ä¸Šå±‚å†™äº†ä¸€äº›ç®€å•çš„å°è£…å°±èƒ½ç›´æ¥ä½¿ç”¨äº†ã€‚éšåå°±æ˜¯å„ç§Utilså°è£…,UIå°è£…ï¼ŒæŠŠRxjava,Glideç­‰å¸¸ç”¨çš„æ¡†æ¶å¼„è¿›æ¥ï¼Œéšåçš„æ—¥å­å°±å¼€å§‹äº†ç–¯ç‹‚çš„ç ä»£ç ,é‚£æ®µæ—¶é—´åŸºæœ¬æ²¡æœ‰åœ¨9ç‚¹é’Ÿä¹‹å‰ä¸‹è¿‡ç­ï¼Œä¸€ç›´æŒç»­åˆ°é¡¹ç›®æˆåŠŸä¸Šçº¿ã€‚è™½ç„¶è¾›è‹¦ï¼Œä½†çœ‹åˆ°è‡ªå·±çš„appä»£ç é€æ¸çš„æˆç†Ÿå®Œå–„ï¼Œæˆå°±æ„Ÿä¹Ÿç‰¹åˆ«çš„å¼ºçƒˆï¼Œè€Œä¸”æ”¶è·ä¹Ÿæ˜¯æ»¡æ»¡çš„ï¼Œæ‡‚å¾—äº†å¦‚ä½•æ­å»ºå¥½çš„æ¶æ„ï¼Œå°è£…åŠŸåº•ä¹Ÿå¾—åˆ°äº†æé«˜ï¼Œæˆ–è®¸ï¼Œè¿™å°±æ˜¯ä¼ è¯´çš„é­”é¬¼å†ç»ƒå§ Kotlinçš„æ•…äº‹éšç€é¡¹ç›®çš„æˆåŠŸä¸Šçº¿ï¼Œæ—¶é—´æ¸æ¸å˜å¾—å……è£•ï¼Œå…¬å¸å‰åä¹Ÿé™†ç»­æ‹›äº†ä¸€äº›Androidå¼€å‘è¿›æ¥ï¼Œæ€»ç›‘ææ‹”æˆ‘å½“äº†Androidç»„çš„ç»„é•¿ï¼Œæ¯å¤©å‘å¥¹æ±‡æŠ¥ä¸€äº›å¼€å‘å·¥ä½œï¼Œç”±äºé¡¹ç›®å¤„äºæ¨å¹¿é˜¶æ®µï¼ŒåæœŸéœ€æ±‚å¢é•¿ä¹åŠ›ï¼Œç•™ä¸‹çš„ç©ºä½™æ—¶é—´è¾ƒå¤šï¼Œæ€»ç›‘è¯´éœ€è¦å¢åŠ ç»„å‘˜çš„å·¥ä½œé¥±å’Œåº¦ï¼Œäºæ˜¯æˆ‘å°±å¼€å§‹äº†Kotlinçš„ä»£ç é‡æ„ï¼Œå¯¹äºKotlin,å…ˆå‰åªæ˜¯äº†è§£ä¸€ç‚¹ï¼Œä½†æ˜¯å½“æ·±å…¥ç ”ç©¶äº†è¿™é—¨è¯­è¨€ä¹‹åï¼Œæˆ‘æ„è¯†åˆ°å®ƒçš„ç¡®èƒ½ä¸ºå¼€å‘å¸¦æ¥å¾ˆå¤§çš„ä¾¿æ·ï¼ˆèƒ½å·æ‡’ï¼‰ã€‚ä½¿ç”¨äº†å®ƒä¹‹åï¼Œæˆ‘ä»¬æ¯ä¸€ä¸ªç±»å¹³å‡å°‘äº†ç™¾æ¥è¡Œä»£ç ï¼Œå¹¶ä¸”å…¶ä¸­çš„æ‰©å±•å‡½æ•°åŠŸèƒ½å®åœ¨æ˜¯ä¸èƒ½å¤ªèµã€‚ç”±äºä¸æ”¹é€»è¾‘ï¼Œåªæ˜¯å•çº¯çš„ç¿»è¯‘ï¼Œä¿®æ”¹é€Ÿåº¦ç‰¹åˆ«å¿«ï¼Œå½“æˆ‘ä»¬æŠŠæ‰€æœ‰ä»£ç éƒ½æ¢æˆKotlinä¹‹åï¼Œæˆ‘ä»¬å°±é’ˆå¯¹Kotlinçš„ç‰¹æ€§ä»åº•å±‚åˆ°åº”ç”¨å±‚æ¥äº†ä¸ªå¤§çš„å°è£…è°ƒæ•´ï¼Œè®©ä»£ç çœ‹èµ·æ¥å°±æ˜¯Kotlinç¼–ç¨‹ï¼Œè€Œä¸æ˜¯Javaç¿»è¯‘è¯­è¨€,è¿™æ ·ï¼Œæˆ‘çš„ç¬¬ä¸€ä¸ªçº¯Kotlinè¯­è¨€å¼€å‘çš„appå°±è¿™æ ·è¯ç”Ÿäº†. æ”¶è·ä¹‹ååœ¨å…¬å¸çš„æ—¥å­å°±æ¯”è¾ƒå¹³æ·¡äº†ï¼Œå¼€å‘å®Œéœ€æ±‚ï¼Œå¦‚æœæœ‰å‰©ä½™çš„æ—¶é—´éƒ½æ˜¯å­¦ä¹ æ–°æŠ€æœ¯æ¥æå‡è‡ªå·±ï¼Œæœ€å¤§çš„æ”¶è·æ˜¯å­¦ä¹ äº†å°ç¨‹åºå¼€å‘ã€‚è€Œå›é¦–ä»Šå¹´ï¼Œåœ¨è‡ªå®šä¹‰View,å¤šçº¿ç¨‹å¼€å‘ï¼Œä»¥åŠè®¾è®¡æ¨¡å¼çš„ä½¿ç”¨ï¼Œç±»çš„å°è£…æ–¹é¢æŠ€èƒ½ä¸Šéƒ½æœ‰å¾ˆå¤§çš„æå‡ã€‚å¹¶ä¸”å­¦ä¼šäº†Kotlinï¼Œä¹Ÿå­¦ä¼šäº†çœ‹æºç ï¼Œä»Kotlinçš„æºç é‡Œå¯ä»¥çœ‹åˆ°è®¸å¤šKotlinçš„ä½¿ç”¨æŠ€å·§ï¼Œè¿™å¯¹äºæå‡Kotlinçš„ç†Ÿç»ƒåº¦éå¸¸æœ‰å¸®åŠ©ï¼Œå¹¶ä¸”ä¹ æƒ¯äº†ç ”ç©¶ç³»ç»Ÿæºç ï¼Œé™†é™†ç»­ç»­çœ‹äº†ä¸€äº›ç±»çš„æºç ï¼Œå‘ç°æºç çš„ä¸–ç•ŒçœŸçš„å¾ˆå¥‡å¦™ï¼Œä½¿ç”¨è¿™äº›ç±»æ—¶éƒ½æœ‰äº†ä¸ä¸€æ ·çš„æ„Ÿè§‰ï¼Œé€šé€äº†è®¸å¤šï¼Œæœç„¶ï¼Œæœ‰äº›ä¸œè¥¿çœ‹é€æ‰æ˜¯æœ€é‡è¦çš„ã€‚ å±•æœ›2019å¹´ï¼Œæˆ‘å·²ç»ç¡®å®šäº†æ¥ä¸‹æ¥éœ€è¦ç ”ç©¶çš„é¢†åŸŸï¼šå›¾å½¢å›¾åƒå’ŒéŸ³è§†é¢‘é¢†åŸŸï¼Œä¸ºæ­¤ï¼Œæˆ‘å†³å®šèŠ±ä¸€ä¸ªå¤šçš„æ—¶é—´å­¦ä¹ c++è¯­è¨€ï¼Œä»¥åº”å¯¹ä¹‹åçš„NDKå¼€å‘ï¼Œæ·±å…¥ç†è§£ç›¸æœºï¼Œç¾é¢œæ•ˆæœçš„å®ç°ï¼ŒAR/VRï¼Œè§†é¢‘è½¬ç ç­‰ç­‰é¢†åŸŸã€‚å¹¶ä¸”åŒæ—¶æå‡ä¸€ä¸‹H5/css/javaScriptçš„å¼€å‘æ°´å¹³ï¼Œè¿˜æœ‰Flutteræˆ‘ä¹Ÿæ˜¯æ¯”è¾ƒçœ‹å¥½çš„ï¼Œå¸Œæœ›èƒ½æœ‰ä¸ªæˆç»©ï¼Œå—¯ï¼Œå°±è¿™æ ·~~~~2019åŠ æ²¹!!!!]]></content>
      <categories>
        <category>æ„Ÿæ‚Ÿ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Android/java å¤šçº¿ç¨‹(å…­)-AsyncTaskä½¿ç”¨è¯¦è§£åŠæºç åˆ†æ]]></title>
    <url>%2FThreadsource6.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. å¤šçº¿ç¨‹ç³»åˆ—å†å²æ–‡ç« :Android/java å¤šçº¿ç¨‹(ä¸€)-Threadçš„ä½¿ç”¨ä»¥åŠæºç åˆ†æAndroid/java å¤šçº¿ç¨‹(äºŒ)-Threadçš„å¥½å…„å¼ŸHandlerAndroid/java å¤šçº¿ç¨‹(ä¸‰)-HandlerThreadçš„ä½¿ç”¨åœºæ™¯åŠæºç è§£æAndroid/java å¤šçº¿ç¨‹(å››)-IntentServiceAndroid/java å¤šçº¿ç¨‹(äº”)-ThreadPoolExecutorçº¿ç¨‹æ± çš„ä½¿ç”¨ ç®€ä»‹ä¸€ä¸ªAndroidå°è£…å¥½çš„è½»é‡çº§å¼‚æ­¥æŠ½è±¡ç±»ï¼Œä½¿ç”¨çš„è¯éœ€è¦ç»§æ‰¿å¹¶é‡å†™éƒ¨åˆ†æ–¹æ³• ä½œç”¨æ–¹ä¾¿çš„å®ç°å¤šçº¿ç¨‹ï¼Œå¹¶èƒ½æ–¹ä¾¿çš„å®ç°ä¸»çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹çš„é€šä¿¡ï¼Œå¹¶ä¸”é€»è¾‘éƒ½åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œä¸åŒäºHandlerçš„å®ç°æœºåˆ¶åœ¨ä¸åŒçš„å›è°ƒä¸­ï¼Œå†…éƒ¨é‡‡ç”¨çº¿ç¨‹æ± ç®¡ç†ç­–ç•¥ï¼Œæ–¹ä¾¿ç®¡ç† ä½¿ç”¨ä»‹ç»123public abstract class AsyncTask&lt;Params, Progress, Result&gt; &#123; ....&#125; å¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ªæ³›å‹å‚æ•°ï¼Œå®ƒä»¬çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼š Params ä¼ é€’ç»™å¼‚æ­¥ä»»åŠ¡çš„å‚æ•°ç±»å‹ï¼Œå¯¹åº”execute()æ–¹æ³•å’ŒdoInBackground()ä¸­çš„å‚æ•°ç±»å‹ Progress è¿›åº¦è·Ÿæ–°å‚æ•°ç±»å‹,å¯¹åº”onProgressUpdate()æ–¹æ³•è¿”å›çš„å‚æ•°ç±»å‹ Result å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•çš„è¿”å›ç»“æœç±»å‹ï¼Œå¯¹åº”doInBackground()æ–¹æ³•çš„è¿”å›ç»“æœç±»å‹å’ŒonPostExecute()æ–¹æ³•çš„å‚æ•°ç±»å‹ å¦‚æœä¸éœ€è¦ä½¿ç”¨åˆ°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨Voidç±»ä»£æ›¿ ç®€å•ç¤ºä¾‹ï¼š ç”³æ˜ä¸€ä¸ªå®ç°ç±»TestAsyncTaskï¼Œä¸»è¦æ‰“å°æ–¹æ³•çš„æ‰§è¡Œé¡ºåºä»¥åŠå‚æ•°åŠè¿è¡Œçš„çº¿ç¨‹åç§°1234567891011121314151617181920212223242526272829303132333435/** * Created by hj on 2018/12/29. * è¯´æ˜ï¼š */public class TestAsyncTask extends AsyncTask&lt;String,Integer,Integer&gt; &#123; @Override protected void onPostExecute(Integer integer) &#123; super.onPostExecute(integer); Log.i(&quot;HJ&quot;,&quot;onPostExecuteæ–¹æ³•æ¥æ”¶çš„å‚æ•°å€¼:&quot;+integer+&quot;--&quot;+runThreadName()); &#125; @Override protected void onPreExecute() &#123; super.onPreExecute(); Log.i(&quot;HJ&quot;,&quot;onPreExecute&quot;+&quot;--&quot;+runThreadName()); &#125; @Override protected void onProgressUpdate(Integer... values) &#123; super.onProgressUpdate(values); Log.i(&quot;HJ&quot;,&quot;onProgressUpdate:&quot;+ Arrays.toString(values)+&quot;--&quot;+runThreadName()); &#125; @Override protected Integer doInBackground(String... strings) &#123; Log.i(&quot;HJ&quot;,&quot;doInBackground()&quot;+&quot;--&quot;+runThreadName()); publishProgress(50); return 1; &#125; private String runThreadName()&#123; return &quot;è¿è¡Œåœ¨:&quot;+Thread.currentThread().getName()+&quot;çº¿ç¨‹&quot;; &#125;&#125; ä½¿ç”¨ï¼š123//å¿…é¡»æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­ TestAsyncTask task = new TestAsyncTask(); task.execute(); æ‰“å°ç»“æœï¼š1234I/HJ: onPreExecute--è¿è¡Œåœ¨:mainçº¿ç¨‹I/HJ: doInBackground()--è¿è¡Œåœ¨:AsyncTask #1çº¿ç¨‹I/HJ: onProgressUpdate:[50]--è¿è¡Œåœ¨:mainçº¿ç¨‹I/HJ: onPostExecuteæ–¹æ³•æ¥æ”¶çš„å‚æ•°å€¼:1--è¿è¡Œåœ¨:mainçº¿ç¨‹ å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰doInBackground()æ–¹æ³•æ‰§è¡Œåœ¨å¼‚æ­¥çº¿ç¨‹ä¸­ï¼Œå…¶ä»–çš„æ–¹æ³•éƒ½æ˜¯è¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¸­ï¼Œæ–¹æ³•æ‰§è¡Œé¡ºåºä¸ºï¼šonPreExecute()â€”-&gt;doInBackground()â€”-&gt;è°ƒç”¨publishProgress()æ–¹æ³•â€”-&gt;onProgressUpdate()â€”â€”&gt;onPostExecute() ä¸‹é¢ä»‹ç»ä¸€ä¸‹æ–¹æ³•çš„å…·ä½“ä½œç”¨: onPreExecute åœ¨è¿›è¡Œå¼‚æ­¥ä»»åŠ¡å¤„ç†å‰çš„ä¸€äº›æ•°æ®å‡†å¤‡å·¥ä½œ doInBackground å¤„ç†å¼‚æ­¥ä»»åŠ¡é€»è¾‘ï¼Œå†…éƒ¨å¯ä»¥è°ƒç”¨publishProgressæ›´æ–°è¿›åº¦ onProgressUpdate è¿›åº¦æ›´æ–°å›è°ƒ onPostExecute å¼‚æ­¥å¤„ç†å®Œæ¯•åçš„ç»“æœå›è°ƒ ï¼Œå¤„ç†uié€»è¾‘ æºç è§£æAsyncTaskå†…éƒ¨çš„å®ç°åŸç†ä¸ºï¼šçº¿ç¨‹æ± +Handler å…¶å†…éƒ¨æœ‰ä¸¤ä¸ªçº¿ç¨‹æ± ï¼š123public static final Executor SERIAL_EXECUTOR = new SerialExecutor();private static volatile Executor sDefaultExecutor = SERIAL_EXECUTOR;public static final Executor THREAD_POOL_EXECUTOR; SERIAL_EXECUTORå¯¹åº”å†…éƒ¨çš„SerialExecutorå†…éƒ¨å®ç°ç±»ï¼Œä¸»è¦å®ç°äº†å¼‚æ­¥ä»»åŠ¡çš„é¡ºåºåˆ†å‘:123456789101112131415161718192021222324252627282930private static class SerialExecutor implements Executor &#123; final ArrayDeque&lt;Runnable&gt; mTasks = new ArrayDeque&lt;Runnable&gt;(); Runnable mActive; //å½“å‰è¦å¤„ç†çš„å¼‚æ­¥ä»»åŠ¡ //ç»™executeæ–¹æ³•åŠ é”ä¿è¯äº†é¡ºåºæ‰§è¡Œ public synchronized void execute(final Runnable r) &#123; //å°†ä¸€ä¸ªrunnableæ·»åŠ è¿›åŒç«¯é˜Ÿåˆ—ä¸­ mTasks.offer(new Runnable() &#123; public void run() &#123; try &#123; r.run(); //æ‰§è¡Œ &#125; finally &#123; scheduleNext(); &#125; &#125; &#125;); if (mActive == null) &#123; scheduleNext(); &#125; &#125; //æ­¤æ–¹æ³•çš„ä½œç”¨æ˜¯å°†SerialExecutor æ± ä¸­çš„ä»»åŠ¡çš„ç¬¬ä¸€ä¸ªä»»åŠ¡èµ‹å€¼ç»™mActive ï¼Œå¹¶å‹å…¥åˆ° //THREAD_POOL_EXECUTORçº¿ç¨‹æ± ä¸­ protected synchronized void scheduleNext() &#123; //poll()æ–¹æ³•çš„ä½œç”¨æ˜¯åˆ é™¤é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå¹¶è¿”å›ç»“æœ,å¦‚æœä¸ºnullåˆ™è¿”å›null if ((mActive = mTasks.poll()) != null) &#123; //å°†ç¬¬ä¸€ä¸ªä»»åŠ¡æ·»åŠ åˆ°THREAD_POOL_EXECUTORçº¿ç¨‹æ± ä¸­ THREAD_POOL_EXECUTOR.execute(mActive); &#125; &#125; &#125; è€ŒTHREAD_POOL_EXECUTORçš„å®ç°æ˜¯åœ¨è¿™é‡Œï¼š1234567static &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( CORE_POOL_SIZE, MAXIMUM_POOL_SIZE, KEEP_ALIVE_SECONDS, TimeUnit.SECONDS, sPoolWorkQueue, sThreadFactory); threadPoolExecutor.allowCoreThreadTimeOut(true); THREAD_POOL_EXECUTOR = threadPoolExecutor;&#125; å¯ä»¥çœ‹å‡ºå®ƒæ˜¯ä¸€ä¸ªå¸¸è§çš„å·¥ä½œçº¿ç¨‹æ± ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹æ± ï¼Œä¸€ä¸ªè´Ÿè´£æ¶ˆæ¯çš„ä»»åŠ¡è°ƒåº¦ï¼Œä¿è¯æŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œå¦å¤–ä¸€ä¸ªåˆ™æ˜¯çœŸæ­£çš„å¼‚æ­¥ä»»åŠ¡å¤„ç†æ±  æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹å®ƒçš„æ„é€ æ–¹æ³•ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950public AsyncTask(@Nullable Looper callbackLooper) &#123; //åˆå§‹åŒ–ä¸€ä¸ªHandlerå¤„ç†ä¸»çº¿ç¨‹çš„é€šä¿¡ mHandler = callbackLooper == null || callbackLooper == Looper.getMainLooper() ? getMainHandler() : new Handler(callbackLooper); //åˆå§‹åŒ–ä¸€ä¸ªå¯ä»¥å­˜å‚¨Paramså‚æ•°çš„callableå®ç°ï¼Œå…¶å®ä¹Ÿæ˜¯ //THREAD_POOL_EXECUTOR.execute()çš„æ‰§è¡Œå›è°ƒ mWorker = new WorkerRunnable&lt;Params, Result&gt;() &#123; public Result call() throws Exception &#123; //é‡Œé¢çš„å›è°ƒæ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå’ŒHandlerThreadç±»ä¼¼ mTaskInvoked.set(true); //æ·»åŠ çº¿ç¨‹æ ‡è¯†,ç”¨äºpostResultIfNotInvokedæ–¹æ³•çš„æ£€æŸ¥ Result result = null; //è¿™å°±æ˜¯onPostExecute()æ–¹æ³•çš„result try &#123; Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND); //noinspection unchecked result = doInBackground(mParams); //doInBackgroundæ–¹æ³•åœ¨è¿™é‡Œæ‰§è¡Œäº† Binder.flushPendingCommands(); &#125; catch (Throwable tr) &#123; mCancelled.set(true); //æŠ›å¼‚å¸¸äº†å–æ¶ˆä»»åŠ¡ throw tr; &#125; finally &#123; postResult(result); //æ­¤æ–¹æ³•çš„ä½œç”¨æ˜¯å°†ç»“æœå‘é€åˆ°ä¸»çº¿ç¨‹ &#125; return result; &#125; &#125;; //åˆå§‹åŒ–ä¸€ä¸ªFutureå›è°ƒï¼Œä¸»è¦ç”¨äºæ£€æŸ¥å¤„ç†ç»“æœæ˜¯å¦å‘é€ mFuture = new FutureTask&lt;Result&gt;(mWorker) &#123; //done()æ–¹æ³•æ˜¯åœ¨callable()æ–¹æ³•ä¹‹åçš„å›è°ƒ @Override protected void done() &#123; try &#123; //æ‰§è¡Œæ£€æŸ¥ postResultIfNotInvoked(get()); &#125; catch (InterruptedException e) &#123; android.util.Log.w(LOG_TAG, e); &#125; catch (ExecutionException e) &#123; throw new RuntimeException(&quot;An error occurred while executing doInBackground()&quot;, e.getCause()); &#125; catch (CancellationException e) &#123; postResultIfNotInvoked(null); &#125; &#125; &#125;; &#125;//mWorker çš„å®ç° private static abstract class WorkerRunnable&lt;Params, Result&gt; implements Callable&lt;Result&gt; &#123; Params[] mParams; //ä¿å­˜ä¼ å…¥çš„å‚æ•° &#125; æ¥ä¸‹æ¥çœ‹çœ‹ä»¥ä¸Šæ£€æŸ¥çš„æ–¹æ³•çš„å®ç°ï¼š12345678910111213141516private void postResultIfNotInvoked(Result result) &#123; //æ‰§è¡Œäº†mWorker é‡Œçš„call()å›è°ƒçš„éƒ½ä¼šå˜ä¸ºtrue,å¦‚æœä¸ºfalse,è¯´æ˜ä»»åŠ¡æ²¡æœ‰è¢«æ‰§è¡Œ final boolean wasTaskInvoked = mTaskInvoked.get(); if (!wasTaskInvoked) &#123; postResult(result); &#125; &#125; //å°†æ­¤AsyncTaskå¯¹è±¡ä½œä¸ºmessageå‚æ•°å‘é€,æ¥æ”¶åˆ°ä¹‹åå°±ä¼šè°ƒç”¨finish()æ–¹æ³•ç»“æŸ private Result postResult(Result result) &#123; @SuppressWarnings(&quot;unchecked&quot;) Message message = getHandler().obtainMessage(MESSAGE_POST_RESULT, new AsyncTaskResult&lt;Result&gt;(this, result)); message.sendToTarget(); return result; &#125; å…¶ä¸­çš„getHandler()ä¸­çš„Handlerçš„å®ç°ç±»æ˜¯InternalHandlerï¼Œæ¥çœ‹çœ‹å®ƒçš„å®ç°ï¼š1234567891011121314151617181920212223242526272829303132333435363738 private static class InternalHandler extends Handler &#123; public InternalHandler(Looper looper) &#123; super(looper); &#125; @SuppressWarnings(&#123;&quot;unchecked&quot;, &quot;RawUseOfParameterizedType&quot;&#125;) @Override public void handleMessage(Message msg) &#123; AsyncTaskResult&lt;?&gt; result = (AsyncTaskResult&lt;?&gt;) msg.obj; switch (msg.what) &#123; case MESSAGE_POST_RESULT: //result.mData[0]å°±æ˜¯ä»postResultå‘é€è¿‡æ¥çš„AsyncTaskå¯¹è±¡ result.mTask.finish(result.mData[0]); //å¤„ç†ç»“æœåˆ†å‘ï¼Œå›è°ƒå¯¹åº”çš„æ–¹æ³• break; case MESSAGE_POST_PROGRESS: result.mTask.onProgressUpdate(result.mData); //è¿™é‡Œå¤„ç†è¿›åº¦æ›´æ–° break; &#125; &#125; &#125;private void finish(Result result) &#123; // å…ˆåˆ¤æ–­æ˜¯å¦è°ƒç”¨äº†Cancelled() // 1. è‹¥è°ƒç”¨äº†åˆ™æ‰§è¡Œæˆ‘ä»¬å¤å†™çš„onCancelledï¼ˆï¼‰ // å³ å–æ¶ˆä»»åŠ¡æ—¶çš„æ“ä½œ if (isCancelled()) &#123; onCancelled(result); &#125; else &#123; // 2. è‹¥æ— è°ƒç”¨Cancelled()ï¼Œåˆ™æ‰§è¡Œæˆ‘ä»¬å¤å†™çš„onPostExecute(result) // å³æ›´æ–°UIæ“ä½œ onPostExecute(result); &#125; // æ³¨ï¼šä¸ç®¡AsyncTaskæ˜¯å¦è¢«å–æ¶ˆï¼Œéƒ½ä¼šå°†AsyncTaskçš„çŠ¶æ€å˜æ›´ä¸ºï¼šFINISHED mStatus = Status.FINISHED; &#125; æœ€åæ¥çœ‹ä¸€ä¸‹æ‰§è¡Œæ–¹æ³•execute():1234567891011121314151617181920212223242526272829 @MainThread public final AsyncTask&lt;Params, Progress, Result&gt; execute(Params... params) &#123; return executeOnExecutor(sDefaultExecutor, params); &#125;@MainThread public final AsyncTask&lt;Params, Progress, Result&gt; executeOnExecutor(Executor exec, Params... params) &#123; if (mStatus != Status.PENDING) &#123; switch (mStatus) &#123; case RUNNING: throw new IllegalStateException(&quot;Cannot execute task:&quot; + &quot; the task is already running.&quot;); case FINISHED: throw new IllegalStateException(&quot;Cannot execute task:&quot; + &quot; the task has already been executed &quot; + &quot;(a task can be executed only once)&quot;); &#125; &#125; mStatus = Status.RUNNING; onPreExecute(); mWorker.mParams = params; //mWorkerä¸­çš„å‚æ•°æ˜¯åœ¨è¿™é‡Œä¿å­˜çš„ exec.execute(mFuture); //å°†mFutureå¯¹è±¡æ·»åŠ åˆ°THREAD_POOL_EXECUTOR çº¿ç¨‹æ± ä¸­ï¼ŒmFutureåœ¨æ„é€ æ–¹æ³•ä¸­åšäº†åˆå§‹åŒ–ã€‚ return this; &#125; æ€»ç»“ï¼š1.åˆå§‹åŒ–ä¸¤ä¸ªçº¿ç¨‹æ± ï¼Œä¸€ä¸ªè´Ÿè´£ä»»åŠ¡è°ƒåº¦(SerialExecutor),ä¸€ä¸ªè´Ÿè´£ä»»åŠ¡å¤„ç†THREAD_POOL_EXECUTOR2.æ„é€ æ–¹æ³•ä¸­å®ä¾‹åŒ–äº†å­çº¿ç¨‹ä¸­çš„callableæ¥å£æ–¹æ³•ï¼Œä»WorkerRunnableä¸­å–å‡ºParamså¯¹è±¡å¹¶èµ‹å€¼ç»™dodoInBackground(mParams)æ–¹æ³•æ‰§è¡Œè€—æ—¶ä»»åŠ¡ã€‚3.æ‰§è¡Œexecute()æ–¹æ³•å°†ä»»åŠ¡æäº¤åˆ°THREAD_POOL_EXECUTORçº¿ç¨‹æ± ä¸­ï¼Œå¹¶å°†Paramså‚æ•°èµ‹å€¼åˆ°äº†WorkerRunnableä¸­ã€‚4.è°ƒç”¨äº†postResult(result),é€šè¿‡InternalHandler å°†æ¶ˆæ¯å›è°ƒåˆ°äº†ä¸»çº¿ç¨‹ï¼ˆæ‰§è¡Œäº†finish()æ–¹æ³•ï¼Œé‡Œé¢æœ‰onPostExecuteæ–¹æ³•),å®ç°äº†UIçš„æ›´æ–°]]></content>
      <categories>
        <category>å¤šçº¿ç¨‹ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android/java å¤šçº¿ç¨‹(äº”)-ThreadPoolExecutorçº¿ç¨‹æ± çš„ä½¿ç”¨]]></title>
    <url>%2FThreadsource5.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. å¤šçº¿ç¨‹ç³»åˆ—å†å²æ–‡ç« :Android/java å¤šçº¿ç¨‹(ä¸€)-Threadçš„ä½¿ç”¨ä»¥åŠæºç åˆ†æAndroid/java å¤šçº¿ç¨‹(äºŒ)-Threadçš„å¥½å…„å¼ŸHandlerAndroid/java å¤šçº¿ç¨‹(ä¸‰)-HandlerThreadçš„ä½¿ç”¨åœºæ™¯åŠæºç è§£æAndroid/javaå¤šçº¿ç¨‹(å››)-IntentService å‰é¢å‡ ç¯‡æ–‡ç« ä¸»è¦éƒ½æ˜¯ä»‹ç»çš„å•ä¸ªçº¿ç¨‹çš„è¿ç”¨ä»¥åŠåŸç†ï¼Œè¿™ç¯‡æ–‡ç« å¼€å§‹è®²è§£å¤šä¸ªçº¿ç¨‹çš„è¿ç”¨ ç®€ä»‹çº¿ç¨‹æ± æ˜¯ä¸€ä¸ªèƒ½å¯¹å¤šä¸ªçº¿ç¨‹è¿›è¡Œç»Ÿä¸€ç®¡ç†çš„ä¸€å¥—æœºåˆ¶ï¼Œå®ƒå…·æœ‰è¯¸å¤šçš„ä¼˜ç‚¹ï¼š èƒ½å¯¹çº¿ç¨‹è¿›è¡Œå¤ç”¨ï¼Œå½“æœ‰ç©ºé—²çš„çº¿ç¨‹ï¼Œçº¿ç¨‹æ± ä¼šå¤ç”¨è¿™äº›çº¿ç¨‹è€Œä¸ä¼šå»é‡æ–°åˆ›å»ºï¼ŒèŠ‚çœäº†èµ„æº èƒ½çµæ´»åˆ›å»ºå„ç§çº¿ç¨‹ä½¿ç”¨åœºæ™¯ï¼Œå†…éƒ¨å°è£…äº†å¸¸ç”¨çº¿ç¨‹æ± åˆ›å»ºé€»è¾‘ï¼Œå¹¶æ”¯æŒè‡ªå®šä¹‰çº¿ç¨‹æ± é€»è¾‘åˆ›å»º èƒ½å‡†ç¡®çš„å¯¹æ¯ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œç®¡ç†ï¼Œå¹¶èƒ½è¯»å–æ¯ä¸ªçº¿ç¨‹çš„ä¸€å†™åŸºç¡€ä¿¡æ¯ï¼Œæ–¹ä¾¿è¿›è¡Œä¸€äº›é€»è¾‘å¤„ç† ç¼ºç‚¹ï¼šçº¿ç¨‹ä¸­çš„æ•°æ®ä¼ é€’æ²¡æœ‰Handleræœºåˆ¶æ–¹ä¾¿ ä½¿ç”¨åœºæ™¯ï¼šå…·æœ‰è¯¸å¤šè€—æ—¶ä»»åŠ¡çš„æƒ…å†µï¼Œå½“ç³»ç»Ÿä¸ºæ¯ä¸€ä¸ªä»»åŠ¡åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œä¼šå ç”¨ç³»ç»Ÿçš„å¤§é‡èµ„æºï¼Œå®¹æ˜“å¼•èµ·ç•Œé¢çš„å¡é¡¿ï¼Œçº¿ç¨‹æ± çš„å¤ç”¨æœºåˆ¶å°±å¾ˆå¥½çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ å¸¸ç”¨çš„çº¿ç¨‹æ± çš„ä½¿ç”¨è‡ªå®šä¹‰çº¿ç¨‹æ± 123456789101112131415161718192021public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler) &#123; if (corePoolSize &lt; 0 || maximumPoolSize &lt;= 0 || maximumPoolSize &lt; corePoolSize || keepAliveTime &lt; 0) throw new IllegalArgumentException(); if (workQueue == null || threadFactory == null || handler == null) throw new NullPointerException(); this.corePoolSize = corePoolSize; this.maximumPoolSize = maximumPoolSize; this.workQueue = workQueue; this.keepAliveTime = unit.toNanos(keepAliveTime); this.threadFactory = threadFactory; this.handler = handler;&#125; ä¼ å…¥ä¸åŒçš„å‚æ•°ï¼Œå®ç°çš„æ•ˆæœä¹Ÿä¸åŒ,ä¸‹é¢è¯´ä¸€ä¸‹æ¯ä¸ªå‚æ•°çš„ä½œç”¨: corePoolSize æ ¸å¿ƒçº¿ç¨‹æ•°,ï¼Œå³ä½¿ç©ºé—²æ—¶ä»ä¿ç•™åœ¨æ± ä¸­çš„çº¿ç¨‹æ•°,é™¤éè®¾ç½®äº†allowCoreThreadTimeOut maximumPoolSize çº¿ç¨‹æ± ä¸­å…è®¸çš„æœ€å¤§çº¿ç¨‹æ•° keepAliveTime é¡¾åæ€ä¹‰ï¼Œçº¿ç¨‹ç»ˆæ­¢å‰çš„å­˜æ´»æ—¶é—´ï¼Œå³å½“çº¿ç¨‹æ•°å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°(corePoolSize )æ—¶,å¤šä½™çš„ç©ºé—²çº¿ç¨‹åœ¨ç»ˆæ­¢ä¹‹å‰ç­‰å¾…æ–°ä»»åŠ¡çš„æœ€å¤§æ—¶é—´ TimeUnit keepAliveTimeçš„å•ä½ workQueue åœ¨æ‰§è¡Œä»»åŠ¡ä¹‹å‰ç”¨äºä¿å­˜ä»»åŠ¡çš„é˜Ÿåˆ—ã€‚ è¯¥é˜Ÿåˆ—å°†ä»…ä¿å­˜executeæ–¹æ³•æäº¤çš„Runnableä»»åŠ¡ã€‚ ThreadFactory æ‰§è¡Œç¨‹åºåˆ›å»ºæ–°çº¿ç¨‹æ—¶ä½¿ç”¨çš„å·¥å‚ RejectedExecutionHandler æ‰§è¡Œè¢«é˜»æ­¢æ—¶ä½¿ç”¨çš„å¤„ç†ç¨‹åº è¿™é‡Œè¯´ä¸€ä¸‹å„ä¸ªå‚æ•°çš„é…ç½®å¥—è·¯,å½“ä½¿ç”¨execute(Runnable)æ–¹æ³•æ·»åŠ ä¸€ä¸ªä»»åŠ¡åˆ°é˜Ÿåˆ—ä¸­ï¼Œå¦‚æœcorePoolSizeæ¯”maximumPoolSizeå°ï¼Œé˜Ÿåˆ—æ»¡äº†åå°±ä¼šå»åˆ›å»ºæ–°çš„çº¿ç¨‹,å½“corePoolSizeä¸maximumPoolSizeç›¸ç­‰æ—¶ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªå›ºå®šå¤§å°çš„æ ¸å¿ƒçº¿ç¨‹æ± ã€‚å¦‚æœå°†maximumPoolSizeè®¾ç½®ä¸ºæ— é™å¤§(ä¾‹å¦‚nteger.MAX_VALUE)ï¼Œåˆ™æ˜¯åˆ›å»ºä¸€ä¸ªèƒ½å®¹çº³ä»»æ„æ•°é‡ä»»åŠ¡çš„çº¿ç¨‹æ± ã€‚ThreadFactoryçš„ä½œç”¨æ˜¯ç”¨æ¥åˆ›å»ºæ–°çš„çº¿ç¨‹çš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ¥å£,å®ç°å®ƒå³å¯åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼š123456789101112public interface ThreadFactory &#123; /** * Constructs a new &#123;@code Thread&#125;. Implementations may also initialize * priority, name, daemon status, &#123;@code ThreadGroup&#125;, etc. * * @param r a runnable to be executed by new thread instance * @return constructed thread, or &#123;@code null&#125; if the request to * create a thread is rejected */ Thread newThread(Runnable r);&#125; é€šè¿‡å®ƒï¼Œä½ å¯ä»¥æŒ‡å®šçº¿ç¨‹çš„åç§°ï¼Œä¼˜å…ˆçº§ï¼Œå®ˆæŠ¤è¿›ç¨‹ç­‰ï¼Œå¦‚æœä¸è®¾ç½®ï¼Œåˆ™ä¼šé»˜è®¤ä½¿ç”¨Executors.defaultThreadFactory()ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªä¸æ‰€æœ‰çº¿ç¨‹ä¸æ‰€æœ‰ç›¸åŒçš„ThreadGroupå¹¶ä¸”å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§å’Œéå®ˆæŠ¤è¿›ç¨‹çŠ¶æ€NORM_PRIORITYã€‚workQueueæ˜¯ä¸€ä¸ªæ’é˜Ÿç­–ç•¥,ä¸€èˆ¬æœ‰ä¸‰ç§: ç›´æ¥åˆ‡æ¢ï¼šå¯¹åº”SynchronousQueueå®ç°ç±»ï¼Œå°†ä»»åŠ¡ç›´æ¥äº¤ç»™çº¿ç¨‹å¤„ç†ï¼Œä¸éœ€è¦å¦å¤–çš„æ§åˆ¶ï¼Œé€šå¸¸éœ€è¦é…ç½®ä¸€ä¸ªæ— é™åˆ¶çš„maximumPoolSizesï¼Œä»¥é¿å…æ‹’ç»æ‰æ–°æäº¤çš„ä»»åŠ¡ æ— ç•Œé˜Ÿåˆ—:å¯¹åº”LinkedBlockingDequeå®ç°ç±»ï¼Œå®ƒæ²¡æœ‰é¢„å®šçš„å®¹é‡ï¼Œå½“æœ‰æ–°çš„ä»»åŠ¡ï¼Œä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œç›´åˆ°åŠ å…¥åˆ°corePoolSizeçš„çº¿ç¨‹ä¸­ï¼Œå¦‚æœcorePoolSizeçº¿ç¨‹ä¸€ç›´å¾ˆå¿™ï¼Œä¹Ÿä¸ä¼šå»åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œæ­¤æ—¶ï¼Œæœ€å¤§å€¼æœ€å°å€¼å¯¹å®ƒæ²¡æœ‰ä»»ä½•çš„å½±å“ï¼Œæ¯ä¸ªä»»åŠ¡ä¸å…¶ä»–çš„ä»»åŠ¡éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä¸ä¼šäº’ç›¸å½±å“ æœ‰è¾¹ç•Œçš„é˜Ÿåˆ—ï¼šä¾‹å¦‚ArrayBlockingQueueå®ç°ç±»,å®ƒæœ‰åŠ©äºåœ¨ä½¿ç”¨æœ‰é™çš„maxPoolSizeæ—¶é˜²æ­¢èµ„æºçš„è€—å°½ï¼Œä½†å®ƒæ›´éš¾è°ƒæ•´ä¸æ§åˆ¶ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡javaæä¾›çš„å·¥å‚æ¨¡å¼æ¥æ„é€ æˆ‘ä»¬çš„çº¿ç¨‹æ± ç­–ç•¥ï¼Œä¸»è¦æä¾›äº†ä»¥ä¸‹å‡ ç§æ–¹å¼: newFixedThreadPoolç‰¹ç‚¹: çº¿ç¨‹é‡ç”¨ï¼Œå¦‚æœæ²¡æœ‰é‡ç”¨çš„çº¿ç¨‹ï¼Œå°†ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ·»åŠ åˆ°æ± ä¸­ é€‚åˆæ‰§è¡ŒçŸ­æœŸå¼‚æ­¥ä»»åŠ¡ç¨‹åºï¼Œé»˜è®¤ä¸º60ç§’çš„çº¿ç¨‹ç­‰å¾…æ—¶é—´ï¼Œè¶…è¿‡å°±ä¼šç»ˆæ­¢ä¸ç§»é™¤ é—²ç½®çš„çº¿ç¨‹ä¸ä¼šæ¶ˆè€—èµ„æº æºç é…ç½®ï¼š12345public static ExecutorService newCachedThreadPool() &#123; return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;());&#125; ä½¿ç”¨åœºæ™¯:å®ƒåˆ›å»ºäº†ä¸€ä¸ªæ— é™æ‰©å¤§çš„çº¿ç¨‹æ± ï¼Œä½†æ²¡æœ‰æ ¸å¿ƒçº¿ç¨‹æ± ï¼Œå› æ­¤èµ„æºå ç”¨å°‘ï¼Œé€‚åˆå¤„ç†ä¸€äº›çŸ­æœŸçš„å¼‚æ­¥ä»»åŠ¡ newFixedThreadPoolç‰¹ç‚¹: åˆ›å»ºä¸€ä¸ªå›ºå®šæ•°é‡çš„çº¿ç¨‹æ± ï¼Œä¸èƒ½éšæ—¶çš„æ–°å»ºçº¿ç¨‹ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œæäº¤äº†æ–°ä»»åŠ¡ï¼Œå¿…é¡»ç­‰å¾…ä¸€ä¸ªå¯ç”¨çš„çº¿ç¨‹ çº¿ç¨‹ä¼šä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°è°ƒç”¨shutdownæ–¹æ³• æºç é…ç½®:12345public static ExecutorService newFixedThreadPool(int nThreads) &#123; return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());&#125; ä½¿ç”¨åœºæ™¯:å®ƒåˆ›å»ºäº†ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹æ•°ä¸æœ€å¤§çº¿ç¨‹æ•°ç›¸åŒçš„çº¿ç¨‹æ± ï¼Œé€‚ç”¨äºå·²çŸ¥ä»»åŠ¡æ•°é‡ï¼Œå¯¹çº¿ç¨‹æ•°é‡è¿›è¡Œé™åˆ¶çš„åœºæ™¯ newWorkStealingPoolç‰¹ç‚¹: åˆ›å»ºä½¿ç”¨æ‰€æœ‰ç»™å®šå¹¶è¡Œçº§åˆ«çš„çº¿ç¨‹æ± ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨å¤šä¸ªé˜Ÿåˆ—æ¥å‡å°‘å ç”¨123456public static ExecutorService newWorkStealingPool() &#123; return new ForkJoinPool (Runtime.getRuntime().availableProcessors(), ForkJoinPool.defaultForkJoinWorkerThreadFactory, null, true);&#125; ä½¿ç”¨åœºæ™¯:å®ƒèƒ½åˆ›å»ºä¸€ä¸ªæ‹¥æœ‰å¤šä¸ªä»»åŠ¡é˜Ÿåˆ—çš„çº¿ç¨‹æ± ï¼Œå¯ä»¥å‡å°‘é“¾æ¥æ•°ã€‚å¹¶ä¸”å®ƒæ˜¯é»˜è®¤åˆ›å»ºå½“å‰å¯ç”¨cpuæ•°é‡çš„çº¿ç¨‹æ¥å¹¶è¡Œæ‰§è¡Œï¼Œå› æ­¤é€‚ç”¨äºéå¸¸è€—æ—¶çš„æ“ä½œï¼Œå¹¶ä¸”å¯ä»¥å¹¶è¡Œæ‰§è¡Œ newSingleThreadExecutorç‰¹ç‚¹ï¼š æœ‰ä¸”åªæœ‰ä¸€ä¸ªä»»åŠ¡å¤„äºæ´»åŠ¨çŠ¶æ€ å…ˆæäº¤çš„å…ˆæ‰§è¡Œï¼Œæœ‰ä»»åŠ¡é¡ºåº å½“ä»»åŠ¡å‡ºç°å¼‚å¸¸ï¼Œä¼šå¦åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ›¿æ¢123456public static ExecutorService newSingleThreadExecutor() &#123; return new FinalizableDelegatedExecutorService (new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;()));&#125; ä½¿ç”¨åœºæ™¯:å®ƒæ˜¯ä¸€ä¸ªå•ä¾‹çº¿ç¨‹ï¼Œå¹¶ä¸”æœ‰æ‰§è¡Œé¡ºåºï¼Œæ‰€ä»¥é€‚ç”¨äºæœ‰æ‰§è¡Œé¡ºåºçš„ä»»åŠ¡ï¼Œå¹¶ä¸”æœ‰ä¸”åªæœ‰ä¸€ä¸ªä»»åŠ¡æ˜¯æ‰§è¡Œä¸­çš„ ScheduledThreadPoolExecutorç‰¹ç‚¹ï¼š èƒ½è®¾ç½®å»¶è¿Ÿæ—¶é—´ï¼Œèƒ½å®šæœŸæ‰§è¡Œ ç©ºé—²çš„çº¿ç¨‹ä¼šä¿ç•™ 12345public ScheduledThreadPoolExecutor(int corePoolSize) &#123; super(corePoolSize, Integer.MAX_VALUE, DEFAULT_KEEPALIVE_MILLIS, MILLISECONDS, new DelayedWorkQueue());&#125; ä½¿ç”¨åœºæ™¯ï¼šå®ƒå…·æœ‰å®šæ—¶ç‰¹æ€§ï¼Œå› æ­¤å¯ä»¥ç”¨æ¥æ‰§è¡Œå‘¨æœŸè¡Œçš„ä»»åŠ¡ äº”å¤§çº¿ç¨‹æ± ä»‹ç»å®Œæ¯•ï¼Œæ­¤å¤–è¿˜æœ‰å…¶ä»–çš„å¸¸ç”¨æ–¹æ³•: execute(Runnable command) æäº¤ä»»åŠ¡ï¼Œåœ¨å°†æ¥çš„æŸä¸ªæ—¶é—´ç‚¹æ‰§è¡Œä»»åŠ¡ afterExecute(Runnale r,Throwable t) åœ¨æŒ‡å®šçš„Runnaleæ‰§è¡Œåè°ƒç”¨æ­¤æ–¹æ³• beforeExecute(Thread t,Runnable r)åœ¨ç»™å®šçš„çº¿ç¨‹ä¸­æ‰§è¡Œç»™å®šçš„Runnableä¹‹å‰è°ƒç”¨æ–¹æ³• funalize å½“æ‰§è¡Œå™¨ä¸å†è¢«å¼•ç”¨å¹¶ä¸”æ²¡æœ‰çº¿ç¨‹æ—¶ï¼Œè°ƒç”¨shundown shundown å¯åŠ¨æœ‰åºå…³é—­ï¼Œå…ˆå‰æäº¤çš„ä»»åŠ¡ä¼šæ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ¯•åå…³é—­ shundownNow ä¸»åŠ¨åœæ­¢æ‰§è¡Œä¸­çš„ä»»åŠ¡ï¼Œå¹¶è¿”å›æ­£åœ¨æ‰§è¡Œç­‰å¾…çš„ä»»åŠ¡åˆ—è¡¨]]></content>
      <categories>
        <category>å¤šçº¿ç¨‹ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android/javaå¤šçº¿ç¨‹(å››)-IntentService]]></title>
    <url>%2FThreadsource4.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. å¾€æœŸæ–‡ç« :Android/java å¤šçº¿ç¨‹(ä¸€)-Threadçš„ä½¿ç”¨ä»¥åŠæºç åˆ†æAndroid/java å¤šçº¿ç¨‹(äºŒ)-Threadçš„å¥½å…„å¼ŸHandlerAndroid/java å¤šçº¿ç¨‹(ä¸‰)-HandlerThreadçš„ä½¿ç”¨åœºæ™¯åŠæºç è§£æ ç®€ä»‹ä¸€ä¸ªæ–¹ä¾¿çš„èƒ½åœ¨å­çº¿ç¨‹ä¸­è¿è¡Œçš„æœåŠ¡ï¼Œä¸€ä¸ªIntentServiceå¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œç”±äºæ˜¯å››å¤§ç»„ä»¶ï¼Œä¼˜å…ˆçº§æ¯”çº¿ç¨‹é«˜ï¼Œä¸æ˜“è¢«ç³»ç»Ÿå›æ”¶ï¼Œå¤„ç†å®Œä»»åŠ¡è¿˜èƒ½ä¸»åŠ¨å›æ”¶ï¼Œå› æ­¤ç”¨æ¥å¤„ç†åå°ä¸‹è½½ä»»åŠ¡æä¸ºé€‚åˆ ç®€å•ä½¿ç”¨å…ˆç»§æ‰¿æ­¤ç±»ï¼Œé‡å†™å¿…è¦çš„æ–¹æ³•ï¼Œæˆ‘ä»¬çš„é€»è¾‘å¤„ç†æ˜¯åœ¨onHandleIntent()æ–¹æ³•ä¸­12345678910111213141516171819202122232425262728293031323334/** * Created by hj on 2018/12/21. * è¯´æ˜ï¼š */public class MyIntentService extends IntentService &#123; public MyIntentService() &#123; super(&quot;MyIntentService&quot;); &#125; @Override protected void onHandleIntent(@Nullable Intent intent) &#123; //æ ¸å¿ƒæ–¹æ³•ï¼Œå¤„ç†å¼‚æ­¥é€»è¾‘ Log.i(&quot;HJ&quot;,&quot;onHandleIntent&quot;); &#125; @Override public int onStartCommand(@Nullable Intent intent, int flags, int startId) &#123; Log.i(&quot;HJ&quot;,&quot;onStartCommand&quot;); return super.onStartCommand(intent, flags, startId); &#125; @Override public void onCreate() &#123; Log.i(&quot;HJ&quot;, &quot;onCreate&quot;); super.onCreate(); &#125; @Override public void onDestroy() &#123; Log.i(&quot;HJ&quot;,&quot;onDestroy&quot;); super.onDestroy(); &#125;&#125; åœ¨æ¸…å•æ–‡ä»¶ä¸­æ³¨å†Œ:12345&lt;service android:name=&quot;.MyIntentService&quot;&gt; &lt;intent-filter&gt; &lt;action android:name=&quot;com.jay.thread&quot;/&gt; &lt;/intent-filter&gt;&lt;/service&gt; åœ¨Activityä¸­è¿è¡Œï¼š123Intent intent = new Intent(&quot;com.jay.thread&quot;);intent.setPackage(getPackageName());startService(intent); æ‰“å°çš„ç»“æœå¦‚ä¸‹ï¼š12342018-12-21 15:03:14.848 4241-4241/com.zj.example.customview.funnel I/HJ: onCreate2018-12-21 15:03:14.850 4241-4241/com.zj.example.customview.funnel I/HJ: onStartCommand2018-12-21 15:03:14.850 4241-4258/com.zj.example.customview.funnel I/HJ: onHandleIntent2018-12-21 15:03:16.225 4241-4241/com.zj.example.customview.funnel I/HJ: onDestroy å¯ä»¥çœ‹åˆ°ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸæ˜¯onCreate()-&gt;onStartCommand()-&gt;onHandleIntent()-&gt;onDestroy(),è€Œä¸”å½“å®ƒæŠŠonHandleIntent()æ–¹æ³•é‡Œçš„é€»è¾‘å¤„ç†å®Œæ¯•åä¼šè‡ªåŠ¨è°ƒç”¨onDestroyæ¥ç»“æŸï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦ä¸»åŠ¨æ¥å…³é—­å®ƒã€‚ è€Œä¸”è¯´åˆ°éšå¼å¯åŠ¨Serviceï¼Œè¿™é‡Œè¦å¨é€¼ä¸¤å¥ï¼Œå¦‚æœæˆ‘æŠŠä¸Šé¢çš„intent.setPackage(getPackageName())å»æ‰é‚£ä¹ˆåœ¨5.0ä»¥ä¸Šæœºå‹ä¼šé‡åˆ°è¿™ç§å¼‚å¸¸ï¼š123456789101112131415161718Caused by: java.lang.IllegalArgumentException: Service Intent must be explicit: Intent &#123; act=com.jay.thread &#125; at android.app.ContextImpl.validateServiceIntent(ContextImpl.java:1448) at android.app.ContextImpl.startServiceCommon(ContextImpl.java:1489) at android.app.ContextImpl.startService(ContextImpl.java:1461) at android.content.ContextWrapper.startService(ContextWrapper.java:644) at com.zj.example.customview.funnel.MainActivity.onCreate(MainActivity.java:34) at android.app.Activity.performCreate(Activity.java:6975) at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1213) at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2770) at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2892) at android.app.ActivityThread.-wrap11(Unknown Source:0) at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1593) at android.os.Handler.dispatchMessage(Handler.java:105) at android.os.Looper.loop(Looper.java:164) at android.app.ActivityThread.main(ActivityThread.java:6541) at java.lang.reflect.Method.invoke(Native Method) at com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240) at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767) åŸå› æ˜¯åœ¨5.0æºç ä¸­è°·æ­Œåšäº†é™åˆ¶ï¼Œå¦‚æœcomponentå’Œpackageéƒ½ä¸ºç©ºï¼Œé‚£ä¹ˆå°±ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ï¼Œè¯¦è§æºç (æºç ä½ç½®ï¼šsdk/sources/android21/android/app/ContextImpl.javaï¼‰:123456789101112private void validateServiceIntent(Intent service) &#123; if (service.getComponent() == null &amp;&amp; service.getPackage() == null) &#123; if (getApplicationInfo().targetSdkVersion &gt;= Build.VERSION_CODES.LOLLIPOP) &#123; IllegalArgumentException ex = new IllegalArgumentException( &quot;Service Intent must be explicit: &quot; + service); throw ex; &#125; else &#123; Log.w(TAG, &quot;Implicit intents with startService are not safe: &quot; + service + &quot; &quot; + Debug.getCallers(2, 3)); &#125; &#125; &#125; So,æˆ‘ä»¬åªè¦ä¿è¯å…¶ä¸­ä¸€ä¸ªä¸ä¸ºç©ºå°±å¯ä»¥å•¦. æºç è§£ææºç è¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥å…ˆä»onCreate()æ–¹æ³•çœ‹èµ·ï¼Œå…·ä½“é€»è¾‘è§æ³¨é‡Šï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596public abstract class IntentService extends Service &#123; private volatile Looper mServiceLooper; //HandlerThreadä¸­çš„Looper private volatile ServiceHandler mServiceHandler; //é€»è¾‘å¤„ç†Handler private String mName; //çº¿ç¨‹åç§° private boolean mRedelivery; //æ˜¯å¦ä¿è¯intentåœ¨æœåŠ¡è¢«æ€æ­»åèƒ½è¢«æ¥æ”¶åˆ° //å­çº¿ç¨‹Handlerçš„é€»è¾‘å¤„ç†ç±» private final class ServiceHandler extends Handler &#123; public ServiceHandler(Looper looper) &#123; super(looper); &#125; @Override public void handleMessage(Message msg) &#123; onHandleIntent((Intent)msg.obj); //onHandleIntentæ–¹æ³•å›è°ƒ stopSelf(msg.arg1); //è‡ªåŠ¨å›æ”¶ &#125; &#125; public IntentService(String name) &#123; super(); mName = name; &#125; /** *æ­¤æ–¹æ³•çš„ä½œç”¨ï¼šå¦‚æœä¸ºtrue,åˆ™å°†Service StartResultçŠ¶æ€ç½®ä¸ºSTART_REDELIVER_INTENT,è¿™æ ·å½“onHandleIntentæ–¹æ³•è¿˜æœªå›è°ƒçš„æ—¶å€™æœåŠ¡è¢«å›æ”¶ï¼Œé‡å¯çš„æ—¶å€™onHandleIntentæ–¹æ³•ä¼šè¢«å›è°ƒ,å‘é€ä¸Šä¸€æ¬¡å›æ”¶å‰çš„intent,å¦‚æœæœ‰å¤šä¸ªintent,å°†ä¼šå‘é€æœ€åä¸€ä¸ªæ„å›¾ * **/ public void setIntentRedelivery(boolean enabled) &#123; mRedelivery = enabled; &#125; @Override public void onCreate()&#123; super.onCreate(); //åˆ›å»ºHandlerThread å¹¶å°†çº¿ç¨‹å‘½åä¸ºIntentService+è‡ªå®šä¹‰åç§°çš„å½¢å¼ HandlerThread thread = new HandlerThread(&quot;IntentService[&quot; + mName + &quot;]&quot;); thread.start(); mServiceLooper = thread.getLooper(); mServiceHandler = new ServiceHandler(mServiceLooper); //å°†HandlerThreadé‡Œåˆå§‹åŒ–çš„looperè®¾ç½®ç»™å­çº¿ç¨‹Handler &#125; @Override public void onStart(@Nullable Intent intent, int startId) &#123; Message msg = mServiceHandler.obtainMessage(); msg.arg1 = startId; msg.obj = intent; //æˆ‘ä»¬åœ¨onHandleIntentæ–¹æ³•é‡Œæ¥æ”¶çš„intentæ˜¯åœ¨è¿™é‡Œèµ‹å€¼çš„ mServiceHandler.sendMessage(msg); &#125; /** * You should not override this method for your IntentService. Instead, * override &#123;@link #onHandleIntent&#125;, which the system calls when the IntentService * receives a start request. * @see android.app.Service#onStartCommand */ @Override public int onStartCommand(@Nullable Intent intent, int flags, int startId) &#123; onStart(intent, startId); //StartResultçŠ¶æ€è®¾ç½®æ˜¯åœ¨è¿™é‡Œ return mRedelivery ? START_REDELIVER_INTENT : START_NOT_STICKY; &#125; @Override public void onDestroy() &#123; mServiceLooper.quit(); &#125; //è¿™é‡Œå°†è¿”å›å€¼ç½®ä¸ºäº†nullï¼Œæ‰€ä»¥ä¸å»ºè®®ä½¿ç”¨bindServiceçš„å½¢å¼æ¥å¯åŠ¨å®ƒï¼Œå¦‚æœéœ€è¦ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨Service @Override @Nullable public IBinder onBind(Intent intent) &#123; return null; &#125; /** * This method is invoked on the worker thread with a request to process. * Only one Intent is processed at a time, but the processing happens on a * worker thread that runs independently from other application logic. * So, if this code takes a long time, it will hold up other requests to * the same IntentService, but it will not hold up anything else. * When all requests have been handled, the IntentService stops itself, * so you should not call &#123;@link #stopSelf&#125;. * * @param intent The value passed to &#123;@link * android.content.Context#startService(Intent)&#125;. * This may be null if the service is being restarted after * its process has gone away; see * &#123;@link android.app.Service#onStartCommand&#125; * for details. */ @WorkerThread protected abstract void onHandleIntent(@Nullable Intent intent);&#125; æˆ‘ä»¬åœ¨æºç ä¸­çœ‹åˆ°ï¼Œå†…éƒ¨å®ç°å…¶å®è¿˜æ˜¯HandlerThread+Handlerçš„æ–¹å¼ï¼ŒonCreate()ä¸­åšäº†ä¸€äº›åˆå§‹åŒ–çš„æ“ä½œï¼Œåœ¨onStartä¸­å°†intentç”¨objçš„æ–¹å¼ä¼ é€’ç»™äº†ServiceHandler,ç„¶ååœ¨handleMessageä¸­æ‹¿åˆ°intentå¹¶è°ƒç”¨äº†onHandleIntentå›è°ƒå‡ºæ¥ï¼Œè¿™æ ·ä¸€ä¸ªå®Œæ•´çš„çº¿ç¨‹æœ‰åºå¾ªç¯å°±å»ºç«‹äº†ï¼Œè€Œä¸”å› ä¸ºæ˜¯å››å¤§ç»„ä»¶ï¼Œå­˜æ´»ç‡æœ‰å¾ˆå¤§çš„æå‡ï¼Œè¿™æ˜¯ç›´æ¥ç”¨çº¿ç¨‹å®ç°æ‰€æ²¡æœ‰çš„ä¼˜åŠ¿ çœ‹å®Œäº†æºç ï¼Œæœ‰æ²¡æœ‰å¯¹HandlerThread+Handlerçš„åº”ç”¨è¿›ä¸€æ­¥åŠ æ·±å‘¢ï¼Ÿ]]></content>
      <categories>
        <category>å¤šçº¿ç¨‹ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android/javaå¤šçº¿ç¨‹(ä¸‰)-HandlerThreadçš„ä½¿ç”¨åœºæ™¯åŠæºç è§£æ]]></title>
    <url>%2FThreadsource3.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. HandlerThreadæ˜¯ä»€ä¹ˆï¼Ÿç‚¹å¼€ç±»æ¥¸ä¸€çœ¼ï¼Œè¿™è´§æ˜¯è¿™æ ·ä»‹ç»è‡ªå·±çš„ï¼š12* Handy class for starting a new thread that has a looper. The looper can then be * used to create handler classes. Note that start() must still be called. å¤§æ„æ˜¯è¯´å®ƒæ˜¯ç”¨æ¥å¯åŠ¨å…·æœ‰ä¸€ä¸ªå†…éƒ¨å¾ªç¯çš„æ–°çº¿ç¨‹çš„ä¸€ä¸ªä¾¿åˆ©ç±»ã€‚å†…éƒ¨å¾ªç¯ï¼ŸåŒæ—¶åç§°åˆæœ‰Handleråˆæœ‰Threadï¼Œçœ‹è¿‡æˆ‘è¿™ç¯‡æ–‡ç« çš„åŒå­¦ä¼°è®¡çŒœåˆ°äº†ï¼Œè¿™è´§ä¼°è®¡æ˜¯Handlerä¸Threadçš„äº²å„¿å­æ— ç–‘äº†,ä½†æ˜¯ä¸¤ä¸ªå¥½åŸºå‹å“ªæ¥çš„å„¿å­å‘¢ï¼Œå›§~~~~å¾€æœŸç›®å½•ï¼šAndroid/java å¤šçº¿ç¨‹(ä¸€)-Threadçš„ä½¿ç”¨ä»¥åŠæºç åˆ†æAndroid/java å¤šçº¿ç¨‹(äºŒ)-Threadçš„å¥½å…„å¼ŸHandler æˆ‘åœ¨ä¸Šç¯‡æ–‡ç« ä»‹ç»Handlerçš„æ—¶å€™ä¸¾äº†ä¸€ä¸ªä¾‹å­ï¼Œåœ¨å­çº¿ç¨‹ä¸­ä½¿ç”¨Handlerï¼š123456789101112131415161718class MyThread extends Thread &#123; @Override public void run() &#123; Looper.prepare(); @SuppressLint(&quot;HandlerLeak&quot;) Handler mHandler = new Handler()&#123; @Override public void handleMessage(Message msg) &#123; //å¤„ç†é€»è¾‘ l(Thread.currentThread().getName()); &#125; &#125;; Message message = mHandler.obtainMessage(1); mHandler.sendMessage(message); Looper.loop(); &#125;&#125; æ˜¯ä¸æ˜¯æ˜¾å¾—å·¨éº»çƒ¦ï¼Œè€Œä¸”å·¨ä¸‘ï¼ŒHandlerThreadå°±æ˜¯ä¸ºäº†é˜²æ­¢æˆ‘ä»¬å†™å‡ºå¦‚æ­¤ä¸‘é™‹çš„ä»£ç è€Œç”Ÿçš„ï¼Œå®ƒçš„æœ¬è´¨åŸç†å…¶å®ä¹Ÿå°±æ˜¯ä»¥ä¸Šé‚£å‡ è¡Œä»£ç ã€‚ä¸ä¿¡ï¼Ÿï¼Œæˆ‘ä»¬æ¥ç…ç… HandlerThreadæºç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102public class HandlerThread extends Thread &#123; int mPriority; //çº¿ç¨‹ä¼˜å…ˆçº§ int mTid = -1; Looper mLooper; private @Nullable Handler mHandler;//æŒ‡å®šçº¿ç¨‹çš„åç§°ï¼Œé»˜è®¤çº¿ç¨‹ä¼˜å…ˆçº§ä¸ºDEFAULT,ä¹Ÿæ˜¯æœ€ä½çº§çš„ public HandlerThread(String name) &#123; super(name); mPriority = Process.THREAD_PRIORITY_DEFAULT; &#125; //æŒ‡å®šçº¿ç¨‹çš„åç§°ï¼ŒåŒæ—¶æŒ‡å®šçº¿ç¨‹çš„ä¼˜å…ˆçº§ public HandlerThread(String name, int priority) &#123; super(name); mPriority = priority; &#125; //è¿™é‡Œä¸»è¦å¤„ç†ä¸€äº›æ•°æ®çš„åˆå§‹åŒ–å•Šä¸€äº›å­çº¿ç¨‹çš„é€»è¾‘æ“ä½œå•¥çš„ï¼Œåœ¨run()æ–¹æ³•ä¸­å›è°ƒ protected void onLooperPrepared() &#123; &#125; //ç†Ÿæ‚‰çš„run()æ–¹æ³• @Override public void run() &#123; mTid = Process.myTid(); Looper.prepare(); //åˆ›å»ºLooper() synchronized (this) &#123; mLooper = Looper.myLooper(); notifyAll(); //åˆ°è¿™é‡ŒLooperå·²ç»åˆ›å»ºå®Œæ¯•ï¼Œå”¤é†’é˜»å¡çš„çº¿ç¨‹ &#125; //è®¾ç½®çº¿ç¨‹ä¼˜å…ˆçº§ Process.setThreadPriority(mPriority); onLooperPrepared(); //æ‰§è¡ŒonLooperPrepared()æ–¹æ³• Looper.loop(); //å¼€å¯å¾ªç¯ mTid = -1; &#125; /** * This method returns the Looper associated with this thread. If this thread not been started * or for any reason isAlive() returns false, this method will return null. If this thread * has been started, this method will block until the looper has been initialized. * @return The looper. */ public Looper getLooper() &#123; if (!isAlive()) &#123; return null; &#125; // If the thread has been started, wait until the looper has been created. synchronized (this) &#123; while (isAlive() &amp;&amp; mLooper == null) &#123; try &#123; wait(); &#125; catch (InterruptedException e) &#123; &#125; &#125; &#125; return mLooper; &#125; /** * @return a shared &#123;@link Handler&#125; associated with this thread * @hide */ @NonNull public Handler getThreadHandler() &#123; if (mHandler == null) &#123; mHandler = new Handler(getLooper()); &#125; return mHandler; &#125; //éå®‰å…¨çš„ç»“æŸå¾ªç¯ public boolean quit() &#123; Looper looper = getLooper(); if (looper != null) &#123; looper.quit(); return true; &#125; return false; &#125; ////å®‰å…¨çš„ç»“æŸå¾ªç¯ public boolean quitSafely() &#123; Looper looper = getLooper(); if (looper != null) &#123; looper.quitSafely(); return true; &#125; return false; &#125; /** * Returns the identifier of this thread. See Process.myTid(). */ public int getThreadId() &#123; return mTid; &#125;&#125; ç»“åˆæºç ï¼Œè¿™è´§å…¶å®ä¹Ÿå°±æ˜¯åœ¨run()ä¸­å¼€å¯äº†Looperå¾ªç¯ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªonLooperPrepared ()æ–¹æ³•ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œåšä¸€äº›åˆå§‹åŒ–çš„æ“ä½œã€‚éœ€è¦æ³¨æ„çš„æ˜¯quit()æ–¹æ³•å’ŒquitSafely()çš„åŒºåˆ«ï¼Œquit()æ˜¯ç«‹å³åœæ­¢Looperå¾ªç¯ï¼Œæ­¤æ—¶å¯èƒ½æœ‰æ¶ˆæ¯æœªå¤„ç†å°±GGäº†ï¼Œæ‰€ä»¥è¯´å®ƒçš„ä¸å®‰å…¨çš„ï¼Œè€ŒquitSafely()æ˜¯ç­‰å¾…æ¶ˆæ¯å¤„ç†å®Œæ¯•åæ‰åœæ­¢Looperå¾ªç¯ï¼Œæ‰€ä»¥è¯´å®ƒæ˜¯å®‰å…¨çš„ï¼Œå¦å¤–å¯ä»¥çœ‹åˆ°å®ƒæŒ‡å®šçº¿ç¨‹ä¼˜å…ˆçº§æ˜¯ä½¿ç”¨çš„Process.setThreadPriority(mPriority)æ–¹æ³•ï¼Œæ‰€æœ‰å®ƒçš„å¯é€‰å€¼æ˜¯ä»Process()é‡Œé¢è·å– HandlerThreadçš„ä½¿ç”¨åœºæ™¯HandlerThreadå°æœ‹å‹çš„ä¼˜ç‚¹HandlerThreadé‡Œé¢çš„æœ¬è´¨å®é™…ä¸Šæ˜¯å­çº¿ç¨‹æ¶ˆæ¯è½®è¯¢æœºåˆ¶ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä»ä¸­è·å–åˆ°ä¸€ä¸ªåœ¨å­çº¿ç¨‹ä¸­è½®è¯¢çš„Looperï¼Œå¦‚æœè®¾ç½®ç»™Handler,é‚£ä¹ˆè¿™ä¸ªHandlerå°±èƒ½åœ¨å­çº¿ç¨‹ä¸­å¤„ç†æ¶ˆæ¯ã€‚æ‰€ä»¥å®ƒç‰¹åˆ«é€‚åˆå¤„ç†å¤§é‡éœ€è¦æ’é˜Ÿç­‰å¾…æˆ–éœ€è¦é‡å¤æ“ä½œçš„åˆè€—æ—¶çš„é€»è¾‘ï¼Œå®ƒæ—¢èƒ½å¤Ÿæ–¹ä¾¿çš„é€šçŸ¥ä¸»çº¿ç¨‹æ›´æ–°UIï¼Œå†…éƒ¨åˆèƒ½æ–¹ä¾¿çš„åšçº¿ç¨‹çš„é˜Ÿåˆ—å¤„ç†ï¼Œæ‰€ä»¥å®ƒçš„ä½¿ç”¨è¿˜æ˜¯æ¯”è¾ƒå¹¿æ³›æ»´ã€‚ ä¸¾ä¸ªæ —å­å‡è®¾æœ‰è¿™ä¹ˆä¸ªéœ€æ±‚ï¼šéœ€è¦æ‰¹é‡ä¸‹è½½æ–‡ä»¶ï¼Œä¸€æ¬¡åªèƒ½ä¸‹è½½ä¸€ä¸ªï¼Œä¸‹è½½å®Œæ¯•åè‡ªåŠ¨ä¸‹è½½ä¸‹ä¸€ä¸ªï¼Œæˆ–è€…è¿™ä¸ªä¸‹è½½å¤±è´¥æˆ–æš‚åœè‡ªåŠ¨ä¸‹è½½ä¸‹ä¸€ä¸ª(æ˜¯ä¸æ˜¯æœ‰ç‚¹åƒæŸé›·çš„ä¸‹è½½åœºæ™¯)ï¼Œä¼ªå®ç°å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293/** * Created by hj on 2018/12/21. * è¯´æ˜ï¼šæ¨¡æ‹Ÿçº¿ç¨‹ä¸‹è½½ */public class DownloadHandlerThread extends HandlerThread implements Handler.Callback &#123; private Handler workHandler; //å¤„ç†ä¸‹è½½é€»è¾‘çš„Handler private Handler uiHandler; //å¤„ç†UIåˆ·æ–°çš„Handler public final static int READY = 0X110; public final static int STAR = 0X111; public final static int STOP = 0X112; public final static int ERROR = 0X113; private int max; private int index; public DownloadHandlerThread() &#123; super(&quot;download-thread&quot;); &#125; @Override protected void onLooperPrepared() &#123; //åˆå§‹åŒ– workHandler = new Handler(getLooper(), this); if (uiHandler == null) &#123; throw new NullPointerException(&quot;uiHandler is not null&quot;); &#125; uiHandler.sendEmptyMessage(READY); //é€šçŸ¥ä¸»çº¿ç¨‹Looperå·²ç»å‡†å¤‡å®Œæ¯•ï¼Œå¯ä»¥å¼€å§‹ä¸‹è½½äº† &#125; @Override public boolean handleMessage(Message msg) &#123; switch (msg.what) &#123; case STAR: //å¼€å§‹ä¸‹è½½ index++; //è®°å½•å½“å‰ä¸‹è½½åˆ°äº†ç¬¬å‡ ä¸ª String url = msg.getData().getString(&quot;url&quot;); Log.i(&quot;HJ&quot;, &quot;å‡†å¤‡ä¸‹è½½ï¼š&quot; + url); try &#123; sleep(2000); //æ¨¡æ‹Ÿä¸‹è½½ if (index == 2) &#123; //ä¸‹è½½åˆ°ç¬¬äºŒä¸ªçš„æ—¶å€™æ¨¡æ‹Ÿä¸‹è½½å¤±è´¥ Log.i(&quot;HJ&quot;, &quot;ä¸‹è½½å‡ºé”™ï¼š&quot; + url); setErrorMessage(url); Log.i(&quot;HJ&quot;, &quot;å¼€å§‹ä¸‹è½½ä¸‹ä¸€ä¸ªåœ°å€&quot;); &#125; else &#123; Log.i(&quot;HJ&quot;, &quot;å½“å‰åœ°å€ä¸‹è½½å®Œæˆï¼š&quot; + url); &#125; &#125; catch (InterruptedException e) &#123; setErrorMessage(url); e.printStackTrace(); &#125; if (index == max) &#123; //å…¨éƒ¨ä¸‹è½½å®Œæ¯• workHandler.sendEmptyMessage(STOP); &#125; break; case STOP: //å…¨éƒ¨ä¸‹è½½å®Œæˆ //é€€å‡ºLooperå¾ªç¯ if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN_MR2) &#123; quitSafely(); &#125; else &#123; quit(); &#125; Log.i(&quot;HJ&quot;, &quot;å…¨éƒ¨ä¸‹è½½å®Œæˆ&quot;); break; &#125; return false; &#125; //å‘é€ä¸‹è½½é”™è¯¯æ¶ˆæ¯åˆ°ä¸»çº¿ç¨‹ç”¨äºåˆ·æ–°UI private void setErrorMessage(String url) &#123; Message errorMsg = new Message(); errorMsg.what = ERROR; Bundle bundle = new Bundle(); bundle.putString(&quot;errorUrl&quot;, url); errorMsg.setData(bundle); uiHandler.sendMessage(errorMsg); &#125; public void setUiHandler(Handler uiHandler) &#123; this.uiHandler = uiHandler; &#125; public Handler getWorkHandler() &#123; return workHandler; &#125; public void setMax(int max) &#123; this.max = max; &#125;&#125; åœ¨Activityä¸­ä½¿ç”¨ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657public class MainActivity extends AppCompatActivity &#123; private Handler uiHandler; //æ¨¡æ‹Ÿæ•°æ®æº private String[] urls = new String[]&#123; &quot;url-1&quot;, &quot;url-2&quot;, &quot;url-3&quot;, &quot;url-4&quot;, &quot;url-5&quot; &#125;; private DownloadHandlerThread mThread; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); initUiHandler(); initDownLoad(); &#125; @SuppressLint(&quot;HandlerLeak&quot;) private void initUiHandler() &#123; uiHandler = new Handler() &#123; @Override public void handleMessage(Message msg) &#123; switch (msg.what) &#123; case DownloadHandlerThread.READY: //è·å–åˆ°workHandlerå·²ç»åˆå§‹åŒ–å®Œæ¯•ï¼Œå¯ä»¥è¿›è¡Œä¸‹è½½ä»»åŠ¡äº† Handler workHandler = mThread.getWorkHandler(); mThread.setMax(urls.length); for (String url : urls) &#123; //å¾ªç¯å°†MessageåŠ å…¥MessageQueueæ¶ˆæ¯æ± ä¸­ Message message = new Message(); message.what = DownloadHandlerThread.STAR; Bundle bundle = new Bundle(); bundle.putString(&quot;url&quot;, url); message.setData(bundle); workHandler.sendMessage(message); &#125; break; case DownloadHandlerThread.ERROR: //å¤„ç†ä¸‹è½½å¤±è´¥UIé€»è¾‘ String url = msg.getData().getString(&quot;errorUrl&quot;); showShortToast(&quot;ä¸‹è½½å¤±è´¥é“¾æ¥:&quot; + url); Log.i(&quot;HJ&quot;,&quot;å±•ç¤ºä¸‹è½½å¤±è´¥UI&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot;); break; &#125; &#125; &#125;; &#125; private void showShortToast(String string) &#123; Toast.makeText(this, string, Toast.LENGTH_SHORT).show(); &#125; private void initDownLoad() &#123; mThread = new DownloadHandlerThread(); mThread.setUiHandler(uiHandler); mThread.start(); &#125;&#125; è¿è¡Œç»“æœå¦‚ä¸‹ï¼š123456789101112132018-12-21 11:51:02.775 2390-2432/com.zj.example.customview.funnel I/HJ: å‡†å¤‡ä¸‹è½½ï¼šurl-12018-12-21 11:51:04.775 2390-2432/com.zj.example.customview.funnel I/HJ: å½“å‰åœ°å€ä¸‹è½½å®Œæˆï¼šurl-12018-12-21 11:51:04.775 2390-2432/com.zj.example.customview.funnel I/HJ: å‡†å¤‡ä¸‹è½½ï¼šurl-22018-12-21 11:51:06.777 2390-2432/com.zj.example.customview.funnel I/HJ: ä¸‹è½½å‡ºé”™ï¼šurl-22018-12-21 11:51:06.777 2390-2432/com.zj.example.customview.funnel I/HJ: å¼€å§‹ä¸‹è½½ä¸‹ä¸€ä¸ªåœ°å€2018-12-21 11:51:06.778 2390-2432/com.zj.example.customview.funnel I/HJ: å‡†å¤‡ä¸‹è½½ï¼šurl-32018-12-21 11:51:06.779 2390-2390/com.zj.example.customview.funnel I/HJ: å±•ç¤ºä¸‹è½½å¤±è´¥UI&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;2018-12-21 11:51:08.778 2390-2432/com.zj.example.customview.funnel I/HJ: å½“å‰åœ°å€ä¸‹è½½å®Œæˆï¼šurl-32018-12-21 11:51:08.778 2390-2432/com.zj.example.customview.funnel I/HJ: å‡†å¤‡ä¸‹è½½ï¼šurl-42018-12-21 11:51:10.779 2390-2432/com.zj.example.customview.funnel I/HJ: å½“å‰åœ°å€ä¸‹è½½å®Œæˆï¼šurl-42018-12-21 11:51:10.779 2390-2432/com.zj.example.customview.funnel I/HJ: å‡†å¤‡ä¸‹è½½ï¼šurl-52018-12-21 11:51:12.783 2390-2432/com.zj.example.customview.funnel I/HJ: å½“å‰åœ°å€ä¸‹è½½å®Œæˆï¼šurl-52018-12-21 11:51:12.783 2390-2432/com.zj.example.customview.funnel I/HJ: å…¨éƒ¨ä¸‹è½½å®Œæˆ å¯ä»¥çœ‹åˆ°DownloadHandlerThreadä¸»è¦æ‰¿è½½çš„åŠŸèƒ½å¦‚ä¸‹: åˆå§‹åŒ–ä¸€ä¸ªå­çº¿ç¨‹Handlerç”¨äºå¤„ç†å­çº¿ç¨‹çš„æ¶ˆæ¯é€šä¿¡ æ‰§è¡Œä¸‹è½½ä»»åŠ¡ä»¥åŠä¸ä¸»çº¿ç¨‹çš„uié€šä¿¡ è¿™æ ·çš„å¤„ç†æ–¹å¼æå¤§çš„æ–¹ä¾¿äº†uiçº¿ç¨‹ä¸å­çº¿ç¨‹çš„é€šè®¯ï¼Œåªéœ€è¦ç”¨ä¸åŒçš„handlerå‘é€æ¶ˆæ¯å³å¯ï¼Œæ¥å†å¤šçš„handleréƒ½ä¸æ€•ã€‚è€Œä¸”è¿™åªéœ€è¦å¼€å¯ä¸€ä¸ªçº¿ç¨‹ï¼Œæå¤§çš„èŠ‚çœäº†å†…å­˜ç©ºé—´ï¼Œè€Œä¸”èƒ½è®©çº¿ç¨‹ä»»åŠ¡æœ‰åºè¿›è¡Œï¼Œæ–¹ä¾¿ç®¡ç†ã€‚ å»ºè®®å°†ä»¥ä¸Šä»£ç å¤åˆ¶è¿‡å»è·‘ä¸€è·‘ï¼Œè°ƒè¯•ä¸€ä¸‹ï¼Œè¿™æ ·èƒ½æ›´å¿«çš„ç†è§£HandlerThreadçš„é€šä¿¡ä»¥åŠå®ƒçš„ä¾¿æ·é€šä¿¡æœºåˆ¶ã€‚]]></content>
      <categories>
        <category>å¤šçº¿ç¨‹ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android/java å¤šçº¿ç¨‹(äºŒ)-Threadçš„å¥½å…„å¼ŸHandler]]></title>
    <url>%2Fmultithreading2.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. ä¸Šä¸€ç¯‡å¸¦å¤§å®¶äº†è§£äº†Threadçš„ä½¿ç”¨ä»¥åŠåŸºæœ¬çš„è¿è¡ŒåŸç†ï¼Œè¿™ä¸€ç¯‡å°±å¸¦å¤§å®¶äº†è§£ä¸‹Threadçš„å¥½å…„å¼ŸHandler Android/java å¤šçº¿ç¨‹(ä¸€)-Threadçš„ä½¿ç”¨ä»¥åŠæºç åˆ†æ ç®€ä»‹Handleræœºåˆ¶åœ¨å®‰å“ä¸­åº”ç”¨éå¸¸å¹¿æ³›ï¼Œåƒæˆ‘ä»¬å¸¸è§çš„ç”¨äºåœ¨å­çº¿ç¨‹ä¸­æ›´æ–°UIï¼š123456789101112131415161718192021222324252627282930public class MainActivity extends AppCompatActivity &#123; @SuppressLint(&quot;HandlerLeak&quot;) private Handler mHandler = new Handler()&#123; @Override public void handleMessage(Message msg) &#123; //æ›´æ–°UI &#125; &#125;; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); MyThread thread = new MyThread(); thread.start(); &#125; class MyThread extends Thread &#123; @Override public void run() &#123; //å¤„ç†å­çº¿ç¨‹é€»è¾‘ //.... //å‘é€æ¶ˆæ¯æ›´æ–°UI Message message = mHandler.obtainMessage(1); mHandler.sendMessage(message); &#125; &#125;&#125; ç”±æ­¤å¼•å‡ºä¸€äº›é—®é¢˜ï¼Œä¸ºä»€ä¹ˆsendMessageä¹‹åhandleMessageæ–¹æ³•ä¼šè¢«æ‰§è¡Œ?.ä¸ºä»€ä¹ˆhandleMessageæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­?.å®ƒä»¬çš„æ¶ˆæ¯æ˜¯å¦‚ä½•ä¼ é€’çš„?.è¿™äº›ä¼šåœ¨ä¸‹é¢è®²è§£ ä¸”çœ‹è¿˜æœ‰ä¸€ç§ä½¿ç”¨æƒ…å†µï¼Œåœ¨å­çº¿ç¨‹ä¸­ä½¿ç”¨Handler:123456789101112131415161718192021222324252627282930313233public class MainActivity extends AppCompatActivity &#123; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); MyThread thread = new MyThread(); thread.start(); &#125; class MyThread extends Thread &#123; @Override public void run() &#123; Looper.prepare(); @SuppressLint(&quot;HandlerLeak&quot;) Handler mHandler = new Handler()&#123; @Override public void handleMessage(Message msg) &#123; //å¤„ç†é€»è¾‘ l(Thread.currentThread().getName()); &#125; &#125;; Message message = mHandler.obtainMessage(1); mHandler.sendMessage(message); Looper.loop(); &#125; &#125; public void l(String s) &#123; Log.i(&quot;HJ&quot;, s); &#125;&#125; æ‰“å°ç»“æœå¦‚ä¸‹ï¼š12018-12-20 10:48:21.682 1808-1824/? I/HJ: Thread-2 å¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨Looper.prepare()å’ŒLooper.loop()æ–¹æ³•ï¼Œç›´æ¥è¿è¡Œï¼Œé‚£ä¹ˆä¼šæŠ›å‡ºä»¥ä¸‹å¼‚å¸¸ï¼š1234562018-12-20 11:00:49.654 2029-2045/com.zj.example.customview.funnel E/AndroidRuntime: FATAL EXCEPTION: Thread-2 Process: com.zj.example.customview.funnel, PID: 2029 java.lang.RuntimeException: Only one Looper may be created per thread at android.os.Looper.prepare(Looper.java:95) at android.os.Looper.prepare(Looper.java:90) at com.zj.example.customview.funnel.MainActivity$MyThread.run(MainActivity.java:48) è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿï¼Œä¸ºä»€ä¹ˆå­çº¿ç¨‹ä¸èƒ½ç›´æ¥åˆ›å»ºHandlerå‘¢ï¼Ÿä½¿ç”¨äº†Looper.prepare()å’ŒLooper.loop()ä¸ºä»€ä¹ˆåˆå¯ä»¥äº†å‘¢ï¼Ÿï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•åˆæ˜¯å¹²ä»€ä¹ˆç”¨çš„å‘¢ï¼Ÿè¯·çœ‹ä»¥ä¸‹æºç åˆ†æã€‚ åŸç†åˆ†æHandleræœºåˆ¶çš„æ ¸å¿ƒç±»ä¸»è¦æœ‰ä¸‰ä¸ªï¼ŒHandler ,Message,Looper,è€Œä¸Looperç›¸å…³è”çš„ç±»è¿˜æœ‰ThreadLocalå’ŒMessageQueue,ä¸‹é¢æ¥ä¸€ä¸€ä»‹ç»ä¸‹å®ƒä»¬çš„ä½œç”¨: Messageæ¶ˆæ¯çš„è½½ä½“ï¼Œå†…éƒ¨ä¸»è¦å­˜æ”¾ä¸€äº›æ¶ˆæ¯ç±»å‹ï¼Œå‚æ•°ä¸»è¦æœ‰ï¼šï¼ˆ1ï¼‰public int whatï¼šå˜é‡ï¼Œç”¨äºå®šä¹‰æ­¤Messageå±äºä½•ç§æ“ä½œï¼ˆ2ï¼‰public Object objï¼šå˜é‡ï¼Œç”¨äºå®šä¹‰æ­¤Messageä¼ é€’çš„ä¿¡æ¯æ•°æ®ï¼Œé€šè¿‡å®ƒä¼ é€’ä¿¡æ¯ï¼ˆ3ï¼‰public int arg1ï¼šå˜é‡ï¼Œä¼ é€’ä¸€äº›æ•´å‹æ•°æ®æ—¶ä½¿ç”¨ï¼ˆ4ï¼‰public int arg2ï¼šå˜é‡ï¼Œä¼ é€’ä¸€äº›æ•´å‹æ•°æ®æ—¶ä½¿ç”¨ï¼ˆ5ï¼‰public Handler getTarget()ï¼šæ™®é€šæ–¹æ³•ï¼Œå–å¾—æ“ä½œæ­¤æ¶ˆæ¯çš„Handlerå¯¹è±¡ã€‚åœ¨è¯¥ç±»çš„ä½¿ç”¨ä¸Šï¼Œå°½é‡ä½¿ç”¨obtain()æ–¹æ³•æ¥è·å–ï¼Œè€Œéæ„é€ æ–¹æ³•ï¼Œè¿™æ ·å¯ä»¥èŠ‚çœå†…å­˜ã€‚è€Œåœ¨æ•°æ®ä¼ é€’æ–¹é¢ï¼Œå¦‚æœæ˜¯intç±»å‹çš„ï¼Œå»ºè®®ä½¿ç”¨arg1å’Œarg2,å…¶æ¬¡å†è€ƒè™‘ä½¿ç”¨Bundle Looperæ¶ˆæ¯é€šé“ï¼Œæ¶ˆæ¯æœºåˆ¶çš„ä¸»è¦é€»è¾‘å®ç°ç±»ï¼Œå†…éƒ¨æœ‰ä½¿ç”¨ThreadLocalç”¨æ¥ä¿å­˜å½“å‰çº¿ç¨‹çš„Looper,ä½¿ç”¨MessageQueueç”¨æ¥ç»´æŠ¤Messageæ± ï¼Œè€Œæˆ‘ä»¬ä½¿ç”¨Looper.prepare()æ–¹æ³•å…¶å®ä¹Ÿå°±æ˜¯å°†æ­¤çº¿ç¨‹çš„Looperå¯¹è±¡åŠ å…¥åˆ°ThreadLocalä¸­å»ï¼š1234567891011public static void prepare() &#123; prepare(true);&#125;private static void prepare(boolean quitAllowed) &#123; if (sThreadLocal.get() != null) &#123; //ä¸€ä¸ªçº¿ç¨‹åªèƒ½åˆ›å»ºä¸€ä¸ªLooper throw new RuntimeException(&quot;Only one Looper may be created per thread&quot;); &#125; sThreadLocal.set(new Looper(quitAllowed));&#125; çœ‹æºç å°±çŸ¥é“ï¼Œå½“å‰çº¿ç¨‹ä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªLooperï¼Œå½“æˆ‘ä»¬å†æ¬¡åˆ›å»ºï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ‰€ä»¥ä¸Šé¢æŠ›å¼‚å¸¸çš„åŸå› å°±æ˜¯åœ¨è¿™é‡Œã€‚ è€Œæˆ‘ä»¬çš„loop()æ–¹æ³•å°±æ˜¯æ¶ˆæ¯æœºåˆ¶çš„æ ¸å¿ƒï¼ŒåŸç†æ˜¯å®ç°äº†ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œç”¨äºä»MessageQueueä¸­å–å‡ºæ¶ˆæ¯åˆ†å‘åˆ°å„ä¸ªHandlerä¸­å»ï¼Œä»¥ä¸‹æ˜¯ç²¾ç®€æºç ï¼š1234567891011121314151617181920212223242526272829303132333435public static void loop() &#123; //ä»ThreadLocalä¸­å–å‡ºLooper final Looper me = myLooper(); if (me == null) &#123; throw new RuntimeException(&quot;No Looper; Looper.prepare() wasn&apos;t called on this thread.&quot;); &#125; //ä»Looperä¸­è·å–åˆ°MessageQueue final MessageQueue queue = me.mQueue; ........ //åˆ›å»ºå¾ªç¯ for (;;) &#123; //ä»MessageQueueä¸­ä¸€ä¸ªä¸€ä¸ªçš„å–å‡ºMessage Message msg = queue.next(); // might block if (msg == null) &#123; //æ²¡æ¶ˆæ¯å–äº†å°±é€€å‡º return; &#125; ........... final long start = (slowDispatchThresholdMs == 0) ? 0 : SystemClock.uptimeMillis(); final long end; try &#123; //dispatchMessageæ–¹æ³•çš„è°ƒç”¨åœ¨è¿™ msg.target.dispatchMessage(msg); end = (slowDispatchThresholdMs == 0) ? 0 : SystemClock.uptimeMillis(); &#125; finally &#123; if (traceTag != 0) &#123; Trace.traceEnd(traceTag); &#125; &#125; ......... //å›æ”¶æ¶ˆæ¯ï¼ŒåŒæ—¶å°†Messageç½®ä¸ºç©ºæ¶ˆæ¯å¯¹è±¡ï¼Œå­˜å‚¨åœ¨æ¶ˆæ¯æ± ä¸­ï¼Œç”¨äºobtain()æ–¹æ³•å†æ¬¡è·å– msg.recycleUnchecked(); &#125; &#125; ç»¼åˆè¦ç‚¹å°±æ˜¯ä½¿ç”¨loop()æ¥å¼€å¯æ¶ˆæ¯åˆ†å‘ï¼Œå¹¶ä¸”ä½¿ç”¨prepareæ¥åˆ›å»ºLooperã€‚å¹¶ä¸”ä¸€ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸€ä¸ªLooperã€‚ å¯ä»¥çœ‹åˆ°ï¼ŒdispatchMessageå°±æ˜¯åœ¨è¿™é‡Œå›è°ƒçš„ï¼Œé‚£è¿™ä¸ªtargetæ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Œå…¶å®å°±æ˜¯æˆ‘ä»¬çš„Handlerå¯¹è±¡ã€‚é‚£è¿™ä¸ªHandlerå¯¹è±¡æ˜¯åœ¨å“ªé‡Œèµ‹å€¼çš„å‘¢ï¼Œè¯·çœ‹Handleræºç  Handleré¦–å…ˆçœ‹æˆ‘ä»¬çš„æ„é€ æ–¹æ³•æœ€ç»ˆä¼šè°ƒç”¨åˆ°è¿™é‡Œï¼š12345678910111213141516171819public Handler(Callback callback, boolean async) &#123; if (FIND_POTENTIAL_LEAKS) &#123; final Class&lt;? extends Handler&gt; klass = getClass(); if ((klass.isAnonymousClass() || klass.isMemberClass() || klass.isLocalClass()) &amp;&amp; (klass.getModifiers() &amp; Modifier.STATIC) == 0) &#123; Log.w(TAG, &quot;The following Handler class should be static or leaks might occur: &quot; + klass.getCanonicalName()); &#125; &#125; //è¿™é‡Œå°±å°†Looperåˆ›å»ºå¥½äº†ï¼Œä¸»è¦è¿™é‡Œæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­ mLooper = Looper.myLooper(); if (mLooper == null) &#123; throw new RuntimeException( &quot;Can&apos;t create handler inside thread that has not called Looper.prepare()&quot;); &#125; mQueue = mLooper.mQueue; mCallback = callback; mAsynchronous = async;&#125; è¿™é‡Œä¸»è¦èµ·åˆ°ä»ThreadLocalä¸­è·å–Looperå¯¹è±¡çš„ä½œç”¨ã€‚çœ‹Looper.myLooper()æ–¹æ³•ï¼š1234567/** * Return the Looper object associated with the current thread. Returns * null if the calling thread is not associated with a Looper. */public static @Nullable Looper myLooper() &#123; return sThreadLocal.get();&#125; éšåæˆ‘ä»¬ä¼šè°ƒç”¨sendMessage()ç±»å‹çš„æ–¹æ³•æ¥å‘é€æ¶ˆæ¯ï¼Œæœ€ç»ˆéƒ½ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼š1234567private boolean enqueueMessage(MessageQueue queue, Message msg, long uptimeMillis) &#123; msg.target = this; //è¿™é‡Œå°†Handlerèµ‹å€¼äº† if (mAsynchronous) &#123; msg.setAsynchronous(true); &#125; return queue.enqueueMessage(msg, uptimeMillis);&#125; æ³¨æ„çœ‹è¿™é‡Œmsg.target = thisï¼Œè¿™é‡Œå®ç°äº†å°†å½“å‰Handlerèµ‹å€¼åˆ°äº†Messageä¸­ã€‚éšåè°ƒç”¨äº†enqueueMessageæ–¹æ³•å°±å°†æ­¤MessageæŠ•å…¥åˆ°äº†æ¶ˆæ¯æ± MessageQueueä¸­.åˆ°è¿™é‡Œï¼Œä¸€ç³»åˆ—çš„åˆå§‹åŒ–ä¸è°ƒç”¨éƒ½å®Œæˆäº†ã€‚ æ‰€ä»¥ï¼Œç»è¿‡ä»¥ä¸Šåˆ†æï¼Œæˆ‘ä»¬ä¹‹å‰çš„é—®é¢˜å°±è¿åˆƒè€Œè§£äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªå®ä¾‹ä¸­å¹¶æ²¡æœ‰ä½¿ç”¨Looperçš„prepareå’Œloopæ–¹æ³•ï¼Œé‚£æˆ‘ä»¬çš„æ¶ˆæ¯æœºåˆ¶ä¸ºä»€ä¹ˆä¼šç”Ÿæ•ˆå‘¢ï¼Œå…¶å®åœ¨æˆ‘ä»¬çš„appåˆ›å»ºçš„æ—¶å€™ç³»ç»Ÿå·²ç»é»˜è®¤ä¸ºæˆ‘ä»¬å¼€å¯äº†ï¼Œå¹¶ä¸”æ˜¯åœ¨ä¸»ç¨‹åºçš„æœ€åè°ƒç”¨çš„ï¼Œå¹¶æ²¡æœ‰åœ¨onCreate()æ–¹æ³•ä¸­,è€Œå…¶ä»–çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œæ˜¯é€šè¿‡AMSè¿›è¡Œå›è°ƒã€‚è¿™å°±ä¿è¯äº†æˆ‘ä»¬çš„å¾ªç¯ä¸ä¼šé€ æˆä¸»çº¿ç¨‹å¡é¡¿ï¼Œå…·ä½“çš„æºç è°ƒç”¨æ˜¯åœ¨ActivityThreadç±»ä¸­çš„mainå‡½æ•°ä¸­:1234567891011121314151617181920212223242526272829303132333435363738394041public static void main(String[] args) &#123; SamplingProfilerIntegration.start(); // CloseGuard defaults to true and can be quite spammy. We // disable it here, but selectively enable it later (via // StrictMode) on debug builds, but using DropBox, not logs. CloseGuard.setEnabled(false); Environment.initForCurrentUser(); // Set the reporter for event logging in libcore EventLogger.setReporter(new EventLoggingReporter()); Security.addProvider(new AndroidKeyStoreProvider()); // Make sure TrustedCertificateStore looks in the right place for CA certificates final File configDir = Environment.getUserConfigDirectory(UserHandle.myUserId()); TrustedCertificateStore.setDefaultUserDirectory(configDir); Process.setArgV0(&quot;&lt;pre-initialized&gt;&quot;); Looper.prepareMainLooper(); // //ä¸ºå½“å‰çº¿ç¨‹ï¼ˆä¸»çº¿ç¨‹ï¼‰åˆ›å»ºä¸€ä¸ªLooperå¯¹è±¡ ActivityThread thread = new ActivityThread(); thread.attach(false); if (sMainThreadHandler == null) &#123; sMainThreadHandler = thread.getHandler(); //ä¸ºå½“å‰çº¿ç¨‹è®¾ç½®Handler &#125; AsyncTask.init(); if (false) &#123; Looper.myLooper().setMessageLogging(new LogPrinter(Log.DEBUG, &quot;ActivityThread&quot;)); &#125; Looper.loop(); // æ‰§è¡Œä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­è·å–Messageï¼Œå¹¶è°ƒç”¨Handlerè¿›è¡Œå¤„ç†çš„æ— é™å¾ªç¯ï¼›æ‰€æœ‰å’Œä¸»çº¿ç¨‹ç›¸å…³çš„æ¶ˆæ¯å¤„ç†éƒ½åœ¨è¯¥æ–¹æ³•ä¸­æ‰§è¡Œ throw new RuntimeException(&quot;Main thread loop unexpectedly exited&quot;);&#125; åˆ†æåˆ°è¿™ï¼ŒHandleræµç¨‹å…¶å®ä¹Ÿå·®ä¸å¤šäº†ï¼Œæœ€ååšä¸‹æ€»ç»“: 1.åœ¨ä¸»çº¿ç¨‹ä¸­åˆå§‹åŒ–äº†ä¸€ä¸ªHandler,æ­¤æ—¶Looper.loop()å·²ç»å¼€å¯ï¼Œé€šè¿‡Handleræ„é€ æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªåœ¨ä¸»çº¿ç¨‹ä¸­çš„Looperï¼Œå¹¶ä¿å­˜åˆ°äº†ThreadLocalä¸­ï¼Œæ­¤æ—¶ä¸»çº¿ç¨‹ä¸å…è®¸å†åˆ›å»ºç¬¬äºŒä¸ªLooper. 2.åœ¨å­çº¿ç¨‹ä¸­ä½¿ç”¨sendMessageæ–¹æ³•ï¼Œæ­¤æ—¶ä¼šè°ƒç”¨enqueueMessage()æ–¹æ³•å¹¶åˆ›å»ºä¸€ä¸ªMessage(æˆ–ä»æ± ä¸­å–å‡ºç©ºMessageå¯¹è±¡),ç„¶åæˆ‘ä»¬å°†éœ€è¦å‘é€çš„æ¶ˆæ¯ä¿å­˜åœ¨Messageä¸­ï¼Œå¹¶å°†æ­¤Handlerä¿å­˜åˆ°Messageçš„targetå¯¹è±¡ä¸­ï¼Œç„¶åå‹å…¥åˆ°MessageQueueæ¶ˆæ¯æ± ä¸­ 3.Looperä¸­ä¼šå¾ªç¯ä»MessageQueueä¸­å–å‡ºMessageå¯¹è±¡ï¼Œå¹¶å›è°ƒåˆ°targetå¯¹è±¡ä¸Šçš„Handlerçš„dispatchMessage()æ–¹æ³•ä¸­å»ï¼Œç”±äºLooper.loop()æ–¹æ³•æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨ï¼Œæ‰€ä»¥dispatchMessage()æ–¹æ³•ä¹Ÿæ˜¯è¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¸­ã€‚Looper.loop()æ–¹æ³•è¿è¡Œæ‰€åœ¨çš„çº¿ç¨‹å†³å®šdispatchMessage()æ–¹æ³•å›è°ƒçš„çº¿ç¨‹ï¼Œå¹¶ä¸”éœ€è¦ä¸Looper.prepare()æ–¹æ³•é…å¥—ä½¿ç”¨]]></content>
      <categories>
        <category>å¤šçº¿ç¨‹ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android/java å¤šçº¿ç¨‹(ä¸€)-Threadçš„ä½¿ç”¨ä»¥åŠæºç åˆ†æ]]></title>
    <url>%2FThreadsourse.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. ä¸ƒç‰›äº‘è¿‡æœŸäº†ï¼Œå›¾ç‰‡ä¹Ÿå­˜ä¸äº†äº†ï¼Œä»¥åå†³å®šåœ¨ç®€ä¹¦ä¸Šå‘å¸ƒæ–‡ç« ï¼Œæ­¤åœ°åªåšä¿å­˜è®°å½•æˆ‘çš„ç®€ä¹¦åœ°å€,æ¬¢è¿æ¥é€›é€›å“Ÿ~ çº¿ç¨‹çš„æ¦‚å¿µä»¥åŠçŠ¶æ€åœ¨å­¦ä¹ çº¿ç¨‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ™®åŠä¸€ä¸ªæ¦‚å¿µï¼Œæ¯ä¸€ä¸ªç¨‹åºè¿è¡Œéƒ½ä¼šæœ‰ä¸€ä¸ªçˆ¶è¿›ç¨‹ï¼Œæˆ‘ä»¬çš„çº¿ç¨‹å°±æ˜¯åœ¨æ­¤çˆ¶è¿›ç¨‹ä¸­è¿è¡Œï¼Œæ‹¿Androidæ¥è¯´ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¯åŠ¨ä¸€ä¸ªç¨‹åºï¼Œæ‰€æœ‰çš„ç»„ä»¶ç¨‹åºéƒ½è¿è¡Œåœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå¹¶ä¸”ä¼šåˆ›å»ºä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹åœ¨è¯¥è¿›ç¨‹ä¸­ï¼Œä¿—ç§°â€ä¸»çº¿ç¨‹â€,å½“æˆ‘ä»¬åœ¨è¯¥çº¿ç¨‹ä¸­åšäº†è€—æ—¶çš„æ“ä½œé€ æˆäº†ç¨‹åºå¡é¡¿ï¼Œæˆ‘ä»¬å°±å«â€œçº¿ç¨‹é˜»å¡â€äº†,æ­¤æ—¶å°±åº”è¯¥å¦èµ·ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œè€—æ—¶æ“ä½œã€‚ è¦äº†è§£çº¿ç¨‹ä¸­æ–¹æ³•çš„ä½¿ç”¨ï¼Œå°±å¾—å…ˆäº†è§£çº¿ç¨‹çš„è¿è¡ŒçŠ¶æ€ï¼Œçº¿ç¨‹ä»åˆ›å»ºåˆ°æ‰§è¡Œå®Œæ¯•ï¼Œä¸€å…±æœ‰6ä¸ªçŠ¶æ€ï¼š NEW(çº¿ç¨‹åˆ›å»ºæœªå¯åŠ¨) RUNNABLE(æ­£åœ¨æ‰§è¡Œä¸­çš„çº¿ç¨‹) BLOCKED(è¢«é˜»å¡å¹¶ä¸”åœ¨ç­‰å¾…ç›‘è§†å™¨é”é‡Šæ”¾) WAITING(ç­‰å¾…è¢«å”¤é†’) TIMED_WAITING(ç­‰å¾…æˆ–ç¡çœ ä¸€å®šæ—¶é—´è¢«å”¤é†’) TERMINATEDï¼ˆçº¿ç¨‹ç»ˆæ­¢ï¼Œæ¶ˆäº¡ï¼‰ è¿™äº›çŠ¶æ€å¯¹åº”Threadæºç ä¸­çš„Stateæšä¸¾ï¼Œé€šè¿‡getState()æ–¹æ³•å¯ä»¥è·å–è¯¥çº¿ç¨‹çš„è¿è¡ŒçŠ¶æ€ å…¶ä¸­BLOCKEDè¡¨ç¤ºç­‰å¾…ç›‘è§†å™¨é”çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯ç›‘è§†å™¨é”å‘¢ï¼Œç›‘è§†å™¨é”æ˜¯ä¸ºäº†è§£å†³çº¿ç¨‹ä¸å®‰å…¨è€Œè¯ç”Ÿçš„æ–¹æ³•ï¼Œå½“å¤šä¸ªè¿›ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªæ•°æ®ç»“æ„å¹¶ä¿®æ”¹æ—¶ï¼Œè¿™æ—¶æ•°æ®ç»“æ„æ˜¯ä¸ç¡®å®šçš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œçº¿ç¨‹ä¸å®‰å…¨â€,äºæ˜¯æˆ‘ä»¬ä½¿ç”¨synchronized(åŒæ­¥é”)å’Œlocké”ç­‰æœºåˆ¶æ¥è§£å†³è¿™ç§çº¿ç¨‹ä¸å®‰å…¨ï¼Œå¥—ä¸Šæ­¤é”ï¼Œå½“å‰æœ‰ä¸”åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½ä¿®æ”¹æ­¤æ•°æ®ç»“æ„ï¼Œå…¶ä»–çš„çº¿ç¨‹åˆ™éœ€è¦ç­‰å¾…ï¼Œè¿™å°±ä¿è¯äº†æ•°æ®ç»“æ„çš„ä¸€è‡´æ€§ï¼Œè€Œå…¶ä»–çº¿ç¨‹ä¼šè¿›å…¥ç­‰å¾…çš„çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„BLOCKEDçŠ¶æ€ã€‚synchronizedä½¿ç”¨ç¤ºä¾‹ï¼š 123456789class MyThread extends Thread &#123; @Override public void run() &#123; synchronized (this) &#123; //è¿™é‡Œå†™ä¿®æ”¹æ•°æ®æºçš„ä»£ç  &#125; &#125;&#125; lockä½¿ç”¨ç¤ºä¾‹ï¼š12345678910class MyThread extends Thread &#123; private final ReentrantLock lock = new ReentrantLock (); @Override public void run() &#123; lock.lock(); //è¿™é‡Œå†™ä¿®æ”¹æ•°æ®æºçš„ä»£ç  lock.unlock(); &#125;&#125; å½“ç„¶è¿™ä¸¤è€…çš„åº”ç”¨ä¸ä»…ä»…æ˜¯åœ¨çº¿ç¨‹ä¸­ï¼Œåœ¨å¿…è¦çš„æ–¹æ³•è°ƒç”¨ä¸Šä¹Ÿå¯ä½¿ç”¨ çº¿ç¨‹çš„æºç ä»¥åŠæ–¹æ³•ä½¿ç”¨Threadæºç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344public class Thread implements Runnable &#123; ........... /* Some of these are accessed directly by the VM; do not rename them. */ private volatile long nativePeer; volatile ThreadGroup group; volatile boolean daemon; volatile String name; volatile int priority; volatile long stackSize; Runnable target; private static int count = 0; private long threadInitNumber ; /** * Normal thread local values. */ ThreadLocal.Values localValues; /** * Inheritable thread local values. */ ThreadLocal.Values inheritableValues; /** Callbacks to run on interruption. */ private final List&lt;Runnable&gt; interruptActions = new ArrayList&lt;Runnable&gt;(); /** * Holds the class loader for this Thread, in case there is one. */ private ClassLoader contextClassLoader; /** * Holds the handler for uncaught exceptions in this Thread, * in case there is one. */ private UncaughtExceptionHandler uncaughtHandler; /** * Holds the default handler for uncaught exceptions, in case there is one. */ private static UncaughtExceptionHandler defaultUncaughtHandler; .....&#125; Threadå®ç°äº†Runnableæ¥å£ï¼Œå¹¶å£°æ˜äº†ä¸€äº›çº¿ç¨‹å¸¸ç”¨çš„ä¸€äº›å˜é‡: groupçº¿ç¨‹ç»„ï¼Œçº¿ç¨‹ç»„åŒ…å«å…¶ä»–çš„çº¿ç¨‹ç»„ï¼Œå½¢æˆäº†ä¸€ä¸ªæ ‘ç»“æ„ï¼Œé™¤äº†åˆå§‹çš„çº¿ç¨‹ç»„å¤–ï¼Œå…¶ä»–çš„çº¿ç¨‹ç»„éƒ½ä¼šæœ‰ä¸ªçˆ¶è¿›ç¨‹ï¼Œå…¶ä¸­çº¿ç¨‹èƒ½è®¿é—®å½“å‰çº¿ç¨‹ç»„çš„ä¿¡æ¯ï¼Œä½†ä¸èƒ½è®¿é—®çˆ¶çº¿ç¨‹ç»„çš„ä¿¡æ¯ daemonæ˜¯å¦æ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œå•¥æ˜¯å®ˆæŠ¤çº¿ç¨‹å‘¢ï¼Œå®ˆæŠ¤çº¿ç¨‹æ˜¯ä¾èµ–äºåˆ›å»ºå®ƒçš„çº¿ç¨‹çš„ä¸€ç§çº¿ç¨‹ï¼Œä¸æ™®é€šçº¿ç¨‹çš„åŒºåˆ«æ˜¯å½“åˆ›å»ºå®ƒçš„çº¿ç¨‹å…³é—­äº†é‚£å®ƒä¹Ÿä¼šå…³é—­ï¼Œè€Œæ™®é€šçº¿ç¨‹ä¸ä¼šï¼Œåƒæˆ‘ä»¬çš„åƒåœ¾æ”¶é›†å™¨çº¿ç¨‹å°±æ˜¯ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ threadInitNumber å½“å‰çº¿ç¨‹çš„æ ‡è¯†ç¬¦ï¼Œå®ƒæ˜¯æŒ‰ç…§çº¿ç¨‹çš„åˆ›å»ºé¡ºåºæ¥å åŠ çš„ name çº¿ç¨‹çš„åç§°ï¼ŒæœªæŒ‡å®šçš„è¯å°±ä»¥&quot;Thread-&quot; + threadInitNumberçš„é€»è¾‘å‘½å priorityçº¿ç¨‹ä¼˜å…ˆçº§ï¼Œæœ‰ä¸‰ä¸ªçŠ¶æ€MIN_PRIORITY,NORM_PRIORITY,MAX_PRIORITY,åˆ†åˆ«å¯¹åº”ä½ï¼Œä¸­ï¼Œé«˜ stackSize å †æ ˆå¤§å° target å½“å‰çš„ç›®æ ‡çº¿ç¨‹ contextClassLoader ç±»åŠ è½½å™¨ï¼Œç”¨äºä¿å­˜è¯¥çº¿ç¨‹çš„ä¿¡æ¯ï¼Œæ–­ç‚¹ç»­ä¼ ç­‰åŠŸèƒ½å¯ä»¥ç”¨åˆ° uncaughtHandlerçº¿ç¨‹æœªæ•è·å¼‚å¸¸è°ƒç”¨ç±»ï¼Œå¦‚æœæ²¡æœ‰å¯¹å…¶è¿›è¡Œè®¾ç½®ï¼Œå°†ä¼šé»˜è®¤ä½¿ç”¨defaultUncaughtHandleræ¥å¤„ç†å¼‚å¸¸ï¼Œç”±äºæˆ‘ä»¬çš„ä¸»çº¿ç¨‹ä¹Ÿæ˜¯ä¸€ä¸ªThread,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°UncaughtExceptionHandleræ¥å£å¹¶è°ƒç”¨Thread.setDefaultUncaughtExceptionHandlerï¼ˆï¼‰æ–¹æ³•å°†æˆ‘ä»¬è‡ªå®šä¹‰çš„å¼‚å¸¸æ•è·ç±»è®¾ç½®ç»™Thread,è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ•è·å…¨å±€çš„å¼‚å¸¸ äº†è§£äº†ä¸€äº›å¸¸ç”¨å˜é‡åï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹å…¶ä¸­çš„ä¸€äº›å¸¸ç”¨æ–¹æ³•: start()æ–¹æ³•ç”¨äºå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œåªæœ‰è°ƒç”¨æ­¤æ–¹æ³•ï¼Œç³»ç»Ÿæ‰ä¼šæ–°å¼€å¯ä¸€ä¸ªçº¿ç¨‹å¹¶åˆ†é…ç»™å…¶å¿…è¦çš„èµ„æºã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹Threadçš„æ„é€ æ–¹æ³•ï¼Œå‘ç°æœ€ç»ˆéƒ½æ˜¯è°ƒç”¨äº†initæ–¹æ³•ï¼Œé‡Œé¢ä¹Ÿåªæ˜¯å¯¹åŸºæœ¬å˜é‡è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶æ²¡æœ‰åˆ†é…åˆ°ä»»ä½•çš„èµ„æºï¼š1234567891011121314151617181920private void init(ThreadGroup g, Runnable target, String name, long stackSize) &#123; Thread parent = currentThread(); if (g == null) &#123; g = parent.getThreadGroup(); &#125; g.addUnstarted(); this.group = g; this.target = target; this.priority = parent.getPriority(); this.daemon = parent.isDaemon(); setName(name); init2(parent); /* Stash the specified stack size in case the VM cares */ this.stackSize = stackSize; tid = nextThreadID();&#125; æ‰€ä»¥ï¼Œæ–°å»ºä¸€ä¸ªçº¿ç¨‹ä¸ä¼šæ¶ˆè€—èµ„æºï¼Œåªæœ‰å½“staråæ‰ä¼šå»åˆ†é…å¿…è¦çš„èµ„æºï¼Œæ­¤æ—¶çº¿ç¨‹çŠ¶æ€ç”±NEWå˜ä¸ºäº†RUNNABLE run()æ–¹æ³•æ­¤æ–¹æ³•ç”¨äºå¤„ç†çº¿ç¨‹ä¸­æ‰§è¡Œçš„é€»è¾‘ï¼Œå¦‚æœç»§æ‰¿Threadç±»åˆ™å¿…é¡»é‡å†™è¯¥æ–¹æ³• sleep()æ–¹æ³•12sleep(long millis) //å‚æ•°ä¸ºæ¯«ç§’sleep(long millis,int nanoseconds) //ç¬¬ä¸€å‚æ•°ä¸ºæ¯«ç§’ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºçº³ç§’ è®©çº¿ç¨‹ä¼‘çœ ä¸€æ®µæ—¶é—´ï¼Œç›¸å½“äºè®©çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ã€‚æ³¨æ„å³ä½¿çº¿ç¨‹ä¼‘çœ äº†å…¶é”æœºåˆ¶ä¾æ—§ç”Ÿæ•ˆï¼Œå…¶ä»–çš„çº¿ç¨‹ä¾æ—§ä¸èƒ½è®¿é—®å…¶è¢«é”çš„æ•°æ®ç»“æ„ï¼Œç›´åˆ°å…¶é‡Šæ”¾å¯¹è±¡é”ï¼Œæ­¤æ—¶çº¿ç¨‹çŠ¶æ€ç”±RUNNABLEè¿›å…¥TIMED_WAITING yield()æ–¹æ³•è®©å½“å‰çº¿ç¨‹äº¤å‡ºç›¸åº”çš„æƒé™ï¼Œä¸ºå…¶ä»–çº¿ç¨‹è®©æ­¥ï¼Œè¿™æ˜¯é˜²æ­¢CPUè¿‡åº¦ä½¿ç”¨çš„ä¸€ç§æœ‰æ•ˆæ‰‹æ®µã€‚æ•ˆæœä¸sleepå·®ä¸å¤šï¼Œä½†ä¸èƒ½æŒ‡å®šå…·ä½“çš„æ—¶é—´ï¼Œå¹¶ä¸”å¹¶ä¸æ˜¯è®©çº¿ç¨‹è¿›å…¥åˆ°é˜»å¡çŠ¶æ€ï¼Œè€Œæ˜¯è¿›å…¥å°±ç»ªçŠ¶æ€.æ­¤æ—¶çº¿ç¨‹çŠ¶æ€ç”±RUNNABLEè¿›å…¥WAITING join()æ–¹æ³•123join()join(long millis) //å‚æ•°ä¸ºæ¯«ç§’join(long millis,int nanoseconds) //ç¬¬ä¸€å‚æ•°ä¸ºæ¯«ç§’ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºçº³ç§’ æ­¤æ–¹æ³•æ˜¯è®©çº¿ç¨‹ä¼˜å…ˆæ¥æ‰§è¡Œï¼Œå…¶ä½™çš„çº¿ç¨‹ä¼šæš‚åœï¼Œç›´åˆ°æ­¤çº¿ç¨‹æ‰§è¡Œå®Œæ¯•æ‰ä¼šç»§ç»­æ‰§è¡Œã€‚ä½ å¯ä»¥å°†çº¿ç¨‹çœ‹æˆä¸€äº›æ­£å¸¸è¡Œé©¶çš„è½¦è¾†(åœ¨çº¿ç¨‹é˜Ÿåˆ—ä¸­)ï¼Œå½“ç»™å…¶ä¸­ä¸€è¾†è½¦ä½¿ç”¨äº†join(å¼¯é“è¶…è½¦),é‚£å…¶ä½™çš„è½¦ä¼šç»™å…¶è®©è¡Œï¼ˆçº¿ç¨‹è¿›å…¥æš‚åœçŠ¶æ€ï¼‰ï¼Œä¼˜å…ˆè®©å®ƒè¡Œé©¶(joinçš„çº¿ç¨‹è¿è¡Œ)ï¼Œç›´åˆ°å®ƒåˆ°è¾¾ç»ˆç‚¹(è¿è¡Œå®Œæˆ)ï¼Œæ‰ä¼šç»§ç»­è¡Œé©¶ï¼ˆç»§ç»­æ‰§è¡Œï¼‰è€Œjoinæºç ä¸­æ˜¯è°ƒç”¨çš„wait()æ–¹æ³•ï¼Œè€Œwait()æ–¹æ³•èƒ½ä½¿çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€å¹¶é‡Šæ”¾å¯¹è±¡é”ï¼Œæ‰€ä»¥joinæ–¹æ³•ä¹Ÿæ˜¯èƒ½é‡Šæ”¾å¯¹è±¡é”çš„ interruptï¼ˆï¼‰æ–¹æ³•ä¸­æ–­çº¿ç¨‹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œçº¿ç¨‹æ‰§è¡Œå®Œrunæ–¹æ³•é‡Œçš„é€»è¾‘å°±ä¼šè¿›å…¥ç»ˆæ­¢çŠ¶æ€ã€‚è°ƒç”¨æ­¤æ–¹æ³•ä¼šä½¿ä¸€ä¸ªé˜»å¡çš„çº¿ç¨‹æŠ›å‡ºInterruptedExceptionå¼‚å¸¸ï¼Œä»è€Œç»ˆæ­¢çº¿ç¨‹ï¼Œå¯ä»¥è°ƒç”¨isInterrupted()åˆ¤æ–­æ˜¯å¦ç»ˆæ­¢äº†çº¿ç¨‹ï¼Œä½†éé˜»å¡çº¿ç¨‹å¦‚ä½•ä¸­æ–­å‘¢ï¼Œè¯·çœ‹ï¼š1234567891011121314class MyThread extends Thread&#123; private volatile boolean isStop = false; @Override public void run() &#123; int i = 0; while(!isStop)&#123; i++; &#125; &#125; public void setStop(boolean stop)&#123; this.isStop = stop; &#125; &#125; æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªå˜é‡æ¥æ§åˆ¶æ˜¯å¦æ‰§è¡Œå®Œæ¯•ï¼Œä»è€Œç»“æŸçº¿ç¨‹ï¼Œæ­¤æ—¶çº¿ç¨‹çŠ¶æ€è¿›å…¥TERMINATEDçŠ¶æ€]]></content>
      <categories>
        <category>å¤šçº¿ç¨‹ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®‰å“å°ç™½ä¹‹ndkç¼–è¯‘æ‰“åŒ…æˆsoä¾›ç¬¬ä¸‰æ–¹è°ƒç”¨]]></title>
    <url>%2Fndkbuildproject.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æœ¬æ–‡æ¥ç€ä¸Šç¯‡æ–‡ç« å†…å®¹æ¥,ä¸»è¦è®²è¿°å¦‚ä½•ç”Ÿæˆsoåº“ä»¥åŠå°†ç±»ç¼–è¯‘æˆjaråŒ…ä¾›ç¬¬ä¸‰æ–¹è°ƒç”¨å®‰å“å°ç™½ä¹‹ndkå…¥é—¨ç¯‡ é…ç½®åœ¨build.gradleä¸­1234567externalNativeBuild &#123; cmake &#123; cppFlags &quot;&quot; //åœ¨è¿™é‡ŒæŒ‡å®šéœ€è¦ç”Ÿæˆä»€ä¹ˆç±»å‹çš„so abiFilters &quot;armeabi&quot;,&quot;armeabi-v7a&quot; &#125;&#125; åœ¨CMakeListæ–‡ä»¶ä¸­å¯ä»¥æŒ‡å®šç”Ÿæˆçš„soåº“çš„åç§°12345678910111213141516add_library( # Sets the name of the library. native-lib #ä¿®æ”¹æ­¤å¤„ # Sets the library as a shared library. SHARED # Provides a relative path to your source file(s). src/main/cpp/native-lib.cpp).....target_link_libraries( # Specifies the target library. native-lib #ä¿®æ”¹æ­¤å¤„ # Links the target library to the log library # included in the NDK. $&#123;log-lib&#125;) æ³¨æ„add_libraryçš„åç§°å’Œtarget_link_librariesçš„åç§°å¿…é¡»ç›¸åŒè¿˜æœ‰å¦å¤–ä¸€ç§é…ç½®12345678defaultConfig&#123; ndk&#123; //æŒ‡å®šç”Ÿæˆçš„soåº“åç§° moduleName &quot;native&quot; //åœ¨è¿™é‡ŒæŒ‡å®šéœ€è¦ç”Ÿæˆä»€ä¹ˆç±»å‹çš„so abiFilters &quot;armeabi&quot;,&quot;armeabi-v7a&quot; &#125;&#125; å¯ä»¥ç›´æ¥åœ¨gradleä¸­éƒ½é…ç½®å¥½ï¼Œä¸éœ€è¦æ›´æ”¹CMakeList é…ç½®å¥½åï¼Œç‚¹å‡»Build-&gt;Make Projectç­‰å¾…ç¼–è¯‘å®Œæˆ,å¦‚æœä½ æ˜¯é€šè¿‡ç¬¬ä¸€ç§æ–¹æ³•é…ç½®çš„ï¼Œé‚£ä¹ˆç”Ÿæˆçš„soåº“ä½äºapp-&gt;build-&gt;intermediates-&gt;cmake-&gt;debug-&gt;objç›®å½•ä¸‹ï¼Œå¦‚æœæ˜¯ç¬¬äºŒç§æ–¹æ³•ï¼Œé‚£ä¹ˆsoåº“ä½äºapp-&gt;build-&gt;intermediates-&gt;ndk-&gt;debug-&gt;objç›®å½•ä¸‹ã€‚ ç”ŸæˆjaråŒ…çœ‹cppæ–‡ä»¶é‡Œçš„æ–¹æ³•å°±çŸ¥é“ï¼Œæ–¹æ³•å£°æ˜éƒ½æ˜¯ä¸åŒ…åç»‘å®šçš„ï¼Œé‚£æˆ‘è¦æ˜¯ç»™ç¬¬ä¸‰æ–¹appè°ƒç”¨å‘¢ï¼Œæ€»ä¸èƒ½è®©å®ƒä»¬ç”¨æˆ‘ä»¬çš„åŒ…åå§ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å°±éœ€è¦å°†æˆ‘ä»¬çš„ç±»éƒ½æ‰“æˆjaråŒ…ä¾›ç¬¬ä¸‰æ–¹é—´æ¥è°ƒç”¨ï¼Œè®©ç¬¬ä¸‰æ–¹è°ƒç”¨æˆ‘ä»¬çš„ç±»ï¼Œæˆ‘ä»¬çš„ç±»æ¥è°ƒç”¨cä»£ç ï¼Œè¿™æ ·é—®é¢˜å°±è§£å†³å•¦ã€‚ 1.è¦ç¼–è¯‘jaråŒ…ï¼Œå‰ææ¡ä»¶æ˜¯ä½ çš„è¿™ä¸ªé¡¹ç›®å¿…é¡»æ˜¯ä¸€ä¸ªç±»åº“ï¼Œä¹Ÿå°±æ˜¯library,åœ¨app gradleçš„æœ€ä¸Šé¢æŸ¥çœ‹æ˜¯å¦ä¸ºapply plugin: &#39;com.android.library&#39; 2.åœ¨build defaultConfigç›®å½•é‡ŒåŠ å…¥ä»¥ä¸‹ä»£ç :123456789101112131415task makeJar(type: Copy) &#123; //åˆ é™¤å­˜åœ¨çš„ delete &apos;build/libs/jar.jar&apos; //è®¾ç½®æ‹·è´çš„æ–‡ä»¶ from(&apos;build/intermediates/bundles/debug/&apos;) //æ‰“è¿›jaråŒ…åçš„æ–‡ä»¶ç›®å½• into(&apos;build/libs/&apos;) //å°†classes.jaræ”¾å…¥build/libs/ç›®å½•ä¸‹ //include ,excludeå‚æ•°æ¥è®¾ç½®è¿‡æ»¤ //ï¼ˆæˆ‘ä»¬åªå…³å¿ƒclasses.jarè¿™ä¸ªæ–‡ä»¶ï¼‰ include(&apos;classes.jar&apos;) //é‡å‘½å rename (&apos;classes.jar&apos;, &apos;jar.jar&apos;) &#125; makeJar.dependsOn(build) çœ‹æ³¨é‡Šï¼Œåå­—ä»»æ„å–ï¼Œç„¶åå†Terminalä¸­æ‰§è¡Œå‘½ä»¤gradlew makeJar, Terminalåœ¨AndroidStudioçš„å·¦ä¸‹è§’ã€‚æ‰§è¡Œå®Œï¼Œæç¤ºBUILD SUCCESSFULåï¼Œåœ¨ä»¥ä¸‹è·¯å¾„å¯ä»¥æ‰¾åˆ°ç”Ÿæˆçš„jaråŒ…ï¼šapp/build/intermediates/bundles/debug/ è°ƒç”¨jaråŒ…å’Œsoåº“éƒ½ç”Ÿæˆå¥½åï¼Œå°±å¯ä»¥ä½¿ç”¨äº†ï¼Œå°†jaråŒ…æ”¾å…¥app-&gt;libsç›®å½•ï¼Œå°†soåº“æ”¾å…¥app-&gt;src-&gt;main-&gt;jinLibsæ ¹æ®ä½ çš„éœ€è¦åœ¨jinLibsä¸­å»ºç«‹ä¸åŒçš„cpuæ¶æ„ç›®å½•ï¼Œä¸€èˆ¬åˆ›å»ºä¸€ä¸ªarmeabiå’Œarmeabi-v7aå°±å¯ä»¥äº†ï¼Œæ³¨æ„ä¸è¦å†™é”™ï¼ŒåŒæ—¶æ³¨æ„åœ¨gradleä¸­ç”³æ˜ä½ éœ€è¦çš„æ¶æ„ç±»å‹1234ndk&#123; //åœ¨è¿™é‡ŒæŒ‡å®šéœ€è¦ç”Ÿæˆä»€ä¹ˆç±»å‹çš„so abiFilters &quot;armeabi&quot;,&quot;armeabi-v7a&quot; &#125; éƒ½é…ç½®å¥½åï¼Œé‡æ–°Sync Projectä¸‹é¡¹ç›®ï¼Œå°±èƒ½æ„‰å¿«çš„ä½¿ç”¨äº†ã€‚ åœ¨ä½¿ç”¨ä¸­ï¼Œæœ‰åŒå­¦ç»å¸¸ä¼šé‡åˆ°soåº“æ–‡ä»¶æ‰¾ä¸åˆ°çš„é—®é¢˜ï¼Œè¿™æ—¶ä½ å°±éœ€è¦æ£€æŸ¥ä½ çš„æ¶æ„ç›®å½•ä¸‹çš„soçš„æ•°é‡æ˜¯ä¸æ˜¯ç›¸åŒçš„ï¼Œåƒä¸‡ä¸è¦å‡ºç°å•ä¸ªç›®å½•æ²¡æœ‰çš„æƒ…å†µã€‚è¿™æ˜¯å› ä¸ºsoåº“éƒ½æ˜¯å‘ä¸‹å…¼å®¹ï¼Œå‡å¦‚ä¸€å°v7æ¶æ„çš„æ‰‹æœºï¼Œä½ æŠŠä¸¤ä¸ªéœ€è¦ä½¿ç”¨çš„soåº“éƒ½æ”¾åˆ°armeabiç›®å½•ä¸­ï¼Œæ²¡é—®é¢˜ï¼Œå› ä¸ºç³»ç»Ÿåœ¨v7ä¸­æ‰¾ä¸åˆ°ä¼šå»armeabiç›®å½•æ‰¾ã€‚ä½†æ˜¯å¦‚æœä½ å°†ä¸€ä¸ªsoæ”¾åˆ°armeabiå’Œarmeabi-v7aï¼Œå¦ä¸€ä¸ªåªæ”¾äº†åˆ°äº†armeabiï¼Œå½“ä¸€ä¸ªv7æ¶æ„çš„æ‰‹æœºä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°armeabi-v7ä¸­æ²¡æœ‰æ˜¯ä¸ä¼šå»armeabiä¸­æ‰¾çš„ï¼Œå› ä¸ºå¦ä¸€ä¸ªsoä¹Ÿæ”¾åˆ°äº†armeabi-v7ç›®å½•ä¸‹ï¼Œä»£è¡¨ä½ å…¼å®¹äº†armeabi-v7çš„æƒ…å†µï¼Œæ­¤æ—¶æ˜¯ä¸ä¼šå‘ä¸‹å…¼å®¹çš„ã€‚æ‰€ä»¥ï¼Œè§£å†³æ–¹æ¡ˆå°±æ˜¯è¦ä¹ˆåˆ é™¤v7é‡Œçš„so,è¦ä¹ˆæŠŠç¼ºå°‘çš„soè¡¥é½ã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[å®‰å“å°ç™½ä¹‹ndkå…¥é—¨ç¯‡]]></title>
    <url>%2Fandroidndkstudyfirst.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æœ¬æ–‡æ˜¯æœ¬äººæ€»ç»“ndkçš„ä¸€ä¸ªå…¥é—¨ç¯‡ï¼Œå¸Œæœ›å¯¹å­¦ä¹ ndkçš„åŒå­¦æœ‰æ‰€å¸®åŠ©å“¦ 1.ç¯å¢ƒæ­å»ºå¼€å‘å·¥å…·ï¼šAndroidStudioæ‰“å¼€AndroidStudioï¼Œè¿›å…¥settings,æ‰¾åˆ°Android SDKç›®å½•ï¼Œç‚¹å‡»SDK toolsï¼Œåˆ†åˆ«æ‰¾åˆ°å¦‚å›¾ä¸‰ä¸ªé…ç½®ï¼Œå‹¾ä¸Šï¼Œä¸‹è½½ã€‚åˆ†åˆ«ä»‹ç»ä¸€ä¸‹ï¼š cmakeç±»ä¼¼äºAndroid studioä¸­çš„gradle,æ˜¯å¯¹ndkçš„ä¸€ä¸ªé…ç½®ç®¡ç† LLDBc/c++çš„ä¸€ä¸ªè°ƒè¯•å·¥å…·ï¼Œå®‰è£…åå¯ä»¥å¯¹c/c++ä»£ç è¿›è¡Œdebug NDKndkçš„å¼€å‘å·¥å…·åŒ… å®‰è£…å®Œæˆåï¼Œæ–°å»ºä¸€ä¸ªå·¥ç¨‹ï¼Œæ³¨æ„å‹¾é€‰ä¸‹æ–¹çš„include c++ support,ä¸€è·¯nextï¼Œç›´åˆ°é¡¹ç›®æ„å»ºå®Œæˆï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬çš„æ•´ä½“çš„ndké¡¹ç›®å¼€å‘ç¯å¢ƒå°±é…ç½®å¥½äº†ã€‚ 2.é…ç½®æ–‡ä»¶ä»‹ç»é¡¹ç›®æ„å»ºå®Œæ¯•åï¼Œæˆ‘ä»¬ä¼šå‘ç°å¤šäº†é…ç½®å’Œæ–‡ä»¶ï¼Œå¦‚å›¾ï¼š å…ˆä»‹ç»ä¸€ä¸‹è¿™å‡ ä¸ªå‚æ•°çš„ä½œç”¨ï¼šç‚¹å¼€CMakeLists.txtï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758# For more information about using CMake with Android Studio, read the# documentation: https://d.android.com/studio/projects/add-native-code.html# Sets the minimum version of CMake required to build the native library.cmake_minimum_required(VERSION 3.4.1)# Creates and names a library, sets it as either STATIC# or SHARED, and provides the relative paths to its source code.# You can define multiple libraries, and CMake builds them for you.# Gradle automatically packages shared libraries with your APK.# é…ç½®soåº“ä¿¡æ¯add_library( # Sets the name of the library. # ç”Ÿæˆçš„soåº“åç§°ï¼Œæ­¤å¤„ç”Ÿæˆçš„soæ–‡ä»¶åç§°æ˜¯libnative-lib.so native-lib # Sets the library as a shared library. # STATICï¼šé™æ€åº“ï¼Œæ˜¯ç›®æ ‡æ–‡ä»¶çš„å½’æ¡£æ–‡ä»¶ï¼Œåœ¨é“¾æ¥å…¶å®ƒç›®æ ‡çš„æ—¶å€™ä½¿ç”¨ # SHAREDï¼šåŠ¨æ€åº“ï¼Œä¼šè¢«åŠ¨æ€é“¾æ¥ï¼Œåœ¨è¿è¡Œæ—¶è¢«åŠ è½½ # MODULEï¼šæ¨¡å—åº“ï¼Œæ˜¯ä¸ä¼šè¢«é“¾æ¥åˆ°å…¶å®ƒç›®æ ‡ä¸­çš„æ’ä»¶ï¼Œä½†æ˜¯å¯èƒ½ä¼šåœ¨è¿è¡Œæ—¶ä½¿ç”¨dlopen-ç³»åˆ—çš„å‡½æ•°åŠ¨æ€é“¾æ¥ SHARED # Provides a relative path to your source file(s). # èµ„æºæ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªï¼Œ # èµ„æºè·¯å¾„æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œç›¸å¯¹äºæœ¬CMakeLists.txtæ‰€åœ¨ç›®å½• src/main/cpp/native-lib.cpp )# Searches for a specified prebuilt library and stores the path as a# variable. Because CMake includes system libraries in the search path by# default, you only need to specify the name of the public NDK library# you want to add. CMake verifies that the library exists before# completing its build.# ä»ç³»ç»ŸæŸ¥æ‰¾ä¾èµ–åº“find_library( # Sets the name of the path variable. # androidç³»ç»Ÿæ¯ä¸ªç±»å‹çš„åº“ä¼šå­˜æ”¾ä¸€ä¸ªç‰¹å®šçš„ä½ç½®ï¼Œè€Œlogåº“å­˜æ”¾åœ¨log-libä¸­ log-lib # Specifies the name of the NDK library that # you want CMake to locate. # androidç³»ç»Ÿåœ¨cç¯å¢ƒä¸‹æ‰“logåˆ°logcatçš„åº“ log )# Specifies libraries CMake should link to your target library. You# can link multiple libraries, such as libraries you define in this# build script, prebuilt third-party libraries, or system libraries.# é…ç½®åº“çš„é“¾æ¥ï¼ˆä¾èµ–å…³ç³»ï¼‰target_link_libraries( # Specifies the target library. # ç›®æ ‡åº“ native-lib # Links the target library to the log library # included in the NDK. # ä¾èµ–äº $&#123;log-lib&#125; ) çœ‹æ³¨é‡Šå°±èƒ½æ˜ç™½æ¯ä¸ªæ–¹æ³•å‚æ•°ä»£è¡¨ä»€ä¹ˆæ„æ€äº†ï¼Œå¦‚æœä½ è§‰å¾—é‡Œé¢æ³¨é‡Šå¤ªå¤šï¼Œçœ‹èµ·æ¥ä¸æ˜¯å¾ˆé¡ºçœ¼ï¼Œå¯ä»¥ä¸‹è½½CMake simple highligheræ’ä»¶æ¥æé«˜ä»£ç äº®åº¦å…³äºcmakeçš„é…ç½®è¿˜æœ‰è®¸å¤šï¼Œè¿™é‡Œåªæ˜¯å…ˆç®€å•ä»‹ç»ä¸€ä¸ªã€‚æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹build.gradleä¸­çš„é…ç½®æ–¹æ³•çš„ä½œç”¨,åœ¨defultConfigä¸­æœ‰ä¸ªè¿™ä¸ªå‚æ•°ï¼Œ123456externalNativeBuild &#123; cmake &#123; cppFlags &quot;&quot; abiFilters &apos;armeabi&apos;,&apos;arm64-v8a&apos;, &apos;armeabi-v7a&apos;, &apos;x86&apos;, &apos;x86_64&apos; &#125; &#125; æˆ‘ä»¬ä¸»è¦å…³æ³¨ abiFiltersï¼Œå®ƒæ˜¯ç”¨æ¥è®¾ç½®ç¼–è¯‘ç”Ÿæˆä»€ä¹ˆç±»å‹çš„soçš„ï¼Œæˆ‘ä»¬çš„cupæ¶æ„ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§: armeabi armeabi-v7a arm64-v8a x86 x86_64 mips mips_64å…¶ä¸­ï¼Œarmeabi-v7aæ˜¯ç›®å‰å¤§éƒ¨åˆ†æ‰‹æœºçš„ä¸»æµæ¶æ„ï¼Œå®ƒæ˜¯åŸºäºarmeabiçš„ä¸€ç§å‡çº§æ¶æ„ï¼Œå› æ­¤ï¼Œå®ƒä»¬æ˜¯äº’ç›¸å…¼å®¹çš„ï¼Œä½†ç›®å‰å„æ‰‹æœºå‚å•†çš„æ——èˆ°çº§ï¼Œéƒ½å·²ç»å¼€å§‹é‡‡ç”¨arm64-v8açš„cpu,ä¸è¿‡ä¸è¦æ…Œï¼Œå®ƒä¹Ÿæ˜¯å…¼å®¹armeabiçš„ï¼Œæ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬åªéœ€è¦å¼€å‘æ™®é€šåº”ç”¨çš„è¯ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨armeabiå’Œarmeabi-v7aå°±å¯ä»¥äº†ï¼Œè€Œåƒx86ç­‰è¿™ç§ç±»å‹çš„æ¶æ„å¤šç”¨äºå¹³æ¿ç­‰è®¾å¤‡ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦äº†è§£å³å¯ã€‚ä¸æ­¤ç›¸åŒçš„è¿˜æœ‰ä¸€ä¸ªé…ç½®ï¼š123ndk&#123; abiFilters &quot;armeabi&quot;,&quot;armeabi-v7a&quot; &#125; å®ƒä¹Ÿæ˜¯ç”¨æ¥é…ç½®éœ€è¦ä»€ä¹ˆç±»å‹çš„soçš„ï¼Œä½†å®ƒæ˜¯è´Ÿè´£æ‰“åŒ…åˆ°apké‡Œæœ‰ä»€ä¹ˆç±»å‹çš„so,è€Œä¸æ˜¯ç¼–è¯‘å‡ºä»€ä¹ˆso,ä¸¤è€…è¿˜æ˜¯æœ‰åŒºåˆ«çš„ã€‚ä¾‹å¦‚æˆ‘åœ¨cmakeé‡Œè®¾ç½®ä¸€ä¸ª â€œarmeabiâ€,â€armeabi-v7aâ€ï¼Œåœ¨ndké‡Œè®¾ç½®ä¸€ä¸ªarmeabiï¼Œæˆ‘make projectä¸€ä¸‹ï¼Œå®ƒä¼šç”Ÿæˆä¸¤ä¸ªcpuç±»å‹çš„so,ä½†æ˜¯æˆ‘è¿è¡Œæ‰“åŒ…apkï¼Œåœ¨apkçš„libç›®å½•é‡Œå°±åªæœ‰ä¸€ä¸ªarmeabiçš„soäº†ï¼Œæ‰€ä»¥ï¼šå½“æˆ‘ä»¬ä¸éœ€è¦ç¼–è¯‘soåº“æ—¶ï¼Œä¾‹å¦‚å¼•ç”¨çš„ç¬¬ä¸‰æ–¹åº“ï¼Œå¯ä»¥ä½¿ç”¨ndkæ¥è¿‡æ»¤ï¼Œå®Œå…¨ä¸éœ€è¦cmakeæ¥ä¸‹æ¥è¯´ä¸€ä¸‹androidä¸‹çš„æ–¹æ³•ï¼š12345externalNativeBuild &#123; cmake &#123; path &quot;CMakeLists.txt&quot; &#125; &#125; å…¶å®å¾ˆæ˜¾ç„¶ï¼Œå®ƒå°±æ˜¯æŒ‡å®šæˆ‘ä»¬çš„CMakeListsæ–‡ä»¶è·¯å¾„çš„ï¼Œå½“ç„¶æˆ‘ä»¬çš„è¿™ä¸ªè·¯å¾„æ˜¯å¯ä»¥æ›´æ”¹çš„ã€‚è¿™é‡Œæ•™å¤§å®¶ä¸€ä¸ªå°æŠ€å·§ï¼Œåœ¨cmdä¸­æ‰§è¡Œï¼šadb shell cat /proc/cpuinfoå¯ä»¥æŸ¥çœ‹å½“å‰æ‰‹æœºçš„cpuæ¶æ„å“¦ï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼šCPU architecture: 8è¯´æ˜æˆ‘çš„æ‰‹æœºæ˜¯arm64-v8aæ¶æ„ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹cppæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯å¹²å˜›çš„å‘¢ï¼Œå®ƒæ˜¯cé‡Œ.hæ–‡ä»¶çš„å®ç°çš„æºæ–‡ä»¶ï¼Œä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸javaäº¤äº’çš„æ¡¥æ¢ï¼Œé‡Œé¢åŒ…å«äº†javaå±‚éœ€è¦è°ƒç”¨åˆ°çš„å‡½æ•°æ–¹æ³•ï¼Œç‚¹å¼€å¯ä»¥çœ‹åˆ°ä»¥ä¸‹å‡½æ•°ï¼š12345678910#include &lt;jni.h&gt;#include &lt;string&gt;extern &quot;C&quot; JNIEXPORT jstring JNICALLJava_com_jie_ndkdemo_MainActivity_stringFromJNI( JNIEnv *env, jobject /* this */) &#123; std::string hello = &quot;Hello from C++&quot;; return env-&gt;NewStringUTF(hello.c_str());&#125; ä¸»è¦æ˜¯çœ‹è¿™ä¸ªå‡½æ•°ï¼šJava_com_jie_ndkdemo_MainActivity_stringFromJNI,å®ƒæ˜¯æœ‰æ ¼å¼è¦æ±‚çš„ï¼Œç”±JavaåŒ…åç±»å_å‡½æ•°åç»„æˆï¼Œå®šä¹‰çš„æ—¶å€™ä¸€å®šè¦æŒ‰ç…§è¿™ä¸ªæ ¼å¼æ¥ï¼Œå…¶ä¸­ï¼ŒMainActivityæ˜¯æˆ‘å£°æ˜nativeæ–¹æ³•çš„ç±»çš„ç±»åã€‚]]></content>
      <categories>
        <category>ndk</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotliné«˜é˜¶å‡½æ•°ä½¿ç”¨(äºŒ)]]></title>
    <url>%2Fkotlin-%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. ä¸Šä¸€ç¯‡æ–‡ç« å¸¦å¤§å®¶è®¤è¯†åˆ°äº†ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°ï¼Œé‚£è¿™ä¸€ç« å°±å¸¦å¤§å®¶çœ‹çœ‹é«˜é˜¶å‡½æ•°çš„å®é™…ä½¿ç”¨åœºæ™¯å§ æé—®æˆ‘ä»¬æƒ³ä¸€æƒ³ï¼Œé«˜é˜¶å‡½æ•°å¸¦ç»™æˆ‘ä»¬çš„æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒå‘¢ï¼Ÿå› ä¸ºä»–å¯ä»¥è®©æˆ‘ä»¬çš„æ–¹æ³•æ›´ç®€å•é«˜æ•ˆï¼Œèƒ½å»æ‰å†—ä½™çš„æ ·æ¿ä»£ç ï¼Œè®©æˆ‘ä»¬å…³æ³¨çš„é€»è¾‘æ›´æ¸…æ™°çš„å±•ç°åœ¨æˆ‘ä»¬çš„é¢å‰ï¼Œæ‰€ä»¥é«˜é˜¶å‡½æ•°ä¸€å®šæ˜¯ç”¨åœ¨æˆ‘ä»¬çš„æ–¹æ³•å®ç°ä¸Šï¼Œè€Œå®˜æ–¹apiå…¶å®å·²ç»å°†æˆ‘ä»¬å¸¸ç”¨çš„å¿«æ·æ“ä½œç”¨é«˜é˜¶å‡½æ•°ç»™å°è£…å¥½äº†ï¼Œæ¯”å¦‚with,applyç­‰æ“ä½œç¬¦ï¼Œæ‰€ä»¥å‰©ä¸‹çš„å°±æ˜¯æ¥å£è°ƒç”¨äº†ã€‚ ä¸çŸ¥é“å¤§å®¶ç”¨Kotlinå®ç°è¿‡OnClickListeneræ¥å£æ²¡æœ‰ï¼Œæœ‰3ç§å†™æ³•ï¼š é’é“œç‰ˆ:12345view.setOnClickListener(object :View.OnClickListener&#123; override fun onClick(v: View?) &#123; //å•Šï¼æˆ‘è¢«ç‚¹å‡»äº† &#125; &#125;) é»„é‡‘ç‰ˆ12345view.setOnClickListener &#123; v -&gt; &#123; //å•Šï¼æˆ‘è¢«ç‚¹å‡»äº† &#125; &#125; é’»çŸ³ç‰ˆ123view.setOnClickListener &#123; //å•Šï¼æˆ‘è¢«ç‚¹å‡»äº† &#125; æˆ‘ä»¬ä¸€å¯¹æ¯”å‘ç°ï¼Œä»£ç æ˜¯ä¸€æ­¥ä¸€æ­¥è¢«çœç•¥çš„ï¼Œé¦–å…ˆæ˜¯çœç•¥äº†æ¥å£å£°æ˜(è½¬åŒ–ä¸ºäº†lambda)ï¼Œå…¶æ¬¡æ˜¯çœç•¥äº†lambdaçš„èŠ±æ‹¬å·(Kotlinçš„ç‰¹æ€§ï¼Œå½“å‚æ•°åªæœ‰ä¸€ä¸ªlambdaå‚æ•°çš„æ—¶å€™ï¼Œæ‹¬å·å¯ä»¥çœç•¥),æ‰€ä»¥æˆ‘ä»¬è¦å®ç°çš„æ˜¯å¦‚ä½•å°†æ¥å£å£°æ˜è½¬åŒ–ä¸ºlambda,å“ˆå“ˆï¼Œè¿™ä¸æ­£æ˜¯æˆ‘ä»¬é«˜é˜¶å‡½æ•°æ‰€æ“…é•¿çš„å— å®ç°è™½ç„¶æˆ‘ä»¬ä¸èƒ½ç›´æ¥çœ‹åˆ°kotlinå†…éƒ¨çš„é«˜é˜¶å‡½æ•°çš„å®ç°æ–¹å¼ï¼Œä½†æ˜¯æˆ‘ä»¬æŒ‰ä½ctrlé”®å°†é¼ æ ‡ç§»åˆ°æ–¹æ³•ä¸Šæ˜¯å¯ä»¥çœ‹åˆ°é«˜é˜¶å‡½æ•°çš„å£°æ˜æ–¹å¼çš„ï¼Œå¦‚ä½ æ‰€è§æ˜¯è¿™æ ·çš„ï¼š1public final fun setOnClickListener( l: ((v: View!) â†’ Unit)! ): Unit çœ‹è¿‡æˆ‘ä¸Šç¯‡æ–‡ç« çš„ä¸€çœ¼å°±èƒ½çœ‹æ˜ç™½ï¼Œè¿™æ˜¯å£°æ˜äº†ä¸€ä¸ªä»¥viewä¸ºå‚æ•°çš„æ— è¿”å›å€¼çš„é«˜é˜¶å‡½æ•°ï¼Œä½†ä»–æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Œè¯·çœ‹ä»¥ä¸‹ä»£ç ï¼š12345678public final fun setOnClickListener( l: ((v: View!) â†’ Unit)! ): Unit&#123; //å°†æ¥å£å®ç°å¹¶èµ‹å€¼ç»™å…¨å±€å˜é‡æ¥å£æ–¹ä¾¿æ¥å£æ–¹æ³•è°ƒç”¨ mOnClickListener = object :View.OnClickListener&#123; override fun onClick(v: View?) &#123; l.invoke(v) //å…³é”®æ˜¯è¿™å¥ &#125; &#125;&#125; åŸç†å°±æ˜¯å†…éƒ¨å°†æ¥å£ç»™å®ä¾‹åŒ–ï¼Œç„¶åå°†é€»è¾‘é€šè¿‡invokeæ–¹æ³•ä»£ç†å‡ºå»ï¼Œè¿™æ ·æˆ‘ä»¬ç‚¹å‡»äº‹ä»¶å†…éƒ¨å°±ä¼šèµ°invokeæ–¹æ³•å•¦ã€‚è€Œinvokeå®é™…æ˜¯ä¸€ä¸ªæ¥å£(ç¿»è¯‘æˆjavaä»£ç ä½ å°±æ˜ç™½å•¦),æ‰€ä»¥æˆ‘ä»¬åœ¨æ–¹æ³•å¤–é¢å®ç°çš„å…¶å®æ˜¯invokeçš„æ¥å£å®ç°é€»è¾‘ï¼Œæ³¨æ„ï¼Œè¿™ç§æ¥å£çš„å®ç°æ–¹å¼åªèƒ½åœ¨æ¥å£åªæœ‰ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™å“¦ï¼Œå› ä¸ºinvokeåªæœ‰ä¸€ä¸ªï¼Œå“ˆå“ˆï¼Œæ€ä¹ˆæ ·ï¼ŒsetOnClickListenerçš„å¤„ç†é€»è¾‘å°ä¼™ä¼´ä»¬æ˜ç™½äº†å—ï¼Œä¸¾ä¸€åä¸‰çš„äº‹æƒ…å°±äº¤ç»™å„ä½å‹¤å¥‹çš„å°ä¼™ä¼´äº†.]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotliné«˜é˜¶å‡½æ•°ä½¿ç”¨(ä¸€)]]></title>
    <url>%2FKotlin-Higher-order-function1.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. ç”¨è¿‡Kotlinçš„åŒå­¦éƒ½çŸ¥é“ï¼Œé‚£äº›æ‰©å±•æ–¹æ³•ç”¨èµ·æ¥ç®€ç›´ä¸è¦å¤ªçˆ½ï¼Œé‚£ä¹ˆè¿™äº›æ‰©å±•æ–¹æ³•æ˜¯æ€ä¹ˆå®šä¹‰å®ç°çš„å‘¢ï¼Œæœ¬æ–‡ä»‹ç»äº†Kotliné«˜é˜¶å‡½æ•°çš„ä½¿ç”¨,å¸¦ä½ å®ç°è‡ªå·±çš„è¶…æºœæ‰©å±•æ–¹æ³•ï¼Œå¹¶ä¸”èƒ½è®©ä½ èƒ½çœ‹æ‡‚æ‰©å±•æ–¹æ³•æºç ï¼Œé˜…è¯»æœ¬æ–‡éœ€è¦æœ‰ä¸€å®šçš„KotlinåŸºç¡€ï¼Œè¯·è°¨æ…é˜…è¯». 1.å®šä¹‰:ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°é«˜é˜¶å‡½æ•°å°±æ˜¯ä»¥å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°æˆ–è¿”å›å€¼çš„å‡½æ•°ï¼ŒKotlinå¯ä»¥ä»¥lambdaæˆ–å‚æ•°å¼•ç”¨ä½œä¸ºå‚æ•°æˆ–è¿”å›å€¼ï¼Œæ‰€ä»¥ï¼Œä»»ä½•ä»¥lambdaæˆ–å‡½æ•°å¼•ç”¨ä½œä¸ºå‚æ•°æˆ–è¿”å›å€¼çš„éƒ½æ˜¯é«˜é˜¶å‡½æ•° 2.å‡½æ•°ç±»å‹è¦ä½¿ç”¨Kotlinçš„é«˜é˜¶å‡½æ•°å°±å¿…é¡»éµå¾ªå®ƒçš„å‡½æ•°ç±»å‹å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•çš„å‡½æ•°ç±»å‹ç”³æ˜1val sum = &#123; x: Int, y: Int -&gt; x + y &#125; ä¹‹æ‰€ä»¥èƒ½è¿™ä¹ˆå†™å¾—ç›ŠäºKotlinçš„ç±»å‹æ¨å¯¼ï¼Œå®ƒçš„æ˜¾ç¤ºå†™æ³•æ˜¯è¿™æ ·çš„ï¼š1var sum:(Int,Int)-&gt; Int = &#123;x , y-&gt; x + y&#125; (Int,Int)æ˜¯å‚æ•°ç±»å‹ï¼Œ-&gt;åé¢çš„å€¼Intæ˜¯è¿”å›ç±»å‹,ç»„åˆåœ¨ä¸€èµ·å°±æ„æˆäº†ä¸€ä¸ªå‡½æ•°ç±»å‹,ä»¥ä¸Šå±äºæœ‰å‚æœ‰è¿”å›å€¼ç±»å‹ï¼Œä¸‹é¢åˆ—ä¸¾å…¶ä»–å‡ ç§ç±»å‹ 12var action:() -&gt;Unit = &#123;&#125; //æ— å‚æ— è¿”å›å€¼var a = &#123;&#125; //ç±»å‹æ¨å¯¼åçš„ç®€åŒ–å†™æ³• 1var action:(Int) -&gt;Unit = &#123;&#125; //æœ‰å‚æ— è¿”å›å€¼ 1var action:() -&gt; Int = &#123;&#125; //æ— å‚æœ‰è¿”å›å€¼ 3.ä½¿ç”¨é«˜é˜¶å‡½æ•°(å°†å‡½æ•°ç±»å‹ä½œä¸ºå‚æ•°)ç›´æ¥çœ‹ä»£ç 12345678910 fun getNumResult(result: (Int, Int) -&gt; Int): Int &#123; return result(1,2) &#125;//è°ƒç”¨var value = getNumResult&#123; a, b -&gt; a + b &#125;==&gt; value = 3var value = getNumResult&#123; a, b -&gt; a * b &#125;==&gt; value = 2 ä¾ç…§å‡½æ•°ç±»å‹æ‰€ç¤ºï¼Œaå’Œbå¯¹åº”ä¸¤ä¸ªIntç±»å‹çš„å‚æ•°ï¼Œè¿™ä¸ªåç§°å¯ä»¥ä»»æ„å®šä¹‰ï¼Œa+bä¸ºè¿”å›å€¼ï¼Œéšåreturn äº†ä¸€ä¸ªlambdaçš„è¿”å›å€¼ï¼Œçœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆå¼ºå¤§,è€Œä¸”ä¾ç…§Kotlinçš„ç‰¹æ€§ï¼Œå½“å‚æ•°åªæœ‰ä¸€ä¸ªlambdaå‚æ•°çš„æ—¶å€™ï¼Œæ‹¬å·å¯ä»¥çœç•¥ï¼Œå› æ­¤å°±å˜æˆäº†å®ä¾‹ä¸­çš„é‚£æ ·ç®€æ´çš„è°ƒç”¨ åƒKotlinä¸­çš„filterç­‰æ“ä½œç¬¦ï¼Œéƒ½æ˜¯è¿™æ ·å®šä¹‰å®ç°çš„ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥ç ”ç©¶ä¸‹ çœ‹åˆ°è¿™é‡Œï¼Œå¯èƒ½æœ‰åŒå­¦ä¼šé—®äº†ï¼ŒKotlinä¸æ˜¯å·ç§°ä¸JAVAå…¼å®¹å—ï¼Œé‚£å†Javaä¸­å¦‚ä½•è°ƒç”¨å‘¢ï¼Œè¿™å°±è¦ä»Kotlinå‡½æ•°çš„ç”ŸæˆåŸç†è¯´èµ·äº†ï¼ŒKotlinçš„è¿™äº›å‡½æ•°ç±»å‹å…¶å®ä¼šè¢«ç”³æ˜æˆæ™®é€šçš„æ¥å£ï¼Œä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°å°±ä¼šå˜æˆFunction1çš„å®ç°ï¼ŒNä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°å°±æ˜¯FunctionNï¼Œè¿™ä¸ªæ¥å£å®šä¹‰äº†ä¸€ä¸ªinvokeæ–¹æ³•ï¼Œè°ƒç”¨è¯¥æ–¹æ³•å°±ä¼šæ‰§è¡Œå‡½æ•°ï¼ŒSo,æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™: Java8: å› ä¸ºæ”¯æŒlambdaï¼Œæ‰€ä»¥ä¾æ—§å¯ä»¥è¿™æ ·å†™1int value = getNumResult(a ,b - &gt;a + b); Java8ä»¥ä¸‹ç‰ˆæœ¬1234567int value = getNumResult( new Function2&lt;Integer, Integer, Integer&gt;() &#123; @Override public Integer invoke(Integer a, Integer b) &#123; return a + b; &#125; &#125;); æ³¨æ„ï¼Œå¦‚æœå®šä¹‰çš„è¿”å›å€¼æ˜¯Unit,ä¾‹å¦‚forEaché«˜é˜¶å‡½æ•°ï¼Œåœ¨Javaä¸­å°±å¿…é¡»æ˜¾ç¤ºè¿”å›ä¸€ä¸ªUnitå¯¹è±¡,å› ä¸ºUnitæ˜¯ä¸€ä¸ªå•ä¾‹å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥è¿™æ ·å®šä¹‰è¿”å›1return Unit.INSTANCEï¼› 4.ä½¿ç”¨é«˜é˜¶å‡½æ•°(å°†å‡½æ•°ç±»å‹ä½œä¸ºè¿”å›å€¼)é¡¾åæ€ä¹‰ï¼Œç›¸ä¿¡åŒå­¦ä»¬æŠŠä½œä¸ºå‚æ•°çš„é«˜é˜¶å‡½æ•°ç†è§£é€äº†è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œç¤ºä¾‹å¦‚ä¸‹: 1234567891011121314151617181920212223242526//å®šä¹‰ä¸€ä¸ªç±»ç”¨äºè£…è½½å‚æ•°class Num(var num: Int)//æ­¤æ–¹æ³•çš„ä½œç”¨æ˜¯å¦‚æœtypeç­‰äº1ï¼Œé‚£ä¹ˆå°±ä»Numç±»ä¸­å–å‡ºnumè¿›è¡Œä¹˜æ³•æ“ä½œï¼Œå¦‚æœä¸ç­‰äºä¸€ï¼Œå°±è¿›è¡Œç›¸åŠ æ“ä½œ fun getNum(type: Int): (Num) -&gt; Int &#123; if (type == 1) &#123; //è¿™æ˜¯ä¸€ç§å†™æ³• return &#123; entity -&gt; entity.num * entity.num &#125; &#125; else &#123; //è¿™æ˜¯å¦ä¸€ç§ç®€å†™ï¼Œå¯ä»¥ç”¨itä»£æ›¿entityå‚æ•° return &#123; it.num + it.num &#125; &#125; &#125;ä½¿ç”¨:var ride = getNum(1) //ä¼ é€’ä¸€ä¸ª1è¿›å»ä»£è¡¨ä½¿ç”¨ä¹˜æ³•var result = ride(Num(3)) //å¾—åˆ°ä¸€ä¸ªä»¥Numä½œä¸ºå‚æ•°çš„é«˜é˜¶å‡½æ•°==&gt; result = 9var sum = getNum(2)var result = sum(Num(3))==&gt; result = 6]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gitlabåŠ jitpackæ­å»ºå…è´¹ç§æœ‰ä¾èµ–åº“]]></title>
    <url>%2Fgitlabab-jitpack%E7%A7%81%E6%9C%89%E4%BE%9D%E8%B5%96%E5%BA%93%E6%90%AD%E5%BB%BA.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. ä¸€ç›´æƒ³ä¸ºå…¬å¸é¡¹ç›®æ­å»ºä¸€ä¸ªä¾èµ–åº“ï¼Œå¯ä»¥ç›´æ¥åƒå¼•å…¥ç¬¬ä¸‰æ–¹å¼€æºé¡¹ç›®ä¸€æ ·å»å¼•ç”¨å®ƒï¼Œæ–¹ä¾¿é›†æˆåˆ°å…¶ä»–çš„é¡¹ç›®ä¸­å»ï¼Œè¶ç€è¿™ä¸ªå‘¨æœ«å°†å‡ å¤§ä¾èµ–åº“å¹³å°éƒ½ç ”ç©¶äº†ä¸€ç•ªï¼Œé¡ºä¾¿åšä¸€ä¸ªæ€»ç»“ é€‰æ‹©æ‰˜ç®¡å¹³å° æ­å»ºå…¬å¸ä¾èµ–åº“çš„å‰ææ˜¯é¡¹ç›®éå…¬å¼€ï¼Œå¿…é¡»èƒ½æ‰˜ç®¡ç§æœ‰é¡¹ç›®ï¼ŒåŒæ—¶éœ€è¦å…è´¹ï¼Œå¯¹æ¯”ç°åœ¨æ¯”è¾ƒç«çš„åªæœ‰ä¸¤ä¸ªï¼š gitlab GitLab æ˜¯ä¸€ä¸ªç”¨äºä»“åº“ç®¡ç†ç³»ç»Ÿçš„å¼€æºé¡¹ç›®ï¼Œä½¿ç”¨Gitä½œä¸ºä»£ç ç®¡ç†å·¥å…·ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šæ­å»ºèµ·æ¥çš„webæœåŠ¡ã€‚å®‰è£…æ–¹æ³•æ˜¯å‚è€ƒGitLabåœ¨GitHubä¸Šçš„Wikié¡µé¢ã€‚ Coding æœ‰äººè¯´Codingå°±æ˜¯ä¸­å›½çš„github,ä½†ä»æœ€è¿‘çš„äº§å“æ¼”å˜æ–¹å‘çœ‹ï¼Œcodingæ›´æƒ³åšçš„æ˜¯å›¢é˜Ÿä»£ç äº‘ç«¯æœåŠ¡ï¼Œé€šè¿‡å®ƒå¯ä»¥äº‘ç«¯ä¸€é”®éƒ¨ç½²ä»£ç  ä¸¤è€…ç›¸æ¯”è¾ƒï¼Œè™½ç„¶Codingæ˜¯å›½å†…äº§å“ï¼Œä¸Šæ‰‹ç¨‹åº¦ä¸Šå…·æœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼Œä½†æ˜¯äº§å“å¹¶æ²¡æœ‰gitlabå‘å±•çš„æˆç†Ÿï¼Œæ•…ç¬”è€…é€‰æ‹©äº†gitlabæ¥æ‰˜ç®¡ç§æœ‰é¡¹ç›® é€‰æ‹©æ„å»ºå·¥å…·ç›®å‰å·²çŸ¥æœ‰ä»¥ä¸‹å¹³å°ä¾›é€‰æ‹©ï¼š Bintrayä¼˜ç‚¹ï¼šå“åº”å¿«ï¼Œç»“æ„æ¸…æ™°ï¼Œå½“éƒ¨ç½²å‡ºé”™èƒ½è¿…é€Ÿæ‰“å°logï¼Œåˆ†æé”™è¯¯åŸå› ç¼ºç‚¹: éœ€è¦ç¿»å¢™ï¼Œé…ç½®ç¨æ˜¾å¤æ‚ é…ç½®å¯å‚è€ƒ:å‘å¸ƒ Android Library åˆ° JCenter ä»å…¥é—¨åˆ°æ”¾å¼ƒ jitpackä¼˜ç‚¹: é…ç½®ç®€å•,æ”¯æŒåº¦å¹¿æ³›ç¼ºç‚¹: ç®¡ç†å¹³å°è¾ƒç®€å• ä½¿ç”¨Nexus Repository Manager OSS 3.xæ¥æ­å»ºç§æœ‰mavenæœåŠ¡ä¼˜ç‚¹:è¾ƒä¸ºå¼€æ”¾ï¼Œå®Œå…¨æœ¬åœ°æœåŠ¡å™¨è¿è¡Œç¼ºç‚¹ï¼šéœ€è¦å¯¹gradleè¿›è¡Œå¤æ‚çš„é…ç½®,éœ€è¦æœ¬åœ°æœåŠ¡å™¨ ç»¼åˆè€ƒè™‘ï¼Œå†³å®šç”¨jitpackæ¥æ­å»º å‡†å¤‡å·¥ä½œ æ³¨å†Œä¸€ä¸ªgitlabè´¦å· æ³¨å†Œä¸€ä¸ªjitpackè´¦å· åœ¨gitlabä¸­åˆ›å»ºä¸€ä¸ªç§æœ‰é¡¹ç›®,å¹¶ç”Ÿæˆä¸€ä¸ªAccess Tokens(Setting-&gt;Access Tokens),å¦‚æœæ˜¯ç®¡ç†è€…æŠŠæƒé™å…¨éƒ¨å‹¾ä¸Šï¼ŒExpires atä¸éœ€è¦å¡«ï¼Œç‚¹å‡»ç”Ÿæˆè®°ä¸‹å¯†é’¥(æˆ‘æ¯”è¾ƒæ‡’å°±ä¸æ”¾ç¤ºä¾‹å›¾äº†) è¿›å…¥jitpackçš„è®¾ç½®ç•Œé¢ï¼ˆç‚¹å‡»ç”¨æˆ·åå¯è¿›å…¥ï¼‰,çœ‹åˆ°GitLabä¸€æ ï¼Œå°†æ­¤ä»¤ç‰Œè¾“å…¥ å›åˆ°jitpacké¦–é¡µå·¦è¾¹Repositoriesé‡Œåº”è¯¥å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å…ˆå‰åˆ›å»ºçš„ç§æœ‰é¡¹ç›®äº† ä¸Šä¼ libraryåŒ… åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæ·»åŠ ä¸€ä¸ªlibraryåŒ… åœ¨æ­¤libraryçš„gradleé‡ŒåŠ å…¥ 12apply plugin: 'com.github.dcendents.android-maven'group='com.gitlab.UserName' å…¶ä¸­UserNameæ˜¯ä½ çš„ç”¨æˆ·å 3 åœ¨æ ¹ç›®å½•çš„gradleä¸­åŠ å…¥123dependencies&#123; classpath 'com.github.dcendents:android-maven-gradle-plugin:2.0'&#125; æ³¨æ„çœ‹ä½ çš„gradleç‰ˆæœ¬ï¼Œå¦‚æœæ˜¯4.1+å°±ä½¿ç”¨2.0ï¼Œå¦‚æœæ˜¯4.4+å°±ä½¿ç”¨2.1é…ç½®å®Œæ¯•ï¼Œä½¿ç”¨gitæäº¤åˆ°gitlab,æ€ä¹ˆæäº¤ä¸éœ€è¦æˆ‘è¯´äº†å§ï¼Œå°±æ˜¯å¹³å¸¸æäº¤ä»£ç åˆ°githubä¸Šä¸€æ · 4 ç‰ˆæœ¬æ§åˆ¶ æäº¤æˆåŠŸåå¯ä»¥åœ¨gitlabä¸­ç”Ÿæˆä¸€ä¸ªtagï¼Œtagçš„åç§°å°±æ˜¯ä½ åœ¨é¡¹ç›®ä¸­å¼•ç”¨çš„åç§° 5 åˆ·æ–°jitpack, é¡¹ç›®ç»“æ„å¦‚å›¾: ç‚¹å‡»Get itå³å¯è·å–ä½ çš„é…ç½®åœ°å€äº†ï¼Œå¤åˆ¶å®ƒ é¡¹ç›®ä¸­ä½¿ç”¨ç›´æ¥åœ¨é¡¹ç›®çš„build.gradleä¸­è´´ä¸Šè¿™ä¸ªåœ°å€ï¼Œbuildâ€¦â€¦â€¦â€¦ å’¦ï¼Œæ€ä¹ˆå¤±è´¥äº†ï¼Œåˆ«æ€¥ï¼Œè¿™æ˜¯å› ä¸ºæƒé™é—®é¢˜é€ æˆçš„ã€‚ç”±äºæˆ‘ä»¬åœ¨gitlabä¸Šåˆ›å»ºçš„æ˜¯ç§æœ‰é¡¹ç›®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨é¡¹ç›®ä¸­é…ç½®ä¸€ä¸‹ä»¤ç‰Œ:æ‰“å¼€é¡¹ç›®çš„gradle.properties,åŠ ä¸ŠauthToken=ä½ çš„ä»¤ç‰Œåœ°å€,éšååœ¨é¡¹ç›®æ ¹ç›®å½•åŠ ä¸Š12345678allprojects &#123; repositories &#123; ........ maven &#123; url 'https://jitpack.io' credentials &#123; username authToken &#125; &#125; &#125;&#125; é‡æ–°rebuildä¸€ä¸‹ï¼Œç¼–è¯‘æˆåŠŸï¼Œè¯•è¯•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨libraryä¸­çš„ä»£ç ï¼Œå¤§åŠŸå‘Šæˆï¼Œæ€ä¹ˆæ ·ï¼Œé…ç½®æ˜¯ä¸æ˜¯è¶…çº§ç®€å•]]></content>
      <categories>
        <category>å®‰å“æ‚è®°</category>
      </categories>
      <tags>
        <tag>tools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinç³»åˆ—å­¦ä¹ èµ„æ–™æ•´ç†]]></title>
    <url>%2FKotlin%E7%B3%BB%E5%88%97-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æ—¶è‡³ä»Šæ—¥,Kotlinåœ¨Androidå¼€å‘ä¸­è¶Šæ¥è¶Šå—æ¬¢è¿,å®ƒçš„é«˜æ•ˆæ€§ï¼Œç®€ä»‹æ€§,ä»¥åŠæ›´é«˜çš„å®¹é”™ç‡ä¸ç¦è®©æˆ‘æ„Ÿå¹:ä¸€å…¥Kotlinæ·±ä¼¼æµ·ï¼Œä»æ­¤Javaæ˜¯è·¯äººï¼Œå…¥äº†Kotlinçš„é—¨ï¼Œä¿è¯è®©ä½ å›ä¸å»,å“ˆå“ˆå“ˆï¼Œè¿˜ç­‰ä»€ä¹ˆ,å¿«æ¥å’Œæˆ‘ä¸€èµ·å­¦ä¹ KotlinæŠŠ å‰è¨€ç½‘ä¸ŠKotlinçš„èµ„æ–™å¾ˆå¤šï¼Œæˆ‘ä¹Ÿä¸é‡å¤é€ â€˜èµ„æ–™â€™äº†ï¼Œè·Ÿç€æˆ‘çš„èµ„æ–™ç´¢å¼•æ¥ï¼Œä¸€æ­¥ä¸€æ­¥çš„å­¦ä¹ ï¼Œç›¸ä¿¡ä½ å¾ˆå¿«å°±èƒ½ç†Ÿç»ƒä½¿ç”¨äº† å®˜ç½‘æ•™ç¨‹Kotlinå¼€æºåœ°å€ Kotlinä¸­æ–‡æ–‡æ¡£æ­¤æ–‡æ¡£åº”ä»”ç»†ç†Ÿè¯»ä¸‰éï¼Œç¡®ä¿æ¯ä¸€ç« èŠ‚éƒ½æœ‰ä¸€ä¸ªå¤§æ¦‚çš„å°è±¡ï¼Œæ–¹ä¾¿ä»¥åç¿»é˜…ï¼ŒåŒæ—¶è¿™ä¹Ÿæ˜¯æœ€é‡è¦çš„èµ„æ–™,åº”ä¿å­˜åˆ°ä¹¦ç­¾.è¯»è¯­æ³•æ˜¯åº”è¯¥è”æƒ³ä¸€ä¸‹ä½¿ç”¨javaä¼šå¦‚ä½•å®ç°ï¼Œæ€è€ƒä¸€ä¸‹Kotlinçš„å¥½å¤„ï¼Œä¸‹æ¬¡é‡è§æ­¤åœºæ™¯å°±ä¼šè”æƒ³åˆ°éœ€è¦ä½¿ç”¨è¿™ä¸ªApiæ¥ç¼–å†™ä»£ç äº†. è§†é¢‘æ•™ç¨‹ ç»ƒä¹ ç†Ÿæ‚‰äº†æ–‡æ¡£åå°±å¯ä»¥å»Kotlinå®˜ç½‘å»åœ¨çº¿ç»ƒä¹ ä¸€ä¸‹è¯­æ³•å•¦ï¼Œç”¨æ¥å·©å›ºä½ çš„çŸ¥è¯†ç‚¹ã€‚åœ°å€:Hello,Kotlinå¯ä»¥ç‚¹å‡»Kotlin Koansæ¥åšä¸Šé¢çš„ç»ƒä¹ é¢˜ï¼Œè®©ä½ å®è·µå„ç§Apiçš„ä½¿ç”¨ å‚è€ƒä»£ç å½“ä½ ä½¿ç”¨Kotlinå¾—å¿ƒåº”æ‰‹ä¹‹å,å°±å¯ä»¥å‚è€ƒä¸€ä¸‹åˆ«äººæ˜¯æ€ä¹ˆä½¿ç”¨Kotlinæ¥ç¼–å†™ä»£ç çš„ï¼Œè¿™é‡Œåˆ—ä¸¾å‡ ä¸ªå¯å‚è€ƒçš„å¼€æºé¡¹ç›® åŸºäºKotlin+MVP+Retrofit+RxJava+Glide ç­‰æ¶æ„å®ç°çš„çŸ­è§†é¢‘ç±»çš„APPç»ƒæ‰‹é¡¹ç›®ï¼ŒUI ç®€çº¦é£æ ¼ï¼Œä»£ç è¯¦ç»†æ³¨é‡Š Kotlin for Android Developers (the book)å›½å¤–æŸKotlinä¹¦ç±ä¸­çš„ç¤ºä¾‹ä»£ç .. ä»¿å¼€çœ¼è§†é¢‘ ä½¿ç”¨å¹²è´§é›†ä¸­è¥Apiå®ç°çš„App Kotlinçš„MVPç¤ºä¾‹ ç»“æŸæœ€åè¯´ä¸‹é€šè¿‡ä¹¦ç±çš„é˜…è¯»å¯ä»¥è®©ä½ çš„çŸ¥è¯†ç‚¹æ›´æˆä½“ç³»,æ¨èKotlinå®æˆ˜è¿™æœ¬ä¹¦ï¼Œå†…å®¹ä¸é”™,æ¨è]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®‰å“é«˜çº§å¸ƒå±€-flexboxLayoutï¼šæœ€èªæ˜çš„å¸ƒå±€]]></title>
    <url>%2F%E5%AE%89%E5%8D%93%E9%AB%98%E7%BA%A7%E5%B8%83%E5%B1%80-flexboxLayout-%E6%9C%80%E8%81%AA%E6%98%8E%E7%9A%84%E5%B8%83%E5%B1%80.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. ps:æœ€è¿‘ç”±äºè¿æ¥å¤–æ¥ç¡¬ç›˜çš„æ•°æ®çº¿è½æœ‹å‹å®¶äº†ï¼Œè€Œæˆ‘hexoæ–‡æ¡£éƒ½å­˜åœ¨å¤–æ¥ç¡¬ç›˜ä¸Šäº†ï¼Œå¯¼è‡´è®¸ä¹…éƒ½æ²¡å†™æ–‡ç« å•¦ï¼Œè¿˜åˆ«è¯´ï¼Œæ‰‹è¿˜æœ‰ç‚¹ç—’ï¼Œä»¥åè¿˜æ˜¯å°½é‡ä¿æŒæ¯å‘¨ä¸€æ›´ å‰è¨€ä»Šå¤©ç»™å¤§å®¶ä»‹ç»çš„æ˜¯è°·æ­Œå¼€æºçš„æ–°çš„ä¸€ç§å¸ƒå±€ï¼Œå¦‚æœç”¨csså†™è¿‡flexboxå¸ƒå±€çš„æœ‹å‹ä¸€å®šä¸ä¼šé™Œç”Ÿ,æ²¡é”™ï¼ŒFlexboxLayoutå¯ä»¥è¯´æ˜¯Androidç‰ˆçš„flexboxå¸ƒå±€ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¯ä»¥è®©å­å¸ƒå±€è½»æ¾å¡«å……çˆ¶å¸ƒå±€ï¼Œå¹¶ä¸”å¯ä»¥å¯¹å­å¸ƒå±€è¿›è¡Œæ’åºï¼Œè®¾ç½®å¯ä»¥è®©å­å¸ƒå±€è‡ªåŠ¨â€˜æ¢è¡Œâ€™,å®ƒè¿˜èƒ½å¤ŸæŒ‡å®šå­å¸ƒå±€çš„æ’åˆ—æ–¹å‘,ç›¸å½“äºä¸€ä¸ªåŠ å¼ºç‰ˆçš„LinearLayoutï¼Œæ€ä¹ˆæ ·ï¼Œä½ æ˜¯ä¸æ˜¯è¿«ä¸åŠå¾…æƒ³è¯•è¯•äº†ï¼Ÿ ä½¿ç”¨FlexboxLayoutå¼€æºåœ°å€ï¼šhttps://github.com/google/flexbox-layout åœ¨build.gradleä¸­æ·»åŠ ï¼š123dependencies &#123; implementation 'com.google.android:flexbox:0.3.2'&#125; åœ¨xmlä¸­ä½¿ç”¨ï¼š12345678910111213141516171819202122232425262728293031323334&lt;com.google.android.flexbox.FlexboxLayout xmlns:android="http://schemas.android.com/apk/res/android" android:layout_width="match_parent" android:layout_height="match_parent" &gt; &lt;TextView android:layout_width="100dp" android:layout_height="20dp" android:background="#43eeff" android:gravity="center" android:text="1" /&gt; &lt;TextView android:layout_width="100dp" android:layout_height="20dp" android:background="#ef3344" android:gravity="center" android:text="2" /&gt; &lt;TextView android:layout_width="100dp" android:layout_height="20dp" android:background="#ee998f" android:gravity="center" android:text="3" /&gt; &lt;TextView android:layout_width="100dp" android:layout_height="50dp" android:background="#eeff22" android:gravity="center" android:text="4" /&gt;&lt;/com.google.android.flexbox.FlexboxLayout&gt; æˆ‘ä»¬ä»€ä¹ˆå±æ€§éƒ½ä¸åŠ ,å¯ä»¥çœ‹åˆ°æ•ˆæœæ˜¯è¿™æ ·çš„ï¼š å’¦ï¼Œå¥½åƒå¹¶æ²¡æœ‰æ¢è¡Œï¼Œåˆ«æ€¥ï¼Œè¿™å…¶å®æ˜¯flexboxLayouté»˜è®¤å±æ€§çš„ä¸€ä¸ªæ•ˆæœï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥å­¦ä¹ å®ƒçš„ä¸€äº›å¸¸ç”¨å±æ€§å§ï¼š flexDirectionflexDirectionå±æ€§å†³å®šå­å¸ƒå±€çš„æ’åˆ—æ–¹å‘ã€‚ç±»ä¼¼LinearLayout çš„ orientationå±æ€§ï¼Œä¸è¿‡,flexboxLayoutçš„å±æ€§æ›´åŠ å¼ºå¤§,å®ƒé™¤äº†å†³å®šå­å¸ƒå±€çš„æ’åˆ—æ–¹å‘,è¿˜å¯ä»¥å†³å®šå­å¸ƒå±€çš„èµ·ç‚¹ä½ç½®ï¼š rowï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå­å¸ƒå±€ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯ row_reverseï¼šå­å¸ƒå±€ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å³ç«¯ã€‚ columnï¼šå­å¸ƒå±€ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿ column_reverseï¼šå­å¸ƒå±€ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿ ä½¿ç”¨column_reverseæ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š flexWrapflexWrapæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å±æ€§ï¼Œå®ƒå¯ä»¥è®©æ§ä»¶è‡ªåŠ¨æ¢è¡Œ, nowrap ï¼ˆé»˜è®¤ï¼‰ï¼šä¸æ¢è¡Œ wrapï¼šæŒ‰æ­£æ–¹å‘æ¢è¡Œ wrap_reverseï¼šæŒ‰åæ–¹å‘æ¢è¡Œ ä½¿ç”¨wrapå±æ€§æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š justifyContentjustifyContentå®šä¹‰äº†å­æ§ä»¶çš„å¯¹é½æ–¹å¼ï¼ŒæŠŠå®ƒçœ‹æˆgravityå±æ€§ï¼Œå­æ§ä»¶ä¸ºä¸€ä¸ªæ•´ä½“å°±å¥½ç†è§£äº†ï¼Œå±æ€§å¦‚ä¸‹ï¼š flex_start(é»˜è®¤):å·¦å¯¹é½ flex_endï¼šå³å¯¹é½ centerï¼šå±…ä¸­ space_betweenï¼šä¸¤ç«¯å¯¹é½ï¼Œæ¯ä¸ªå­æ§ä»¶ä¹‹é—´çš„è·ç¦»ç›¸ç­‰ space_aroundï¼šæ¯ä¸ªå­æ§ä»¶çš„ä¸¤ä¾§ç›¸ç­‰,é¡¹ç›®ä¹‹é—´çš„é—´éš”æ¯”é¡¹ç›®ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚ å¦‚ä¸‹æ˜¯è®¾ç½®äº†space_aroundçš„æ•ˆæœï¼š alignItemsalignltemsç”¨äºè®¾ç½®å­å¸ƒå±€çš„å¯¹é½æ–¹å¼,å±æ€§å¦‚ä¸‹ï¼š flex-startï¼šé¡¶ç«¯å¯¹é½ã€‚ï¼šç¬¬ä¸€è¡Œå†…å®¹çš„çš„åŸºçº¿å¯¹é½ã€‚ flex_endï¼šåº•éƒ¨å¯¹é½ã€‚ stretch ï¼ˆé»˜è®¤ï¼‰ï¼šå¦‚æœitemæ²¡æœ‰è®¾ç½®é«˜åº¦ï¼Œåˆ™å……æ»¡å®¹å™¨é«˜åº¦ã€‚ centerï¼šå±…ä¸­å¯¹é½ baselineï¼šç¬¬ä¸€è¡Œå†…å®¹çš„åŸºçº¿å¯¹é½ã€‚ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸€å¼€å§‹ä»€ä¹ˆä¹Ÿä¸è®¾ç½®å­å¸ƒå±€ä¼šå¡«å……çˆ¶å¸ƒå±€çš„åŸå› ã€‚è¿™é‡Œè¿˜è¯´ä¸‹baselineå±æ€§ï¼Œç”¨è¿‡TextViewä¸€å®šå¯¹åŸºçº¿ä¸ä¼šé™Œç”Ÿ,å¦‚æœå­æ§ä»¶æœ‰æ–‡å­—ï¼ŒåŸºçº¿å¯¹é½å¯ä»¥ä¿è¯æ–‡å­—å¯¹é½è€Œä¸å¿…ç†ä¼šåŒ…è£¹å®ƒçš„æ§ä»¶æ˜¯æ€æ ·çš„ã€‚è§‚çœ‹ä¸‹å›¾å¯ä»¥æœ‰åŠ©äºç†è§£ï¼š alignContentalignContentå¯ä»¥æ§åˆ¶å¤šè¡Œçš„å¯¹é½æ–¹å¼ï¼Œå¦‚æœå­å¸ƒå±€åªæœ‰ä¸€è¡Œåˆ™ä¸èµ·ä½œç”¨ï¼Œå±æ€§å¦‚ä¸‹ï¼š stretch ï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå……æ»¡äº¤å‰è½´çš„é«˜åº¦ï¼ˆæµ‹è¯•å‘ç°ï¼Œéœ€è¦alignItems çš„å€¼ä¹Ÿä¸ºstretch æ‰æœ‰æ•ˆï¼‰ã€‚ flex_startï¼šä¸äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚ flex_endï¼šä¸äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚ centerï¼šä¸äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚ space_betweenï¼šä¸äº¤å‰è½´ä¸¤ç«¯å¯¹é½ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”å¹³å‡åˆ†å¸ƒã€‚ space_aroundï¼šæ¯æ ¹è½´çº¿ä¸¤ä¾§çš„é—´éš”éƒ½ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”æ¯”è½´çº¿ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚ å­å¸ƒå±€å±æ€§å­å¸ƒå±€ä¹Ÿæœ‰éå¸¸ç»™åŠ›çš„å±æ€§,çˆ¶ä¸å­å¸ƒå±€çš„ç»“åˆä½¿å¾—æ’ç‰ˆéå¸¸çµæ´» layout_flexBasisPercentayout_flexBasisPercentçš„å€¼ä¸ºä¸€ä¸ªç™¾åˆ†æ¯”ï¼Œè¡¨ç¤ºè®¾ç½®å­å…ƒç´ çš„é•¿åº¦ä¸ºå®ƒçˆ¶å®¹å™¨é•¿åº¦çš„ç™¾åˆ†æ¯”,é»˜è®¤å€¼æ˜¯auto,å³å…ƒç´ æœ¬æ¥çš„å¤§å°ã€‚å¦‚å›¾ï¼Œæˆ‘è®¾ç½®æ¯ä¸ªå­å¸ƒå±€çš„å®½åº¦ä¸€æ ·ï¼Œç¬¬ä¸€ä¸ªå­å¸ƒå±€æˆ‘è®¾ç½®50%çš„ç™¾åˆ†æ¯”ï¼Œæ•ˆæœå¦‚å›¾ï¼š layout_orderlayout_orderå±æ€§ç”¨äºç»™å­å¸ƒå±€æ’åºï¼Œé»˜è®¤æ˜¯æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡æ’åˆ—çš„ï¼Œå¦‚æœåŠ å…¥è¯¥å€¼ï¼Œå€¼è¶Šå°ä½ç½®å°±ä¼šè¶Šé å‰ layout_flexGrowlayout_flexGrowç”¨äºå®šä¹‰å­å¸ƒå±€çš„æ”¾å¤§æ¯”ä¾‹ï¼Œå…¶å®å°±æ˜¯LinearLayoutçš„weightå±æ€§ï¼Œç›¸ä¿¡è¿™ä¸ªä¸ç”¨è¿‡å¤šä»‹ç»å§ layout_flexShrinklayout_flexShrinkå®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º1ï¼Œå³å¦‚æœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°ã€‚å¦‚æœæ‰€æœ‰é¡¹ç›®çš„ layout_flexShrink å±æ€§éƒ½ä¸º1ï¼Œå½“ç©ºé—´ä¸è¶³æ—¶ï¼Œéƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„flex-shrinkå±æ€§ä¸º0ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™ç©ºé—´ä¸è¶³æ—¶ï¼Œå‰è€…ä¸ç¼©å°ã€‚è´Ÿå€¼å¯¹è¯¥å±æ€§æ— æ•ˆã€‚ layout_alignSelflayout_alignSelfå±æ€§å…è®¸å•ä¸ªå­å…ƒç´ æœ‰ä¸å…¶ä»–å­å…ƒç´ ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œå¯è¦†ç›– alignItems å±æ€§ã€‚é»˜è®¤å€¼ä¸ºautoï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„alignItems å±æ€§ï¼Œå¦‚æœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäºstretchã€‚å±æ€§ä½œç”¨åŒalignItemsä¸€æ ·ã€‚ flexboxLayoutå¤§éƒ¨åˆ†å¸¸ç”¨çš„å±æ€§å°±ä»‹ç»åˆ°è¿™é‡Œï¼Œæ­¤å¸ƒå±€å¯ä»¥è½»æ¾å®Œæˆç±»ä¼¼æ·»åŠ tagä¾¿ç­¾çš„å¸ƒå±€æ ·å¼ï¼Œä¹Ÿå¯ä»¥æŠŠå®ƒå½“æˆç™¾åˆ†æ¯”å¸ƒå±€æ¥ç”¨ï¼Œç”šè‡³å¯ä»¥ä¸RecyclerViewæ­é…å®Œæˆå›¾ç‰‡æµæ•ˆæœï¼Œå› æ­¤ç†Ÿç»ƒæŒæ¡è¿™ä¸ªå¸ƒå±€è¿˜æ˜¯æœ‰å¿…è¦çš„ï¼Œè·Ÿç€æ–‡ç« çš„è®²è§£å¤šæ•²æ•²ä»£ç ï¼Œç›¸ä¿¡ä½ å¾ˆå¿«å°±ä¼šä¸Šæ‰‹çš„ã€‚]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
        <category>å®‰å“æ§ä»¶</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[è®°ä¸€æ¬¡é‡æ„é¡¹ç›®å¿ƒå¾—]]></title>
    <url>%2Frefactoring-project-learned.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. è¿™æ¬¡èŠ±æ—¶é—´é‡æ„äº†ä¸‹ä¸€å¹´å‰çš„è‡ªå®šä¹‰é”®ç›˜é¡¹ç›®,æ”¶è·äº†è®¸å¤šï¼Œå¿ä¸ä½æƒ³å†™å‡ºæ¥åˆ†äº«ä¸€ä¸‹,é¡¹ç›®åœ°å€EasyKeyBoardView,è¯¥åº“æ—¨åœ¨å¸®åŠ©å¼€å‘è€…æ›´å¿«çš„å®ç°è‡ªå®šä¹‰é”®ç›˜ï¼Œæ— éœ€å…³æ³¨é”®ç›˜è‡ªèº«çš„å®ç°é€»è¾‘ï¼Œè¯¦ç»†ç”¨æ³•è§README.md å¦‚ä½•é‡æ„é¡¹ç›®å¯¹äºä¸€ä¸ªå¼€æºé¡¹ç›®æ¥è¯´ï¼Œé¦–å…ˆè¦å¼„æ¸…æ¥šå®ƒçš„æ„ä¹‰åœ¨å“ªé‡Œï¼Œå®ƒçš„ç›®çš„åœ¨å“ªé‡Œï¼Œä¿—è¯è¯´ï¼Œç¨‹åºå‘˜éƒ½æ˜¯æ‡’æƒ°çš„ï¼Œä¸ºäº†å·æ‡’ï¼Œç¨‹åºå‘˜åˆ›é€ äº†è¶Šæ¥è¶Šæ–¹ä¾¿çš„å·¥å…·æ¥å¸®è‡ªå·±å·æ‡’ï¼Œè¿™å°±æ˜¯ä¸€ç§è¿›æ­¥ã€‚ åŸºäºæ­¤ï¼Œæˆ‘åˆ†æäº†ä¸‹è‡ªå®šä¹‰é”®ç›˜çš„ä½¿ç”¨åœºæ™¯ï¼Œå‘ç°é”®ç›˜çš„ä½¿ç”¨é€»è¾‘æ˜¯å·®ä¸å¤šçš„ï¼Œæ— éæ˜¯UIåŠä¸€äº›åŠŸèƒ½ç‚¹ä¸Šçš„ä¸åŒï¼Œä½†ç»ˆç©¶æ˜¯ä¸€ä¸ªé”®ç›˜ï¼Œè¾“å…¥åŠŸèƒ½æ˜¯åˆšéœ€ï¼Œæ‰€ä»¥ç®€åŒ–è¾“å…¥åŠŸèƒ½å°±æ˜¯è¿™ä¸ªåº“çš„æ„ä¹‰æ‰€åœ¨äº†ã€‚ è€Œè¿™æ¬¡æˆ‘å‘ç°ï¼Œä¸€æ¬¾ä¼˜è´¨çš„å¼€æºé¡¹ç›®å¿…é¡»è¦æœ‰é«˜åº¦çš„æ‰©å±•æ€§ï¼Œåº”æ­¤å°†åŠŸèƒ½æ¨¡å—åŒ–æ˜¯æˆ‘æ­¤æ¬¡å­¦ä¹ åˆ°çš„é‡è¦æŠ€èƒ½ï¼Œæ¯ä¸€ä¸ªç±»éƒ½æœ‰ç€å®ƒè‡ªå·±çš„åŠŸèƒ½ï¼Œç„¶åå†å°†è¿™äº›ç±»ç»„è£…èµ·æ¥å°±å˜æˆäº†ä¸€å°çµæ´»è¿ä½œçš„æœºå™¨ã€‚è€Œå…¶ä¸­é‚£äº›ç‚¹å¯å¯¹å¤–ä¿®æ”¹ï¼Œé‚£äº›ä¸èƒ½ï¼Œè¿™éƒ½éœ€è¦è‡ªå·±åˆ¤æ–­çš„ã€‚ å­¦ä¹ åˆ°çš„æŠ€èƒ½æ›´å¿«çš„é…ç½®ï¼šä¸Šä¼ é¡¹ç›®åˆ°JitPackç›¸æ¯”äºjcenter,æˆ‘å‘ç°JitPackå¯è°“æ˜¯ç¥å™¨ï¼Œ1åˆ†é’Ÿå°±å¯å®ç°ä»£ç ä¸Šä¼ ï¼Œå¼ºçƒˆæ¨èï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼šé¦–å…ˆè¿›å…¥å®ƒçš„githubåœ°å€:jitpack.io,æ‰¾åˆ°å®ƒçš„æœ€æ–°ç‰ˆæ’ä»¶ç‰ˆæœ¬ï¼Œåœ¨è¦ä¸Šä¼ çš„é¡¹ç›®çš„root build.gradleä¸­æ·»åŠ æ’ä»¶ï¼Œå¤§æ¦‚é•¿è¿™æ ·ï¼š123456dependencies &#123; classpath 'com.android.tools.build:gradle:3.0.0' classpath 'com.github.dcendents:android-maven-gradle-plugin:2.0' // è¿™æ˜¯æˆªè‡³ç›®å‰æœ€æ–°ç‰ˆçš„æ’ä»¶ // NOTE: Do not place your application dependencies here; they belong // in the individual module build.gradle files &#125; ç„¶ååœ¨ä½ è¦ä¸Šä¼ çš„libraryåŒ…ä¸­çš„build.gradleæ–‡ä»¶ä¸­æ·»åŠ ï¼š12apply plugin: 'com.github.dcendents.android-maven'group='com.github.Jay-huangjie' //è¿™é‡Œå†™ä½ è‡ªå·±çš„githubåå­—ï¼Œåˆ«å†™æˆ‘çš„å•Š é‡æ–°ç¼–è¯‘ä¸€ä¸‹ï¼Œç„¶åå°†ä»£ç ä¸Šä¼ åˆ°github,ä¸Šä¼ æˆåŠŸåè¿›å…¥é¡¹ç›®ä¸»é¡µï¼Œç‚¹å‡»releasesåˆ›å»ºä¸€ä¸ªç‰ˆæœ¬ï¼Œreleasesæˆ–tagéƒ½è¡Œï¼Œå¦‚å›¾ï¼š åˆ›å»ºå¥½åè¿›å…¥jitPackå®˜ç½‘ï¼šhttps://jitpack.io/;åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ä½ çš„é¡¹ç›®åœ°å€ï¼Œä¾‹å¦‚æˆ‘çš„é¡¹ç›®åœ°å€å°±æ˜¯https://github.com/Jay-huangjie/EasyKeyBoardView,å¾—åˆ°å¦‚å›¾æ‰€ç¤ºçš„ä¿¡æ¯ï¼šç‚¹å‡»Get itæŒ‰é’®å³å¯è·å–ä½ çš„åœ°å€å•¦ï¼Œå¹¶ä¸”ï¼Œé€šè¿‡æ­¤åœ°å€ä¸‹è½½çš„æ˜¯ä½ çš„libraryåŒ…è€Œä¸æ˜¯æ•´ä¸ªé¡¹ç›®ï¼Œæ‰€ä»¥ä½ å¯ä»¥å°†åº“çš„demoä¹Ÿä¸€èµ·ä¸Šä¼ åˆ°githubä¸Šï¼Œæ˜¯ä¸æ˜¯éå¸¸çš„æ–¹ä¾¿ç®€å•å‘¢]]></content>
      <categories>
        <category>å®‰å“æ‚è®°</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[okhttp3Wikiæ–‡æ¡£è¯‘æ–‡]]></title>
    <url>%2Fokhttp3-wiki-chinese.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æœ¬æ–‡æä¾›ä¸€äº›okhttp3çš„æ–‡æ¡£ç¿»è¯‘,è‹±æ–‡æ–‡æ¡£åœ°å€:https://github.com/square/okhttp/wiki Calls(è°ƒç”¨)HTTPå®¢æˆ·ç«¯çš„å·¥ä½œæ˜¯æ¥å—ä½ çš„è¯·æ±‚å¹¶äº§ç”Ÿå“åº”ã€‚è¿™åœ¨ç†è®ºä¸Šå¾ˆç®€å•ï¼Œä½†åœ¨å®è·µä¸­ä¼šå˜å¾—æ£˜æ‰‹ã€‚ Requestsæ¯ä¸ªHTTPè¯·æ±‚éƒ½åŒ…å«ä¸€ä¸ªURLï¼Œä¸€ä¸ªæ–¹æ³•ï¼ˆå¦‚GETæˆ–POSTï¼‰å’Œä¸€ä¸ªå¤´éƒ¨åˆ—è¡¨(headers)ã€‚è¯·æ±‚ä¹Ÿå¯èƒ½åŒ…å«ä¸€ä¸ªè¯·æ±‚ä½“(body)ï¼šç‰¹å®šå†…å®¹ç±»å‹çš„æ•°æ®æµã€‚ Responsesæ¯ä¸€ä¸ªHTTPå“åº”ä¸­éƒ½åŒ…å«ä¸€ä¸ªçŠ¶æ€ç ï¼ˆå¦‚200ä»£è¡¨æˆåŠŸï¼Œ404ä»£è¡¨æœªæ‰¾â€‹â€‹åˆ°ï¼‰ï¼Œä¸€ä¸ªå“åº”å¤´åˆ—è¡¨ï¼ˆheadersï¼‰å’Œä¸€ä¸ªå¯é€‰çš„å“åº”ä½“ï¼ˆbodyï¼‰ã€‚ é‡å†™è¯·æ±‚å½“ä½ çš„OkHttpå‘é€ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œä½ åœ¨æè¿°ä¸€ä¸ªé«˜å±‚æ¬¡çš„è¦æ±‚ï¼šâ€œç»™æˆ‘è·å–è¿™ä¸ªç½‘å€ä¸­çš„è¿™äº›è¯·æ±‚å¤´ã€‚â€å¯¹äºæ­£ç¡®æ€§å’Œæ•ˆç‡ï¼ŒOkHttpå‘é€å‰ä¼šé‡å†™ä½ çš„è¯·æ±‚ã€‚ OkHttpå¯ä»¥åœ¨åŸå…ˆçš„è¯·æ±‚ä¸­æ·»åŠ è¯·æ±‚å¤´ï¼ˆheadersï¼‰ï¼ŒåŒ…æ‹¬Content-Length, Transfer-Encoding, User-Agent, Host, Connection, å’Œ Content-Typeã€‚é™¤éè¯·æ±‚å¤´å·²ç»å­˜åœ¨å‹ç¼©å“åº”ï¼Œå¦åˆ™å®ƒè¿˜å°†æ·»åŠ ä¸€ä¸ªAccept-Encodingè¯·æ±‚å¤´ã€‚å¦‚æœä½ æœ‰cookiesï¼ŒOkHttpè¿˜å°†æ·»åŠ ä¸€ä¸ªCookieè¯·æ±‚å¤´ã€‚ ä¸€äº›è¯·æ±‚ä¼šæœ‰ä¸€ä¸ªç¼“å­˜çš„å“åº”ã€‚å½“è¿™ä¸ªç¼“å­˜çš„å“åº”ä¸æ˜¯æœ€æ–°çš„æ—¶å€™ï¼ŒOkHttpä¼šå‘é€ä¸€ä¸ªæœ‰æ¡ä»¶çš„GETæ¥ä¸‹è½½æ›´æ–°çš„å“åº”ï¼Œå¦‚æœå®ƒæ¯”ç¼“å­˜è¿˜æ–°ã€‚å®ƒå°†ä¼šæ·»åŠ éœ€è¦çš„è¯·æ±‚å¤´ï¼Œå¦‚IF-Modified-Sinceå’ŒIf-None-Matchã€‚ é‡å†™å“åº”å¦‚æœä½¿ç”¨é€æ˜å‹ç¼©ï¼ŒOkHttpå°†åˆ é™¤ç›¸åº”çš„å“åº”å¤´Content-Encodingï¼ŒContent-Lengthå› ä¸ºå®ƒä»¬ä¸é€‚ç”¨äºè§£å‹ç¼©çš„å“åº”ä¸»ä½“ã€‚ å¦‚æœæ¡ä»¶GETæˆåŠŸï¼Œåˆ™æ¥è‡ªç½‘ç»œå’Œç¼“å­˜çš„å“åº”å°†æŒ‰ç…§è§„èŒƒçš„æŒ‡ç¤ºè¿›è¡Œåˆå¹¶ã€‚ åç»­è¯·æ±‚å½“æ‚¨è¯·æ±‚çš„URLå·²ç»ç§»åŠ¨æ—¶ï¼ŒWebæœåŠ¡å™¨å°†è¿”å›ä¸€ä¸ªå“åº”ä»£ç ï¼Œ302ä»¥æŒ‡ç¤ºæ–‡æ¡£çš„æ–°URLã€‚OkHttpå°†æŒ‰ç…§é‡å®šå‘æ¥æ£€ç´¢æœ€ç»ˆå“åº”ã€‚å¦‚æœå“åº”å‘å‡ºæˆæƒè´¨è¯¢ï¼Œåˆ™OkHttpä¼šè¯¢é—®Authenticatorï¼ˆå¦‚æœå·²é…ç½®ï¼‰ä»¥æ»¡è¶³è´¨è¯¢ã€‚å¦‚æœè®¤è¯è€…æä¾›è¯ä¹¦ï¼Œåˆ™è¯·æ±‚å°†ä¼šå¸¦ç€è¯ä¹¦è¿›è¡Œé‡è¯•ã€‚ é‡è¯•è¯·æ±‚æœ‰æ—¶è¿æ¥å¤±è´¥ï¼šè¦ä¹ˆæ˜¯è¿æ¥æ± å·²ç»è¿‡æ—¶å’Œæ–­å¼€ï¼Œæˆ–æ˜¯WebæœåŠ¡å™¨æœ¬èº«æ— æ³•è¾¾æˆã€‚å¦‚æœæœ‰ä¸€ä¸ªæ˜¯å¯ç”¨çš„ï¼ŒOkHttpå°†ä¼šä½¿ç”¨ä¸åŒçš„è·¯ç”±è¿›è¡Œè¯·æ±‚é‡è¯•ã€‚ å‘¼å«éšç€é‡å†™ï¼Œé‡å®šå‘ï¼Œåç»­å’Œé‡è¯•ï¼Œä½ ç®€å•çš„è¦æ±‚å¯èƒ½ä¼šäº§ç”Ÿå¾ˆå¤šè¯·æ±‚å’Œå“åº”ã€‚OkHttpä½¿ç”¨å‘¼å«ï¼ˆCallï¼‰å¹¶é€šè¿‡è®¸å¤šå¿…è¦çš„ä¸­é—´è¯·æ±‚å’Œå“åº”æ¥æ»¡è¶³ä½ è¯·æ±‚çš„ä»»åŠ¡æ¨¡å‹ã€‚é€šå¸¸æƒ…å†µï¼Œè¿™æ˜¯ä¸æ˜¯å¾ˆå¤šï¼å¦‚æœæ‚¨çš„ç½‘å€è¢«é‡å®šå‘ï¼Œæˆ–è€…å¦‚æœæ‚¨æ•…éšœè½¬ç§»åˆ°å¦ä¸€ä¸ªIPåœ°å€ï¼Œä½†å®ƒä¼šæ¬£æ…°çš„çŸ¥é“ä½ çš„ä»£ç ä¼šç»§ç»­å·¥ä½œã€‚ é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼è¿›è¡Œå‘¼å«ï¼š åŒæ­¥ï¼šç›´åˆ°å“åº”,ä½ çš„çº¿ç¨‹å—æ˜¯å¯è¯»çš„ã€‚ å¼‚æ­¥ï¼šä½ åœ¨ä»»ä½•çº¿ç¨‹è¿›è¡Œæ’é˜Ÿè¯·æ±‚ï¼Œå¹¶ä¸”å½“å“åº”æ˜¯å¯è¯»çš„æ—¶å€™ï¼Œä½ ä¼šåœ¨å¦ä¸€ä¸ªçº¿ç¨‹å¾—åˆ°å›è°ƒã€‚ å‘¼å«ï¼ˆCallsï¼‰å¯ä»¥åœ¨ä»»ä½•çº¿ç¨‹ä¸­å–æ¶ˆã€‚å¦‚æœå®ƒå°šæœªå®Œæˆï¼Œå®ƒå°†ä½œä¸ºå¤±è´¥çš„å‘¼å«ï¼ˆCallsï¼‰ï¼å½“å‘¼å«ï¼ˆCallï¼‰è¢«å–æ¶ˆçš„æ—¶å€™ï¼Œå¦‚æœä»£ç è¯•å›¾è¿›è¡Œå†™è¯·æ±‚ä½“ï¼ˆrequest bodyï¼‰æˆ–è¯»å–å“åº”ä½“ï¼ˆresponse bodyï¼‰ä¼šé­å—IOExceptionå¼‚å¸¸ã€‚ è°ƒåº¦å¯¹äºåŒæ­¥å‘¼å«ï¼Œæ‚¨éœ€è¦è‡ªå¸¦çº¿ç¨‹ï¼Œå¹¶è´Ÿè´£ç®¡ç†å¤šå°‘ä¸ªåŒæ—¶å‘å‡ºçš„è¯·æ±‚ã€‚åŒæ—¶è¿æ¥çš„åƒåœ¾èµ„æºè¿‡å¤š; å¤ªå°‘çš„å±å®³ç­‰å¾…æ—¶é—´ã€‚ å¯¹äºå¼‚æ­¥è°ƒç”¨ï¼ŒDispatcherå®ç°æœ€å¤§åŒæ—¶è¯·æ±‚çš„ç­–ç•¥ã€‚æ‚¨å¯ä»¥è®¾ç½®æ¯ä¸ªç½‘ç»œæœåŠ¡å™¨çš„æœ€å¤§æ•°é‡ï¼ˆé»˜è®¤å€¼æ˜¯5ï¼‰ï¼Œæ€»ä½“ï¼ˆé»˜è®¤å€¼æ˜¯64ï¼‰ã€‚ Connections(è¿æ¥)è™½ç„¶æ‚¨åªæä¾›äº†URLï¼Œä½†æ˜¯OkHttpè®¡åˆ’ä½¿ç”¨ä¸‰ç§ç±»å‹è¿æ¥åˆ°ä½ çš„webæœåŠ¡å™¨ï¼šURL, Address, å’Œ Route URLURLï¼ˆå¦‚https://github.com/square/okhttpï¼‰æ˜¯HTTPå’ŒInternetçš„åŸºç¡€ã€‚é™¤äº†ä½œä¸ºç½‘ç»œä¸Šæ‰€æœ‰å†…å®¹çš„é€šç”¨åˆ†æ•£å‘½åæ–¹æ¡ˆä¹‹å¤–ï¼Œä»–ä»¬è¿˜æŒ‡å®šå¦‚ä½•è®¿é—®ç½‘ç»œèµ„æºã€‚ ç½‘å€æ˜¯æŠ½è±¡çš„ï¼š ä»–ä»¬æŒ‡å®šçš„è°ƒç”¨å¯èƒ½æ˜¯æ˜æ–‡ï¼ˆhttpï¼‰æˆ–åŠ å¯†ï¼ˆhttpsï¼‰ï¼Œä½†ä¸åº”è¯¥ä½¿ç”¨å“ªäº›åŠ å¯†ç®—æ³•ã€‚ä»–ä»¬ä¹Ÿæ²¡æœ‰æŒ‡å®šå¦‚ä½•éªŒè¯å¯¹ç­‰æ–¹çš„è¯ä¹¦ï¼ˆHostnameVerifierï¼‰æˆ–å“ªäº›è¯ä¹¦å¯ä»¥ä¿¡ä»»ï¼ˆSSLSocketFactoryï¼‰ã€‚ä»–ä»¬ä¹Ÿæ˜¯å…·ä½“çš„ï¼šæ¯ä¸ªURLæ ‡è¯†ä¸€ä¸ªç‰¹å®šçš„è·¯å¾„ï¼ˆå¦‚/square/okhttpï¼‰å’ŒæŸ¥è¯¢ï¼ˆå¦‚?q=sharks&amp;lang=enï¼‰ã€‚æ¯ä¸ªç½‘ç»œæœåŠ¡å™¨éƒ½æœ‰è®¸å¤šç½‘å€ã€‚ å®ƒä»¬ä¸æŒ‡å®šæ˜¯å¦åº”è¯¥ä½¿ç”¨ç‰¹å®šçš„ä»£ç†æœåŠ¡å™¨ï¼Œæˆ–è€…å¦‚ä½•ä½¿ç”¨è¯¥ä»£ç†æœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯ã€‚ ä»–ä»¬ä¹Ÿæ˜¯å…·ä½“çš„ï¼šæ¯ä¸ªURLæ ‡è¯†ä¸€ä¸ªç‰¹å®šçš„è·¯å¾„ï¼ˆå¦‚/square/okhttpï¼‰å’ŒæŸ¥è¯¢ï¼ˆå¦‚?q=sharks&amp;lang=enï¼‰ã€‚æ¯ä¸ªç½‘ç»œæœåŠ¡å™¨éƒ½æœ‰è®¸å¤šç½‘å€ã€‚ Addressesåœ°å€æŒ‡å®šä¸€ä¸ªç½‘ç»œæœåŠ¡å™¨ï¼ˆå¦‚github.comï¼‰ä»¥åŠè¿æ¥åˆ°è¯¥æœåŠ¡å™¨æ‰€éœ€çš„æ‰€æœ‰é™æ€é…ç½®ï¼šç«¯å£å·ï¼ŒHTTPSè®¾ç½®å’Œé¦–é€‰ç½‘ç»œåè®®ï¼ˆå¦‚HTTP / 2æˆ–SPDYï¼‰ã€‚ å…±äº«ç›¸åŒåœ°å€çš„URLä¹Ÿå¯èƒ½å…±äº«ç›¸åŒçš„åº•å±‚TCPå¥—æ¥å­—è¿æ¥ã€‚å…±äº«è¿æ¥å…·æœ‰æ˜¾ç€çš„æ€§èƒ½ä¼˜åŠ¿ï¼šæ›´ä½çš„å»¶è¿Ÿï¼Œæ›´é«˜çš„ååé‡ï¼ˆç”±äºTCPå¯åŠ¨ç¼“æ…¢ï¼‰å’Œä¿å­˜çš„ç”µæ± ã€‚OkHttpä½¿ç”¨ConnectionPoolè‡ªåŠ¨é‡ç”¨HTTP / 1.xè¿æ¥å¹¶å¤ç”¨HTTP / 2å’ŒSPDYè¿æ¥ã€‚ åœ¨OkHttpåœ°å€çš„ä¸€äº›å­—æ®µæ¥è‡ªURLï¼ˆæ–¹æ¡ˆï¼Œä¸»æœºåï¼Œç«¯å£ï¼‰ï¼Œå…¶ä½™æ¥è‡ªOkHttpClientã€‚ Routesè·¯ç”±æä¾›å®é™…è¿æ¥åˆ°WebæœåŠ¡å™¨æ‰€éœ€çš„åŠ¨æ€ä¿¡æ¯ã€‚è¿™æ˜¯è¦å°è¯•çš„ç‰¹å®šIPåœ°å€ï¼ˆé€šè¿‡DNSæŸ¥è¯¢å‘ç°ï¼‰ï¼Œè¦ä½¿ç”¨çš„ç¡®åˆ‡ä»£ç†æœåŠ¡å™¨ï¼ˆå¦‚æœæ­£åœ¨ä½¿ç”¨ProxySelectorï¼‰ä»¥åŠè¦åå•†å“ªä¸ªç‰ˆæœ¬çš„TLSï¼ˆç”¨äºHTTPSè¿æ¥ï¼‰ã€‚ å•ä¸ªåœ°å€å¯èƒ½æœ‰å¾ˆå¤šè·¯çº¿ã€‚ä¾‹å¦‚ï¼Œæ‰˜ç®¡åœ¨å¤šä¸ªæ•°æ®ä¸­å¿ƒä¸­çš„WebæœåŠ¡å™¨å¯èƒ½ä¼šåœ¨å…¶DNSå“åº”ä¸­äº§ç”Ÿå¤šä¸ªIPåœ°å€ã€‚ Connectionså½“ä½ ç”¨OkHttpè¯·æ±‚ä¸€ä¸ªURLçš„æ—¶å€™ï¼Œå®ƒçš„åŠŸèƒ½å¦‚ä¸‹ï¼š å®ƒä½¿ç”¨URLå¹¶é…ç½®OkHttpClientæ¥åˆ›å»ºä¸€ä¸ªåœ°å€ã€‚è¯¥åœ°å€æŒ‡å®šæˆ‘ä»¬å°†å¦‚ä½•è¿æ¥åˆ°WebæœåŠ¡å™¨ã€‚å®ƒå°è¯•ä»è¿æ¥æ± ä¸­æ£€ç´¢å…·æœ‰è¯¥åœ°å€çš„è¿æ¥ã€‚å¦‚æœåœ¨æ± ä¸­æ‰¾ä¸åˆ°è¿æ¥ï¼Œåˆ™é€‰æ‹©è¦å°è¯•çš„è·¯ç”±ã€‚è¿™é€šå¸¸æ„å‘³ç€å‘å‡ºDNSè¯·æ±‚æ¥è·å–æœåŠ¡å™¨çš„IPåœ°å€ã€‚ç„¶åæ ¹æ®éœ€è¦é€‰æ‹©TLSç‰ˆæœ¬å’Œä»£ç†æœåŠ¡å™¨ã€‚å¦‚æœæ˜¯æ–°è·¯ç”±ï¼Œåˆ™é€šè¿‡æ„å»ºç›´æ¥å¥—æ¥å­—è¿æ¥ï¼ŒTLSéš§é“ï¼ˆç”¨äºé€šè¿‡HTTPä»£ç†çš„HTTPSï¼‰æˆ–ç›´æ¥TLSè¿æ¥è¿›è¡Œè¿æ¥ã€‚å®ƒæ ¹æ®éœ€è¦è¿›è¡ŒTLSæ¡æ‰‹ã€‚å®ƒå‘é€HTTPè¯·æ±‚å¹¶è¯»å–å“åº”ã€‚å¦‚æœè¿æ¥æœ‰é—®é¢˜ï¼ŒOkHttpä¼šé€‰æ‹©å¦å¤–ä¸€ä¸ªè·¯å¾„ï¼Œç„¶åé‡è¯•ã€‚è¿™å…è®¸OkHttpåœ¨æœåŠ¡å™¨åœ°å€çš„å­é›†æ— æ³•è®¿é—®æ—¶æ¢å¤ã€‚å½“æ± è¿æ¥å¤±æ•ˆæˆ–å°è¯•çš„TLSç‰ˆæœ¬ä¸å—æ”¯æŒæ—¶ï¼Œè¿™ä¹Ÿå¾ˆæœ‰ç”¨ã€‚ ä¸€æ—¦æ¥æ”¶åˆ°å“åº”ï¼Œè¿æ¥å°†è¢«è¿”å›åˆ°æ± ä¸­ï¼Œä»¥ä¾¿å°†æ¥å¯ä»¥é‡å¤ä½¿ç”¨ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´çš„ä¸æ´»åŠ¨ä¹‹åï¼Œè¿æ¥è¢«ä»æ± ä¸­é€å‡ºã€‚ Recipes(æ–¹æ³•)æˆ‘ä»¬å·²ç»å†™äº†ä¸€äº›æ–¹æ³•ï¼Œæ¼”ç¤ºäº†å¦‚ä½•è§£å†³OkHttpå¸¸è§é—®é¢˜ã€‚é€šè¿‡é˜…è¯»ä»–ä»¬äº†è§£ä¸€åˆ‡æ˜¯å¦‚ä½•æ­£å¸¸å·¥ä½œçš„ã€‚å¯ä»¥è‡ªç”±å‰ªåˆ‡å’Œç²˜è´´è¿™äº›ä¾‹å­ã€‚ åŒæ­¥è·å–(Synchronous Get)ä¸‹è½½æ–‡ä»¶ï¼Œæ‰“å°å…¶å¤´éƒ¨ï¼Œå¹¶ä»¥å­—ç¬¦ä¸²å½¢å¼æ‰“å°å…¶å“åº”ä½“ã€‚ è¯¥string()æ–¹æ³•åœ¨å“åº”ä½“ä¸­æ˜¯æ–¹ä¾¿å¿«æ·çš„å°å‹æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œå¦‚æœå“åº”ä½“è¾ƒå¤§ï¼ˆå¤§äº1 MIBä»¥ä¸Šï¼‰ï¼Œå®ƒä¼šå°†æ•´ä¸ªè¾ƒå¤§æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥åº”è¯¥é¿å…string() ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ›´å€¾å‘äºå°†å“åº”ä½“ä½œä¸ºæµè¿›è¡Œå¤„ç†ã€‚ 123456789101112131415161718private final OkHttpClient client = new OkHttpClient();public void run() throws Exception &#123; Request request = new Request.Builder() .url("https://publicobject.com/helloworld.txt") .build(); try (Response response = client.newCall(request).execute()) &#123; if (!response.isSuccessful()) throw new IOException("Unexpected code " + response); Headers responseHeaders = response.headers(); for (int i = 0; i &lt; responseHeaders.size(); i++) &#123; System.out.println(responseHeaders.name(i) + ": " + responseHeaders.value(i)); &#125; System.out.println(response.body().string()); &#125;&#125; å¼‚æ­¥è·å–(Asynchronous Get)ä¸‹è½½ä¸€ä¸ªå·¥ä½œçº¿ç¨‹çš„æ–‡ä»¶ï¼Œå½“å“åº”æ˜¯å¯è¯»çš„æ—¶å€™ï¼Œè·å–å›è°ƒï¼ˆCallbackï¼‰ã€‚å½“å“åº”å¤´å·²ç»å‡†å¤‡å¥½åï¼Œå°†äº§ç”Ÿå›è°ƒï¼ˆCallbackï¼‰ã€‚è¯»å–å“åº”ä½“å¯èƒ½ä¸€ç›´é˜»å¡ã€‚ç›®å‰OkHttpä¸æä¾›å¼‚æ­¥APIæ¥æ¥æ”¶å“åº”ä½“çš„éƒ¨ä½ã€‚1234567891011121314151617181920212223242526private final OkHttpClient client = new OkHttpClient(); public void run() throws Exception &#123; Request request = new Request.Builder() .url("http://publicobject.com/helloworld.txt") .build(); client.newCall(request).enqueue(new Callback() &#123; @Override public void onFailure(Call call, IOException e) &#123; e.printStackTrace(); &#125; @Override public void onResponse(Call call, Response response) throws IOException &#123; try (ResponseBody responseBody = response.body()) &#123; if (!response.isSuccessful()) throw new IOException("Unexpected code " + response); Headers responseHeaders = response.headers(); for (int i = 0, size = responseHeaders.size(); i &lt; size; i++) &#123; System.out.println(responseHeaders.name(i) + ": " + responseHeaders.value(i)); &#125; System.out.println(responseBody.string()); &#125; &#125; &#125;); &#125; è®¿é—®å¤´å…¸å‹çš„HTTPå¤´å·¥ä½œå°±åƒä¸€ä¸ªMap ï¼šæ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸€ä¸ªå€¼æˆ–æ— å€¼ã€‚ä½†æ˜¯ï¼Œä¸€äº›å¤´éƒ¨(headers)å…è®¸å¤šä¸ªå€¼ï¼Œæ¯”å¦‚Guavaçš„Multimapã€‚ä¾‹å¦‚ï¼Œå®ƒå…±åŒä¸ºä¸€ä¸ªHTTPå“åº”æä¾›å¤šä¸ªVaryå¤´ã€‚OkHttpçš„APIï¼Œè¯•å›¾ä½¿è¿™ä¸¤ç§æƒ…å†µä¸‹éƒ½èƒ½èˆ’é€‚ä½¿ç”¨ã€‚ å½“å†™è¯·æ±‚å¤´ï¼Œç”¨header(name, value)æ¥ä¸ºå”¯ä¸€å‡ºç°çš„nameè®¾ç½®valueã€‚å¦‚æœå®ƒæœ¬èº«å­˜åœ¨å€¼ï¼Œåœ¨æ·»åŠ æ–°çš„valueä¹‹å‰ï¼Œä»–ä»¬ä¼šè¢«ç§»é™¤ã€‚ä½¿ç”¨addHeader(name, value)æ¥æ·»åŠ å¤´éƒ¨ä¸éœ€è¦ç§»é™¤å½“å‰å­˜åœ¨çš„headersã€‚ å½“è¯»å–å“åº”å¤´ï¼Œç”¨header(name)è¿”å›æœ€åè®¾ç½®nameçš„valueã€‚å¦‚æœæ²¡æœ‰valueï¼Œheader(name)å°†è¿”å›nullã€‚å¯ä»¥ä½¿ç”¨headers(name)æ¥è¯»å–æ‰€æœ‰åˆ—è¡¨å­—æ®µçš„å€¼ï¼Œã€‚ è¦è®¿é—®æ‰€æœ‰çš„å¤´éƒ¨ï¼Œç”¨Headersç±»ï¼Œå®ƒæ”¯æŒç´¢å¼•è®¿é—®ã€‚123456789101112131415161718private final OkHttpClient client = new OkHttpClient();public void run() throws Exception &#123; Request request = new Request.Builder() .url("https://api.github.com/repos/square/okhttp/issues") .header("User-Agent", "OkHttp Headers.java") .addHeader("Accept", "application/json; q=0.5") .addHeader("Accept", "application/vnd.github.v3+json") .build(); try (Response response = client.newCall(request).execute()) &#123; if (!response.isSuccessful()) throw new IOException("Unexpected code " + response); System.out.println("Server: " + response.header("Server")); System.out.println("Date: " + response.header("Date")); System.out.println("Vary: " + response.headers("Vary")); &#125;&#125; æäº¤ä¸€ä¸ªæ–‡æœ¬(Posting a String)ä½¿ç”¨HTTP POSTçš„è¯·æ±‚ä½“å‘é€åˆ°æœåŠ¡ã€‚ä¸‹é¢ä¾‹å­postäº†ä¸€ä¸ªmarkdownæ–‡æ¡£åˆ°ä¸€ä¸ªçš„WebæœåŠ¡ï¼ˆå°†markdownä½œä¸ºHTMLï¼‰ã€‚ç”±äºæ•´ä¸ªè¯·æ±‚ä½“æ˜¯åŒæ—¶åœ¨å†…å­˜ä¸­ï¼Œåº”é¿å…ä½¿ç”¨æ­¤APIå‘é€è¾ƒå¤§ï¼ˆå¤§äº1 MIBï¼‰çš„æ–‡ä»¶ã€‚12345678910111213141516171819202122232425public static final MediaType MEDIA_TYPE_MARKDOWN = MediaType.parse("text/x-markdown; charset=utf-8");private final OkHttpClient client = new OkHttpClient();public void run() throws Exception &#123; String postBody = "" + "Releases\n" + "--------\n" + "\n" + " * _1.0_ May 6, 2013\n" + " * _1.1_ June 15, 2013\n" + " * _1.2_ August 11, 2013\n"; Request request = new Request.Builder() .url("https://api.github.com/markdown/raw") .post(RequestBody.create(MEDIA_TYPE_MARKDOWN, postBody)) .build(); try (Response response = client.newCall(request).execute()) &#123; if (!response.isSuccessful()) throw new IOException("Unexpected code " + response); System.out.println(response.body().string()); &#125;&#125; å‘å¸ƒä¸€ä¸ªæµ(Post Streaming)åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬POSTè¯·æ±‚ä½“ä½œä¸ºstreamã€‚å°†æ­£åœ¨ç”Ÿæˆè¯·æ±‚ä½“çš„å†…å®¹å†™å…¥åˆ°streamä¸­ã€‚ä¸‹é¢ä¾‹å­streamsç›´æ¥è¿›å…¥Okioç¼“å†²æ°´æ§½ã€‚ä½ çš„ç¨‹åºå¯èƒ½æ›´å–œæ¬¢ä½¿ç”¨OutputStreamï¼Œä½ å¯ä»¥é€šè¿‡BufferedSink.outputStreamï¼ˆï¼‰è·å¾— OutputStreamã€‚123456789101112131415161718192021222324252627282930313233343536373839public static final MediaType MEDIA_TYPE_MARKDOWN = MediaType.parse("text/x-markdown; charset=utf-8");private final OkHttpClient client = new OkHttpClient();public void run() throws Exception &#123; RequestBody requestBody = new RequestBody() &#123; @Override public MediaType contentType() &#123; return MEDIA_TYPE_MARKDOWN; &#125; @Override public void writeTo(BufferedSink sink) throws IOException &#123; sink.writeUtf8("Numbers\n"); sink.writeUtf8("-------\n"); for (int i = 2; i &lt;= 997; i++) &#123; sink.writeUtf8(String.format(" * %s = %s\n", i, factor(i))); &#125; &#125; private String factor(int n) &#123; for (int i = 2; i &lt; n; i++) &#123; int x = n / i; if (x * i == n) return factor(x) + " Ã— " + i; &#125; return Integer.toString(n); &#125; &#125;; Request request = new Request.Builder() .url("https://api.github.com/markdown/raw") .post(requestBody) .build(); try (Response response = client.newCall(request).execute()) &#123; if (!response.isSuccessful()) throw new IOException("Unexpected code " + response); System.out.println(response.body().string()); &#125;&#125; å‘å¸ƒæ–‡ä»¶(Posting a File)å°†æ–‡ä»¶ä½œä¸ºè¯·æ±‚ä½“æ˜¯å¾ˆå®¹æ˜“çš„ã€‚12345678910111213141516171819public static final MediaType MEDIA_TYPE_MARKDOWN = MediaType.parse("text/x-markdown; charset=utf-8");private final OkHttpClient client = new OkHttpClient();public void run() throws Exception &#123; File file = new File("README.md"); Request request = new Request.Builder() .url("https://api.github.com/markdown/raw") .post(RequestBody.create(MEDIA_TYPE_MARKDOWN, file)) .build(); try (Response response = client.newCall(request).execute()) &#123; if (!response.isSuccessful()) throw new IOException("Unexpected code " + response); System.out.println(response.body().string()); &#125;&#125; å‘å¸ƒè¡¨å•(Posting form parameters)ä½¿ç”¨FormBody.Builderå»ºç«‹ä¸€ä¸ªè¯·æ±‚ä½“ï¼Œå®ƒå°±åƒä¸€ä¸ªHTMLçš„&lt;form&gt;æ ‡è®°ã€‚Nameså’Œvalueså°†ä½¿ç”¨HTMLå…¼å®¹çš„è¡¨å•URLç¼–ç è¿›è¡Œç¼–ç ã€‚1234567891011121314151617private final OkHttpClient client = new OkHttpClient();public void run() throws Exception &#123; RequestBody formBody = new FormBody.Builder() .add("search", "Jurassic Park") .build(); Request request = new Request.Builder() .url("https://en.wikipedia.org/w/index.php") .post(formBody) .build(); try (Response response = client.newCall(request).execute()) &#123; if (!response.isSuccessful()) throw new IOException("Unexpected code " + response); System.out.println(response.body().string()); &#125;&#125; å‘å¸ƒmultipartè¯·æ±‚(Posting a multipart request)MultipartBody.Builderå¯ä»¥æ„å»ºä¸HTMLæ–‡ä»¶ä¸Šä¼ è¡¨å•å…¼å®¹çš„å¤æ‚è¯·æ±‚ä¸»ä½“ã€‚multipartè¯·æ±‚ä½“çš„æ¯ä¸€éƒ¨åˆ†æœ¬èº«å°±æ˜¯è¯·æ±‚ä½“ï¼Œå¹¶ä¸”å¯ä»¥å®šä¹‰è‡ªå·±çš„å¤´éƒ¨ã€‚å¦‚æœå­˜åœ¨ï¼Œè¿™äº›å¤´åº”è¯¥æè¿°çš„éƒ¨åˆ†è¯·æ±‚ä½“ï¼Œå¦‚å®ƒçš„Content-Dispositionã€‚å¦‚æœContent-Lengthå’Œ Content-Typeå¤´éƒ¨å¯ä»¥ä½¿ç”¨ï¼Œåˆ™ä»–ä»¬ä¼šè‡ªåŠ¨æ·»åŠ ã€‚123456789101112131415161718192021222324252627282930/** * The imgur client ID for OkHttp recipes. If you're using imgur for anything other than running * these examples, please request your own client ID! https://api.imgur.com/oauth2 */private static final String IMGUR_CLIENT_ID = "...";private static final MediaType MEDIA_TYPE_PNG = MediaType.parse("image/png");private final OkHttpClient client = new OkHttpClient();public void run() throws Exception &#123; // Use the imgur image upload API as documented at https://api.imgur.com/endpoints/image RequestBody requestBody = new MultipartBody.Builder() .setType(MultipartBody.FORM) .addFormDataPart("title", "Square Logo") .addFormDataPart("image", "logo-square.png", RequestBody.create(MEDIA_TYPE_PNG, new File("website/static/logo-square.png"))) .build(); Request request = new Request.Builder() .header("Authorization", "Client-ID " + IMGUR_CLIENT_ID) .url("https://api.imgur.com/3/image") .post(requestBody) .build(); try (Response response = client.newCall(request).execute()) &#123; if (!response.isSuccessful()) throw new IOException("Unexpected code " + response); System.out.println(response.body().string()); &#125;&#125; ç”¨Moshiè§£æJSONå“åº”Moshiæ˜¯ä¸€ä¸ªä¾¿æ·çš„APIï¼Œç”¨äºåœ¨JSONå’ŒJavaå¯¹è±¡ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å®ƒæ¥è§£ç æ¥è‡ªGitHub APIçš„JSONå“åº”ã€‚ è¯·æ³¨æ„ï¼ŒResponseBody.charStream()ä½¿ç”¨Content-Typeå“åº”å¤´æ¥é€‰æ‹©è§£ç å“åº”ä¸»ä½“æ—¶ä½¿ç”¨å“ªä¸ªå­—ç¬¦é›†ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šå­—ç¬¦é›†ï¼Œå®ƒé»˜è®¤ä¸ºUTF-8ã€‚123456789101112131415161718192021222324252627private final OkHttpClient client = new OkHttpClient();private final Moshi moshi = new Moshi.Builder().build();private final JsonAdapter&lt;Gist&gt; gistJsonAdapter = moshi.adapter(Gist.class);public void run() throws Exception &#123; Request request = new Request.Builder() .url("https://api.github.com/gists/c2a7c39532239ff261be") .build(); try (Response response = client.newCall(request).execute()) &#123; if (!response.isSuccessful()) throw new IOException("Unexpected code " + response); Gist gist = gistJsonAdapter.fromJson(response.body().source()); for (Map.Entry&lt;String, GistFile&gt; entry : gist.files.entrySet()) &#123; System.out.println(entry.getKey()); System.out.println(entry.getValue().content); &#125; &#125;&#125;static class Gist &#123; Map&lt;String, GistFile&gt; files;&#125;static class GistFile &#123; String content;&#125; å“åº”ç¼“å­˜è¦ç¼“å­˜å“åº”ï¼Œä½ éœ€è¦æœ‰ä¸€ä¸ªç¼“å­˜ç›®å½•æ¥è¿›è¡Œè¯»å–å’Œå†™å…¥ï¼Œå¹¶é™åˆ¶ç¼“å­˜çš„å¤§å°ã€‚ç¼“å­˜ç›®å½•åº”è¯¥æ˜¯ç§æœ‰çš„ï¼Œä¸è¢«ä¿¡ä»»çš„åº”ç”¨ç¨‹åºä¸èƒ½å¤Ÿé˜…è¯»å…¶å†…å®¹ï¼ å¤šä¸ªç¼“å­˜åŒæ—¶è®¿é—®ç›¸åŒçš„ç¼“å­˜ç›®å½•ï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚å¤§å¤šæ•°åº”ç”¨ç¨‹åºåº”è¯¥è°ƒç”¨ä¸€æ¬¡new OkHttpClient()ï¼Œåœ¨ä»»ä½•åœ°æ–¹éƒ½ä½¿ç”¨ç›¸åŒçš„å®ä¾‹å’Œè‡ªå·±çš„ç¼“å­˜é…ç½®ã€‚å¦åˆ™ï¼Œè¿™ä¸¤ä¸ªç¼“å­˜å®ä¾‹å°†è¸©åˆ°å¯¹æ–¹ï¼Œç ´åå“åº”ç¼“å­˜ï¼Œè¿™å¯èƒ½ä½¿ä½ çš„ç¨‹åºå´©æºƒã€‚ å“åº”ç¼“å­˜ä½¿ç”¨HTTPå¤´è¿›è¡Œé…ç½®ã€‚æ‚¨å¯ä»¥æ·»åŠ è¯·æ±‚å¤´Cache-Control: max-stale=3600ï¼Œè¿™æ ·OkHttpçš„ç¼“å­˜å°±ä¼šéµå¾ªä»–ä»¬ã€‚ä½ çš„ç½‘ç»œæœåŠ¡å™¨å¯ä»¥é€šè¿‡è‡ªå·±çš„å“åº”å¤´é…ç½®ç¼“å­˜å¤šé•¿æ—¶é—´çš„å“åº”ï¼Œå¦‚Cache-Control: max-age=9600ã€‚æœ‰ç¼“å­˜å¤´å¼ºåˆ¶ç¼“å­˜çš„å“åº”ï¼Œå¼ºåˆ¶ç½‘ç»œå“åº”ï¼Œæˆ–å¼ºåˆ¶ä½¿ç”¨æ¡ä»¶GETéªŒè¯çš„ç½‘ç»œå“åº”ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738private final OkHttpClient client;public CacheResponse(File cacheDirectory) throws Exception &#123; int cacheSize = 10 * 1024 * 1024; // 10 MiB Cache cache = new Cache(cacheDirectory, cacheSize); client = new OkHttpClient.Builder() .cache(cache) .build();&#125;public void run() throws Exception &#123; Request request = new Request.Builder() .url("http://publicobject.com/helloworld.txt") .build(); String response1Body; try (Response response1 = client.newCall(request).execute()) &#123; if (!response1.isSuccessful()) throw new IOException("Unexpected code " + response1); response1Body = response1.body().string(); System.out.println("Response 1 response: " + response1); System.out.println("Response 1 cache response: " + response1.cacheResponse()); System.out.println("Response 1 network response: " + response1.networkResponse()); &#125; String response2Body; try (Response response2 = client.newCall(request).execute()) &#123; if (!response2.isSuccessful()) throw new IOException("Unexpected code " + response2); response2Body = response2.body().string(); System.out.println("Response 2 response: " + response2); System.out.println("Response 2 cache response: " + response2.cacheResponse()); System.out.println("Response 2 network response: " + response2.networkResponse()); &#125; System.out.println("Response 2 equals Response 1? " + response1Body.equals(response2Body));&#125; ä½¿ç”¨CacheControl.FORCE_NETWORKå¯ä»¥ç¦æ­¢ä½¿ç”¨ç¼“å­˜çš„å“åº”ã€‚ä½¿ç”¨CacheControl.FORCE_CACHEå¯ä»¥ç¦æ­¢ä½¿ç”¨ç½‘ç»œã€‚è­¦å‘Šï¼šå¦‚æœæ‚¨ä½¿ç”¨FORCE_CACHEå’Œå“åº”æ¥è‡ªç½‘ç»œï¼ŒOkHttpå°†ä¼šè¿”å›ä¸€ä¸ª504ä¸å¯æ»¡è¶³è¯·æ±‚çš„å“åº”ã€‚ å–æ¶ˆCallé€šè¿‡Call.cancel()æ¥ç«‹å³åœæ­¢æ­£åœ¨è¿›è¡Œçš„Callã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹ç›®å‰æ­£åœ¨å†™è¯·æ±‚æˆ–è¯»å“åº”ï¼Œå®ƒè¿˜å°†æ”¶åˆ°ä¸€ä¸ªIOExceptionå¼‚å¸¸ã€‚å½“ä¸€ä¸ªCallä¸éœ€è¦æ—¶ï¼Œä½¿ç”¨å–æ¶ˆCallæ¥ä¿æŠ¤ç½‘ç»œ; ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·ä»åº”ç”¨ç¨‹åºå¯¼èˆªç¦»å¼€ã€‚åŒæ­¥å’Œå¼‚æ­¥è°ƒç”¨å¯ä»¥è¢«å–æ¶ˆã€‚1234567891011121314151617181920212223242526272829private final ScheduledExecutorService executor = Executors.newScheduledThreadPool(1);private final OkHttpClient client = new OkHttpClient();public void run() throws Exception &#123; Request request = new Request.Builder() .url("http://httpbin.org/delay/2") // This URL is served with a 2 second delay. .build(); final long startNanos = System.nanoTime(); final Call call = client.newCall(request); // Schedule a job to cancel the call in 1 second. executor.schedule(new Runnable() &#123; @Override public void run() &#123; System.out.printf("%.2f Canceling call.%n", (System.nanoTime() - startNanos) / 1e9f); call.cancel(); System.out.printf("%.2f Canceled call.%n", (System.nanoTime() - startNanos) / 1e9f); &#125; &#125;, 1, TimeUnit.SECONDS); System.out.printf("%.2f Executing call.%n", (System.nanoTime() - startNanos) / 1e9f); try (Response response = call.execute()) &#123; System.out.printf("%.2f Call was expected to fail, but completed: %s%n", (System.nanoTime() - startNanos) / 1e9f, response); &#125; catch (IOException e) &#123; System.out.printf("%.2f Call failed as expected: %s%n", (System.nanoTime() - startNanos) / 1e9f, e); &#125;&#125; è¶…æ—¶å½“æ— æ³•è®¿é—®æŸ¥è¯¢æ—¶ï¼Œå°†è°ƒç”¨è¶…æ—¶å¤±è´¥ã€‚è¶…æ—¶åœ¨ç½‘ç»œåˆ’åˆ†ä¸­å¯ä»¥æ˜¯ç”±äºå®¢æˆ·ç«¯è¿æ¥é—®é¢˜ï¼ŒæœåŠ¡å™¨å¯ç”¨æ€§çš„é—®é¢˜ï¼Œæˆ–ä¸¤è€…ä¹‹é—´çš„ä»»ä½•ä¸œè¥¿ã€‚OkHttpæ”¯æŒè¿æ¥ï¼Œè¯»å–å’Œå†™å…¥è¶…æ—¶ã€‚12345678910111213141516171819private final OkHttpClient client;public ConfigureTimeouts() throws Exception &#123; client = new OkHttpClient.Builder() .connectTimeout(10, TimeUnit.SECONDS) .writeTimeout(10, TimeUnit.SECONDS) .readTimeout(30, TimeUnit.SECONDS) .build();&#125;public void run() throws Exception &#123; Request request = new Request.Builder() .url("http://httpbin.org/delay/2") // This URL is served with a 2 second delay. .build(); try (Response response = client.newCall(request).execute()) &#123; System.out.println("Response completed: " + response); &#125;&#125; æ¯ä¸ªå‘¼å«é…ç½®æ‰€æœ‰çš„HTTPå®¢æˆ·ç«¯éƒ½åœ¨OkHttpClientä¸­é…ç½®ï¼Œè¿™åŒ…æ‹¬ä»£ç†è®¾ç½®ï¼Œè¶…æ—¶å’Œç¼“å­˜ã€‚å½“ä½ éœ€è¦æ”¹å˜å•ä¸€Callçš„é…ç½®æ—¶ï¼Œè°ƒç”¨OkHttpClient.newBuilder()ã€‚è¿™å°†è¿”å›å…±äº«ç›¸åŒçš„è¿æ¥æ± ï¼Œè°ƒåº¦å’Œé…ç½®çš„åŸå®¢æˆ·ç«¯çš„å»ºé€ å™¨ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åšäº†500æ¯«ç§’è¶…æ—¶ï¼Œå¦å¤–ä¸€ä¸ª3000æ¯«ç§’è¶…æ—¶è¯·æ±‚ã€‚ 123456789101112131415161718192021222324252627private final OkHttpClient client = new OkHttpClient();public void run() throws Exception &#123; Request request = new Request.Builder() .url("http://httpbin.org/delay/1") // This URL is served with a 1 second delay. .build(); // Copy to customize OkHttp for this request. OkHttpClient client1 = client.newBuilder() .readTimeout(500, TimeUnit.MILLISECONDS) .build(); try (Response response = client1.newCall(request).execute()) &#123; System.out.println("Response 1 succeeded: " + response); &#125; catch (IOException e) &#123; System.out.println("Response 1 failed: " + e); &#125; // Copy to customize OkHttp for this request. OkHttpClient client2 = client.newBuilder() .readTimeout(3000, TimeUnit.MILLISECONDS) .build(); try (Response response = client2.newCall(request).execute()) &#123; System.out.println("Response 2 succeeded: " + response); &#125; catch (IOException e) &#123; System.out.println("Response 2 failed: " + e); &#125;&#125; è®¤è¯å¤„ç†OkHttpèƒ½å¤Ÿè‡ªåŠ¨é‡è¯•æœªç»æˆæƒçš„è¯·æ±‚ã€‚å½“å“åº”æ˜¯401 Not Authorizedï¼Œä¸€ä¸ªAuthenticatorè¢«è¦æ±‚æä¾›å‡­æ®ã€‚åº”è¯¥å»ºç«‹ä¸€ä¸ªåŒ…å«ç¼ºå°‘å‡­æ®çš„æ–°è¦æ±‚ã€‚å¦‚æœæ²¡æœ‰å‡­è¯å¯ç”¨ï¼Œåˆ™è¿”å›nullè·³è¿‡é‡è¯•ã€‚ ä½¿ç”¨Response.challengesï¼ˆï¼‰è·å¾—ä»»ä½•è®¤è¯æŒ‘æˆ˜æ–¹æ¡ˆå’Œé¢†åŸŸã€‚å½“å®Œæˆä¸€ä¸ªåŸºæœ¬çš„æŒ‘æˆ˜ï¼Œç”¨Credentials.basic(username, password)ç¼–ç è¯·æ±‚å¤´ã€‚1234567891011121314151617181920212223242526272829303132private final OkHttpClient client;public Authenticate() &#123; client = new OkHttpClient.Builder() .authenticator(new Authenticator() &#123; @Override public Request authenticate(Route route, Response response) throws IOException &#123; if (response.request().header("Authorization") != null) &#123; return null; // Give up, we've already attempted to authenticate. &#125; System.out.println("Authenticating for response: " + response); System.out.println("Challenges: " + response.challenges()); String credential = Credentials.basic("jesse", "password1"); return response.request().newBuilder() .header("Authorization", credential) .build(); &#125; &#125;) .build();&#125;public void run() throws Exception &#123; Request request = new Request.Builder() .url("http://publicobject.com/secrets/hellosecret.txt") .build(); try (Response response = client.newCall(request).execute()) &#123; if (!response.isSuccessful()) throw new IOException("Unexpected code " + response); System.out.println(response.body().string()); &#125;&#125; ä¸ºäº†é¿å…éªŒè¯æ—¶ä¸å·¥ä½œçš„é‡è¯•ï¼Œä½ å¯ä»¥è¿”å›nullæ”¾å¼ƒã€‚ä¾‹å¦‚ï¼Œå½“è¿™äº›ç¡®åˆ‡çš„å‡­æ®å·²ç»å°è¯•,æ‚¨å¯ä»¥è·³è¿‡é‡è¯•ï¼š123if (credential.equals(response.request().header("Authorization"))) &#123; return null; // å¦‚æœæˆ‘ä»¬å·²ç»ä½¿ç”¨è¿™äº›å‡­æ®å¤±è´¥ï¼Œä¸é‡è¯• &#125; å½“ä½ çš„åº”ç”¨å°è¯•çš„æ¬¡æ•°è¶…è¿‡äº†é™åˆ¶çš„æ¬¡æ•°æ—¶ï¼Œä½ å¯ä»¥è·³è¿‡é‡è¯•ï¼š123if (responseCount(response) &gt;= 3) &#123; return null; //å¦‚æœæˆ‘ä»¬å·²ç»å¤±è´¥äº†3æ¬¡ï¼Œæ”¾å¼ƒã€‚ . &#125; è¿™ä¸Šé¢çš„ä»£ç ä¾èµ–äºä¸‹é¢çš„responseCount()æ–¹æ³•ï¼š1234567private int responseCount(Response response) &#123; int result = 1; while ((response = response.priorResponse()) != null) &#123; result++; &#125; return result; &#125; Interceptors(æ‹¦æˆªå™¨)æ‹¦æˆªå™¨æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æœºåˆ¶ï¼Œå®ƒå¯ä»¥ç›‘æ§ï¼Œé‡å†™å’Œé‡è¯•Callsã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•è®°å½•ä¼ å‡ºè¯·æ±‚å’Œå“åº”ä¼ å…¥çš„æ‹¦æˆªå™¨ã€‚1234567891011121314151617class LoggingInterceptor implements Interceptor &#123; @Override public Response intercept(Interceptor.Chain chain) throws IOException &#123; Request request = chain.request(); long t1 = System.nanoTime(); logger.info(String.format("Sending request %s on %s%n%s", request.url(), chain.connection(), request.headers())); Response response = chain.proceed(request); long t2 = System.nanoTime(); logger.info(String.format("Received response for %s in %.1fms%n%s", response.request().url(), (t2 - t1) / 1e6d, response.headers())); return response; &#125;&#125; è°ƒç”¨chain.proceed(request)æ˜¯æ¯ä¸ªæ‹¦æˆªå™¨å®ç°çš„å…³é”®éƒ¨åˆ†ã€‚è¿™ä¸ªçœ‹èµ·æ¥å¾ˆç®€å•çš„æ–¹æ³•å°±æ˜¯æ‰€æœ‰HTTPå·¥ä½œå‘ç”Ÿçš„åœ°æ–¹ï¼Œäº§ç”Ÿæ»¡è¶³è¯·æ±‚çš„å“åº”ã€‚ æ‹¦æˆªå™¨å¯ä»¥è¢«é“¾æ¥ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªå‹ç¼©æ‹¦æˆªå™¨å’Œä¸€ä¸ªæ ¡éªŒå’Œæ‹¦æˆªå™¨ï¼šä½ éœ€è¦å†³å®šæ•°æ®æ˜¯å‹ç¼©çš„ï¼Œç„¶åè¿›è¡Œæ ¡éªŒå’Œï¼Œæˆ–è€…æ ¡éªŒå’Œå‹ç¼©ã€‚OkHttpä½¿ç”¨åˆ—è¡¨æ¥è·Ÿè¸ªæ‹¦æˆªå™¨ï¼Œæ‹¦æˆªå™¨æ˜¯æŒ‰é¡ºåºè°ƒç”¨çš„ã€‚ åº”ç”¨ç¨‹åºæ‹¦æˆªå™¨æ‹¦æˆªå™¨å¯ä»¥æ³¨å†Œä¸ºåº”ç”¨æ‹¦æˆªå™¨æˆ–ç½‘ç»œæ‹¦æˆªå™¨ã€‚æˆ‘ä»¬å°†ä½¿ç”¨LoggingInterceptoræ¥åŒºåˆ«ã€‚ é€šè¿‡åœ¨OkHttpClient.Builderä¸Šè°ƒç”¨addInterceptorï¼ˆï¼‰æ¥æ³¨å†Œåº”ç”¨ç¨‹åºæ‹¦æˆªå™¨ï¼š1234567891011OkHttpClient client = new OkHttpClient.Builder() .addInterceptor(new LoggingInterceptor()) .build();Request request = new Request.Builder() .url("http://www.publicobject.com/helloworld.txt") .header("User-Agent", "OkHttp Example") .build();Response response = client.newCall(request).execute();response.body().close(); è¯¥URLï¼šhttp://www.publicobject.com/helloworld.txt é‡å®šå‘åˆ°https://publicobject.com/helloworld.txt, OkHttpè‡ªåŠ¨é‡å®šå‘ã€‚æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ‹¦æˆªå™¨è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œè¿”å›çš„å“åº”chain.proceed()å…·æœ‰é‡å®šå‘çš„å“åº”ï¼š12345678INFO: Sending request http://www.publicobject.com/helloworld.txt on nullUser-Agent: OkHttp ExampleINFO: Received response for https://publicobject.com/helloworld.txt in 1179.7msServer: nginx/1.4.6 (Ubuntu)Content-Type: text/plainContent-Length: 1759Connection: keep-alive æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è¢«é‡å®šå‘äº†ï¼Œå› ä¸ºresponse.request().url()ä¸åŒäºrequest.url()ã€‚è¿™ä¸¤ä¸ªæ—¥å¿—è¯­å¥è®°å½•ä¸¤ä¸ªä¸åŒçš„URLã€‚ ç½‘ç»œæ‹¦æˆªå™¨æ³¨å†Œç½‘ç»œæ‹¦æˆªå™¨å¾ˆç±»ä¼¼ã€‚è°ƒç”¨addNetworkInterceptor()ä»£æ›¿addInterceptor()ï¼š1234567891011OkHttpClient client = new OkHttpClient.Builder() .addNetworkInterceptor(new LoggingInterceptor()) .build();Request request = new Request.Builder() .url("http://www.publicobject.com/helloworld.txt") .header("User-Agent", "OkHttp Example") .build();Response response = client.newCall(request).execute();response.body().close(); å½“æˆ‘ä»¬è¿è¡Œè¿™ä¸ªä»£ç æ—¶ï¼Œæ‹¦æˆªå™¨è¿è¡Œä¸¤æ¬¡ã€‚ä¸€æ¬¡ä¸ºæœ€åˆçš„è¯·æ±‚http://www.publicobject.com/helloworld.txtï¼Œå¦ä¸€ä¸ªä¸ºé‡å®šå‘https://publicobject.com/helloworld.txtã€‚123456789101112131415161718192021222324INFO: Sending request http://www.publicobject.com/helloworld.txt on Connection&#123;www.publicobject.com:80, proxy=DIRECT hostAddress=54.187.32.157 cipherSuite=none protocol=http/1.1&#125;User-Agent: OkHttp ExampleHost: www.publicobject.comConnection: Keep-AliveAccept-Encoding: gzipINFO: Received response for http://www.publicobject.com/helloworld.txt in 115.6msServer: nginx/1.4.6 (Ubuntu)Content-Type: text/htmlContent-Length: 193Connection: keep-aliveLocation: https://publicobject.com/helloworld.txtINFO: Sending request https://publicobject.com/helloworld.txt on Connection&#123;publicobject.com:443, proxy=DIRECT hostAddress=54.187.32.157 cipherSuite=TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA protocol=http/1.1&#125;User-Agent: OkHttp ExampleHost: publicobject.comConnection: Keep-AliveAccept-Encoding: gzipINFO: Received response for https://publicobject.com/helloworld.txt in 80.9msServer: nginx/1.4.6 (Ubuntu)Content-Type: text/plainContent-Length: 1759Connection: keep-alive ç½‘ç»œè¯·æ±‚è¿˜åŒ…å«å¾ˆå¤šæ•°æ®ï¼Œå¦‚OkHttpåŠ å…¥Accept-Encoding: gzipå¤´éƒ¨é€šçŸ¥æ”¯æŒå‹ç¼©å“åº”ã€‚ç½‘ç»œæ‹¦æˆªå™¨çš„é“¾å…·æœ‰éç©ºçš„è¿æ¥ï¼Œå®ƒå¯ç”¨äºè¯¢é—®IPåœ°å€å’Œè¿æ¥åˆ°ç½‘ç»œæœåŠ¡å™¨çš„TLSé…ç½®ã€‚ åº”ç”¨ç¨‹åºå’Œç½‘ç»œæ‹¦æˆªä¹‹é—´è¿›è¡Œé€‰æ‹©æ¯ä¸ªæ‹¦æˆªå™¨é“¾(interceptor chain)éƒ½å…·æœ‰ç›¸å¯¹ä¼˜åŠ¿ã€‚ åº”ç”¨æ‹¦æˆªå™¨ ä¸å¿…æ‹…å¿ƒåƒé‡å®šå‘å’Œé‡è¯•çš„ä¸­é—´å“åº”ã€‚ æ€»æ˜¯è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå³ä½¿HTTPå“åº”æ¥è‡ªç¼“å­˜æœåŠ¡ã€‚ è§‚å¯Ÿåº”ç”¨ç¨‹åºçš„åŸæ„ã€‚ä¸å…³å¿ƒOkHttpæ³¨å…¥çš„å¤´æ–‡ä»¶ï¼Œå¦‚ If-None-Matchã€‚ å…è®¸çŸ­è·¯å’Œä¸è°ƒç”¨Chain.proceedï¼ˆï¼‰ ã€‚ å…è®¸é‡è¯•ï¼Œå¹¶å¤šæ¬¡è°ƒç”¨Chain.proceedï¼ˆï¼‰ ã€‚ ç½‘ç»œæ‹¦æˆªå™¨ èƒ½å¤Ÿæ“ä½œåƒé‡å®šå‘å’Œé‡è¯•çš„ä¸­é—´å“åº”ã€‚ åœ¨çŸ­è·¯ç½‘ç»œä¸Šä¸è°ƒç”¨ç¼“å­˜çš„å“åº”ã€‚ è§‚å¯Ÿåœ¨ç½‘ç»œä¸Šä¼ è¾“çš„æ•°æ®ã€‚ è®¿é—®Connectionæ‰¿è½½è¯·æ±‚ã€‚ é‡å†™è¯·æ±‚æ‹¦æˆªå™¨å¯ä»¥æ·»åŠ ï¼Œåˆ é™¤æˆ–æ›¿æ¢è¯·æ±‚å¤´ã€‚ä»–ä»¬è¿˜å¯ä»¥è½¬æ¢è¯·æ±‚ä½“ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ è¿æ¥åˆ°å·²çŸ¥æ”¯æŒå®ƒçš„ç½‘ç»œæœåŠ¡å™¨ï¼Œä½ å¯ä»¥ä½¿ç”¨åº”ç”¨ç¨‹åºæ‹¦æˆªå™¨æ·»åŠ è¯·æ±‚ä½“çš„å‹ç¼©ã€‚123456789101112131415161718192021222324252627282930313233/** This interceptor compresses the HTTP request body. Many webservers can't handle this! */final class GzipRequestInterceptor implements Interceptor &#123; @Override public Response intercept(Interceptor.Chain chain) throws IOException &#123; Request originalRequest = chain.request(); if (originalRequest.body() == null || originalRequest.header("Content-Encoding") != null) &#123; return chain.proceed(originalRequest); &#125; Request compressedRequest = originalRequest.newBuilder() .header("Content-Encoding", "gzip") .method(originalRequest.method(), gzip(originalRequest.body())) .build(); return chain.proceed(compressedRequest); &#125; private RequestBody gzip(final RequestBody body) &#123; return new RequestBody() &#123; @Override public MediaType contentType() &#123; return body.contentType(); &#125; @Override public long contentLength() &#123; return -1; // We don't know the compressed length in advance! &#125; @Override public void writeTo(BufferedSink sink) throws IOException &#123; BufferedSink gzipSink = Okio.buffer(new GzipSink(sink)); body.writeTo(gzipSink); gzipSink.close(); &#125; &#125;; &#125;&#125; é‡å†™å“åº”ç›¸å¯¹åº”çš„ï¼Œæ‹¦æˆªå™¨ä¹Ÿå¯ä»¥é‡å†™å“åº”å¤´å’Œè½¬æ¢å“åº”ä½“ã€‚é€šå¸¸ä¸è¦é‡å†™è¯·æ±‚å¤´ï¼Œå› ä¸ºå®ƒå¯èƒ½è¿åäº†WebæœåŠ¡å™¨çš„æœŸæœ›å¯¼è‡´æ›´å±é™©ï¼ åœ¨ä¸€ä¸ªæ£˜æ‰‹çš„æƒ…å†µä¸‹ï¼Œå¦‚æœå·²ç»åšå¥½åº”å¯¹çš„åæœï¼Œé‡å†™å“åº”å¤´æ˜¯è§£å†³é—®é¢˜çš„æœ‰æ•ˆæ–¹å¼ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä¿®å¤æœåŠ¡å™¨çš„é…ç½®é”™è¯¯çš„Cache-Controlå“åº”å¤´ä»¥ä¾¿æ›´å¥½åœ°å“åº”ç¼“å­˜ï¼š123456789/** Dangerous interceptor that rewrites the server's cache-control header. */private static final Interceptor REWRITE_CACHE_CONTROL_INTERCEPTOR = new Interceptor() &#123; @Override public Response intercept(Interceptor.Chain chain) throws IOException &#123; Response originalResponse = chain.proceed(chain.request()); return originalResponse.newBuilder() .header("Cache-Control", "max-age=60") .build(); &#125;&#125;; é€šå¸¸æ­¤æ–¹æ³•æ•ˆæœæœ€å¥½ï¼Œå®ƒè¡¥å……äº†åœ¨WebæœåŠ¡å™¨ä¸Šç›¸åº”çš„ä¿®å¤ï¼ å¯ç”¨æ€§OkHttpçš„æ‹¦æˆªå™¨éœ€è¦OkHttp 2.2æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæ‹¦æˆªå™¨ä¸é€‚OkUrlFactoryç”¨äºæ„å»ºå®ƒçš„åº“ï¼ŒåŒ…æ‹¬Retrofitâ‰¤1.8å’ŒPicassoâ‰¤2.4ã€‚ HTTPSOkHttpè¯•å›¾å¹³è¡¡ä¸¤ä¸ªç›¸äº’ç«äº‰çš„æ‹…å¿§ï¼š è¿æ¥åˆ°å°½å¯èƒ½å¤šçš„ä¸»æœºã€‚è¿™åŒ…æ‹¬è¿è¡Œæœ€æ–°ç‰ˆæœ¬çš„boringsslçš„é«˜çº§ä¸»æœºï¼Œä»¥åŠè¿è¡Œæ—§ç‰ˆæœ¬OpenSSLçš„è¿‡æ—¶ä¸»æœºã€‚ è¿æ¥çš„å®‰å…¨æ€§ã€‚è¿™åŒ…æ‹¬éªŒè¯å…·æœ‰è¯ä¹¦çš„è¿œç¨‹ç½‘ç»œæœåŠ¡å™¨ä»¥åŠä¸å¼ºå¯†ç äº¤æ¢çš„æ•°æ®çš„ç§å¯†æ€§ã€‚åå•†è¿æ¥åˆ°HTTPSæœåŠ¡å™¨æ—¶ï¼ŒOkHttpéœ€è¦çŸ¥é“æä¾›å“ªäº›TLSç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶ã€‚å¸Œæœ›æœ€å¤§åŒ–è¿æ¥çš„å®¢æˆ·ç«¯å°†åŒ…æ‹¬è¿‡æ—¶çš„TLSç‰ˆæœ¬å’Œå¼±è®¾è®¡å¯†ç å¥—ä»¶ã€‚ä¸€ä¸ªæƒ³è¦æœ€å¤§é™åº¦åœ°æé«˜å®‰å…¨æ€§çš„ä¸¥æ ¼çš„å®¢æˆ·ç«¯å°†ä»…é™äºæœ€æ–°çš„TLSç‰ˆæœ¬å’Œæœ€å¼ºçš„å¯†ç å¥—ä»¶ã€‚ ConnectionSpecå®ç°ç‰¹å®šçš„å®‰å…¨æ€§å’Œè¿æ¥æ€§å†³å®šã€‚OkHttpåŒ…å«ä¸‰ä¸ªå†…ç½®çš„è¿æ¥è§„èŒƒï¼š MODERN_TLSæ˜¯è¿æ¥åˆ°ç°ä»£HTTPSæœåŠ¡å™¨çš„å®‰å…¨é…ç½®ã€‚ COMPATIBLE_TLSæ˜¯ä¸€ç§è¿æ¥åˆ°å®‰å…¨ä½†ä¸æ˜¯å½“å‰HTTPSæœåŠ¡å™¨çš„å®‰å…¨é…ç½®ã€‚ CLEARTEXTæ˜¯ç”¨äºhttp://URL çš„ä¸å®‰å…¨é…ç½®ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒOkHttpå°†å°è¯•MODERN_TLSè¿æ¥ï¼ŒCOMPATIBLE_TLSå¦‚æœç°ä»£é…ç½®å¤±è´¥ï¼Œåˆ™å›é€€è¿æ¥ã€‚ æ¯ä¸ªè§„èŒƒä¸­çš„TLSç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶å¯éšæ¯ä¸ªç‰ˆæœ¬è€Œæ”¹å˜ã€‚ä¾‹å¦‚ï¼Œåœ¨OkHttp 2.2ä¸­ï¼Œæˆ‘ä»¬æ”¾å¼ƒäº†å¯¹SSL 3.0çš„æ”¯æŒæ¥å“åº”POODLEæ”»å‡»ã€‚è€Œåœ¨OkHttp 2.3æˆ‘ä»¬æ”¾å¼ƒäº†å¯¹RC4çš„æ”¯æŒã€‚ä¸æ‚¨çš„æ¡Œé¢ç½‘ç»œæµè§ˆå™¨ä¸€æ ·ï¼Œä¿æŒOkHttpçš„æœ€æ–°çŠ¶æ€æ˜¯ä¿æŒå®‰å…¨çš„æœ€ä½³æ–¹å¼ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„TLSç‰ˆæœ¬å’Œå¯†ç å¥—ä»¶æ¥æ„å»ºè‡ªå·±çš„è¿æ¥è§„èŒƒã€‚ä¾‹å¦‚ï¼Œè¿™ç§é…ç½®ä»…é™äºä¸‰ä¸ªå¤‡å—å¥½è¯„çš„å¯†ç å¥—ä»¶ã€‚å®ƒçš„ç¼ºç‚¹æ˜¯å®ƒéœ€è¦Android 5.0+å’Œä¸€ä¸ªç±»ä¼¼çš„å½“å‰ç½‘ç»œæœåŠ¡å™¨ã€‚ 1234567891011ConnectionSpec spec = new ConnectionSpec.Builder(ConnectionSpec.MODERN_TLS) .tlsVersions(TlsVersion.TLS_1_2) .cipherSuites( CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256, CipherSuite.TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, CipherSuite.TLS_DHE_RSA_WITH_AES_128_GCM_SHA256) .build();OkHttpClient client = new OkHttpClient.Builder() .connectionSpecs(Collections.singletonList(spec)) .build(); è¯ä¹¦é”å®šé»˜è®¤æƒ…å†µä¸‹ï¼ŒOkHttpä¿¡ä»»ä¸»æœºå¹³å°çš„è¯ä¹¦æƒé™ã€‚è¿™ä¸€æˆ˜ç•¥æœ€å¤§é™åº¦åœ°æé«˜äº†è¿æ¥æ€§ï¼Œä½†æ˜¯å®ƒå—åˆ°è¯ä¹¦é¢å‘æœºæ„çš„æ”»å‡»ï¼Œä¾‹å¦‚[2011å¹´DigiNotaræ”»å‡»ã€‚å®ƒè¿˜å‡å®šæ‚¨çš„HTTPSæœåŠ¡å™¨çš„è¯ä¹¦ç”±è¯ä¹¦é¢å‘æœºæ„ç­¾åã€‚ ä½¿ç”¨CertificatePinneræ¥é™åˆ¶å“ªäº›è¯ä¹¦å’Œè¯ä¹¦é¢å‘æœºæ„æ˜¯å¯ä¿¡çš„ã€‚è¯ä¹¦å›ºå®šå¢åŠ äº†å®‰å…¨æ€§ï¼Œä½†æ˜¯é™åˆ¶äº†æ‚¨çš„æœåŠ¡å™¨å›¢é˜Ÿæ›´æ–°å…¶TLSè¯ä¹¦çš„èƒ½åŠ›ã€‚å¦‚æœæ²¡æœ‰æœåŠ¡å™¨çš„TLSç®¡ç†å‘˜çš„åŒæ„ï¼Œè¯·å‹¿ä½¿ç”¨è¯ä¹¦é”å®šï¼ 1234567891011121314151617181920public CertificatePinning() &#123; client = new OkHttpClient.Builder() .certificatePinner(new CertificatePinner.Builder() .add("publicobject.com", "sha256/afwiKY3RxoMmLkuRW1l7QsPZTJPwDS2pdDROQjXw8ig=") .build()) .build();&#125;public void run() throws Exception &#123; Request request = new Request.Builder() .url("https://publicobject.com/robots.txt") .build(); Response response = client.newCall(request).execute(); if (!response.isSuccessful()) throw new IOException("Unexpected code " + response); for (Certificate certificate : response.handshake().peerCertificates()) &#123; System.out.println(CertificatePinner.pin(certificate)); &#125;&#125; è‡ªå®šä¹‰å¯ä¿¡è¯ä¹¦å®Œæ•´çš„ä»£ç ç¤ºä¾‹æ˜¾ç¤ºäº†å¦‚ä½•ç”¨è‡ªå·±çš„é›†åˆæ›¿æ¢ä¸»æœºå¹³å°çš„è¯ä¹¦é¢å‘æœºæ„ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œè¯·å‹¿åœ¨æ²¡æœ‰æœåŠ¡å™¨çš„TLSç®¡ç†å‘˜åŒæ„çš„æƒ…å†µä¸‹ä½¿ç”¨è‡ªå®šä¹‰è¯ä¹¦ï¼12345678910111213141516171819202122232425private final OkHttpClient client;public CustomTrust() &#123; SSLContext sslContext = sslContextForTrustedCertificates(trustedCertificatesInputStream()); client = new OkHttpClient.Builder() .sslSocketFactory(sslContext.getSocketFactory()) .build();&#125;public void run() throws Exception &#123; Request request = new Request.Builder() .url("https://publicobject.com/helloworld.txt") .build(); Response response = client.newCall(request).execute(); System.out.println(response.body().string());&#125;private InputStream trustedCertificatesInputStream() &#123; ... // Full source omitted. See sample.&#125;public SSLContext sslContextForTrustedCertificates(InputStream in) &#123; ... // Full source omitted. See sample.&#125; Events(äº‹ä»¶ç›‘å¬)äº‹ä»¶å…è®¸æ‚¨åœ¨åº”ç”¨ç¨‹åºçš„HTTPè°ƒç”¨ä¸­æ•è·åº¦é‡å€¼ã€‚ä½¿ç”¨äº‹ä»¶è¿›è¡Œç›‘è§†ï¼š HTTPè°ƒç”¨æ‚¨çš„åº”ç”¨ç¨‹åºçš„å¤§å°å’Œé¢‘ç‡ã€‚å¦‚æœä½ å£°æ˜äº†å¤ªå¤šçš„callsï¼Œæˆ–è€…ä½ çš„callså¤ªå¤§ï¼Œä½ åº”è¯¥çŸ¥é“å®ƒçš„ä¸€åˆ‡ è¿™äº›è°ƒç”¨åœ¨åº•å±‚ç½‘ç»œä¸Šçš„æ€§èƒ½ã€‚å¦‚æœç½‘ç»œæ€§èƒ½ä¸è¶³ï¼Œåˆ™éœ€è¦æ”¹å–„ç½‘ç»œæˆ–å°‘ç”¨ç½‘ç»œã€‚ è­¦å‘Šï¼šè¿™æ˜¯ä¸€ä¸ªéæœ€ç»ˆçš„APIã€‚ä»OkHttp 3.9å¼€å§‹ï¼Œæ­¤åŠŸèƒ½æ˜¯ä¸€ä¸ªä¸ç¨³å®šçš„é¢„è§ˆï¼šAPIå¯èƒ½ä¼šæ›´æ”¹ï¼Œå¹¶ä¸”å®ç°ä¸å®Œæ•´ã€‚æˆ‘ä»¬é¢„è®¡OkHttp 3.10æˆ–3.11å°†å®Œæˆè¿™ä¸ªAPIã€‚åœ¨æ­¤ä¹‹å‰ï¼Œå½“æ‚¨æ›´æ–°æ‚¨çš„OkHttpä¾èµ–å…³ç³»æ—¶ï¼Œè¯·å‡†å¤‡APIå’Œè¡Œä¸ºæ›´æ”¹ã€‚ äº‹ä»¶ç›‘å¬å­ç±» EventListener,è¦†ç›–æ‚¨æ„Ÿå…´è¶£çš„äº‹ä»¶çš„æ–¹æ³•ã€‚åœ¨æ²¡æœ‰é‡å®šå‘æˆ–é‡è¯•çš„æˆåŠŸHTTPè°ƒç”¨ä¸­ï¼Œäº‹ä»¶åºåˆ—ç”±æ­¤æµç¨‹æè¿°ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹äº‹ä»¶ä¾¦å¬å™¨ï¼Œå®ƒä½¿ç”¨æ—¶é—´æˆ³æ‰“å°æ¯ä¸ªäº‹ä»¶ã€‚123456789101112131415161718192021222324252627282930class PrintingEventListener extends EventListener &#123; private long callStartNanos; private void printEvent(String name) &#123; long nowNanos = System.nanoTime(); if (name.equals("callStart")) &#123; callStartNanos = nowNanos; &#125; long elapsedNanos = nowNanos - callStartNanos; System.out.printf("%.3f %s%n", elapsedNanos / 1000000000d, name); &#125; @Override public void callStart(Call call) &#123; printEvent("callStart"); &#125; @Override public void callEnd(Call call) &#123; printEvent("callEnd"); &#125; @Override public void dnsStart(Call call, String domainName) &#123; printEvent("dnsStart"); &#125; @Override public void dnsEnd(Call call, String domainName, List&lt;InetAddress&gt; inetAddressList) &#123; printEvent("dnsEnd"); &#125; ...&#125; æˆ‘ä»¬åšå‡ ä¸ªcallsï¼š123456789101112131415Request request = new Request.Builder() .url("https://publicobject.com/helloworld.txt") .build();System.out.println("REQUEST 1 (new connection)");try (Response response = client.newCall(request).execute()) &#123; // Consume and discard the response body. response.body().source().readByteString();&#125;System.out.println("REQUEST 2 (pooled connection)");try (Response response = client.newCall(request).execute()) &#123; // Consume and discard the response body. response.body().source().readByteString();&#125; ç›‘å¬å™¨æ‰“å°ç›¸åº”çš„äº‹ä»¶ï¼š12345678910111213141516171819202122232425262728REQUEST 1 (new connection)0.000 callStart0.010 dnsStart0.017 dnsEnd0.025 connectStart0.117 secureConnectStart0.586 secureConnectEnd0.586 connectEnd0.587 connectionAcquired0.588 requestHeadersStart0.590 requestHeadersEnd0.591 responseHeadersStart0.675 responseHeadersEnd0.676 responseBodyStart0.679 responseBodyEnd0.679 connectionReleased0.680 callEndREQUEST 2 (pooled connection)0.000 callStart0.001 connectionAcquired0.001 requestHeadersStart0.001 requestHeadersEnd0.002 responseHeadersStart0.082 responseHeadersEnd0.082 responseBodyStart0.082 responseBodyEnd0.083 connectionReleased0.083 callEnd æ³¨æ„ç¬¬äºŒæ¬¡è°ƒç”¨æ²¡æœ‰è¿æ¥äº‹ä»¶ã€‚å®ƒé‡ç”¨äº†ç¬¬ä¸€ä¸ªè¯·æ±‚çš„è¿æ¥ï¼Œä»¥æ˜¾ç€æé«˜æ€§èƒ½ã€‚ EventListener.Factoryåœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå­—æ®µcallStartNanosæ¥è·Ÿè¸ªæ¯ä¸ªäº‹ä»¶çš„ç»è¿‡æ—¶é—´ã€‚è¿™å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯å¦‚æœå¤šä¸ªè°ƒç”¨åŒæ—¶æ‰§è¡Œï¼Œå®ƒå°†ä¸èµ·ä½œç”¨ã€‚ä¸ºäº†é€‚åº”è¿™ä¸ªï¼Œä½¿ç”¨ä¸€ä¸ªFactoryåˆ›å»ºä¸€ä¸ªæ–°çš„EventListenerä¸ºæ¯ä¸ªCallã€‚è¿™å…è®¸æ¯ä¸ªç›‘å¬è€…ä¿æŒç‰¹å®šäºå‘¼å«çš„çŠ¶æ€ã€‚ æ­¤ç¤ºä¾‹å·¥å‚ä¸ºæ¯ä¸ªå‘¼å«åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„IDï¼Œå¹¶ä½¿ç”¨è¯¥IDåŒºåˆ†æ—¥å¿—æ¶ˆæ¯ä¸­çš„å‘¼å«ã€‚12345678910111213141516171819202122232425262728293031323334class PrintingEventListener extends EventListener &#123; public static final Factory FACTORY = new Factory() &#123; final AtomicLong nextCallId = new AtomicLong(1L); @Override public EventListener create(Call call) &#123; long callId = nextCallId.getAndIncrement(); System.out.printf("%04d %s%n", callId, call.request().url()); return new PrintingEventListener(callId, System.nanoTime()); &#125; &#125;; final long callId; final long callStartNanos; public PrintingEventListener(long callId, long callStartNanos) &#123; this.callId = callId; this.callStartNanos = callStartNanos; &#125; private void printEvent(String name) &#123; long elapsedNanos = System.nanoTime() - callStartNanos; System.out.printf("%04d %.3f %s%n", callId, elapsedNanos / 1000000000d, name); &#125; @Override public void callStart(Call call) &#123; printEvent("callStart"); &#125; @Override public void callEnd(Call call) &#123; printEvent("callEnd"); &#125; ...&#125; æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªä¾¦å¬å™¨æ¥ç«äº‰ä¸€å¯¹å¹¶å‘çš„HTTPè¯·æ±‚ï¼š12345678910111213Request washingtonPostRequest = new Request.Builder() .url("https://www.washingtonpost.com/") .build();client.newCall(washingtonPostRequest).enqueue(new Callback() &#123; ...&#125;);Request newYorkTimesRequest = new Request.Builder() .url("https://www.nytimes.com/") .build();client.newCall(newYorkTimesRequest).enqueue(new Callback() &#123; ...&#125;); è¿è¡Œè¿™åœºæ¯”èµ›çš„å®¶åº­æ— çº¿ç½‘ç»œæ˜¾ç¤ºï¼ŒTimesï¼ˆ0002ï¼‰æ¯”Postï¼ˆ0001ï¼‰ç•¥å¿«ä¸€ç‚¹ï¼š123456789101112131415161718192021222324252627282930313233340001 https://www.washingtonpost.com/0001 0.000 callStart0002 https://www.nytimes.com/0002 0.000 callStart0002 0.010 dnsStart0001 0.013 dnsStart0001 0.022 dnsEnd0002 0.019 dnsEnd0001 0.028 connectStart0002 0.025 connectStart0002 0.072 secureConnectStart0001 0.075 secureConnectStart0001 0.386 secureConnectEnd0002 0.390 secureConnectEnd0002 0.400 connectEnd0001 0.403 connectEnd0002 0.401 connectionAcquired0001 0.404 connectionAcquired0001 0.406 requestHeadersStart0002 0.403 requestHeadersStart0001 0.414 requestHeadersEnd0002 0.411 requestHeadersEnd0002 0.412 responseHeadersStart0001 0.415 responseHeadersStart0002 0.474 responseHeadersEnd0002 0.475 responseBodyStart0001 0.554 responseHeadersEnd0001 0.555 responseBodyStart0002 0.554 responseBodyEnd0002 0.554 connectionReleased0002 0.554 callEnd0001 0.624 responseBodyEnd0001 0.624 connectionReleased0001 0.624 callEnd è¯¥EventListener.Factoryè¿˜èƒ½å¤ŸæŒ‡æ ‡é™åˆ¶å‘¼å«çš„å­é›†ã€‚è¿™ä¸€ä¸ªéšæœºæ•è·æŒ‡æ ‡ä¸º10ï¼…ï¼š12345678910111213class MetricsEventListener extends EventListener &#123; private static final Factory FACTORY = new Factory() &#123; @Override public EventListener create(Call call) &#123; if (Math.random() &lt; 0.10) &#123; return new MetricsEventListener(call); &#125; else &#123; return EventListener.NONE; &#125; &#125; &#125;; ...&#125; äº‹ä»¶ä¸å¤±è´¥å½“æ“ä½œå¤±è´¥æ—¶ï¼Œè°ƒç”¨å¤±è´¥æ–¹æ³•ã€‚è¿™æ˜¯connectFailed()åœ¨å»ºç«‹åˆ°æœåŠ¡å™¨çš„è¿æ¥callFailed()æ—¶ï¼Œä»¥åŠHTTPè°ƒç”¨æ°¸ä¹…å¤±è´¥æ—¶çš„å¤±è´¥ã€‚å‘ç”Ÿæ•…éšœæ—¶ï¼Œstartäº‹ä»¶å¯èƒ½æ²¡æœ‰ç›¸åº”çš„endäº‹ä»¶ã€‚ äº‹ä»¶ä¸é‡è¯•å’Œè·Ÿè¿›OkHttpå…·æœ‰å¼¹æ€§ï¼Œå¯ä»¥è‡ªåŠ¨ä»ä¸€äº›è¿æ¥å¤±è´¥ä¸­æ¢å¤ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒconnectFailed()äº‹ä»¶ä¸æ˜¯ç»ˆç«¯ï¼Œä¹Ÿä¸æ˜¯éšä¹‹è€Œæ¥çš„callFailed()ã€‚å½“å°è¯•é‡è¯•æ—¶ï¼Œäº‹ä»¶ç›‘å¬å™¨å°†æ”¶åˆ°å¤šä¸ªç›¸åŒç±»å‹çš„äº‹ä»¶ã€‚ å•ä¸ªHTTPè°ƒç”¨å¯èƒ½éœ€è¦åç»­è¯·æ±‚æ¥å¤„ç†è®¤è¯æŒ‘æˆ˜ï¼Œé‡å®šå‘å’ŒHTTPå±‚è¶…æ—¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå°è¯•å¤šä¸ªè¿æ¥ï¼Œè¯·æ±‚å’Œå“åº”ã€‚è·Ÿè¿›æ˜¯å•ä¸ªç”µè¯å¯èƒ½è§¦å‘å¤šä¸ªç›¸åŒç±»å‹äº‹ä»¶çš„å¦ä¸€ä¸ªåŸå› ã€‚ å¯ç”¨æ€§OkHttp 3.9ä¸­çš„é¢„è§ˆç‰ˆæœ¬æä¾›äº†äº‹ä»¶ã€‚æˆ‘ä»¬é¢„è®¡OkHttp 3.10æˆ–3.11å°†å®Œæˆè¿™ä¸ªAPIã€‚æœªæ¥ç‰ˆæœ¬å¯èƒ½ä¼šå¼•å…¥æ–°çš„äº‹ä»¶ç±»å‹; æ‚¨å°†éœ€è¦è¦†ç›–ç›¸åº”çš„æ–¹æ³•æ¥å¤„ç†å®ƒä»¬ã€‚ FAQs(å¸¸è§é—®é¢˜è§£ç­”))å¦‚ä½•ä¿®å¤dalvikvmä¸­çš„éªŒè¯è­¦å‘Šï¼ŸOkHttpæ”¯æŒä¸€äº›éœ€è¦Java 7+æˆ–Android API 20+çš„APIã€‚å¦‚æœä½ åœ¨æ—©æœŸçš„Androidç‰ˆæœ¬ä¸Šè¿è¡ŒOkHttpï¼Œdalvikvmçš„éªŒè¯å™¨ä¼šè­¦å‘Šä½ ç¼ºå°‘çš„æ–¹æ³•ã€‚è¿™ä¸æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥å¿½ç•¥è­¦å‘Šã€‚12345678910111213141516I/dalvikvmï¹• Could not find method okhttp3.internal.huc.HttpURLConnectionImpl.getContentLengthLong, referenced from method okhttp3.internal.huc.HttpsURLConnectionImpl.getContentLengthLongW/dalvikvmï¹• VFY: unable to resolve virtual method 21498: Lokhttp3/internal/huc/HttpURLConnectionImpl;.getContentLengthLong ()JD/dalvikvmï¹• VFY: replacing opcode 0x6e at 0x0002I/dalvikvmï¹• Could not find method okhttp3.internal.huc.HttpURLConnectionImpl.getHeaderFieldLong, referenced from method okhttp3.internal.huc.HttpsURLConnectionImpl.getHeaderFieldLongW/dalvikvmï¹• VFY: unable to resolve virtual method 21503: Lokhttp3/internal/huc/HttpURLConnectionImpl;.getHeaderFieldLong (Ljava/lang/String;J)JD/dalvikvmï¹• VFY: replacing opcode 0x6e at 0x0002W/dalvikvmï¹• VFY: unable to find class referenced in signature (Ljava/nio/file/Path;)W/dalvikvmï¹• VFY: unable to find class referenced in signature ([Ljava/nio/file/OpenOption;)I/dalvikvmï¹• Could not find method java.nio.file.Files.newOutputStream, referenced from method okio.Okio.sinkW/dalvikvmï¹• VFY: unable to resolve static method 24080: Ljava/nio/file/Files;.newOutputStream (Ljava/nio/file/Path;[Ljava/nio/file/OpenOption;)Ljava/io/OutputStream;D/dalvikvmï¹• VFY: replacing opcode 0x71 at 0x000aW/dalvikvmï¹• VFY: unable to find class referenced in signature (Ljava/nio/file/Path;)W/dalvikvmï¹• VFY: unable to find class referenced in signature ([Ljava/nio/file/OpenOption;)I/dalvikvmï¹• Could not find method java.nio.file.Files.newInputStream, referenced from method okio.Okio.sourceW/dalvikvmï¹• VFY: unable to resolve static method 24079: Ljava/nio/file/Files;.newInputStream (Ljava/nio/file/Path;[Ljava/nio/file/OpenOption;)Ljava/io/InputStream;D/dalvikvmï¹• VFY: replacing opcode 0x71 at 0x000a]]></content>
      <categories>
        <category>å®‰å“å¼€æºåº“ä½¿ç”¨æ•™ç¨‹</category>
      </categories>
      <tags>
        <tag>okhttp3</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android Studioä½¿ç”¨æŠ€å·§å’Œèµ„æº]]></title>
    <url>%2FAndroidStudio_uses_skills_and_resources.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡è½¬è½½è‡ª:http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2016/1116/6776.html.ç‰ˆæƒå½’åŸä½œè€…æ‰€æœ‰ å¯¹äºAndroidStudioçš„ä½¿ç”¨ï¼Œæ—¥å¸¸ä½¿ç”¨æ²¡é—®é¢˜ï¼Œä½†ä¾æ—§æœ‰äº›å¿«æ·æŠ€å·§æ²¡æœ‰ä¹ æƒ¯ä½¿ç”¨,å› æ­¤è½¬è½½æœ¬ç¯‡æ–‡ç« å¸¸è¯»ï¼Œå¸Œæœ›å¯¹æ–‡ç« çš„æŠ€å·§æœ‰äº›è®°å¿†ï¼Œåšåˆ°ä»¥åçš„ç†Ÿç»ƒä½¿ç”¨ æœ¬æ–‡åˆ—ä¸¾å‡ºä¸€äº›å¯ä»¥æé«˜æ•´ä½“æ•ˆç‡çš„Android StudioæŠ€å·§å’Œèµ„æºã€‚ æ˜¾ç„¶æœ‰å¤ªå¤šå¤ªå¤šè¿™æ–¹é¢çš„ä¸œè¥¿ï¼Œä½†æ˜¯ä¸ºäº†æ–‡ç« çš„ç®€æ´æ€§ï¼Œæˆ‘æŠŠå®ƒé™åˆ¶åœ¨50ä¸ªä»¥å†…ï¼Œå¸Œæœ›ä½ èƒ½å–œæ¬¢ï¼ è§†è§‰æ•ˆæœ1.Android Logcatçš„Materialé¢œè‰²ä¸»é¢˜ã€‚è¦æ”¹å˜Android Studioçš„Logcatä½ éœ€è¦è¿™æ ·åšï¼šè¿›å…¥Preferences (Windowsä¸Šæ˜¯Settings / Linux machines) â†’ Editor â†’ Colors &amp; Fonts â†’ Android Logcatï¼Œç„¶åä¸ºæ¯ç§ç±»å‹çš„logè®¾ç½®å‰æ™¯é¢œè‰²ï¼ˆforegroundï¼‰ã€‚ æˆ‘ä½¿ç”¨çš„materialé¢œè‰²ï¼š Assert #BA68C8Debug #2196F3Error #F44336Info #4CAF50Verbose #BBBBBBWarning #FF9800æ³¨æ„é‡Œé¢æœ‰å‡ ä¸ªç°æœ‰çš„ä¸»é¢˜ï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹ç°æœ‰ä¸»é¢˜ï¼ˆä¸å»ºè®®ï¼‰ï¼Œæˆ–è€…ç‚¹å‡»save asæŒ‰é’®æ‹·è´ä¸€ä¸ªä¸»é¢˜å¹¶æ”¹åä¸ºMaterial theme Colorç„¶åå†æ”¹å˜æ¯ç§ç±»å‹logçš„é¢œè‰²ã€‚ 2.é˜²æ­¢å½“å‰åº”ç”¨å´©æºƒæ—¶Logcatæ¸…é™¤logã€‚ åœ¨Android Monitoré¢æ¿çš„å³ä¸Šæ–¹ç‚¹å‡»ä¸‹æ‹‰èœå•ä¸­çš„Edit filter configurationï¼šæ³¨æ„æ˜¯åœ¨å·¥ç¨‹ç•Œé¢çš„åº•éƒ¨Android Monitoré¢æ¿ï¼Œè€Œä¸æ˜¯å•ç‹¬çš„Android Monitorå·¥å…·ä¸­ã€‚ 3.ä½¿ç”¨ä¸€ä¸ªé€‚åˆè‡ªå·±çš„ä»£ç ä¸»é¢˜ (IntelliJ / Android Studio). æ‰¾åˆ°Preferences â†’ Code Style â†’ Javaï¼Œåœ¨Schemeä¸‹æ‹‰èœå•ä¸­ä½ å¯ä»¥é€‰æ‹©ä¸€ä¸ªä»£ç é£æ ¼ï¼ˆæˆ–è€…è®¾ç½®ä¸€ä¸ªæ–°çš„ï¼‰ã€‚ æœ‰ä¸¤ä¸ªé£æ ¼å€¼å¾—ä¸“é—¨æä¸€ä¸‹ï¼š Square Java Code Styles with Android Google Java Code Style ä½ å¯ä»¥æŒ‰ç…§ä¸‹é¢gifå›¾ä¸­çš„åšæ³•å¯¼å…¥ä¸»é¢˜ï¼š .ä½¿ç”¨åˆ†å±æé«˜æ•ˆç‡ è¦æ‰“å¼€è¿™ä¸ªåŠŸèƒ½ï¼Œå³é”®ä¸»å±å¹•çš„é€‰é¡¹å¡ï¼ˆtabï¼‰é€‰æ‹© Split Vertically / Horizontallyã€‚ä½†æ˜¯ä¸ºäº†å°½é‡æé«˜æ•ˆç‡æˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªè‡ªå®šä¹‰çš„å¿«æ·æ–¹å¼ã€‚ä¸ºæ­¤æ‰¾åˆ°åˆ°Preferences â†’ Keymapï¼Œæœç´¢Split Verticallyã€‚ç„¶åæ‰“å¼€ä¸€ä¸ªä¸Šä¸‹æ–‡èœå•ï¼Œç‚¹å‡»Add Keyboard Shortcutã€‚ æˆ‘çš„åˆ†å±ï¼ˆverticalï¼‰å¿«æ·é”®è®¾ç½®çš„æ˜¯control + alt + vã€‚åšæ³•å¦‚ä¸‹é¢çš„gifå›¾æ‰€ç¤ºã€‚åŒæ ·çš„ä½ è¿˜å¯ä»¥ä¸º horizontal splitè®¾ç½®å¿«æ·é”®ã€‚ 5.æ— å¹²æ‰°æ¨¡å¼ä½ å¯ä»¥åˆ°View â†’ Enter Distraction Free Modeé‡Œå¯ç”¨å®ƒ åœ¨æ— å¹²æ‰°æ¨¡å¼ä¸‹ï¼Œç¼–è¾‘å™¨å æ®äº†æ•´ä¸ªIntelliJIDEAçª—å£ï¼Œæ²¡æœ‰ä»»ä½•tabæˆ–è€…å·¥å…·æŒ‰é’®ã€‚ä»£ç å±…ä¸­æ˜¾ç¤º 6.ä½¿ç”¨Live Templates ä½ å¯ä»¥ä½¿ç”¨å¿«æ·é”®ï¼šcmd + j (Windows / Linux: ctrl + j)ã€‚ å¯ä»¥ä½¿ç”¨å·²ç»å®šä¹‰å¥½äº†çš„Live Templatesï¼Œæ¯”å¦‚Toasts æˆ–è€…ifè¯­å¥ã€‚ å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„templatesã€‚è¿™é‡Œæ˜¯Reto Meierçš„ä¸€ç¯‡ä¸é”™çš„å‚è€ƒæ–‡ç« ã€‚ä½ ä¹Ÿå¯ä»¥å‚è€ƒIntelliJ IDEAçš„æ–‡æ¡£. å¿«æ·é”®ä»¥åŠæœ‰ç”¨çš„å‘½ä»¤1.æœ€æœ‰ç”¨çš„å‘½ä»¤æ˜¯æœç´¢å‘½ä»¤çš„å‘½ä»¤ï¼šcmd + shift + a (Windows / Linux: ctrl + shift + a)ã€‚ å‡è®¾ä½ æƒ³å…³é—­å½“å‰tabå´ä¸çŸ¥é“æ€ä¹ˆåšï¼Œä½ åªéœ€è¾“å…¥closeä½ å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ­£ç¡®çš„å¿«æ·é”®/å‘½ä»¤ã€‚ 2.é€‰æ‹©æœ€è¿‘çš„å¤åˆ¶ç²˜è´´ï¼ˆç®¡ç†å‰ªåˆ‡ç‰ˆï¼‰ï¼šcmd + shift + v (Windows / Linux: ctrl + shift + v)ã€‚é»˜è®¤æœ‰5ä¸ªæœ€è¿‘çš„å¤åˆ¶/ç²˜è´´å…ƒç´ ã€‚ 3.å¯ç”¨å¤šå…‰æ ‡åŠŸèƒ½ï¼šcontrol + g (alt + j for Windows / Linux)ã€‚ 4.æ‰“å¼€ä¸€ä¸ªç±»ï¼š cmd + o (Windows / Linux: ctrl + n)ã€‚ 5.æ‰“å¼€ä»»æ„æ–‡ä»¶ï¼š cmd + shift + o (Windows / Linux: ctrl + shift + n)ã€‚ 6.æ‰“å¼€symbolï¼šcmd + option + o (Windows / Linux: alt + shift + n)ã€‚ 7.è·³åˆ°å®ç°ï¼šcmd + option + b (Windows / Linux:ctrl + alt + b)ã€‚ å‡å¦‚ä½ æœ‰ä¸€ä¸ªinterfaceã€‚é€šè¿‡ç‚¹å‡»æ¥å£çš„åå­—ï¼Œç„¶åæŒ‰ä¸‹å¿«æ·é”®å°±å¯ä»¥è·³è½¬åˆ°è¿™ä¸ªæ¥å£çš„å®ç°ã€‚å¦‚æœæœ‰å¤šä¸ªå®ç°ä¼šå‡ºç°ä¸‹æ‹‰é€‰æ‹©ã€‚ 8.è·³è½¬åˆ°å®šä¹‰ï¼šcmd + b (Windows / Linux: ctrl + b)ã€‚ å¯ä»¥è®©ä½ å¿«é€Ÿè·³è½¬åˆ°ä¸€ä¸ªç±»ï¼Œæ–¹æ³•æˆ–è€…å˜é‡è¢«å®šä¹‰çš„åœ°æ–¹ã€‚ 9.è·³è½¬åˆ°ç±»å‹å®šä¹‰å¤„ï¼šcontrol + shift + b (Windows / Linux:ctrl + shift + b)ã€‚ å‡è®¾ä½ å®šä¹‰äº†ï¼š Employee employee = new Employee(â€œMichalâ€); å½“ä½ çš„æ’å…¥ç¬¦å·åœ¨employeeä¸Šï¼Œè¿™æ—¶ä½ æŒ‰ä¸‹å¿«æ·é”®ï¼Œä½ å°†è·³è½¬åˆ°Employeeç±»ä¸­ã€‚ 10.è·³è½¬åˆ°superï¼š cmd + u (Windows / Linux: ctrl + u)ã€‚ æ¯”å¦‚ï¼Œä½ é‡å†™äº†ä¸€äº›æ–¹æ³•,å½“ä½ çš„æ’å…¥ç¬¦å·åœ¨æ–¹æ³•åä¸Šï¼ŒæŒ‰ä¸‹è¿™ä¸ªå¿«æ·é”®ä½ å°†è·³è½¬åˆ°parentçš„è¿™ä¸ªæ–¹æ³•ã€‚ 11.Move between tabs: cmd + shift + (move left) or cmd + shift + (Windows / Linux: alt + â† / â†’). 12 Move between Design / Text tabs in layoutâ€™s view:control + shift + â† / â†’ (Windows / Linux: alt + shift + â† / â†’). 13.å…³é—­å½“å‰çš„tabï¼šcmd + w (Windows / Linux: ctrl + shift + a)ã€‚ 14.éšè—æ‰€æœ‰çª—å£ï¼šcmd + shift + F12 (Windows / Linux:ctrl + shift + F12)ã€‚ 15.æœ€å°åŒ– Android Studio instance: cmd + m (Windows / Linux:ctrl + m)ã€‚ 16.æ ¼å¼åŒ–ä»£ç : cmd + option + l (Windows / Linux:ctrl + alt + l)ã€‚ 17.Auto-indent lines: control + option + i (Windows / Linux:ctrl + alt + i). 18.å®ç°æ¥å£çš„æ–¹æ³•: control + i (Windows / Linux: ctrl + i)ã€‚ å‡è®¾ä½ è¦å®ç°ä¸€ä¸ªæ¥å£ã€‚è¿™ä¸ªå¿«æ·é”®å¯ä»¥è®©ä½ å¿«é€Ÿå¯¼å…¥è¿™ä¸ªæ¥å£çš„æ‰€æœ‰æ–¹æ³•ã€‚ 19.Smart code completion (filters the list of methods and variables by expected type): control + shift + space (Windows / Linux: ctrl + shift + space). 20.æŸ¥æ‰¾: cmd + f (Windows / Linux: ctrl + f)ã€‚ 21.æŸ¥æ‰¾å¹¶æ›¿æ¢: cmd + r (Windows / Linux: ctrl + r)ã€‚ 22.æŠŠä¸€ä¸ªç¡¬ç¼–ç çš„å­—ç¬¦ä¸²æ”¾åˆ°èµ„æºæ–‡ä»¶ä¸­ï¼šoption + return (Windows / Linux: alt + enter)ã€‚å…‰æ ‡å¿…é¡»åœ¨è¿™ä¸ªæ–‡å­—ä¹‹ä¸Šæ—¶æ‰èƒ½ä½¿ç”¨è¿™ä¸ªå¿«æ·é”®ã€‚çœ‹ä¸‹é¢çš„gifå›¾ï¼š æ’ä»¶1.Key promoter - å¿«æ·é”®æç¤ºæ’ä»¶ å½“ä½ ç‚¹å‡»é¼ æ ‡ä¸€ä¸ªåŠŸèƒ½çš„æ—¶å€™,å¯ä»¥æç¤º ä½ è¿™ä¸ªåŠŸèƒ½å¿«æ·é”®æ˜¯ä»€ä¹ˆ ,å’Œè¿™ä¸ªæŒ‰é’®ä½ çš„ä½¿ç”¨é¢‘ç‡ 2.String Manipulation - a plugin which provides actions for text manipulation (e.g. toggling styles like camelCase, hyphen-lowercase etc., capitalize text and many more). 3.Android Material Design Icon Generator -è¿™ä¸ªæ’ä»¶å¸®åŠ©ä½ ä¸ºå·¥ç¨‹æ·»åŠ Material Designå›¾æ ‡ã€‚å®‰è£…ä¹‹åä½¿ç”¨å¿«æ·é”®cmd + shift + mç”Ÿæˆä¸€ä¸ªå›¾æ ‡ã€‚ 4.ButterKnifeZelezny - ä¸€é”®ä» å¸ƒå±€æ–‡ä»¶ä¸­ ç”Ÿæˆå¯¹äºçš„ View å£°æ˜å’Œ ButterKnife æ³¨è§£ï¼š 5.IntelliJ/Android Studio Plugin for Android Parcelable boilerplate code generation - ä¸€ä¸ªæ ¹æ®ç±»çš„æˆå‘˜ç”ŸæˆParcelableçš„æ’ä»¶ã€‚ 6.ADB Idea - ä¸€ä¸ªå¸®åŠ©ä½ ä½¿ç”¨adbå‘½ä»¤çš„æ’ä»¶ï¼šå¸è½½ï¼Œæ€æ­»ï¼Œå¯åŠ¨ï¼Œé‡å¯ï¼Œæ¸…é™¤æ•°æ®ç­‰å‘½ä»¤ã€‚ 7.Genymotion plugin - ä¸€ä¸ªè®©ä½ å¯ä»¥åœ¨Android Studioä¸­åˆ›å»ºå’Œå¼€å¯Genymotionè™šæ‹Ÿè®¾å¤‡çš„æ’ä»¶ã€‚ 8.Android Methods Count - a plugin that parses your Android library dependencies and shows the methods count as an handy hint. 9.Git Flow Integration - a plugin for introducing a Git Flow branching model. 10.Builder plugin - a plugin (from Square) that generates a static nested Builder for a class. èµ„æº1.Android Studio Tips of the Day by Philippe Breault2.å¿«æ·é”®å‚è€ƒ3.(About) 10 Things You (Probably) Didnâ€™t Know You Could do in Android Studio by Reto Meierã€‚ä¸­æ–‡ç‰ˆï¼š10ä¸ªä½ å¯èƒ½ä¸çŸ¥é“çš„ Android StudioæŠ€å·§ã€‚ 4.æ— é¼ æ ‡å¼€å‘ by Hadi Hariri6.Android Studio for Experts (Android Dev Summit 2015)7.Android Studio Tips and Tricks by Michael Evans8.è®¤è¯† Android Studio9.Android Studio - Tips and Tricks by Donn Felker10.Debug Your App with Android Studio11.What are some of your must-have plugins for - Reddit discussion]]></content>
      <categories>
        <category>AndroidStudio</category>
      </categories>
      <tags>
        <tag>AndroidStudio</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android5.0æ–°æ§ä»¶å­¦ä¹ ]]></title>
    <url>%2FAndroid5-0-control-study-AppBarLayout-Toolbar-CoordinateLayout-cardView.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æœ¬æ–‡è®°å½•ä¸€äº›Androd5.0çš„æ–°æ§ä»¶çš„ä¸€äº›å­¦ä¹ æ€»ç»“ï¼Œç”±äºç½‘ä¸Šçš„åšæ–‡æ€»ç»“çš„æ¯”è¾ƒå…¨é¢ï¼Œæˆ‘å°±ä¸å†™åšæ–‡æ€»ç»“äº†ï¼Œè¿™é‡Œä¸»è¦æ˜¯åˆ—ä¸¾ä¸€äº›æ§ä»¶çš„å­¦ä¹ èµ„æ–™ CoordinateLayoutç®€ä»‹ï¼šåè°ƒå¸ƒå±€,é…åˆBehaviorä½¿ç”¨ï¼Œç‰¹ç‚¹æ˜¯èƒ½æ ¹æ®ä¸€ä¸ªViewçš„åŠ¨ä½œåè°ƒå¦ä¸€ä¸ªViewçš„åŠ¨ä½œã€‚å‚è€ƒæ–‡ç« :CoordinatorLayoutçš„ä½¿ç”¨å¦‚æ­¤ç®€å• ToolBarç®€ä»‹ï¼šä»£æ›¿ActionBarï¼Œæ¯”å®ƒæ›´åŠ çš„çµæ´»ï¼Œå®è´¨æ˜¯ä¸€ä¸ªViewGroup å‚è€ƒèµ„æ–™:Android 5.x Theme ä¸ ToolBar å®æˆ˜xamarin android toolbar(è¸©å‘å®Œå…¨å…¥é—¨è¯¦è§£) AppBarLayoutç®€ä»‹ï¼šç»§æ‰¿è‡ªLinearLayout,å®ƒå¯ä»¥è®©ä½ å®šåˆ¶å½“æŸä¸ªå¯æ»šåŠ¨Viewæ‰‹åŠ¿å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå…¶å†…éƒ¨å­Viewä¼šå®ç°ä½•ç§åŠ¨ä½œ. CollapsingToolbarLayoutç®€ä»‹ï¼šç”¨æ¥å¯¹ToolBarè¿›è¡Œå†æ¬¡åŒ…è£…çš„ViewGroupï¼Œå¯ä»¥å®ç°ä¸€äº›æŠ˜å çš„æ•ˆæœï¼ˆæ›´åƒæ˜¯ç¼©æ”¾ï¼‰ï¼Œæ¯”å¦‚å‘ä¸Šæ»‘åŠ¨æ ‡é¢˜æ–‡å­—é€æ¸ç¼©å°è‡³å·¦ä¸Šè§’ï¼Œå®ƒéœ€è¦ä½œä¸ºAppBarLayoutå¸ƒå±€é‡Œé¢å¹¶ä½œä¸ºå®ƒçš„ç›´æ¥å­View. NestedScrollViewç®€ä»‹ï¼šä¸ºäº†é…åˆAppBarLayoutçš„æ»šåŠ¨æ•ˆæœè€Œç¼–å†™çš„æ»šåŠ¨æ§ä»¶ï¼Œç»§æ‰¿è‡ªFrameLayout,éšåä½¿ç”¨appbar_scrolling_view_behaviorå³å¯å®ç°ç›¸åº”çš„æ•ˆæœ å‚è€ƒæ–‡ç« :ç©è½¬AppBarLayoutï¼Œæ›´é…·ç‚«çš„é¡¶éƒ¨æ  CardViewç®€ä»‹ï¼šå¡ç‰‡å¸ƒå±€ï¼Œç»§æ‰¿è‡ªFrameLayoutï¼Œå¯å®ç°é˜´å½±æ•ˆæœ,é€šå¸¸ä¸RecycleViewæˆ–ListViewé…åˆä½¿ç”¨ä½œä¸ºitemçš„å®¹å™¨å‚è€ƒèµ„æ–™:CardViewçš„åŸºæœ¬ç”¨æ³• RecyclerViewç®€ä»‹ï¼šæ¯”ListViewæ›´åŠ çµæ´»ï¼Œæ›´ä½è€¦åˆçš„åˆ—è¡¨å±•ç¤ºæ§ä»¶ï¼Œå¯è½»æ˜“å®ç°ListView,GridView,å’Œç€‘å¸ƒæµçš„æ•ˆæœ å‚è€ƒèµ„æ–™: Android RecyclerView ä½¿ç”¨å®Œå…¨è§£æ ä½“éªŒè‰ºæœ¯èˆ¬çš„æ§ä»¶ FloatingActionButtonç®€ä»‹ï¼šç”¨æ¥åœ¨ç•Œé¢ä¸Šæ˜¾ç¤ºä¸€ä¸ªæ‚¬æµ®çš„æŒ‰é’®å‚è€ƒèµ„æ–™ï¼šFloatingActionButton å®Œå…¨è§£æ[Design Support Library(2)] TextInputLayoutç®€ä»‹ï¼šé€šå¸¸ä¸EditTexté…åˆä½¿ç”¨ï¼Œèƒ½åœ¨EditTextè¾“å…¥æ—¶å°†hintæ”¾å…¥åˆ°ä¸Šæ–¹ï¼Œè¿˜å…·æœ‰ç©ºæ ¡éªŒçš„åŠŸèƒ½ å‚è€ƒèµ„æ–™ï¼šTextInputlayoutå…¥é—¨è®²è§£Android Design TextInputLayout è§£æ,å¸¦ä½ æ·±å…¥TextInputLayout TabLayoutç®€ä»‹ï¼šæä¾›ä¸€ä¸ªæ°´å¹³çš„å¸ƒå±€æ¥å±•ç¤ºTAB å‚è€ƒèµ„æ–™ï¼šDesignåº“-TabLayoutå±æ€§è¯¦è§£TabLayoutçš„é«˜ç«¯ç”¨æ³• NavigationViewç®€ä»‹:åœ¨Material Designä¸­ï¼ŒNavigation drawerå¯¼èˆªæŠ½å±‰ï¼Œè¢«è®¾è®¡ç”¨äºåº”ç”¨å¯¼èˆªï¼Œæä¾›äº†ä¸€ç§é€šç”¨çš„å¯¼èˆªæ–¹å¼ï¼Œä½“ç°äº†è®¾è®¡çš„ä¸€è‡´æ€§ã€‚è€ŒNavigationViewçš„å…¸å‹ç”¨é€”å°±æ˜¯é…åˆä¹‹å‰v4åŒ…çš„DrawerLayoutï¼Œä½œä¸ºå…¶ä¸­çš„Draweréƒ¨åˆ†ï¼Œå³å¯¼èˆªèœå•çš„æœ¬ä½“éƒ¨åˆ†ã€‚NavigationViewæ˜¯ä¸€ä¸ªå¯¼èˆªèœå•æ¡†æ¶ï¼Œä½¿ç”¨menuèµ„æºå¡«å……æ•°æ®ï¼Œä½¿æˆ‘ä»¬å¯ä»¥æ›´ç®€å•é«˜æ•ˆçš„å®ç°å¯¼èˆªèœå•ã€‚å®ƒæä¾›äº†ä¸é”™çš„é»˜è®¤æ ·å¼ã€é€‰ä¸­é¡¹é«˜äº®ã€åˆ†ç»„å•é€‰ã€åˆ†ç»„å­æ ‡é¢˜ã€ä»¥åŠå¯é€‰çš„Headerã€‚ å‚è€ƒèµ„æ–™ï¼š Android5.0ä¹‹NavigationViewçš„ä½¿ç”¨ Snackbarç®€ä»‹ï¼šä¸Toastç›¸ä¼¼,å¼¹å‡ºä¸€ä¸ªæç¤ºæ¡† å‚è€ƒèµ„æ–™ï¼šæ²¡æ—¶é—´è§£é‡Šäº†ï¼Œå¿«ä½¿ç”¨Snackbar!â€”â€”Android SnackbarèŠ±å¼ä½¿ç”¨æŒ‡å— Paletteç®€ä»‹ï¼šå–è‰²å™¨ï¼Œä»å›¾ç‰‡ä¸­æå–å…³é”®çš„é¢œè‰²ï¼Œå¹¶å°†è¯¥é¢œè‰²è®¾ç½®åˆ°åˆ«çš„æ§ä»¶ä¸Š,å¯ä»¥å’ŒToolBaré…åˆä½¿ç”¨åŠ¨æ€æ”¹å˜é¢œè‰²å‚è€ƒèµ„æ–™:å®‰å“5.xçš„Paletteä¹‹ä½ ä¸çŸ¥é“çš„äº‹ Android Material Designä¹‹Toolbarä¸Paletteå®è·µ RippleDrawableç®€ä»‹ï¼š5.0ä»¥ä¸Šçš„æ¶Ÿæ¼ªæ•ˆæœ,éœ€è¦å…¼å®¹5.0ä»¥ä¸‹éœ€è¦ä½¿ç”¨å¼€æºåº“RippleEffect.å‚è€ƒèµ„æ–™ï¼šMaterial Designä¹‹RippleDrawableè¯¦è§£]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
        <category>å®‰å“æ§ä»¶</category>
      </categories>
      <tags>
        <tag>Android5.0</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€äº›å…³äºå®‰å“éç¼–ç é—®é¢˜çš„è§£å†³æ–¹æ¡ˆè®°å½•]]></title>
    <url>%2F%E4%B8%80%E4%BA%9B%E5%85%B3%E4%BA%8E%E5%AE%89%E5%8D%93%E9%9D%9E%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E8%AE%B0%E5%BD%95.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. å®‰å“çš„ä¸€äº›éç¼–ç é—®é¢˜çš„ä¸€äº›è§£å†³æ–¹æ¡ˆè®°å½•ï¼Œå¦‚æ‰“åŒ…ï¼ŒåŠ å¯†ç­‰.. å®‰å“è‡ªåŠ¨åŒ–æ‰“åŒ…å‘å¸ƒå·¥ä½œæµ,ç­¾ååŠ å¯†è§£å†³æ–¹æ¡ˆï¼šå¯ä½¿ç”¨Travis CIé¡¹ç›®æ¡†æ¶ æœªè‡ªåŠ¨åŒ–å‰å®‰å“å¼€å‘çš„å·¥ä½œæµç¨‹ï¼š å¼€å‘ä¸€äº›æ–°åŠŸèƒ½ï¼Œæäº¤ä»£ç  å®Œæˆä¸€éƒ¨åˆ†åŠŸèƒ½åï¼Œæ‰“åŒ…ä¸€ä¸ªæµ‹è¯•ç‰ˆAPK å°†æµ‹è¯•ç‰ˆAPKä¸Šä¼ åˆ°QQç¾¤ / ç½‘ç›˜ / Fir.im / è’²å…¬è‹±ç­‰ åœ¨QQç¾¤æˆ–å‘å¸ƒå¹³å°è§£é‡Šå½“å‰ç‰ˆæœ¬æ‰€å®Œæˆçš„åŠŸèƒ½ é€šçŸ¥æµ‹è¯•äººå‘˜æµ‹è¯• å®ç°äº†è¿™å¥—è‡ªåŠ¨åŒ–å‘å¸ƒåï¼Œå·¥ä½œæµç¨‹è¢«ç®€åŒ–æˆï¼š å¼€å‘æ–°åŠŸèƒ½ï¼Œæäº¤ä»£ç  é€šè¿‡git tagå¯¹ä»£ç æ‰“ä¸€ä¸ªå†…æµ‹ç‰ˆçš„tagï¼Œåœ¨tagçš„æè¿°ä¸­å¯¹å†™å½“å‰å®Œæˆçš„åŠŸèƒ½ æ­¤å¤–è¿˜æ”¯æŒç­¾ååŠ å¯†ï¼šåŠ å¯†å‰:1234567891011121314151617android &#123; signingConfigs &#123; releaseConfig &#123; storeFile file(&quot;../keys/evandroid.jks&quot;) storePassword &quot;123456&quot; keyAlias &quot;evandroid_alias&quot; keyPassword &quot;654321&quot; &#125; &#125; buildTypes &#123; release &#123; minifyEnabled false proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos; signingConfig signingConfigs.releaseConfig &#125; &#125;&#125; åŠ å¯†åï¼š123456releaseConfig &#123; storeFile file(&quot;../keys/evandroid.jks&quot;) storePassword project.hasProperty(&quot;KEYSTORE_PASS&quot;) ? KEYSTORE_PASS : System.getenv(&quot;KEYSTORE_PASS&quot;) keyAlias project.hasProperty(&quot;ALIAS_NAME&quot;) ? ALIAS_NAME : System.getenv(&quot;ALIAS_NAME&quot;) keyPassword project.hasProperty(&quot;ALIAS_PASS&quot;) ? ALIAS_PASS : System.getenv(&quot;ALIAS_PASS&quot;)&#125; å¯†é’¥å®Œå…¨ä»åå°è·å– å…³äºTravis CIçš„èµ„æ–™: åŸºäºTravis CIæ­å»ºAndroidè‡ªåŠ¨æ‰“åŒ…å‘å¸ƒå·¥ä½œæµï¼ˆæ”¯æŒGithub ReleaseåŠfir.im) å®‰å“å¤šæ¸ é“æ‰“åŒ…(åŒæ—¶æ‰“900ä¸ªæ¸ é“åŒ…æ€ä¹ˆåŠï¼Ÿï¼Ÿï¼Ÿ)è§£å†³æ–¹æ¡ˆï¼šV1ç­¾åä¸‹çš„å¿«é€Ÿæ‰“åŒ…å·¥å…·ï¼šAndroidMultiChannelBuildTool ä¸ç®¡å¤šå°‘æ¸ é“åŒ…ï¼Œåˆ†åˆ†é’Ÿæ‰“å®Œã€‚ V2ç­¾åæ‰“åŒ…:å¦‚æœå…¬å¸éœ€è¦å‡çº§åˆ°V2ç­¾å,é‚£ä¹ˆä¸Šé¢é‚£ä¸ªå°±ä¸åœ¨é€‚ç”¨ï¼Œè¯·ç§»æ­¥åˆ°è¿™ä¸ª:walle,ç¾å›¢é’ˆå¯¹V2ç­¾åè®¾è®¡çš„æ‰“åŒ…å·¥å…·ï¼Œä¸è¿‡ä½¿ç”¨æ–¹å¼ä¸ä¸Šé¢çš„é‚£ä¸ªä¸åŒï¼Œéœ€è¦åœ¨é¡¹ç›®ä¸­æ·»åŠ æ’ä»¶å¹¶ç”¨Gradleæ„å»ºæ‰“åŒ….]]></content>
      <categories>
        <category>å®‰å“æ‚è®°</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[objectBoxæ•°æ®åº“ä½¿ç”¨æ•™ç¨‹]]></title>
    <url>%2FobjectBox%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B-objectbox-java.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æ•°æ®åº“ç®€ä»‹objectboxæ•°æ®åº“æ˜¯greenrobotå›¢é˜Ÿå¼€å‘çš„å…¨æ–°éå…³ç³»å‹æ•°æ®åº“æ¡†æ¶ï¼Œè¯¥å›¢é˜Ÿè¿˜å¼€å‘è¿‡greenDao,EventBusç­‰çƒ­é—¨æ¡†æ¶ï¼Œå¯è°“å®åŠ›é›„åšã€‚æŒ‰ç…§å®˜æ–¹ä»‹ç»ï¼Œè¯¥åº“æœ‰å¦‚ä¸‹ç‰¹ç‚¹: è¶…å¿«é€Ÿ:å·ç§°èƒœè¿‡æµ‹è¯•è¿‡çš„æ‰€æœ‰åµŒå…¥å¼æ•°æ®åº“ é¢å‘å¯¹è±¡çš„ API: æ²¡æœ‰ rowsã€columns å’Œ SQLï¼Œå®Œå…¨ä»0å¼€å§‹çš„å¯¹è±¡ï¼ˆæ²¡æœ‰ORMï¼Œæ²¡æœ‰SQLiteï¼‰ ååº”æ€§:å¯¹æ•°æ®å˜åŒ–çš„ååº”ç®€å•è€Œå¼ºå¤§,ä½¿ç”¨ObjectBoxä¸­çš„ååº”æ•°æ®è§‚å¯Ÿå™¨æˆ–ä¸RxJavaé›†æˆã€‚ å¤šå¹³å°:å·²ç»æ”¯æŒå®‰å“å’Œjava,ioså’ŒMacOsæ­£åœ¨é›†æˆ ç®€å•çš„çº¿ç¨‹:ObjectBoxè¿”å›çš„å¯¹è±¡å¯ä»¥åœ¨æ‰€ä»¥çº¿ç¨‹ä¸­è¿è¡Œ æ²¡æœ‰æ‰‹åŠ¨æ¨¡å¼è¿ç§»:ObjectBoxè´Ÿè´£æ·»åŠ ï¼Œåˆ é™¤å’Œé‡å‘½åå±æ€§çš„æ–°å¯¹è±¡ç‰ˆæœ¬ï¼Œæ„å‘³ç€æ•°æ®åº“çš„å‡çº§ä¸å†éœ€è¦æˆ‘ä»¬è‡ªå·±ç®¡ç†ç‰ˆæœ¬å·ï¼ŒObjectBoxå†…éƒ¨ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç®¡ç† å®‰è£…æ³¨æ„ï¼Œæœ¬æ•™ç¨‹æ˜¯åŸºäºæˆªè‡³äºç›®å‰æœ€æ–°ç‰ˆ1.4.0ç¼–å†™ æ ¹ç›®å½•build.gradleä¸­æ·»åŠ ï¼š12345678910111213141516buildscript &#123; ext.objectboxVersion = &apos;1.4.0&apos; repositories &#123; maven &#123; url &quot;http://objectbox.net/beta-repo/&quot; &#125; &#125; dependencies &#123; classpath &quot;io.objectbox:objectbox-gradle-plugin:$objectboxVersion&quot; &#125; &#125; allprojects &#123; repositories &#123; maven &#123; url &quot;http://objectbox.net/beta-repo/&quot; &#125; &#125;&#125; app build.gradleä¸­æ·»åŠ 1apply plugin: &apos;io.objectbox&apos; // after applying Android plugin ä½¿ç”¨åˆå§‹åŒ–åœ¨Applicationä¸­çš„onCreate()ä¸­åˆå§‹åŒ–1boxStore = MyObjectBox.builder().androidContext(this).build(); åˆå§‹åŒ–åå¾—åˆ°ä¸€ä¸ªBoxStoreå¯¹è±¡,è¯¥å¯¹è±¡å¯ä»¥ç®€å•ç†è§£ä¸ºè·å–æŸ¥è¯¢å¯¹è±¡çš„å…¥å£,å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”³æ˜ä¸€ä¸ªget()æ–¹æ³•ï¼Œåƒè¿™æ ·ï¼š12345678910111213141516171819202122public class BaseApp extends Application &#123; private static BaseApp baseApp; private BoxStore boxStore; //æ•°æ®åº“è¡¨çš„ç®¡ç†è€… @Override public void onCreate() &#123; super.onCreate(); baseApp = this; boxStore = MyObjectBox.builder().androidContext(this).build(); if (BuildConfig.DEBUG) &#123; new AndroidObjectBrowser(boxStore).start(this); &#125; &#125; public BoxStore getBoxStore()&#123; return boxStore; &#125; public static BaseApp getInstence()&#123; return baseApp; &#125;&#125; å®ä½“ç±»çš„å»ºç«‹objectboxæ˜¯é€šè¿‡æ³¨è§£æ¥æ ‡æ˜å“ªä¸ªç±»æ˜¯å®ä½“ï¼Œå¸¸ç”¨çš„æ³¨è§£å¦‚ä¸‹ï¼š123456789101112131415161718@Entity //è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªéœ€è¦æŒä¹…åŒ–çš„å®ä½“public class Student &#123; @Id public long id; @Index public String name; @Transient public int tempUsageCount; @NameInDb(&quot;USERNAME&quot;) public String name; public ToOne&lt;Class&gt; classToOne; public int age;&#125; @Entityï¼šè¿™ä¸ªå¯¹è±¡éœ€è¦æŒä¹…åŒ–ã€‚ @Idï¼šè¿™ä¸ªå¯¹è±¡çš„ä¸»é”®,é»˜è®¤æƒ…å†µä¸‹ï¼Œidæ˜¯ä¼šè¢«objectboxç®¡ç†çš„ï¼Œä¹Ÿå°±æ˜¯è‡ªå¢idï¼Œå¦‚æœä½ æƒ³æ‰‹åŠ¨ç®¡ç†idéœ€è¦åœ¨æ³¨è§£çš„æ—¶å€™åŠ ä¸Š@Id(assignable = true)å³å¯ã€‚å½“ä½ åœ¨è‡ªå·±ç®¡ç†idçš„æ—¶å€™å¦‚æœè¶…è¿‡longçš„æœ€å¤§å€¼ï¼Œobjectbox ä¼šæŠ¥é”™.idçš„å€¼ä¸èƒ½ä¸ºè´Ÿæ•°ã€‚å½“idç­‰äº0æ—¶objectboxä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªæ–°çš„å®ä½“å¯¹è±¡,å› æ­¤ä¼šæ–°å¢åˆ°æ•°æ®åº“è¡¨ä¸­ @Indexï¼šè¿™ä¸ªå¯¹è±¡ä¸­çš„ç´¢å¼•ã€‚å¯¹ç»å¸¸å¤§é‡è¿›è¡ŒæŸ¥è¯¢çš„å­—æ®µåˆ›å»ºç´¢å¼•ï¼Œä¼šæé«˜ä½ çš„æŸ¥è¯¢æ€§èƒ½ã€‚ @Transient:å¦‚æœä½ æœ‰æŸä¸ªå­—æ®µä¸æƒ³è¢«æŒä¹…åŒ–ï¼Œå¯ä»¥ä½¿ç”¨æ­¤æ³¨è§£,é‚£ä¹ˆè¯¥å­—æ®µå°†ä¸ä¼šä¿å­˜åˆ°æ•°æ®åº“ @NameInDbï¼šæœ‰çš„æ—¶å€™æ•°æ®åº“ä¸­çš„å­—æ®µè·Ÿä½ çš„å¯¹è±¡å­—æ®µä¸åŒ¹é…çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨æ­¤æ³¨è§£ã€‚ @ToOne:åšä¸€å¯¹ä¸€çš„å…³è”æ³¨è§£ï¼Œä¾‹å¦‚ç¤ºä¾‹ä¸­è¡¨ç¤ºä¸€å¼ å­¦ç”Ÿè¡¨ï¼ˆStudentï¼‰å…³è”ä¸€å¼ ç­çº§è¡¨ï¼ˆClassï¼‰,æ­¤å¤–è¿˜æœ‰ä¸€å¯¹å¤šï¼Œå¤šå¯¹å¤šçš„å…³è”ï¼Œä¾‹å¦‚Classçš„ç¤ºä¾‹ï¼š12345678@Entitypublic class Class&#123; @Id long id; @Backlink(to = &quot;classToOne&quot;) public ToMany&lt;Student&gt; studentEntitys;&#125; @ToMany:åšä¸€å¯¹å¤šçš„å…³è”æ³¨è§£ï¼Œå¦‚ç¤ºä¾‹ä¸­è¡¨ç¤ºä¸€å¼ ç­çº§è¡¨(Class)å…³è”å¤šå¼ å­¦ç”Ÿè¡¨(Student) @Backlink:è¡¨ç¤ºåå‘å…³è” å¢åˆ æ”¹æŸ¥å®ä½“ç±»å»ºç«‹å®Œåï¼Œåœ¨Android Studioä¸­ä½¿ç”¨Build&gt; Make projectç¼–è¯‘ä¸€æ¬¡ï¼Œobjectboxä¼šè‡ªåŠ¨å¸®ä½ ç”Ÿæˆç›¸åº”çš„æ“ä½œå®ä½“,ä¾‹å¦‚Â·Studentåˆ™ä¼šç”Ÿæˆä¸€ä¸ªStudent_çš„ç±»ï¼Œè¯¥ç±»é€šå¸¸ä½œä¸ºParamsä¼ é€’ã€‚ å¢åŠ ä¸€æ¡æ•°æ®é¦–å…ˆæˆ‘ä»¬è·å–è¯¥å®ä½“çš„Boxå¯¹è±¡ï¼Œéšåè°ƒç”¨è¯¥å¯¹è±¡çš„put()æ–¹æ³•å³å¯å®Œæˆæ–°å¢æ“ä½œ1234Box&lt;Student&gt; StudentBox = BaseApp.getInstence().getBoxStore().boxFor(Student.class);Student student = new Student();student.name = &quot;Jay&quot;;StudentBox.put(student); åˆ é™¤æ•°æ®1StudentBox.remove(student); //è¯¥å‚æ•°å¯ä»¥ä¼ è¦åˆ é™¤çš„å®ä½“ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥è¦åˆ é™¤çš„å®ä½“çš„id,å¯ä»¥æ‰¹é‡ä¼ å…¥ æŸ¥è¯¢é€šè¿‡Boxçš„query()æ–¹æ³•å¯ä»¥å¾—åˆ°ä¸€ä¸ªQueryBuilderå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯ä»¥å®ç°å„ç§æŸ¥è¯¢æ“ä½œï¼Œé‡Œé¢åŒ…å«contains(),equal()ç­‰å„ç§ä¾¿æ·çš„æŸ¥è¯¢æ–¹æ³•ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š12//æŸ¥è¯¢ä¸€ä¸ªåå«Jayçš„å­¦ç”Ÿä¿¡æ¯çš„è¡¨Student jayStudent = StudentBox.query().equal(Student_.name, &quot;Jay&quot;).build().find(); é‡Œé¢çš„Propertyå¯¹è±¡å…¶å®å°±æ˜¯ä¼ å…¥æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆçš„Student_å¯¹è±¡çš„å‚æ•°ã€‚ ä¿®æ”¹objectBoxä¿®æ”¹æ•°æ®éå¸¸ç®€å•ï¼Œé¦–å…ˆå¾—åˆ°è¦ä¿®æ”¹çš„å®ä½“ç±»ï¼Œç›´æ¥ä¿®æ”¹æ•°æ®ï¼Œéšåè°ƒç”¨put()æ–¹æ³•å³å¯ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š1234//æŸ¥è¯¢ä¸€ä¸ªåå«Jayçš„å­¦ç”Ÿä¿¡æ¯çš„è¡¨Student jayStudent = StudentBox.query().equal(Student_.name, &quot;Jay&quot;).build().find();jayStudent.name = &quot;www.huangjie.name&quot;;StudentBox.put(jayStudent); è¿™æ ·å°±æŠŠJayæ”¹æˆäº†æˆ‘çš„åšå®¢åœ°å€,haha~ æ•°æ®åº“çš„å…¶ä»–æ“ä½œæ•°æ®åº“çš„æ•°æ®å‡çº§å½“æˆ‘ä»¬éœ€è¦æ–°å¢å’Œåˆ é™¤å­—æ®µæ—¶ï¼Œç›´æ¥æ“ä½œå®ä½“ç±»å³å¯ï¼Œä¸éœ€è¦åšç‰¹æ®Šçš„æ›´æ”¹ï¼Œå¦‚æœéœ€è¦é‡å‘½åå­—æ®µåæˆ–å®ä½“ç±»åï¼Œå¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ­¥éª¤æ“ä½œï¼šç¬¬ä¸€æ­¥ï¼šç»™éœ€è¦ä¿®æ”¹çš„ç±»ååŠ ä¸Š@UIDæ³¨è§£123@Entity@Uidpublic class MyName &#123; ... &#125; ç¬¬äºŒæ­¥ï¼šç¼–è¯‘é¡¹ç›®ï¼Œç¼–è¯‘å°†å¤±è´¥ï¼Œå¹¶ä¸”ä¼šç»™ä½ ä¸€ä¸ªUIDerror: [ObjectBox] UID operations for entity &quot;MyName&quot;: [Rename] apply the current UID using @Uid(6645479796472661392L) - [Change/reset] apply a new UID using @Uid(4385203238808477712L)ç¬¬ä¸‰æ­¥ï¼šå°†Renameåé¢çš„UIDæ”¾å…¥åˆ°è¦ä¿®æ”¹çš„ç±»ä¸­ï¼š123@Entity@Uid(6645479796472661392L)public class MyName &#123; ... &#125; ç¬¬å››æ­¥ï¼šè¿›è¡Œæ•°æ®çš„ä¿®æ”¹123@Entity@Uid(6645479796472661392L)public class MyNewName &#123; ... &#125; æ›´æ”¹æ•°æ®å±æ€§æˆ–é‡å‘½åå­—æ®µååŒç†æ“ä½œã€‚ è¡¨å…³ç³»@ToOneå’Œ@ToManyå¯ä»¥çœ‹ä½œJAVAä¸­çš„Tå’ŒListçš„å…³ç³»,æ‹¿ç­çº§å’Œå­¦ç”Ÿä¸¾ä¾‹ï¼Œè®¾ç½®ç›¸å…³çš„å­¦ç”Ÿå¯¹è±¡å¦‚ä¸‹ï¼š12345Class class = new Class(); //å…ˆåˆ›å»ºä¸€ä¸ªç­çº§Student student = new Student();student.name = &quot;Jay&quot;;student.classToOne.setTarget(class); //è®¾ç½®ä¸€å¯¹ä¸€çš„targetå¯¹è±¡ï¼Œå­—æ®µå‚è§ä»¥ä¸Šç¤ºä¾‹long studentId = StudentBox.put(student); è·å–è¯¥å­¦ç”Ÿçš„ç­çº§ä¿¡æ¯ï¼š12Student student = StudentBox.get(studentId);Class class = student.classToOne.getTarget(); è€Œä¸€å¯¹å¤šçš„å…³ç³»æ›´ä¸ºç®€å•ï¼Œä½ å¯ä»¥åƒListé›†åˆä¸€æ ·å»æ“ä½œå®ƒï¼š1234567891011Class class_ = new Class(); //å…ˆåˆ›å»ºä¸€ä¸ªç­çº§Student s1 = new Student(); //æ·»åŠ ä¸€ä¸ªå­¦ç”Ÿstudent.name = &quot;Jay&quot;;Student s2 = new Student();s2.name = &quot;Android&quot;;class_ .studentEntitys.add(s1);class_ .studentEntitys.add(s2);Box classBox = BaseApp.getInstence().getBoxStore().boxFor(Class.class);classBox.put(class); è¿™æ ·çš„è¯ä¸€å¼ Classè¡¨ä¸­å°±æœ‰ä¸¤ä¸ªå­¦ç”Ÿè¡¨çš„æ•°æ®äº†ï¼ŒæŸ¥è¯¢çš„è¯å¯ä»¥è·å–è¯¥Classçš„å®ä½“ï¼Œéšååƒéå†Listé›†åˆä¸€æ ·å»éå†studentEntityså­—æ®µ,objectBoxæä¾›çš„æ–¹æ³•å’ŒListé›†åˆå‡ ä¹ä¸€æ ·ï¼Œè¿™é‡Œå°±ä¸åšç¤ºä¾‹äº†ã€‚ æ±‚å’Œç­‰æ“ä½œä½¿ç”¨Queryå¯¹è±¡å³å¯è¿›è¡Œæ±‚å’Œç­‰æ“ä½œ,é€šè¿‡QueryBuilderçš„build()æ–¹æ³•å³å¯å¾—åˆ°ã€‚éšåè°ƒç”¨sumDouble()ç­‰æ–¹æ³•ä¼ å…¥æ±‚å’Œæ¡ä»¶å³å¯ã€‚æˆ‘ä»¬è·å–å®ä½“ç±»æˆ–å®ä½“ç±»é›†åˆä¹Ÿæ˜¯ä½¿ç”¨çš„è¯¥å¯¹è±¡è·å–ã€‚ å¦å¤–ï¼ŒobjectBoxè¿˜æ”¯æŒäº‹åŠ¡ï¼ŒRxjavaæŸ¥è¯¢ï¼ŒKotlinçš„æ”¯æŒï¼Œæ›´å¤šè¯¦æƒ…å¯ä»¥é€šè¿‡å®˜æ–¹æ–‡æ¡£äº†è§£http://objectbox.io. Endemmmmmmâ€¦å†™äº†è¿™ä¹ˆå¤šï¼Œä¸ªäººè§‰å¾—objectBoxæŒºå¥½ç”¨çš„ï¼Œç›®å‰æ²¡å‘ç°å•¥å‘ï¼Œå”¯ä¸€çš„å‘æ˜¯ç¼–è¯‘çš„æ—¶å€™æç¤ºæ‰¾ä¸åˆ°MyObjectBoxè¿™ä¸ªç±»ï¼Œè¿™ä¸ªä¸ç”¨æ‹…å¿ƒï¼Œå…ˆç¡®è®¤ä¸€ä¸‹é…ç½®æ˜¯å¦æœ‰è¯¯ï¼Œæ— è¯¯çš„è¯å°†é¡¹ç›®Make Projectä¸€ä¸‹æˆ–è€…é‡æ–°ç¼–è¯‘ä¸€ä¸‹å°±OKäº†ï¼Œå¦å¤–ï¼Œæ¨èä¸‹æˆ‘å†™çš„ObjectBoxæ•°æ®åº“çš„ç»ƒæ‰‹é¡¹ç›®ä»¿æ”¯ä»˜å®è®°è´¦æœ¬,ä»¿çš„æ”¯ä»˜å®ä¸­çš„è®°è´¦æœ¬åŠŸèƒ½ï¼Œç»“åˆå®ƒçœ‹ä½ çš„objectBoxä¸Šæ‰‹æ›´å¿«å“¦ã€‚]]></content>
      <categories>
        <category>å®‰å“å¼€æºåº“ä½¿ç”¨æ•™ç¨‹</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[Androidå¼€å‘å¸¸è§é—®é¢˜ä¸æŠ€å·§æ±‡æ€»]]></title>
    <url>%2FAndroid%E5%BC%80%E5%8F%91%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æ­¤ä¸ºå¼€å‘ä¸­é‡åˆ°çš„ä¸€äº›å¸¸è§é—®é¢˜çš„æ•´ç†ï¼Œæ–¹ä¾¿ä¸‹æ¬¡é‡åˆ°é—®é¢˜èƒ½å¿«é€Ÿæ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œæ­¤å¤–è¿˜æ”¶é›†äº†ä¸€äº›å¸¸è§çš„å¼€å‘æŠ€å·§ï¼ŒæŒç»­æ›´æ–°ä¸­~~ 1 ç¼–è¯‘å‡ºç°ï¼š1All com.android.support libraries must use the exact same version specification (mixing versions can lead to runtime crashes)...... å¦‚æœå¼•ç”¨çš„ç¬¬ä¸‰æ–¹åº“çš„æ”¯æŒåº“ç‰ˆæœ¬ä½äºï¼ˆæˆ–è€…ä¸ä¸€è‡´ï¼‰app build.gradleä¸­çš„æ”¯æŒåº“ç‰ˆæœ¬ï¼Œå°±ä¼šå‡ºç°è¿™ç§é—®é¢˜,ä¿®æ”¹ç¬¬ä¸‰æ–¹çš„ä¾èµ–çš„è¯å·¥ä½œé‡å¤ªå¤§,å› æ­¤è€ƒè™‘æ‰€æœ‰æ¨¡å—å¼ºåˆ¶ä½¿ç”¨ç›¸åŒçš„ç‰ˆæœ¬å·çš„æ”¯æŒåº“ï¼Œä»£ç å¦‚ä¸‹ï¼š åœ¨app build.gradleä¸­æ·»åŠ ï¼š 12345678910configurations.all &#123; resolutionStrategy.eachDependency &#123; DependencyResolveDetails details -&gt; def requested = details.requested if (requested.group == 'com.android.support') &#123; if (!requested.name.startsWith("multidex")) &#123; details.useVersion '26.1.0' &#125; &#125; &#125;&#125; æ­¤ä»£ç å£°æ˜äº†é™¤multdexå¤–å…¨éƒ¨ä½¿ç”¨26.1.0çš„ç‰ˆæœ¬åº“ 2 SVGå›¾ç‰‡å…¼å®¹é—®é¢˜(ä¸»è¦é’ˆå¯¹5.0ä»¥ä¸‹æœºå‹)å‚è€ƒåšå®¢ï¼šAndroid Vectoræ›²æŠ˜çš„å…¼å®¹ä¹‹è·¯ åŸºæœ¬é€‚é…æ–¹æ³•ï¼šåœ¨app build.gradle çš„defaultConfigä¸­æ·»åŠ defaultvectorDrawables.useSupportLibrary = true xmlä¸­ä½¿ç”¨ï¼šImageViewåŸæœ¬æ˜¯ä½¿ç”¨srcåŠ è½½,æ”¹ä¸ºapp:srcCompat. javaä¸­ä½¿ç”¨ï¼šImageView iv = (ImageView) findViewById(R.id.iv); iv.setImageResource(R.drawable.vector_image); 3.è‡ªå®šä¹‰Viewä¸­åœ¨4.Xç‰ˆæœ¬ä¸Šé€šè¿‡getContext()æ–¹æ³•å¼ºè½¬æˆActivityå¤±æ•ˆå‚è€ƒåšå®¢ï¼š è®°ä¸€æ¬¡View.getContext()é‡åˆ°çš„å¤§å‘ åŸå› ï¼šå…¼å®¹v7åŒ…å°†ContextåŒ…è£¹æˆäº†TintContextWrapper,æ‰€ä»¥å¼ºè½¬æˆActivityä¼šå‡ºé”™ è§£å†³æ–¹æ³•ï¼šä½¿ç”¨æ„é€ æ–¹æ³•ä¸­çš„Contextæ¥å¼ºè½¬ã€‚ 4.å¼•å…¥çš„ç¬¬ä¸‰æ–¹åº“ä¸è‡ªå·±çš„supportåŒ…å†²çªè§£å†³æ–¹æ³•ï¼šå°†å†²çªçš„åº“æ”¹æˆä»¥ä¸‹å†™æ³•ï¼š123implementation ('æ­¤å¤„æ˜¯ä½ å¼•å…¥çš„åº“')&#123; exclude group: 'com.android.support' //ä»€ä¹ˆåŒ…å†²çªäº†è¿™é‡Œå°±å£°æ˜ä»€ä¹ˆ,æ³¨æ„åç§°è¦å†™å¯¹å†™å…¨ &#125; å¦å¤–ï¼Œåœ¨è¿™é‡Œæ™®åŠä¸€ä¸‹implementationçš„æ¦‚å¿µ,ç°åœ¨å‡çº§äº†ASåå¼•å…¥ä¸‰æ–¹åº“æœ‰å¤šç§æ–¹å¼ï¼Œå¦‚implementation,compile,api ..å…¶ä¸­ï¼Œimplementationä¸»è¦æ˜¯å¼•ç”¨æœ¬æ¨¡å—çš„åº“ï¼Œå…¶ä»–æ¨¡å—æ˜¯è°ƒç”¨ä¸åˆ°è¯¥æ¨¡å—å¼•ç”¨çš„åº“çš„,ç±»ä¼¼javaä¸­çš„privateå±æ€§,è€Œcompileç±»ä¼¼javaä¸­çš„publicå±æ€§,åªè¦æ¨¡å—ä¹‹é—´ç›¸äº’ä¾èµ–,å¼•ç”¨çš„åº“éƒ½èƒ½ç›¸äº’è°ƒç”¨,è€Œapiçš„ä½œç”¨ä¸compileä¸€æ ·,ä½¿ç”¨è¿™äº›ä¸åŒçš„è°ƒç”¨æ–¹å¼æ˜¯ä¸ºäº†åŠ å¿«ç¼–è¯‘é€Ÿåº¦ï¼Œå¦‚æœä½ çš„åº“ä¸éœ€è¦åœ¨å…¶ä»–æ¨¡å—ä¹‹ä¸­ä½¿ç”¨,è¯·ä½¿ç”¨implementationæ–¹å¼ï¼Œè¿™æ ·å½“å¤–éƒ¨è°ƒç”¨æ”¹å˜ä¸ä¼šç¼–è¯‘æ•´ä¸ªmodelè€Œåªä¼šç¼–è¯‘æ”¹å˜çš„é‚£ä¸ªmodel. 5.åœ¨javaä»£ç ä¸­è·å–xmlä¸­è®¾ç½®çš„behavioråœ¨å¼€å‘é¡¹ç›®çš„æ—¶å€™éœ€è¦è·å–behaviorçš„å®ä¾‹åšä¸€äº›äº‹æƒ…ï¼Œå‘ç°CoordinatorLayoutæ²¡æœ‰æä¾›è·å–behaviorçš„æ–¹æ³•ï¼Œåæ¥æŸ¥çœ‹æºç å‘ç°æ˜¯ä½¿ç”¨CoordinatorLayout.LayoutParamsæ¥è®¾ç½®behaviorçš„ï¼Œæ‰€ä»¥behaviorè‡ªç„¶æ˜¯ä»è¿™é‡Œæ¥è·å–,ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 123//å­ç±»è·å–ä¸Šçº§çš„CoordinatorLayout.LayoutParamsCoordinatorLayout.LayoutParams cl = (CoordinatorLayout.LayoutParams) mRecyclerView.getLayoutParams(); MyBehavior behavior = (MyBehavior) cl.getBehavior(); //è°ƒç”¨getBehavioræ–¹æ³• 6.è®¾ç½®çŠ¶æ€æ é€æ˜å¹¶ä½¿çˆ¶å¸ƒå±€ç§»åŠ¨åˆ°çŠ¶æ€æ ä¸Šå»(é€‚ç”¨äº5.0ä»¥ä¸Š)é¡¹ç›®ä¸­éœ€è¦ç”¨åˆ°çŠ¶æ€æ é¢œè‰²éšç€æ ‡é¢˜æ é¢œè‰²æ”¹å˜,ç”šè‡³è¿˜æœ‰æ¸å˜æ•ˆæœ,å¦‚æœå•çº¯è®¾ç½®çŠ¶æ€æ é¢œè‰²éå¸¸ä¸æ–¹ä¾¿ï¼Œå¹¶ä¸”å®ç°é¢œè‰²æ¸å˜ä¹Ÿä¸ç®€å•ï¼Œæ‰€æœ‰å°†é‡‡ç”¨å°†çˆ¶å¸ƒå±€ä¸Šç§»çš„æ–¹æ³•,è¿™æ ·çŠ¶æ€æ çš„é¢œè‰²å°±æ˜¯æ ‡é¢˜æ çš„é¢œè‰²å•¦,å®ç°æ–¹æ³•å¦‚ä¸‹ï¼š step1:å®šä¹‰ä¸»é¢˜æ–‡ä»¶1234&lt;style name="TransTheme" parent="Theme.AppCompat.Light.NoActionBar"&gt; &lt;item name="android:windowTranslucentStatus"&gt;true&lt;/item&gt; &lt;item name="android:statusBarColor"&gt;@android:color/transparent&lt;/item&gt; //è®¾ç½®çŠ¶æ€æ é€æ˜ &lt;/style&gt; step2:åœ¨æ¸…å•æ–‡ä»¶çš„Activityä¸­ä½¿ç”¨å®ƒ123&lt;activity android:name=".module.ScheduleActivity" android:theme="@style/TransTheme" /&gt; step3:è®©ä½ çš„çˆ¶å¸ƒå±€çš„æ§ä»¶å‘ä¸‹åç§»ä¸€ä¸ªçŠ¶æ€æ çš„é«˜åº¦:è·å–çŠ¶æ€æ çš„é«˜åº¦:1234567891011/** * è·å–çŠ¶æ€æ é«˜åº¦ * * @param context context * @return çŠ¶æ€æ é«˜åº¦ */ public static int getStatusBarHeight(Context context) &#123; // è·å¾—çŠ¶æ€æ é«˜åº¦ int resourceId = context.getResources().getIdentifier("status_bar_height", "dimen", "android"); return context.getResources().getDimensionPixelSize(resourceId); &#125; ç„¶åéœ€è¦åç§»çš„æ§ä»¶å°±éœ€è¦æ ¹æ®é¡¹ç›®å®é™…æƒ…å†µäº†ï¼Œä¸€èˆ¬æ˜¯è‡ªå®šä¹‰ä¸€ä¸ªæ ‡é¢˜å¸ƒå±€,ç„¶ååœ¨æ‰€æœ‰çš„Activityä¸­ä½¿ç”¨è¿™ä¸ªæ ‡é¢˜å¸ƒå±€,æˆ‘çš„æ ‡é¢˜å¸ƒå±€çš„çˆ¶å¸ƒå±€æ˜¯ä¸€ä¸ªFragmeLayoutï¼Œå› æ­¤åšå¦‚ä¸‹è®¾ç½®ï¼š 12345if (Build.VERSION.SDK_INT&gt;Build.VERSION_CODES.KITKAT)&#123; FrameLayout.LayoutParams fl = (LayoutParams) mFrameLayout.getLayoutParams(); fl.topMargin = getStatusBarHeight(getContext()); mFrameLayout.setLayoutParams(fl); &#125; ç„¶åç»™mFrameLayoutè®¾ç½®èƒŒæ™¯è‰²,è¿™æ ·çŠ¶æ€æ å°±å’Œæ ‡é¢˜æ ä¸€ä¸ªé¢œè‰²å•¦ã€‚]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[2017å¹´ç»ˆæ€»ç»“]]></title>
    <url>%2F2017%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. å‰è¨€ä»è‡ªå·±å¼€å§‹åšæŒå†™åšå®¢ä¹Ÿæœ‰1ä¸ªæœˆäº†ï¼Œæ„Ÿè§‰éå¸¸çš„å……å®ï¼Œåšå®¢å°±æ˜¯æ³¨é‡æ€»ç»“å½’çº³å˜›ï¼Œæ—¢ç„¶2017éƒ½å·²ç»è¿‡å»ï¼Œé‚£ä¹ˆä¹Ÿæœ‰å¿…è¦æ€»ç»“å½’çº³ä¸€ä¸‹å•¦ã€‚å…¶å®æˆ‘è®¤ä¸ºæˆ‘çš„2017æ€»ç»“èµ·æ¥å°±æ˜¯ï¼šè¡ŒåŠ¨èµ·æ¥ï¼Œä¸å†ç­‰å¾…ï¼Œé‡åœ¨å‚ä¸ï¼ å›é¦–ä¸€çœ¨çœ¼2017å°±è¿‡å»äº†ï¼Œæƒ³æƒ³è‡ªå·±ä»Šå¹´ï¼Œçš„ç¡®æ˜¯æˆé•¿æœ€å¿«çš„ä¸€å¹´ï¼Œä¹Ÿæ˜¯å¿™ç¢Œè€Œåˆå¹³æ·¡çš„ä¸€å¹´ï¼Œæ”¶è·äº†è®¸å¤šã€‚ ä¾ç¨€è®°å¾—å¹´åˆï¼Œå°±æœ‰äº†æŠ€æœ¯è¿›é˜¶çš„æƒ³æ³•ï¼Œå› ä¸ºæ„Ÿè§‰è‡ªå·±åœ¨è®¸å¤šåŠŸèƒ½ç‚¹ä¸Šâ€˜ä¼šåšâ€™ï¼Œä½†â€˜ä¸æ‡‚â€™ï¼Œæ— æ³•æ·±å…¥çš„è§£å†³é—®é¢˜ã€‚äºæ˜¯ï¼Œæˆ‘å°±å¯»æ±‚è¿›é˜¶çš„æ–¹æ³•ï¼Œæˆ‘åœ¨å¸…å¼ çš„å…¬ä¼—å·ä¸Šè¯»äº†ä»–å†™çš„ä¸€éæ–‡ç« ï¼Œæ–‡ç« æŒ‡å‡ºï¼Œä¹ æƒ¯å¾ˆé‡è¦ï¼Œæˆ‘ç»“åˆè‡ªèº«çš„è¡Œä¸ºæ£æ‘©è¿™å¥è¯ï¼Œæ€»ç»“å‘ç°ï¼Œå­¦ä¹ å¹¶ä¸éœ€è¦å¼ºè¿«è‡ªå·±å»å­¦ï¼Œè€Œåº”è¯¥æŠŠå®ƒå½“æˆä¸€ç§è‡ªç„¶ä¹ æƒ¯ï¼Œå°±åƒæ¸´äº†ä¼šå–æ°´ä¸€æ ·çš„ç”Ÿæ´»ä¹ æƒ¯ï¼Œè¿™ç§ä¹ æƒ¯çš„åŸ¹å…»éœ€è¦çš„æ˜¯åšæŒï¼Œä»¥åŠè‡ªå¾‹ï¼ä¸ºæ­¤æˆ‘å°è¯•æ…¢æ…¢å»åŸ¹å…»è‡ªå·±çš„å­¦ä¹ ä¹ æƒ¯ï¼š å› ä¸ºå…¬å¸æ¬å®¶ï¼Œæˆ‘ä»å®¶åˆ°å…¬å¸éœ€è¦30-40åˆ†é’Ÿï¼Œåœ¨åœ°é“ä¸Šï¼Œä»¥å‰æ˜¯éƒ½æ˜¯çœ‹ä¸€ä¸‹æ–°é—»å•Šï¼Œåˆ·ä¸€ä¸‹å¾®åšå•Šï¼Œç°åœ¨æˆ‘éƒ½æ˜¯çœ‹æ˜é‡‘æœ‰æ²¡æœ‰ä»€ä¹ˆæ–°é²œçš„æ¡†æ¶ï¼Œçœ‹çœ‹ç®€ä¹¦æœ‰æ²¡æœ‰å¥½çœ‹çš„æŠ€æœ¯æ–‡ç« ï¼Œçœ‹çœ‹githubæœ‰æ²¡æœ‰ç«çƒ­çš„æŠ€æœ¯æ’åï¼Œé‚£äº›å¾®åšä»€ä¹ˆçš„æˆ‘å†ä¹Ÿæ²¡æ‰“å¼€è¿‡ï¼Œæˆ‘å·²ç»åšæŒæœ‰å¤§åŠå¹´çš„ï¼Œç”šè‡³ç°åœ¨ä½†å‡¡åº§åœ°é“æˆ‘ä¹Ÿä¼šä¹ æƒ¯æ€§æ‰“å¼€è¿™äº›app ä»¥å‰çš„æˆ‘å·¥ä½œå›åˆ°å®¶éƒ½æ˜¯åˆ·ç”µè§†å‰§ï¼Œç°åœ¨éƒ½æ˜¯æœ‰ç›®çš„æ€§çš„å»å­¦ä¹ ä¸€ä¸ªçŸ¥è¯†ç‚¹æˆ–è€…ä¸€é—¨è¯­è¨€ï¼Œè¿™æ ·æ—¶é—´è¿‡å¾—éå¸¸çš„å¿«ï¼Œæ¯å¤©æ„Ÿè§‰æ—¶é—´ä¸å¤Ÿç”¨ï¼Œæœç„¶å½“æŠ•å…¥åˆ°æŸä¸€ä»¶äº‹æ—¶æ—¶é—´çš„æµé€æ˜¯éå¸¸å¿«é€Ÿçš„ã€‚ å…ˆå‰éƒ½æ˜¯è‡ªå·±å†™demo,è‡ªå·±æ€»ç»“çŸ¥è¯†ç‚¹ï¼Œç„¶åå†™åˆ°å°è±¡ç¬”è®°ä¸­ï¼Œä½†æ˜¯æˆ‘å‘ç°é‡Œé¢çš„çŸ¥è¯†ç‚¹å¤ªæ•£ä¹±ï¼Œæ— æ³•æˆä¸ºä¸€ä¸ªä½“ç³»ã€‚äºæ˜¯æˆ‘å°±è¯•ç€å†™åšå®¢ï¼Œä¸ºæ­¤ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªæ–°å¤§é™†ï¼Œå†™åšå®¢å¯¹äºçŸ¥è¯†çš„æ¢³ç†ç®€ç›´å¤ªæœ‰ç”¨äº†ï¼Œå‰ææ˜¯ä½ æƒ³å†™å¥½ä¸€ç¯‡åšå®¢ã€‚ å­¦ä¹ çŸ¥è¯†å°±è¦å–„äºæ€»ç»“å½’çº³ï¼Œä¹¦æœ¬æ˜¯æœ€å¥½çš„è€å¸ˆï¼Œä¸ºæ­¤2017æˆ‘é˜…è¯»äº†ä¸€äº›çš„ä¹¦ç±ï¼š éƒ­ç¥çš„ã€Šç¬¬ä¸€è¡Œä»£ç ã€‹ç¬¬äºŒç‰ˆï¼Œè¿™æ˜¯ä¸€æœ¬åŸºç¡€ä¹¦ç±ï¼Œå®ƒè®©æˆ‘å¯¹å®‰å“çš„åŸºç¡€æœ‰äº†æ›´åŠ å®Œå–„çš„äº†è§£å’Œå¤¯å®ã€‚ ä»»ç‰åˆšçš„ã€Šå®‰å“å¼€å‘è‰ºæœ¯æ¢ç´¢ã€‹ï¼Œè¿™æ˜¯ä¸€æœ¬è¿›é˜¶ç±»çš„ä¹¦ç±ï¼Œå®ƒè®©æˆ‘çªç ´äº†ç“¶é¢ˆï¼Œå¯¹å®‰å“çš„äº†è§£æ›´åŠ çš„æ·±å…¥äº†ã€‚ æˆ‘å¯¹è¿™ä¸¤ä½éƒ½éå¸¸çš„é’¦ä½©ï¼Œæ­£æ˜¯ä»–ä»¬è®©æˆ‘ä»¬è¿™äº›å¼€å‘è€…çš„è¿›é˜¶è‡³å°‘èƒ½æå‰0.5-1å¹´çš„æ—¶é—´ï¼Œã€Šå¼€å‘è‰ºæœ¯æ¢ç´¢ã€‹æˆ‘æ¥å›è¯»äº†å¥½å‡ éï¼Œæ¯ä¸€æ¬¡éƒ½ä¼šæœ‰æ–°çš„æ”¶è·ï¼Œå†æ¬¡æ„Ÿè°¢~ æ™šä¸Šï¼Œæˆ‘ä¹Ÿä¼šå¶å°”çœ‹ä¸‹æ…•è¯¾ç½‘ä¸Šçš„è§†é¢‘ï¼Œæˆ‘è§‰å¾—é‡Œé¢çš„è€å¸ˆè®²çš„è¿˜æ˜¯æ¯”è¾ƒå¥½çš„ï¼Œä¸ºæ­¤æˆ‘ä¹Ÿæ¨èç»™å¤§å®¶ã€‚ å›é¦–2017çš„æŠ€æœ¯æœ‰å¦‚ä¸‹çš„æ€»ç»“ï¼š å­¦ä¹ äº†è‡ªå®šä¹‰View,å¯¹è‡ªå®šä¹‰çš„æµç¨‹æœ‰äº†è¾ƒä¸ºå®Œå–„çš„äº†è§£ å­¦ä¹ äº†Viewä½“ç³»ï¼Œviewçš„ç¡®æ˜¯ä¸€ä¸ªéå¸¸æœ‰é­…åŠ›çš„æ§ä»¶ï¼Œå®ƒå¯ä»¥å¸¦æ¥æ— ç©·çš„åˆ›é€ åŠ› å¯¹æ•°æ®åº“æ¡†æ¶éƒ½æœ‰æ‰€äº†è§£ï¼šå¦‚å…¬å¸é¡¹ç›®æ­£åœ¨ä½¿ç”¨çš„ActiveAndroid(ä½œè€…è²Œä¼¼ä¸ç»´æŠ¤äº†ï¼Ÿ),ä½¿ç”¨greenDAOåšè¿‡ä¸€äº›ç®€å•çš„demo,åæ¥å‘ç°äº†greenDaoçš„ä½œè€…æ­£åœ¨å¼€å‘ä¸€ä¸ªå…¨æ–°çš„æ•°æ®åº“ï¼Œå·ç§°æœ€å¿«çš„æ•°æ®åº“ï¼Œäºæ˜¯å°±æ²¡æœ‰ç»§ç»­æ·±å…¥greenDaoçš„ç ”ç©¶ï¼Œè½¬è€Œç ”ç©¶æ–°çš„æ•°æ®åº“ï¼Œå®ƒå°±æ˜¯æˆ‘ç°åœ¨æ­£åœ¨ç ”ç©¶çš„object-box,ä¸è¿‡ç°åœ¨èµ„æ–™è¿˜è¾ƒå°‘ï¼Œå±Šæ—¶æˆ‘ä¼šå‡ºä¸€ä¸ªæ•™ç¨‹ã€‚ å­¦ä¹ äº†ExoPlayerè§†é¢‘æ’­æ”¾æ¡†æ¶ï¼ŒRxjava,okhttp,mvpç­‰ç­‰çš„ä¸€äº›çƒ­é—¨æ¡†æ¶å’Œæ¶æ„ å­¦ä¹ äº†ä¸€äº›kotlinçš„åŸºæœ¬è¯­æ³• å­¦ä¹ äº†html5çš„ä¸€äº›åŸºæœ¬è¯­æ³•ï¼Œèƒ½åˆ¶ä½œä¸€äº›é™æ€é¡µé¢ åŸºäºhexoå’Œcodingæ­å»ºçš„åšå®¢å¹³å°.å…ˆå‰æœ¬æ¥æ˜¯ä¸Šä¼ åˆ°githubçš„ï¼Œç”±äºç™¾åº¦è¢«å¢™çš„å…³ç³»ï¼Œå°±ç§»åˆ°codingäº†ã€‚ å±•æœ›å¯¹äº2018ï¼Œæˆ‘åšä¿¡æˆ‘çš„åšæŒä¼šå¸¦ç»™æˆ‘æ›´å¤šçš„æ”¶è·ã€‚æˆ‘ä¾æ—§ä¼šåŠªåŠ›åšæŒ2017æ­£åœ¨åšçš„äº‹æƒ…ï¼š åšæŒå†™åšå®¢ï¼Œè‡³å°‘1å‘¨ä¸€ç¯‡ åšæŒæŠ€æœ¯å­¦ä¹  2018è¦åˆ·çš„ä¹¦æœ‰ã€Škotlinå®æˆ˜ã€‹ï¼Œã€ŠAndroidç¥å…µåˆ©å™¨ã€‹ï¼Œã€Šå®‰å“ç¾¤è‹±ä¼ ã€‹ã€‚ 2018éœ€è¦è¿›é˜¶çš„æŠ€æœ¯æœ‰ï¼š kotlinçš„ç†Ÿç»ƒä½¿ç”¨ è‡ªå®šä¹‰Viewçš„æ€»ç»“ï¼ŒåŠ¨ç”»ç³»åˆ— ç›´æ’­ï¼Œè§†é¢‘æ’­æ”¾æŠ€æœ¯è¦ç‚¹æ€»ç»“ è®¾è®¡æ¨¡å¼ å†…å­˜ä¼˜åŒ– gradleç²¾é€š ç®€å•äº†è§£ä¸‹é€†å‘ï¼Œåç¼–è¯‘ç­‰æŠ€æœ¯ 2018ï¼Œè®©æˆ‘ä»¬ä¸€èµ·åŠ æ²¹~]]></content>
      <categories>
        <category>æ„Ÿæ‚Ÿ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ExoPlayerè§†é¢‘æ¡†æ¶ï¼šè‡ªå®šä¹‰UIç•Œé¢åŠæºç è§£æ]]></title>
    <url>%2FExoPlayer%E8%A7%86%E9%A2%91%E6%A1%86%E6%9E%B6%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89UI%E7%95%8C%E9%9D%A2%E5%8F%8A%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æœ¬æ–‡ä¸»è¦è®²è¿°ä½¿ç”¨ExoPlayeræ¡†æ¶æ—¶å¦‚ä½•è‡ªå®šä¹‰è‡ªå·±çš„è§†é¢‘æ’­æ”¾ç•Œé¢ï¼Œæ¥è¾¾åˆ°æ»¡æ„çš„æ•ˆæœï¼Œä»¥åŠSimpleExoPlayerViewçš„æºç è§£æ SimpleExoPlayerView ç±»ä»‹ç»SimpleExoPlayerViewæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰FrameLayout,å†…éƒ¨å°è£…äº†è§†é¢‘ï¼Œå­—å¹•ï¼Œæ’­æ”¾å°é¢ï¼Œæ’­æ”¾æ§åˆ¶å™¨çš„Viewé€»è¾‘ ç®€å•ä½¿ç”¨åœ¨xmlä¸­å£°æ˜è¯¥æ§ä»¶ï¼š123456&lt;com.google.android.exoplayer2.ui.SimpleExoPlayerView android:layout_width="match_parent" android:layout_height="wrap_content" android:id="@+id/simpleExoPlayerView" app:resize_mode="fixed_width" /&gt; SimpleExoPlayerViewå†…éƒ¨çš„AspectRatioFrameLayoutå°è£…äº†è§†é¢‘å®½é«˜æ¯”çš„è®¡ç®—ï¼Œå®ƒæ ¹æ®è§†é¢‘æµçš„å®½é«˜æ¯”æ¥åŠ¨æ€è®¾ç½®æ§ä»¶çš„å®½é«˜æ¥è¾¾åˆ°é€‚åº”å±å¹•çš„ç›®çš„ï¼Œresize_modeå¯ä»¥æŒ‡å®šè¿™ç§è§†é¢‘çš„å®½é«˜æ¯”è®¡ç®—æ¨¡å¼ï¼Œå…±æœ‰å››ç§æ¨¡å¼ï¼Œfixed_widthä»£è¡¨æ ¹æ®å®½åº¦æ¥åŠ¨æ€è®¡ç®—é«˜åº¦ï¼Œå®½åº¦ä¸ä¼šå˜åŒ–ï¼Œfixed_heightä¸ä¹‹ç›¸åï¼Œfillæ¨¡å¼ä¼šå¿½ç•¥å®½é«˜æ¯”ï¼Œä¸è¿›è¡ŒåŠ¨æ€è®¡ç®—ï¼Œfitä¸ºé»˜è®¤æ¨¡å¼ï¼Œå¦‚æœé«˜åº¦å˜å½¢å°±åŠ¨æ€è®¡ç®—é«˜åº¦æ¥é€‚é…ï¼Œå®½åº¦å˜å½¢å°±åŠ¨æ€è®¡ç®—å®½åº¦æ¥é€‚é…ã€‚activityä¸­ï¼š1simpleExoPlayerView.setPlayer(player); é€šè¿‡setPlayeræ–¹æ³•æ¥ä¸ExoPlayerç»‘å®š æºç åˆ†æè¦éšå¿ƒæ‰€æ¬²çš„ä½¿ç”¨è¯¥Viewï¼Œæ¥å®šåˆ¶è‡ªå·±ç†æƒ³çš„UIï¼Œå°±å¾—å…ˆäº†è§£å…¶ä¸­çš„åŸç†ï¼Œæ–¹èƒ½å…¨é¢æŒæ§ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥æ’¸ä¸€éæºç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161@TargetApi(16)public final class SimpleExoPlayerView extends FrameLayout &#123; private static final int SURFACE_TYPE_NONE = 0; private static final int SURFACE_TYPE_SURFACE_VIEW = 1; private static final int SURFACE_TYPE_TEXTURE_VIEW = 2; private final AspectRatioFrameLayout contentFrame; private final View shutterView; private final View surfaceView; private final ImageView artworkView; private final SubtitleView subtitleView; private final PlaybackControlView controller; private final ComponentListener componentListener; private final FrameLayout overlayFrameLayout; private SimpleExoPlayer player; private boolean useController; private boolean useArtwork; private Bitmap defaultArtwork; private int controllerShowTimeoutMs; private boolean controllerAutoShow; private boolean controllerHideOnTouch; public SimpleExoPlayerView(Context context) &#123; this(context, null); &#125; public SimpleExoPlayerView(Context context, AttributeSet attrs) &#123; this(context, attrs, 0); &#125; public SimpleExoPlayerView(Context context, AttributeSet attrs, int defStyleAttr) &#123; super(context, attrs, defStyleAttr); if (isInEditMode()) &#123; contentFrame = null; shutterView = null; surfaceView = null; artworkView = null; subtitleView = null; controller = null; componentListener = null; overlayFrameLayout = null; ImageView logo = new ImageView(context); if (Util.SDK_INT &gt;= 23) &#123; configureEditModeLogoV23(getResources(), logo); &#125; else &#123; configureEditModeLogo(getResources(), logo); &#125; addView(logo); return; &#125; boolean shutterColorSet = false; int shutterColor = 0; int playerLayoutId = R.layout.exo_simple_player_view; boolean useArtwork = true; int defaultArtworkId = 0; boolean useController = true; int surfaceType = SURFACE_TYPE_SURFACE_VIEW; int resizeMode = AspectRatioFrameLayout.RESIZE_MODE_FIT; int controllerShowTimeoutMs = PlaybackControlView.DEFAULT_SHOW_TIMEOUT_MS; boolean controllerHideOnTouch = true; boolean controllerAutoShow = true; if (attrs != null) &#123; TypedArray a = context.getTheme().obtainStyledAttributes(attrs, R.styleable.SimpleExoPlayerView, 0, 0); try &#123; shutterColorSet = a.hasValue(R.styleable.SimpleExoPlayerView_shutter_background_color); shutterColor = a.getColor(R.styleable.SimpleExoPlayerView_shutter_background_color, shutterColor); playerLayoutId = a.getResourceId(R.styleable.SimpleExoPlayerView_player_layout_id, playerLayoutId); useArtwork = a.getBoolean(R.styleable.SimpleExoPlayerView_use_artwork, useArtwork); defaultArtworkId = a.getResourceId(R.styleable.SimpleExoPlayerView_default_artwork, defaultArtworkId); useController = a.getBoolean(R.styleable.SimpleExoPlayerView_use_controller, useController); surfaceType = a.getInt(R.styleable.SimpleExoPlayerView_surface_type, surfaceType); resizeMode = a.getInt(R.styleable.SimpleExoPlayerView_resize_mode, resizeMode); controllerShowTimeoutMs = a.getInt(R.styleable.SimpleExoPlayerView_show_timeout, controllerShowTimeoutMs); controllerHideOnTouch = a.getBoolean(R.styleable.SimpleExoPlayerView_hide_on_touch, controllerHideOnTouch); controllerAutoShow = a.getBoolean(R.styleable.SimpleExoPlayerView_auto_show, controllerAutoShow); &#125; finally &#123; a.recycle(); &#125; &#125; LayoutInflater.from(context).inflate(playerLayoutId, this); componentListener = new ComponentListener(); setDescendantFocusability(FOCUS_AFTER_DESCENDANTS); // Content frame. contentFrame = findViewById(R.id.exo_content_frame); if (contentFrame != null) &#123; setResizeModeRaw(contentFrame, resizeMode); &#125; // Shutter view. shutterView = findViewById(R.id.exo_shutter); if (shutterView != null &amp;&amp; shutterColorSet) &#123; shutterView.setBackgroundColor(shutterColor); &#125; // Create a surface view and insert it into the content frame, if there is one. if (contentFrame != null &amp;&amp; surfaceType != SURFACE_TYPE_NONE) &#123; ViewGroup.LayoutParams params = new ViewGroup.LayoutParams( ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT); surfaceView = surfaceType == SURFACE_TYPE_TEXTURE_VIEW ? new TextureView(context) : new SurfaceView(context); surfaceView.setLayoutParams(params); contentFrame.addView(surfaceView, 0); &#125; else &#123; surfaceView = null; &#125; // Overlay frame layout. overlayFrameLayout = findViewById(R.id.exo_overlay); // Artwork view. artworkView = findViewById(R.id.exo_artwork); this.useArtwork = useArtwork &amp;&amp; artworkView != null; if (defaultArtworkId != 0) &#123; defaultArtwork = BitmapFactory.decodeResource(context.getResources(), defaultArtworkId); &#125; // Subtitle view. subtitleView = findViewById(R.id.exo_subtitles); if (subtitleView != null) &#123; subtitleView.setUserDefaultStyle(); subtitleView.setUserDefaultTextSize(); &#125; // Playback control view. PlaybackControlView customController = findViewById(R.id.exo_controller); View controllerPlaceholder = findViewById(R.id.exo_controller_placeholder); if (customController != null) &#123; this.controller = customController; &#125; else if (controllerPlaceholder != null) &#123; // Propagate attrs as playbackAttrs so that PlaybackControlView's custom attributes are // transferred, but standard FrameLayout attributes (e.g. background) are not. this.controller = new PlaybackControlView(context, null, 0, attrs); controller.setLayoutParams(controllerPlaceholder.getLayoutParams()); ViewGroup parent = ((ViewGroup) controllerPlaceholder.getParent()); int controllerIndex = parent.indexOfChild(controllerPlaceholder); parent.removeView(controllerPlaceholder); parent.addView(controller, controllerIndex); &#125; else &#123; this.controller = null; &#125; this.controllerShowTimeoutMs = controller != null ? controllerShowTimeoutMs : 0; this.controllerHideOnTouch = controllerHideOnTouch; this.controllerAutoShow = controllerAutoShow; this.useController = useController &amp;&amp; controller != null; hideController(); &#125; ä»¥ä¸‹æ˜¯ä¸€äº›æš´éœ²çš„æ–¹æ³• ....... &#125; æˆ‘ä»¬çœ‹ä¸‹å®ƒçš„æ„é€ æ–¹æ³•ï¼Œé¦–å…ˆé€šè¿‡isInEditMode()æ–¹æ³•åˆ¤æ–­äº†æ˜¯å¦æ˜¯åœ¨å¯è§†åŒ–ç¼–è¾‘å™¨ä¸­åŠ è½½çš„ï¼Œæ˜¯çš„è¯å°±returnã€‚ æ¥ä¸‹æ¥å£°æ˜äº†ä¸€äº›é»˜è®¤çš„å˜é‡ï¼Œå¹¶èµ‹äºˆäº†ä¸€äº›é»˜è®¤çš„å€¼ï¼Œæˆ‘ä»¬çœ‹åˆ°æœ‰ä¸€ä¸ªplayerLayoutIdå£°æ˜äº†ä¸€ä¸ªé»˜è®¤çš„å¸ƒå±€æ–‡ä»¶exo_simple_player_viewï¼Œè·Ÿè¸ªå»çœ‹ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;merge xmlns:android="http://schemas.android.com/apk/res/android"&gt; &lt;com.google.android.exoplayer2.ui.AspectRatioFrameLayout android:id="@id/exo_content_frame" android:layout_width="match_parent" android:layout_height="match_parent" android:layout_gravity="center"&gt; &lt;!-- Video surface will be inserted as the first child of the content frame. --&gt; &lt;View android:id="@id/exo_shutter" android:layout_width="match_parent" android:layout_height="match_parent" android:background="@android:color/black"/&gt; &lt;ImageView android:id="@id/exo_artwork" android:layout_width="match_parent" android:layout_height="match_parent" android:scaleType="fitXY"/&gt; &lt;com.google.android.exoplayer2.ui.SubtitleView android:id="@id/exo_subtitles" android:layout_width="match_parent" android:layout_height="match_parent"/&gt; &lt;/com.google.android.exoplayer2.ui.AspectRatioFrameLayout&gt; &lt;FrameLayout android:id="@id/exo_overlay" android:layout_width="match_parent" android:layout_height="match_parent"/&gt; &lt;View android:id="@id/exo_controller_placeholder" android:layout_width="match_parent" android:layout_height="match_parent"/&gt;&lt;/merge&gt; è¿™ä¸ªå¸ƒå±€æ–‡ä»¶å°±æ˜¯æˆ‘ä»¬çš„ExoPlayer uiåŒ…ä¸­çš„é»˜è®¤uiå¸ƒå±€ã€‚AspectRatioFrameLayoutæ˜¯ç»§æ‰¿è‡ªFragmeLayout,ä¹Ÿå°±æ˜¯æºç ä¸­çš„contentFrameï¼Œå®ƒçš„ä½œç”¨æ˜¯æ ¹æ®è§†é¢‘çš„å®½é«˜æ¯”å’Œå±å¹•çš„å®½é«˜æ¯”æ¥åŠ¨æ€è®¡ç®—è§†é¢‘Viewçš„å®½é«˜æ¯”ä¾‹ã€‚è€ŒSimpleExoPlayerViewä¼šå°†surfaceViewåŠ¨æ€æ’å…¥åˆ°AspectRatioFrameLayoutçš„ç¬¬ä¸€ä¸ªå­Viewä¸­æ¥ï¼Œæ¥ä½œä¸ºæ’­æ”¾çš„View. exo_shutterä¹Ÿå°±æ˜¯æºç ä¸­çš„shutterViewï¼Œå®ƒçš„èƒŒæ™¯å¯ä»¥é€šè¿‡ä»£ç åŠ¨æ€è®¾ç½®ï¼Œå¯ä»¥ä½œä¸ºè§†é¢‘çš„ä¸€ä¸ªè’™å±‚. exo_artworkä¸ºæºç ä¸­çš„artworkViewï¼Œæ˜¯ä¸€ä¸ªImageView,å¯ä»¥æ”¾ä¸€äº›å›¾ç‰‡ä¸Šå». SubtitleViewæ˜¯ä¸€ä¸ªå­—å¹•æ˜¾ç¤ºå™¨ï¼Œä¸ºæºç ä¸­çš„subtitleViewï¼Œå¯ä»¥å®šåˆ¶å­—å¹•æ–‡ä»¶ã€‚ exo_overlayä¸ºæºç ä¸­çš„overlayFrameLayoutï¼Œåœ¨æºç ä¸­æ²¡æœ‰å®šåˆ¶ä»»ä½•ä¸œè¥¿ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚æ”¾å…¥ä¸€äº›é€»è¾‘ã€‚ exo_controller_placeholderä¸ºæºç ä¸­çš„controllerPlaceholderï¼Œå®šä¹‰äº†PlaybackControlViewçš„å¸ƒå±€å±æ€§ï¼Œåœ¨ä»£ç ä¸­SimpleExoPlayerä¼šå°†controllerPlaceholderçš„Paramå±æ€§æ·»åŠ åˆ°PlaybackControlViewä¸Šã€‚PlaybackControlViewæ˜¯ä¸€ä¸ªæ’­æ”¾æ§åˆ¶å™¨View.å†…éƒ¨å°è£…äº†æ’­æ”¾å™¨æ§åˆ¶é€»è¾‘ï¼Œä¹Ÿå¯ä»¥å®šåˆ¶è‡ªå®šä¹‰uiå’Œå®ç°è‡ªå·±çš„æ§åˆ¶é€»è¾‘ã€‚ ä»‹ç»äº†è¿™ä¹ˆå¤šï¼Œæ¥ä¸‹æ¥ç»§ç»­åˆ†ææºç LayoutInflater.from(context).inflate(playerLayoutId, this);å¯ä»¥çœ‹åˆ°ï¼ŒSimpleExoPlayerViewå°†playerLayoutIdæ·»åŠ è¿›äº†è¯¥è§†å›¾ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡xmlçš„å±æ€§æ¥æŒ‡å®šè¯¥Viewçš„è§†å›¾idï¼Œæ¥ç€å£°æ˜äº†è¯¥ç„¦ç‚¹æ¨¡å¼ä¸ºåªæœ‰å½“å­Viewä¸éœ€è¦ç„¦ç‚¹æ—¶æ‰è·å–ç„¦ç‚¹ã€‚setDescendantFocusability(FOCUS_AFTER_DESCENDANTS);æ¥ä¸‹æ¥é€šè¿‡findViewByIdçš„æ¨¡å¼å¾—åˆ°è§†å›¾çš„æ§ä»¶æ¥è¿›è¡Œä¸åŒçš„è®¾ç½®ï¼Œå› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬è‡ªå®šä¹‰çš„uiä¸­æƒ³ç”¨åˆ°é‡Œé¢çš„åŠŸèƒ½ï¼Œå°±å¿…é¡»ç”³æ˜ä¸€æ ·çš„id.ä¹Ÿå¯ä»¥é€šè¿‡findViewByIdçš„æ–¹å¼å¾—åˆ°è¯¥æ§ä»¶ã€‚æ¥ä¸‹æ¥ç»§ç»­èµ°ï¼š 1234567891011// Create a surface view and insert it into the content frame, if there is one. if (contentFrame != null &amp;&amp; surfaceType != SURFACE_TYPE_NONE) &#123; ViewGroup.LayoutParams params = new ViewGroup.LayoutParams( ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT); surfaceView = surfaceType == SURFACE_TYPE_TEXTURE_VIEW ? new TextureView(context) : new SurfaceView(context); surfaceView.setLayoutParams(params); contentFrame.addView(surfaceView, 0); &#125; else &#123; surfaceView = null; &#125; å¯ä»¥çœ‹åˆ°ï¼ŒSimpleExoPlayerViewæ ¹æ®sufaceTypeè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªSufaceViewæˆ–TextureView,å¹¶å°†å…¶æ·»åŠ åˆ°AspectRatioFrameLayoutçš„ç¬¬ä¸€ä¸ªå­Viewä¸Šï¼Œç”¨æ¥æ’­æ”¾è§†é¢‘ã€‚å› æ­¤å¦‚æœè‡ªå®šä¹‰UIï¼Œä¸€å®šè¦å®šä¹‰ä¸€ä¸ªAspectRatioFrameLayoutæ¥åŒ…è£¹è¯¥View.æ¥ç€æˆ‘ä»¬çœ‹ä¸€ä¸‹æ§åˆ¶å™¨çš„é€»è¾‘ï¼š1234567891011121314151617// Playback control view. PlaybackControlView customController = findViewById(R.id.exo_controller); View controllerPlaceholder = findViewById(R.id.exo_controller_placeholder); if (customController != null) &#123; this.controller = customController; &#125; else if (controllerPlaceholder != null) &#123; // Propagate attrs as playbackAttrs so that PlaybackControlView's custom attributes are // transferred, but standard FrameLayout attributes (e.g. background) are not. this.controller = new PlaybackControlView(context, null, 0, attrs); controller.setLayoutParams(controllerPlaceholder.getLayoutParams()); ViewGroup parent = ((ViewGroup) controllerPlaceholder.getParent()); int controllerIndex = parent.indexOfChild(controllerPlaceholder); parent.removeView(controllerPlaceholder); parent.addView(controller, controllerIndex); &#125; else &#123; this.controller = null; &#125; å¯ä»¥çœ‹åˆ°PlaybackControlViewä¹Ÿæ˜¯é€šè¿‡æ‰¾idçš„æ–¹å¼è·å–ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å®šåˆ¶æ§åˆ¶å™¨uiçš„è¯å¯ä»¥é€šè¿‡ç»§æ‰¿PlaybackControlViewçš„æ–¹å¼æ¥å®šåˆ¶æˆ‘ä»¬è‡ªå·±çš„æ§åˆ¶UIã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰å®šä¹‰PlaybackControlViewï¼Œé‚£ä¹ˆä¼šå…ˆåˆ›å»ºä¸€ä¸ªPlaybackControlViewï¼Œç„¶åå»å–exo_controller_placeholderçš„paramå±æ€§èµ‹ç»™PlaybackControlViewï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé‚£ä¹ˆä¸ä¼šç”³æ˜ä¸€ä¸ªæ§åˆ¶å™¨ã€‚ UIå®šåˆ¶ä»¥ä¸Šé€šè¿‡æºç åˆ†æï¼Œç›¸ä¿¡å¯¹è¯¥æ§ä»¶ä¹Ÿæœ‰ä¸ªå¤§æ¦‚çš„äº†è§£äº†ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹å¦‚ä½•å®šåˆ¶æˆ‘ä»¬çš„UIï¼šé¦–å…ˆï¼Œåœ¨xmlä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡controller_layout_idå±æ€§ç”³æ˜æˆ‘ä»¬è‡ªå·±çš„Layout id:1234567&lt;com.google.android.exoplayer2.ui.SimpleExoPlayerView android:layout_width="match_parent" android:layout_height="wrap_content" android:id="@+id/simpleExoPlayerView" app:resize_mode="fixed_width" app:controller_layout_id="@layout/simple_player_view" /&gt; simple_player_viewä¸ºæˆ‘è‡ªå®šä¹‰å¸ƒå±€æ–‡ä»¶ï¼Œçœ‹ä¸€ä¸‹simple_player_viewçš„ä»£ç ï¼š12345678910111213&lt;com.google.android.exoplayer2.ui.AspectRatioFrameLayout android:id="@id/exo_content_frame" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_gravity="top"&gt; &lt;com.jie.exoplayerdemo.PlayControlView android:layout_width="match_parent" android:layout_height="wrap_content" android:id="@id/exo_controller" android:layout_gravity="bottom" app:controller_layout_id="@layout/exo_playback_control_view" /&gt;&lt;/com.google.android.exoplayer2.ui.AspectRatioFrameLayout&gt; è¯¥å¸ƒå±€åªè¦idä¸æºç ä¸­å¯¹åº”å³å¯éšæ„å®šåˆ¶ï¼Œæˆ‘åœ¨é‡Œé¢åªæ˜¯ç”³æ˜äº†ä¸€ä¸ªAspectRatioFrameLayoutå’Œä¸€ä¸ªè‡ªå®šä¹‰çš„æ§åˆ¶å™¨ï¼Œå¦‚æœæˆ‘ä»¬ä¸æƒ³ç”¨è¯¥æ¡†æ¶çš„é»˜è®¤æ§åˆ¶å™¨PlaybackControlViewï¼Œå¯ä»¥è‡ªå®šä¹‰è¯¥æ§åˆ¶å™¨ï¼Œæ§åˆ¶å™¨çš„è‡ªå®šä¹‰é€»è¾‘å’ŒSimpleExoPlayerViewä¸€æ ·ï¼Œä¹Ÿæ˜¯é€šè¿‡ç”³æ˜idçš„æ–¹å¼æ¥æ§åˆ¶Viewçš„é€»è¾‘ï¼Œå¹¶ä¸”è¯¥Viewä¸æ˜¯finalç±»ï¼Œå› æ­¤å¯ä»¥ç»§æ‰¿PlaybackControlViewæ¥å®ç°è‡ªå·±çš„é€»è¾‘ã€‚PlayControlViewå°±æ˜¯ç»§æ‰¿PlaybackControlViewæ¥å®ç°çš„è‡ªå®šä¹‰é€»è¾‘ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡æ‰¾idçš„æ–¹å¼æ¥è·å–PlaybackControlViewé‡Œçš„æ§ä»¶ï¼Œå› æ­¤ï¼Œé‡Œé¢çš„æ‰€æœ‰æ§ä»¶æ˜¯å¯å®šåˆ¶çš„ã€‚å¯æ˜¯ï¼Œæˆ‘ä»¬çš„SimpleExoPlayerViewæ˜¯ä¸€ä¸ªfinalç±»ï¼Œå¦‚æœéœ€è¦å®ç°SimpleExoPlayerViewæ²¡æœ‰çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦å°†SimpleExoPlayerViewçš„ä»£ç å¤åˆ¶ä¸€ä»½å‡ºæ¥æ¥è¾¾åˆ°ä¿®æ”¹çš„ç›®çš„ã€‚]]></content>
      <categories>
        <category>Androidè§†é¢‘æ’­æ”¾</category>
      </categories>
      <tags>
        <tag>ExoPlayer</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é«˜æ•ˆèµ„æºæœç½—åˆé›†ï¼Œä¸çœ‹ä¿è¯åæ‚”(æŒç»­æ›´æ–°)]]></title>
    <url>%2FEfficientresourcessearchtogethernoguaranteeofregret.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æ­å–œä½ å‘ç°äº†è¿™ç¯‡åšæ–‡ï¼Œçœ‹äº†è¿™ç¯‡åšæ–‡ï¼Œjayå¸®ä½ æ‰“å¼€æ–°ä¸–ç•Œçš„å¤§é—¨ï¼Œå¤šå¹´è€å¸æœºå¼€è½¦ï¼Œè¯·ç³»å¥½å®‰å…¨å¸¦ã€‚ æœç´¢ç¯‡(ä»€ä¹ˆï¼Ÿè¯´èµ·æœç´¢ä½ åªçŸ¥é“baidu?é‚£ä½ å°±outäº†) å¿«æœï¼šhttp://search.chongbuluo.com/ çœ‹å›¾å°±çŸ¥é“ï¼Œå„ç§èµ„æºåº”æœ‰å°½æœ‰ï¼Œåªæœ‰ä½ æƒ³ä¸åˆ°ï¼Œæ²¡æœ‰ä½ æœä¸åˆ°ï¼Œå¼ºçƒˆæ¨è è¥¿æ—è¡—æœç´¢ï¼šhttp://www.xilinjie.com/ å„ç§ç”µå½±èµ„æº,è€ƒè¯•èµ„æ–™ï¼Œéƒ½æœ‰ï¼Œæœç´¢æ¯”è¾ƒç²¾å‡†ï¼Œæ¨è WolframAlpha :http://www.wolframalpha.com/å›½å¤–ç½‘ç«™ï¼Œå°±ä¸æ”¾å›¾äº†ï¼Œå¯ä»¥åœ¨çº¿è§£ç­”é—®é¢˜ï¼Œä¸ç®¡æ˜¯æ•°å­¦ï¼Œå†å²ï¼Œç”Ÿæ´»ï¼Œç­‰ç­‰ï¼Œéƒ½èƒ½å¸®ä½ å›ç­” StackExchangeï¼š https://stackexchange.com/å›½å¤–çš„â€™çŸ¥ä¹â€™,é‡Œé¢çš„é—®é¢˜å’Œå›ç­”çš„è´¨é‡å¾ˆé«˜ï¼Œè‹±è¯­å¥½çš„å¯ä»¥ç»å¸¸é€›é€› Githubï¼šhttp://www.github.com/å…¨çƒæœ€å¤§ä»£ç æ‰˜ç®¡å¹³å°ï¼Œæ²¡æœ‰ç¨‹åºå‘˜ä¸çŸ¥é“çš„å§ï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥æ‰¾åˆ°å„ç§å¼€æºé¡¹ç›®å’Œå…±äº«èµ„æºï¼Œæ¯”å¦‚è°·æ­Œé•œåƒï¼Œhoståœ°å€åˆ†äº«ç­‰ ç§å­æœç´¢ç±»(å®åœ¨å¤ªå¤šï¼Œéšä¾¿åˆ—å‡ ä¸ª) BTZO :http://www.btzo.net/ç”µå½±èµ„æºæŒºä¸°å¯Œçš„ï¼Œå„ç§vipç”µå½±éƒ½æœ‰ èƒ–æ¬¡æœç´¢ ï¼šhttp://www.panc.cc/ ç•Œé¢ç›¸å½“å¯çˆ±æœ‰æœ¨æœ‰ï¼Œå½“ç„¶èµ„æºä¹Ÿæ˜¯ç›¸å½“å¤šçš„ ç½‘ç›˜æœç´¢ ç½‘ç›˜æœ ï¼šhttp://www.wangpansou.com/ä½ æ˜¯ä¸æ˜¯ç»å¸¸é‡åˆ°æƒ³è¦çš„èµ„æºç™¾åº¦é“¾æ¥åˆå¤±æ•ˆäº†ï¼Œä¸è¦å®³æ€•ï¼Œä½¿ç”¨äº†ç½‘ç›˜æœï¼Œå…¨ç½‘èµ„æºä¸€ç½‘æ‰“å°½ï¼Œå†ä¹Ÿä¸éœ€è¦ç­‰å¾…åˆ«äººåˆ†äº«èµ„æºäº†ã€‚ å›¾ç‰‡ç±»ï¼ˆè®¾è®¡å¸ˆç¦åˆ©ï¼‰Everypixel : https://everypixel.com/å›½å¤–å›¾ç‰‡æœç´¢ç±»ç½‘ç«™ å›¾è™«ç½‘ https://tuchong.com/ æ‘„å½±çˆ±å¥½è€…å¿…å¤‡ Pixabay : https://pixabay.com/ å—¯ï¼Œå…è´¹é«˜æ¸…å›¾ç‰‡ï¼ï¼ï¼ï¼ Pexels : https://www.pexels.com/å›½å¤–ç½‘ç«™ï¼Œç´ æå¾ˆå¤šè€Œä¸”å…è´¹ã€‚ 500PXï¼šhttps://500px.com/ å·ç§°æœ€å‡ºè‰²çš„æ‘„å½±ä¸“åŒºï¼Œå—¯ï¼Œå€¼å¾—ä¸€è¯• è¿˜æœ‰å‡ ä¸ªæ‰¾iconçš„ç½‘ç«™ï¼šiconFont http://www.iconfont.cn/é˜¿é‡ŒçŸ¢é‡å›¾åº“ï¼Œé‡Œé¢æœ‰è®¸å¤šappçš„å›¾ç‰‡èµ„æºå’Œiconï¼Œå¹¶ä¸”æä¾›svgå’Œå›¾æ ‡é¢œè‰²è½¬æ¢ï¼Œæˆ‘å¹³æ—¶ä»¿å†™appå°±æ˜¯ç”¨çš„å®ƒæ¥æ‰¾iconçš„ easyicon :http://www.easyicon.net/iconsearch/See/ä¸€ä¸ªiconå›¾æ ‡æœç´¢ç½‘ç«™ æ­¤å¤–ï¼Œè¿˜æœ‰ç™¾åº¦çš„ç™¾åº¦è¯†å›¾ä¹Ÿä¸é”™ï¼Œæœ‰æ—¶å€™æ‰¾åˆ°äº†ä¸€å¼ éé«˜æ¸…çš„å›¾å¯ä»¥é€šè¿‡å®ƒæ‰¾åˆ°é«˜æ¸…çš„å›¾ï¼šhttp://image.baidu.com/?fr=shitu å½±è§†ç±»ï¼ˆé«˜æ¸…ç”µå½±åœ¨çº¿è§‚çœ‹ï¼‰æ¨èå‡ ä¸ªåœ¨çº¿è§‚çœ‹ç”µå½±çš„ç½‘ç«™ï¼Œæ²¡æœ‰å¹¿å‘Šå“¦,å½“ç„¶ï¼Œè¿™ç§ç½‘ç«™ç°åœ¨å¾ˆå¤šï¼Œæ¯•ç«Ÿæµé‡å¾ˆå¤§yy6080 ï¼šhttp://www.yy6080.org/,ç±»ä¼¼è¿˜æœ‰80s(è€ç‰Œç”µå½±ç½‘ç«™),äººäººå½±è§†ï¼Œå¤©å¤©ç¾å‰§,1905ç”µå½±ç½‘ï¼ŒBTå¤©å ‚ï¼Œç«¥è¯æ‘ï¼Œè¿™é‡Œå°±ä¸è´´åœ°å€äº†ï¼Œç™¾åº¦å°±èƒ½æ‰¾åˆ° éŸ³ä¹ç±»ï¼ˆhighåˆ°åœä¸ä¸‹æ¥ï¼‰å¼ºçƒˆå®‰åˆ©ä¸€æ¬¾å¬æ­Œç¥å™¨ï¼šlisten1 :http://listen1.github.io/listen1/è¿™æ˜¯ä¸€æ¬¾è°·æ­Œæµè§ˆå™¨æ’ä»¶ï¼Œå½“ä½ æƒ³å¬æŸä¸€é¦–æœ‰ç‰ˆæƒçš„æ­Œï¼ŒQQéŸ³ä¹æœ‰è¿™é¦–æ­Œçš„ç‰ˆæƒï¼Œè€Œç½‘æ˜“äº‘æ²¡æœ‰ï¼Œè€Œä½ ä½¿ç”¨çš„æ˜¯ç½‘æ˜“äº‘ï¼Œè€Œä½ åˆæƒ³å¬è¿™é¦–æ­Œï¼Œè¿™ä¸ªæ—¶å€™ä½ å°±ä¸å¾—ä¸ä½¿ç”¨QQéŸ³ä¹æ’­æ”¾å™¨ï¼Œæ˜¯ä¸æ˜¯å¾ˆé—¹å¿ƒï¼Œè¿™ä¸ªæ’ä»¶çš„ä½œç”¨å°±æ˜¯é›†ç»“äº†ä¸‰å¤§ä¸»æµå¹³å°çš„éŸ³ä¹ï¼Œè®©ä½ å…å»åˆ‡æ’­æ”¾å™¨çš„çƒ¦æ¼ï¼Œä»æ­¤ä¸€æ¬¡æ€§å¯ä»¥å¬3ä¸ªéŸ³ä¹å¹³å°çš„æ­Œäº†ã€‚ 5Sing : http://5sing.kugou.com/index.htmlå®ƒæ˜¯ä¸€ä¸ªåŸåˆ›éŸ³ä¹åŸºåœ°ï¼Œæœ‰è®¸å¤šçš„åŸåˆ›å’Œç¿»å”±ä¼´å¥æ­Œæ›²ã€‚ è½¯ä»¶å·¥å…·ç±»ï¼ˆè°ç”¨è°çŸ¥é“ï¼‰æ‰‹æœºapp:è—ä¹¦åº“ : http://www.geeboo.com/ è—ä¹¦é¦†ï¼Œæ˜¯è¯»ä¹¦çˆ±å¥½è€…åœ¨ç§»åŠ¨äº’è”ç½‘ç©ºé—´é‡Œçš„ä¸“å±ç§äººå›¾ä¹¦é¦†ï¼Œå®ƒé€šè¿‡å…±äº«å€Ÿé˜…çš„æ¨¡å¼ï¼Œå®ç°äº†ä¹¦å‹é—´æµ·é‡ä¹¦ç±çš„çº¿ä¸Šäº’å€Ÿã€‚ ç½‘æ˜“èœ—ç‰›è¯»ä¹¦ï¼šhttp://du.163.com/å…¨ç½‘æ¯å¤©æœ‰1å°æ—¶çš„å…è´¹è¯»ä¹¦æ—¶é—´ï¼Œæ¯”è¾ƒæœ‰ç‰¹è‰² ç½‘ç«™ï¼šTinyPNG:https://tinypng.com/è¿™æ˜¯ä¸€æ¬¾å¯ä»¥åœ¨çº¿å‹ç¼©å›¾ç‰‡çš„ç½‘ç«™ï¼Œå‹ç¼©åå›¾ç‰‡è´¨é‡è¿˜æŒºå¥½çš„ï¼Œæœ¬äººä¸€ç›´åœ¨ç”¨ 135ç¼–è¾‘å™¨ï¼šhttp://www.135editor.com/å¦‚æœä½ æ­£åœ¨è¿è¥ä¸€ä¸ªå…¬ä¼—å·ï¼Œé‚£ä¹ˆåœ¨å…¬ä¼—å·é‡Œå†™æ–‡ç« å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªç½‘ç«™ï¼Œé‡Œé¢çš„å…¬ä¼—å·æ¨¡æ¿å’Œæ’ç‰ˆä¸ªäººä¸€ç›´å¾ˆå–œæ¬¢ å¦å¤–ï¼Œå®‰åˆ©ä¸€ä¸ªæ·˜è½¯ä»¶çš„ç¥å™¨ç½‘ç«™ï¼š52ç ´è§£è®ºå›:https://www.52pojie.cn/é‡Œé¢æ±‡èš360ï¼Œè…¾è®¯ï¼Œé˜¿é‡Œç­‰å®‰å…¨å¤§ç‰›ï¼Œæ¯å¤©éƒ½æœ‰åŸåˆ›ç ´è§£è½¯ä»¶å‘å¸ƒï¼ŒæƒŠå–œå¤šå¤šå“¦~~ èµ„æºæš‚æ—¶åˆ†äº«åˆ°è¿™ï¼ŒåæœŸè¿˜ä¼šæŒç»­æ›´æ–°ï¼Œç å­—ä¸æ˜“ï¼Œå¦‚æœè§‰å¾—å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¸å¦‚ç‚¹å‡»ä¸‹æ–¹èµèµæŒ‰é’®è¯·æˆ‘å–æ¯å’–å•¡ï¼Œå¦å¤–ï¼Œä½ å¯ä»¥æŒ‰ä¸‹Ctrl+Dæ”¶è—è¯¥ç½‘å€æˆ–è€…åˆ†äº«ç»™å¥½å‹ï¼Œé˜²æ­¢ä¸‹æ¬¡æ‰¾ä¸åˆ°äº†å“¦~~]]></content>
      <categories>
        <category>èµ„æºæ•´åˆ</category>
      </categories>
      <tags>
        <tag>tools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€çœ‹å°±æ‡‚çš„è‡ªå®šä¹‰é¡¶éƒ¨ç²˜æ€§ä¸‹æ‹‰æ§ä»¶TouchPullViewå…¨é¢å‰–æ]]></title>
    <url>%2F%E4%B8%80%E7%9C%8B%E5%B0%B1%E6%87%82%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A1%B6%E9%83%A8%E7%B2%98%E6%80%A7%E4%B8%8B%E6%8B%89%E6%8E%A7%E4%BB%B6TouchPullView%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90.html</url>
    <content type="text"><![CDATA[ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„(www.huangjie.name)ï¼Œä¿æŠ¤åŸåˆ›ï¼Œä»æˆ‘åšèµ·. æ˜¨å¤©åœ¨æ…•è¯¾ä¸Šçœ‹åˆ°äº†ä¸€ä¸ªè‡ªå®šä¹‰ç²˜æ€§å¤´éƒ¨çš„å®ç°ï¼Œå‘ç°ç°åœ¨æœ‰è®¸å¤šçš„appéƒ½æœ‰è¿™ä¸ªæ•ˆæœï¼Œäºæ˜¯è·Ÿç€æ…•è¯¾ä¸Šå¾—è§†é¢‘æ•²äº†ä¸€éã€‚å› ä¸ºæ…•è¯¾ä¸Šçš„è€å¸ˆå¯¹äºååŠéƒ¨åˆ†çš„åæ ‡è¿ç®—è®²çš„å¹¶ä¸æ˜¯å¾ˆç»†è‡´ï¼Œå› æ­¤æˆ‘è‡ªå·±åˆ†æäº†ä¸€ä¸‹æºä»£ç ï¼Œæ€»ç»“äº†è¿™ç¯‡åšå®¢ï¼Œå¸Œæœ›å¯¹åŒå­¦ä»¬æœ‰æ‰€å¸®åŠ©ã€‚ æ…•è¯¾è§†é¢‘åœ°å€ï¼šhttps://www.imooc.com/learn/830æºç ä¸‹è½½åœ°å€ï¼šhttps://github.com/Jay-huangjie/TouchPullViewå»ºè®®å¤§å®¶å…ˆä¸‹è½½æºç å†æ¥è§‚çœ‹ ç”¨åˆ°çš„çŸ¥è¯†ç‚¹æˆ‘ä»¬å…ˆæ¥å¤ä¹ ä¸€ä¸‹éœ€è¦ç”¨åˆ°çš„æ•°å­¦çŸ¥è¯†ç‚¹ ä¸‰è§’å‡½æ•°ï¼š sin = a/c; cos = b/c; tan = a/b; è´å¡å°”æ›²çº¿ï¼š é˜…è¯»æœ¬æ–‡éœ€è¦äº†è§£è‡ªå®šä¹‰Viewçš„åŸºæœ¬æµç¨‹å’Œè´å¡å°”æ›²çº¿çš„ç»˜åˆ¶ã€‚ å¥½ï¼Œè¿›å…¥æ­£é¢˜ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹å®ƒçš„è¿è¡Œæ•ˆæœï¼š emmmmm,æ•ˆæœæ„Ÿè§‰è¿˜ä¸é”™~ å®ç°åŸç†æ—¢ç„¶æ˜¯æ‹–åŠ¨ï¼Œè‚¯å®šæ˜¯åŸºäºTouchäº‹ä»¶æ¥å®ç°çš„ï¼Œé€šè¿‡Touchçš„Yåæ ‡è·å–åˆ°æ‹–åŠ¨è¿›åº¦progress,ç„¶åé€šè¿‡requestLayoutæ–¹æ³•ä¸æ–­é‡ç»˜ç•Œé¢ï¼Œåœ¨onSizeChangedæ–¹æ³•ä¸­é€šè¿‡è®¡ç®—ä¸æ–­ç§»åŠ¨åœ†å¿ƒåæ ‡ï¼Œåœ†çš„å·¦å³ä¸¤è¾¹æ˜¯ç»å…¸çš„è´å¡å°”æ›²çº¿ï¼Œåªè¦è·å–åˆ°æ§åˆ¶ç‚¹å’Œç»“æŸç‚¹çš„åæ ‡å°±èƒ½ç»˜åˆ¶å‡ºæ¥ï¼Œé€šè¿‡æ§åˆ¶ç‚¹çš„ä¸æ–­ç§»åŠ¨å’ŒonDrawæ–¹æ³•ä¸­çš„ç”»å¸ƒçš„ä¸æ–­ç§»åŠ¨æ¥è¾¾åˆ°å¼¹æ€§å’Œé¡¶éƒ¨ä¸¤ä¸ªèµ·å§‹ç‚¹å‘ä¸­å¿ƒé æ‹¢çš„æ•ˆæœï¼Œä¸­é—´çš„åœ†å¿ƒä¸æ—è¾¹çš„é—´è·éƒ¨åˆ†åˆ™æ˜¯ä½¿ç”¨çš„drawableçš„Boundsæ•ˆæœ,å›å¼¹åˆ™æ˜¯åˆ©ç”¨çš„å±æ€§åŠ¨ç”»çš„addUpdateListeneræ¥å£å°†progressæ•°å€¼ç”±å¤§åˆ°å°æ‰§è¡Œå›å»ä»è€Œè¾¾åˆ°çš„å›å¼¹æ•ˆæœ å…·ä½“åˆ†æå…‰çœ‹åŸç†è‚¯å®šæ˜¯å››è„¸è’™è”½ï¼Œè¿˜æ˜¯ç»“åˆä»£ç åˆ†ææ‰èƒ½è¾¾åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœã€‚æˆ‘ä»¬å…ˆçœ‹OnTouchéƒ¨åˆ†çš„ä»£ç ï¼š123456789101112131415161718192021222324252627findViewById(R.id.ll_mainLayout).setOnTouchListener(new View.OnTouchListener() &#123; @Override public boolean onTouch(View v, MotionEvent event) &#123; int actionMasked = event.getActionMasked(); switch (actionMasked) &#123; case MotionEvent.ACTION_DOWN: mTouchStartY = event.getY(); return true; case MotionEvent.ACTION_MOVE: float y = event.getY(); if (y &gt;= mTouchStartY) &#123; //è¡¨ç¤ºå‘ä¸‹ç§»åŠ¨ float moveSize = y - mTouchStartY; float progress = moveSize &gt; TOUCH_MOVE_MAX_Y ? 1 : moveSize / TOUCH_MOVE_MAX_Y; //è®¡ç®—è¿›åº¦å€¼ touchView.setProgress(progress); return true; &#125; break; case MotionEvent.ACTION_UP: touchView.release(); return true; default: break; &#125; return false; &#125; &#125;); è¿™é‡Œè¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼Œé€šè¿‡getYè·å–æ»‘åŠ¨çš„è·ç¦»ï¼ŒæŒ‰ä¸‹å»æœ‰ä¸€ä¸ªç‚¹ï¼Œæ»‘åŠ¨åæœ‰ä¸€ä¸ªç‚¹ï¼Œä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»å°±æ˜¯æˆ‘ä»¬çš„moveSizeäº†ï¼Œç”±äºprogressæ˜¯æŒ‡å½“å‰æ»‘åŠ¨çš„è¿›åº¦å€¼ï¼Œå–å€¼è‚¯å®šæ˜¯åœ¨0~1ä¹‹é—´ï¼Œå› æ­¤ï¼Œå½“moveSizeå¤§äºæˆ‘ä»¬é¢„è®¾çš„æœ€å¤§å€¼æ—¶ï¼Œprogresså°±è¿”å›1ï¼Œå¦åˆ™å°±è¿”å›å…·ä½“çš„è¿›åº¦å€¼ï¼Œæœ€ååœ¨è®¾ç½®ç»™touchViewï¼ŒtouchViewå°±ä¼šè¿›è¡Œé‡ç»˜ã€‚ å†æ¥çœ‹ä¸‹TouchPullViewé‡Œé¢çš„ä»£ç ï¼šæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹å˜é‡ï¼š1234567891011121314private Paint mCirclePaint = new Paint(Paint.ANTI_ALIAS_FLAG); private float mCircleRadius = 50; //åœ†çš„åŠå¾„ private float mCirclePointX, mCirclePointY; //åœ†å¿ƒåæ ‡ private int mDargHeight = 400; //æœ€å¤§å¯ä¸‹æ‹‰çš„é«˜åº¦ private float mProgress; //ä¸‹æ‹‰è¿›åº¦å€¼ private int mTargetWidth = 400; //ç›®æ ‡å®½åº¦ private Path mPath = new Path(); //è´å¡å°”è·¯å¾„ private Paint mPathPaint = new Paint(Paint.ANTI_ALIAS_FLAG); //è´å¡å°”ç”»ç¬” private int mTargetGravityHeight = 10; //é‡å¿ƒç‚¹æœ€ç»ˆé«˜åº¦ï¼Œå†³å®šæ§åˆ¶ç‚¹çš„Yåæ ‡ private int mTargetAngle = 105; //è§’åº¦å˜æ¢ 0~135 private Interpolator mProgessInterpolator = new DecelerateInterpolator(); //ä¸€ä¸ªç”±å¿«åˆ°æ…¢çš„æ’å€¼å™¨ private Interpolator mTanentAngleInterpolator; private Drawable content = null; //ä¸­å¿ƒåœ†drawable private int mContentDrawableMargin = 0; //ä¸­å¿ƒåœ†Drawableè¾¹è· å¤§éƒ¨åˆ†å˜é‡éƒ½ç®€æ´æ˜äº†ï¼ŒmTargetGravityHeightè§„å®šäº†æ§åˆ¶ç‚¹ä¸Šä¸‹æµ®åŠ¨çš„æœ€å¤§è·ç¦»ï¼Œè¯¥å€¼è¶Šå¤§ï¼Œæ§åˆ¶ç‚¹è¶Šå¾€ä¸‹ç§»ï¼ŒmTargetAngleè§„å®šäº†ç»“æŸç‚¹ä¸åœ†å¿ƒè¿çº¿çš„é‚£ä¸ªè§’åº¦çš„æœ€å¤§å˜å¹»å€¼ï¼Œå› ä¸ºä¸è§„å®šå¯ä»¥çœ‹åˆ°ç»“æŸç‚¹ä¼šå›´ç»•åœ†å¿ƒåšåœ†ç¯è¿åŠ¨ï¼Œæœ€ç»ˆå¯¼è‡´å˜å½¢ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°çš„ã€‚mTargetWidthåˆ™è§„å®šäº†è¯¥æ§ä»¶èƒ½ç¼©å°çš„æœ€å°å®½åº¦ã€‚ æ¥ä¸‹æ¥çœ‹onDraw()æ–¹æ³•çš„å®ç°ï¼š12345678910111213141516171819202122@Override protected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); //åŸºç¡€åæ ‡ç³»æ”¹å˜ int count = canvas.save(); //è·å–å¹³ç§»ç”»å¸ƒçš„Xçš„å€¼,éšç€ä¸‹æ»‘èµ·å§‹ç‚¹çš„åæ ‡ç§»åŠ¨ final float transX = (getWidth() - getValueByLine(getWidth(), mTargetWidth, mProgress)) / 2; canvas.translate(transX, 0); //ç»˜åˆ¶è´å¡å°” canvas.drawPath(mPath, mPathPaint); //ç”»åœ† canvas.drawCircle(mCirclePointX, mCirclePointY, mCircleRadius, mCirclePaint); //ç»˜åˆ¶Drawable Drawable drawable = content; if (drawable != null) &#123; canvas.save(); canvas.clipRect(drawable.getBounds()); drawable.draw(canvas); canvas.restore(); &#125; canvas.restoreToCount(count); &#125; getValueByLineæ–¹æ³•çš„ä½œç”¨æ˜¯è·å–æŸä¸€æ—¶åˆ»è´å¡å°”æ›²çº¿ä¸Šçš„ç‚¹çš„åæ ‡ï¼Œçœ‹ä¸€ä¸‹å®ƒçš„æ–¹æ³•å®ç°ï¼š1234567891011/** * è·å–æŸä¸€æ—¶åˆ»çš„å€¼ * * @param star èµ·å§‹ç‚¹ * @param end ç»“æŸç‚¹ * @param mProgress å½“å‰è¿›åº¦å€¼ * @return */ private float getValueByLine(float star, float end, float mProgress) &#123; return star + (end - star) * mProgress; &#125; å®ƒå°±æ˜¯ä¸€ä¸ªè´å¡å°”æ›²çº¿å…¬å¼Bt = P0+(P1-P0)*tï¼Œä¼ å…¥åˆå§‹åæ ‡P0å’Œç»“æŸåæ ‡P1å’Œæ—¶é—´tï¼Œå°±èƒ½è·å–åˆ°Btäº†ã€‚æ¥ç€å®ƒå¾—åˆ°äº†ä¸€ä¸ªtransX,å®ƒç­‰äºèµ·å§‹ç‚¹ä¸å±å¹•å·¦å³çš„è·ç¦»ï¼Œé€šè¿‡ç”»å¸ƒçš„ç§»åŠ¨æ¥å®ç°èµ·å§‹ç‚¹ä¸æ–­é æ‹¢çš„æ•ˆæœï¼Œæ¥ä¸‹æ¥æ˜¯ç»˜åˆ¶è´å¡å°”æ›²çº¿ï¼Œç”»åœ†ï¼Œæ ¹æ®Boundså¤§å°æ·»åŠ Drawableåˆ°ç”»å¸ƒä¸Šã€‚ æ¥ä¸‹æ¥åˆ†ææˆ‘ä»¬çš„é‡ç‚¹ï¼šonSizeChangedä¸­çš„å®ç°,å…³é”®æ˜¯è¿™ä¸ªæ–¹æ³•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566/** * æ›´æ–°è·¯å¾„ */ private void updatePathLayout() &#123; final float progress = mProgessInterpolator.getInterpolation(mProgress); //è·å–æ‰€æœ‰çš„å¯ç»˜åˆ¶çš„å®½/é«˜ æ­¤å€¼ä¼šæ ¹æ®progressä¸æ–­çš„å˜åŒ– final float w = getValueByLine(getWidth(), mTargetWidth, mProgress); final float h = getValueByLine(0, mDargHeight, mProgress); //åœ†å¿ƒXåæ ‡ final float cPointX = w / 2; //åŠå¾„ final float cRadius = mCircleRadius; //åœ†å¿ƒYåæ ‡ final float cPaintY = h - cRadius; //æ§åˆ¶ç‚¹ç»“æŸYçš„å€¼ final float endPointY = mTargetGravityHeight; //æ›´æ–°åœ†å¿ƒåæ ‡ mCirclePointX = cPointX; mCirclePointY = cPaintY; final Path path = mPath; path.reset(); //é‡ç½® path.moveTo(0, 0); //åæ ‡ç³»æ˜¯ä»¥æœ€å·¦è¾¹çš„èµ·å§‹ç‚¹ä¸ºåŸç‚¹ float lEndPointX, lEndPointY; //ç»“æŸç‚¹çš„X,Yåæ ‡ float lControlPointX, lControlPointY; //æ§åˆ¶ç‚¹çš„Xï¼ŒYåæ ‡ //è·å–å½“å‰åˆ‡çº¿çš„å¼§åº¦ double angle = mTanentAngleInterpolator.getInterpolation(progress) * mTargetAngle;//è·å–å½“å‰çš„è§’åº¦ double radian = Math.toRadians(angle); //è·å–å½“å‰å¼§åº¦ float x = (float) (Math.sin(radian) * cRadius); //æ±‚å‡ºâ€œè‚¡â€çš„é•¿åº¦ï¼ˆé•¿çš„é‚£æ¡ç›´è§’è¾¹ï¼‰ float y = (float) (Math.cos(radian) * cRadius); //æ±‚å‡ºâ€œå‹¾â€çš„é•¿åº¦ï¼ˆçŸ­çš„é‚£æ¡ç›´è§’è¾¹ï¼‰ lEndPointX = cPointX - x; //ä»¥èµ·å§‹ç‚¹ä¸ºåŸç‚¹ï¼Œxåæ ‡å°±ç­‰äºåœ†çš„Xåæ ‡å‡å»è‚¡çš„é•¿åº¦ lEndPointY = cPaintY + y; //ä»¥èµ·å§‹ç‚¹ä¸ºåŸç‚¹ï¼Œyåæ ‡å°±ç­‰äºåœ†çš„yåæ ‡åŠ ä¸Šå‹¾çš„é•¿åº¦ lControlPointY = getValueByLine(0, endPointY, progress);//è·å–æ§åˆ¶ç‚¹çš„Yåæ ‡ float tHeight = lEndPointY - lControlPointY; //ç»“æŸç‚¹ä¸æ§åˆ¶ç‚¹çš„Yåæ ‡å·®å€¼ float tWidth = (float) (tHeight / Math.tan(radian)); //é€šè¿‡è®¡ç®—ä¸¤ä¸ªè§’åº¦æ˜¯ç›¸ç­‰çš„ï¼Œå› æ­¤å¼§åº¦ä¾æ—§é€‚ç”¨ lControlPointX = lEndPointX - tWidth; //ç»“æŸç‚¹çš„x - â€˜å‹¾â€™ çš„é•¿åº¦æ±‚å‡ºäº†æ§åˆ¶ç‚¹çš„Xåæ ‡ path.quadTo(lControlPointX, lControlPointY, lEndPointX, lEndPointY); //ç”»å·¦è¾¹è´å¡å°”æ›²çº¿ path.lineTo(cPointX + (cPointX - lEndPointX), lEndPointY); //å·¦å³ä¸¤ä¸ªç»“æŸç‚¹ç›¸è¿ path.quadTo(cPointX + (cPointX - lControlPointX), lControlPointY, w, 0); //ç”»å³è¾¹è´å¡å°”æ›²çº¿ updateContentLayout(cPointX, cPaintY, cRadius); &#125; /** * æµ‹é‡å¹¶è®¾ç½®ä¸­å¿ƒDrawable * * @param cx * @param cy * @param radius */ private void updateContentLayout(float cx, float cy, float radius) &#123; Drawable drawable = content; if (drawable != null) &#123; int margin = mContentDrawableMargin; int l = (int) (cx - radius + margin); int r = (int) (cx + radius - margin); int t = (int) (cy - radius + margin); int b = (int) (cy + radius - margin); drawable.setBounds(l, t, r, b); &#125; &#125; å…¶ä¸­æ¯ä¸€è¡Œæˆ‘éƒ½å¤‡æ³¨äº†æ³¨é‡Šï¼Œè¦ç†è§£å…¶ä¸­çš„è®¡ç®—ï¼Œå°±å¾—å…ˆä¸Šä¸ªå›¾ï¼š æˆ‘ä»¬è„‘æµ·ä¸­è¦æœ‰ä¸€ä¸ªæ¸…æ™°çš„å®šä¹‰ï¼Œæ•´ä¸ªåæ ‡ç³»æ˜¯åŸºäºèµ·å§‹ç‚¹ä¸ºåŸç‚¹ï¼Œå‘å³ä¸‹å»¶ä¼¸Xï¼ŒYè½´ï¼Œå·¦å³çš„è´å¡å°”æ›²çº¿æ˜¯ç”±ä¸€æ”¯ç”»ç¬”å®Œæˆ,é€šè¿‡lineToç›¸è¿æ¥ï¼Œå› æ­¤æ•´ä¸ªæ›²çº¿å‘ˆVå­—å½¢ã€‚æ¥ä¸‹æ¥çœ‹ä»£ç ï¼šé¦–å…ˆæ±‚å¾—äº†progressï¼Œè¿™ä¸ªæ— éœ€è§£é‡Šï¼Œä½¿ç”¨åŠ é€Ÿå™¨åªæ˜¯ä¸ºäº†æ›´å¥½çš„æ•ˆæœã€‚æ¥ä¸‹æ¥æ˜¯wå’Œh,è¿™æ˜¯æ§ä»¶çš„æŸä¸€è¿›åº¦ä¸‹çš„å®½å’Œé«˜ï¼Œä¸ºä»€ä¹ˆé€šè¿‡getValueByLineæ–¹æ³•å°±èƒ½å¾—åˆ°å‘¢ï¼Ÿè¯·çœ‹è¾“å…¥çš„å‚æ•°ï¼Œèµ·å§‹ç‚¹æ˜¯getWidthï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªå±å¹•çš„å®½åº¦ï¼Œç»ˆç‚¹æ˜¯mTargetWidthä¹Ÿå°±æ˜¯æˆ‘ä»¬è§„å®šçš„æœ€å°å®½åº¦ï¼Œè€ŒgetValueByLineæ­£å¥½æ˜¯æ±‚å¾—æŸä¸€æ—¶åˆ»çš„è´å¡å°”å€¼ï¼Œå› æ­¤å°†progressè¾“å…¥æ­£å¥½æ±‚å¾—ä»æ•´ä¸ªå±å¹•è¿åŠ¨åˆ°æœ€å°å®½åº¦ä¹‹é—´çš„æŸä¸€ä¸ªå®½åº¦ï¼Œé«˜åº¦åŒç†ã€‚å®½é«˜æ±‚å‡ºæ¥äº†é‚£ä¸ªåœ†å¿ƒçš„åæ ‡ä¹Ÿå°±ç›¸åº”å‡ºæ¥äº†ï¼Œæ³¨æ„æ•´ä¸ªåœ†çš„å¤§å°åŒ…å«marginå€¼ï¼Œä¹Ÿå°±æ˜¯åœ†ä¸å·¦å³ä¸¤è¾¹çš„è¾¹è·ä¹Ÿæ˜¯åŒ…å«çš„ã€‚å› ä¸ºmTargetGravityHeightæ˜¯æˆ‘ä»¬è®¾å®šçš„æ§åˆ¶ç‚¹ä¸‹ç§»çš„é«˜åº¦ï¼Œå› æ­¤ä¹Ÿå°±æ˜¯æ§åˆ¶ç‚¹Yçš„åæ ‡ã€‚å› ä¸ºquadToæ–¹æ³•éœ€è¦æ§åˆ¶ç‚¹çš„åæ ‡å’Œç»“æŸç‚¹çš„åæ ‡ï¼Œå› æ­¤æ±‚å‡ºè¿™ä¸¤ä¸ªç‚¹çš„åæ ‡å°±å¤§åŠŸå‘Šæˆäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ•°å­¦çŸ¥è¯†äº†ã€‚é¦–å…ˆï¼Œé€šè¿‡æ’å€¼å™¨çš„æ–¹æ³•è·å¾—äº†æŸä¸€æ—¶åˆ»çš„è§’åº¦ï¼Œæœ€åé€šè¿‡Mathæ–¹æ³•å¾—åˆ°äº†å¼§åº¦,ä¹Ÿå°±æ˜¯å›¾ä¸­bçš„è§’åº¦ï¼ŒåŠå¾„æˆ‘ä»¬æ˜¯çŸ¥é“çš„ï¼Œæ‰€ä»¥é€šè¿‡sinå¯ä»¥å¾—å‡ºå›¾ä¸­xçš„é•¿åº¦ï¼Œç„¶åé€šè¿‡åŠå¾„çš„xåæ ‡å‡å»xçš„é•¿åº¦å°±å¾—åˆ°äº†ç»“æŸç‚¹çš„xåæ ‡ã€‚é€šè¿‡cosæˆ‘ä»¬å¯ä»¥å¾—åˆ°yçš„é•¿åº¦,åœ†å¿ƒYçš„åæ ‡åŠ ä¸Šyçš„åæ ‡å°±å¾—åˆ°äº†ç»“æŸç‚¹yçš„åæ ‡ï¼ŒlEndPointXï¼ŒlEndPointYçš„å€¼ä¹Ÿå°±å¾—åˆ°äº†ã€‚å› ä¸ºæˆ‘ä»¬å·²çŸ¥æ§åˆ¶ç‚¹ä¸Šä¸‹è¿è¡Œçš„èµ·å§‹å€¼å’Œæœ€å¤§å€¼ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨getValueByLineè·å–åˆ°å½“å‰çš„yåæ ‡ï¼Œæ¥ä¸‹æ¥åªéœ€è¦æ±‚å‡ºæ§åˆ¶ç‚¹çš„xåæ ‡å°±è¡Œäº†,tHeightè¡¨ç¤ºå·¦è¾¹è¿™æ¡ç›´è§’çš„é•¿ç›´è§’è¾¹ï¼Œç»“æŸç‚¹çš„yåæ ‡å·²çŸ¥ï¼Œæ§åˆ¶ç‚¹çš„yåæ ‡å·²çŸ¥ï¼Œå› æ­¤å¯ä»¥æ±‚å‡ºtHeightã€‚å› ä¸ºå¹³è¡Œçº¿é—´çš„è§’åº¦ç›¸ç­‰ï¼Œå› æ­¤a = cï¼Œåˆå› ä¸ºc+d = e+d = 90; æ‰€ä»¥c = eï¼›æ‰€ä»¥a = e;tHeightå·²çŸ¥ï¼Œeå·²çŸ¥ï¼Œæ‰€ä»¥tWidthçš„å€¼å°±èƒ½æ±‚å‡ºæ¥äº†ã€‚æ‰€ä»¥æ§åˆ¶ç‚¹çš„xåæ ‡å°±ç­‰äºç»“æŸç‚¹çš„xåæ ‡å‡å»tWidthã€‚è‡³æ­¤æ‰€æœ‰çš„åæ ‡éƒ½å·²ç»æ±‚å‡ºæ¥äº†ï¼Œæ‰€ä»¥è´å¡å°”æ›²çº¿ä¹Ÿå°±èƒ½ç»˜åˆ¶å‡ºæ¥äº†ã€‚ æ¥ä¸‹æ¥è¿˜æœ‰ä¸ªæµ‹é‡çš„è¿‡ç¨‹ï¼Œé€»è¾‘æ¯”è¾ƒç®€å•ï¼š12345678910111213141516171819202122232425262728293031323334@Override protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123; int MIN_W = (int) (mCircleRadius * 2 + getPaddingLeft() + getPaddingRight()); //éœ€è¦çš„æœ€å°å®½åº¦ int MIN_H = (int) ((mDargHeight * mProgress + 0.5f) //mDargHeight * mProgress = moveSize(å³actionMove.getY - actionDown.getY),+0.5fä¸ºå››èˆäº”å…¥ + getPaddingBottom() + getPaddingTop()); int widthMeasure = getMeasureSize(widthMeasureSpec, MIN_W); int heightMeasure = getMeasureSize(heightMeasureSpec, MIN_H); setMeasuredDimension(widthMeasure, heightMeasure); &#125; /** * è·å–æ‰€éœ€è¦çš„å®½/é«˜çš„æµ‹é‡ç»“æœ * * @param Spec æµ‹é‡æ¨¡å¼ * @param minValue è§„å®šçš„æœ€å°å€¼ * @return æµ‹é‡ç»“æœ */ private int getMeasureSize(int Spec, int minValue) &#123; int result; int mode = MeasureSpec.getMode(Spec); int size = MeasureSpec.getSize(Spec); switch (mode) &#123; case MeasureSpec.AT_MOST: //wrap_content result = Math.min(size, minValue); //å–æµ‹é‡å€¼å’Œè§„å®šçš„æœ€å°å®½åº¦ä¸­çš„æœ€å°å€¼ break; case MeasureSpec.EXACTLY: //match_parent or exactly num result = size; break; default: //å…¶ä½™æƒ…å†µå–æœ€å°å€¼ result = minValue; break; &#125; return result; &#125; æˆ‘å°†è§†é¢‘ä¸­çš„ä»£ç åšäº†ä¸€ä¸‹ç®€å•çš„å°è£…ï¼Œä»£ç ä¸­æœ‰è¯¦ç»†çš„æ³¨é‡Šï¼Œæˆ‘è¿™é‡Œå°±ä¸åšåˆ†æäº†ã€‚ æ•´ä¸ªåˆ†ææµç¨‹å°±åˆ°è¿™ï¼Œå¦‚æœæœ‰é”™è¯¯çš„åœ°æ–¹ï¼Œæ¬¢è¿æŒ‡æ­£ï¼ŒThanks~]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
        <category>å®‰å“ç‰¹æ•ˆåˆé›†è§£æ</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®‰å“Viewä½“ç³»-Viewçš„å·¥ä½œæµç¨‹]]></title>
    <url>%2F%E5%AE%89%E5%8D%93View%E4%BD%93%E7%B3%BB-View%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B.html</url>
    <content type="text"><![CDATA[è‡ªå®šä¹‰Viewä¸‰éƒ¨æ›²ï¼šonMeasure â€“&gt; onLayout â€“&gt;onDraw,æœ¬æ–‡ç€é‡è§£æå‰ä¸¤ä¸ªæ–¹æ³• onMeasure1234@Override protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123; super.onMeasure(widthMeasureSpec, heightMeasureSpec); &#125; æåˆ°è¿™ä¸ªæ–¹æ³•ï¼Œå°±å¿…é¡»å…ˆäº†è§£MeasureSpecè¿™ä¸ªç±»ï¼Œå®ƒæœ‰ä¸€ä¸ªgetModeå’ŒgetSizeæ–¹æ³•ï¼Œç”¨äºè·å–SpecModeå’ŒSpecSize,é‚£ä¹ˆè¿™ä¸¤ä¸ªå‚æ•°åˆæ˜¯ä½•ç‰©å‘¢ï¼Ÿè¯·çœ‹ä»¥ä¸‹ä¸€èˆ¬è‡ªå®šä¹‰Viewçš„å®Œæ•´å®ç°ï¼š1234567891011121314151617181920@Override protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123; setMeasuredDimension(getDefaultSize(getSuggestedMinimumWidth(),widthMeasureSpec),getDefaultSize(getSuggestedMinimumHeight(),heightMeasureSpec)); &#125; public static int getDefaultSize(int size,int measureSpec)&#123; int result = size; int SpecMode = MeasureSpec.getMode(measureSpec); int SpecSize = MeasureSpec.getSize(measureSpec); switch (SpecMode)&#123; case MeasureSpec.UNSPECIFIED: result = size; break; case MeasureSpec.AT_MOST: case MeasureSpec.EXACTLY: result = SpecSize; break; &#125; return result; &#125; å¯ä»¥çœ‹åˆ°ï¼ŒSpecModeæ˜¯æŒ‡æµ‹é‡çš„æ¨¡å¼ï¼Œå®ƒæœ‰ä¸‰ç§æ¨¡å¼ï¼š UNSPECIFIEDä»£è¡¨çˆ¶å®¹å™¨ä¸å¯¹Viewæœ‰ä»»ä½•çš„å¤§å°é™åˆ¶ï¼Œä¸€èˆ¬ç”¨äºç³»ç»Ÿçš„å†…éƒ¨ï¼Œå¾ˆå°‘ç”¨åˆ° AT_MOSTä»£è¡¨çˆ¶å®¹å™¨æŒ‡å®šäº†ä¸€ä¸ªå¤§å°å³SpecSize,Viewçš„å¤§å°ä¸èƒ½å¤§äºè¿™ä¸ªå€¼ï¼Œå®ƒå¯¹åº”äºLayoutParamsä¸­çš„wrap_contentï¼Œç»“åˆå®ƒä½ å°±å¾ˆå¥½ç†è§£äº† EXACTLYçˆ¶å®¹å™¨å·²ç»æ£€æµ‹åˆ°äº†viewæ‰€éœ€çš„ç²¾ç¡®å¤§å°ï¼Œè¿™æ—¶çš„viewçš„æœ€ç»ˆå¤§å°å°±æ˜¯SpecSizeä¸­çš„å€¼ï¼Œå®ƒå¯¹åº”äºLayoutParamä¸­çš„match_parentæˆ–è€…å…·ä½“çš„æ•°å€¼ è€ŒSpecSizeæ˜¯æŒ‡æŸç§æ¨¡å¼ä¸‹çš„è§„æ ¼å¤§å°ã€‚ å› æ­¤ï¼Œç»“åˆæ­¤æ–¹æ³•ï¼Œå½“viewçš„å¤§å°æ˜¯wrap_contentæˆ–è€…æ˜¯match_parentæˆ–è€…æ˜¯å…·ä½“çš„æ•°å€¼æ—¶ï¼Œéƒ½æ˜¯ä½¿ç”¨çš„çˆ¶å®¹å™¨ç»™å­viewæµ‹é‡çš„specsizeçš„å€¼ï¼Œå½“çˆ¶å®¹å™¨å¯¹å­viewæ²¡æœ‰ä»»ä½•çº¦æŸæ—¶ï¼Œç»™viewä¸€ä¸ªæ‰€è§„å®šçš„æœ€å°å€¼ï¼ˆgetSuggestedMinimumâ€¦æ–¹æ³•è·å–ï¼‰,setMeasuredDimensionå°±æ˜¯ç”¨æ¥è®¾ç½®viewçš„æµ‹é‡å¤§å°çš„ã€‚MeasureSpecç±»çš„å€¼çš„è·å–æ˜¯ç”±çˆ¶å®¹å™¨çš„MeasureSpecå’Œè‡ªèº«çš„LayoutParamsæ¥å…±åŒç¡®å®šçš„ï¼ŒMeasureSpecä¸€æ—¦ç¡®å®šï¼ŒonMeasureä¸­å°±å¯ä»¥ç¡®å®šviewçš„æµ‹é‡å®½é«˜äº†ã€‚ è¿™é‡Œå†æ¥è®²è§£ä¸€ä¸‹getSuggestedMinimumWidthè¿™ç±»æ–¹æ³•ï¼Œå®ƒçš„é€»è¾‘æ˜¯è¿™æ ·çš„ï¼šå¦‚æœViewæ²¡æœ‰è®¾ç½®èƒŒæ™¯ï¼Œé‚£ä¹ˆå®ƒä¼šè¿”å›minWidthè®¾ç½®çš„å€¼ï¼Œå¯ä»¥ä¸º0ï¼Œå¦‚æœviewè®¾ç½®äº†èƒŒæ™¯ï¼Œé‚£ä¹ˆå®ƒä¼šè¿”å›minWidthå’ŒèƒŒæ™¯æœ€å°å®½åº¦çš„ä¸¤è€…ä¹‹é—´çš„æœ€å¤§å€¼ã€‚ ä¸€èˆ¬çš„è‡ªå®šä¹‰Viewæˆ‘ä»¬ä¸»è¦æ˜¯ç€é‡å¤„ç†AT_MOSTæ¨¡å¼çš„å€¼ï¼Œéœ€è¦æ ¹æ®å®é™…çš„æƒ…å†µæ¥ï¼Œæ²¡æœ‰å›ºå®šçš„ä¾æ®ï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹ä¸‹TextViewç­‰æ§ä»¶çš„æºç æ˜¯æ€ä¹ˆå¤„ç†çš„ã€‚ Activityä¸­Viewçš„å®½/é«˜è·å–é€šè¿‡ä»¥ä¸Šåˆ†æè¯»è€…å·²ç»çŸ¥é“Viewçš„å®½é«˜æ˜¯éœ€è¦çˆ¶å®¹å™¨å»æµ‹é‡çš„ï¼Œå› æ­¤æˆ‘ä»¬å¦‚æœåœ¨onCreateæˆ–è€…onStaræ–¹æ³•ä¸­å»è·å–Viewçš„å®½é«˜å‘ç°å¹¶ä¸èƒ½ä¿è¯ç™¾åˆ†ç™¾è·å–åˆ°ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆæ–¹æ³•èƒ½è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Œä»¥ä¸‹æœ‰4ä¸ªæ–¹æ³•èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 1.onWindowFocusChangedå½“Activityçš„çª—å£å¾—åˆ°ç„¦ç‚¹æˆ–å¤±å»ç„¦ç‚¹éƒ½ä¼šè¢«è°ƒç”¨ä¸€æ¬¡,å¹¶ä¸”æ­¤æ—¶Viewå·²ç»åˆå§‹åŒ–å®Œæ¯•ï¼Œå› æ­¤æ­¤æ—¶å»è·å–Viewçš„å®½é«˜æ˜¯æ²¡é—®é¢˜çš„1234567@Override public void onWindowFocusChanged(boolean hasFocus) &#123; super.onWindowFocusChanged(hasFocus); if (hasFocus)&#123; int width = view.getMeasuredWidth(); &#125; &#125; 2.view.post(runnable)é€šè¿‡postå¯ä»¥å°†ä¸€ä¸ªrunnableæŠ•é€’åˆ°æ¶ˆæ¯é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œç„¶åç­‰å¾…Looperè°ƒç”¨æ­¤runnableçš„æ—¶å€™ï¼Œviewæ­¤æ—¶ä¹Ÿå·²ç»åˆå§‹åŒ–å¥½äº†ã€‚123456view.post(new Runnable() &#123; @Override public void run() &#123; int width = view.getMeasuredWidth(); &#125; &#125;); 3.ViewTreeObserverä½¿ç”¨ViewTreeObserverè¿™ä¸ªç±»çš„å›è°ƒå¯ä»¥å®Œæˆï¼Œæ¯”å¦‚OnGlobalLayoutListenerï¼Œå½“Viewæ ‘çš„çŠ¶æ€æ”¹å˜æˆ–è€…å†…éƒ¨viewçš„å¯è§æ€§å‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¯¥æ¥å£ä¼šè¢«å›è°ƒï¼Œæ³¨æ„ï¼Œæ­¤æ¥å£ä¼šå›è°ƒå¤šæ¬¡ã€‚12345678final ViewTreeObserver viewTreeObserver = view.getViewTreeObserver(); viewTreeObserver.addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() &#123; @Override public void onGlobalLayout() &#123; view.getViewTreeObserver().removeOnGlobalLayoutListener(this); int width = view.getMeasuredWidth(); &#125; &#125;); 4.view.measure(int widthMeasureSpec, int heightMeasureSpec)æ‰‹åŠ¨å¯¹viewè¿›è¡Œæµ‹é‡æ¥å¾—å‡ºviewçš„å®½é«˜ï¼Œè¿™ç§å®ç°æ¯”è¾ƒçš„å¤æ‚ï¼Œéœ€è¦çœ‹viewçš„LayoutParamï¼š match_parentæ— æ³•å¾—å‡ºViewçš„å®½/é«˜ï¼Œå› ä¸ºæ­¤ç§æƒ…å†µéœ€è¦è·å–åˆ°çˆ¶å®¹å™¨çš„å‰©ä½™ç©ºé—´ï¼Œè€Œæ­¤æ—¶æˆ‘ä»¬æ˜¯è·å–ä¸åˆ°çš„ å…·ä½“çš„æ•°å€¼æ¯”å¦‚å®½/é«˜éƒ½æ˜¯50px,é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™æ¥è·å–ï¼š123int widthMeasureSpec = View.MeasureSpec.makeMeasureSpec(100, View.MeasureSpec.EXACTLY);int heightMeasureSpec = View.MeasureSpec.makeMeasureSpec(100,View.MeasureSpec.EXACTLY);view.measure(widthMeasureSpec,heightMeasureSpec); wrap_content123 int widthMeasureSpec = View.MeasureSpec.makeMeasureSpec((1&lt;&lt;30)-1, View.MeasureSpec.AT_MOST);int heightMeasureSpec = View.MeasureSpec.makeMeasureSpec((1&lt;&lt;30)-1,View.MeasureSpec.AT_MOST); view.measure(widthMeasureSpec,heightMeasureSpec); æ³¨æ„(1&lt;&lt;30)-1è¿™ä¸ªå€¼ï¼Œé€šè¿‡æŸ¥çœ‹æºç å¯ä»¥çŸ¥é“Viewçš„å°ºå¯¸æ˜¯ä½¿ç”¨çš„30ä½äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œæ‰€ä»¥æœ€å¤§å€¼æ˜¯30ä¸ª1ï¼ˆ2^30-1ï¼‰ï¼Œä¹Ÿå°±ç­‰äºï¼ˆ1&lt;&lt;30ï¼‰-1ï¼Œæ‰€ä»¥ç»™å‡ºè¿™ä¸ªæ•°å€¼æ˜¯åˆç†çš„ã€‚ onLayoutonLayoutæ–¹æ³•æ˜¯ViewGroupç”¨æ¥ç»™å­å…ƒç´ ç¡®å®šä½ç½®çš„ï¼Œç›¸æ¯”å¦‚onMeasureæ–¹æ³•ï¼ŒonLayoutåˆ™ç®€å•å¤šäº†ï¼š1234@Override protected void onLayout(boolean changed, int left, int top, int right, int bottom) &#123; super.onLayout(changed, left, top, right, bottom); &#125; åå››ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨å·¦ï¼Œä¸Šï¼Œå³ï¼Œä¸‹ï¼Œåªéœ€è¿”å›ä¸åŒçš„åæ ‡å³å¯ç¡®å®šViewçš„ä½ç½®ã€‚]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
        <category>å®‰å“Viewä½“ç³»</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®‰å“Viewä½“ç³»:Viewçš„ä¸€äº›åŸºæœ¬çŸ¥è¯†ç‚¹]]></title>
    <url>%2F%E5%AE%89%E5%8D%93View%E4%BD%93%E7%B3%BB-View%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86%E7%82%B9.html</url>
    <content type="text"><![CDATA[å®‰å“å¼€å‘ä¸­ç†Ÿç»ƒä½¿ç”¨è‡ªå®šä¹‰Viewæ˜¯å¼€å‘è€…å¿…å¤‡çš„æŠ€èƒ½ï¼Œå› ä¸ºå®‰å“åŸç”Ÿæ§ä»¶å¾ˆå¤šæ—¶å€™æ˜¯ä¸èƒ½æ»¡è¶³éœ€æ±‚çš„ï¼Œè€Œè‡ªå®šä¹‰æ§ä»¶èƒ½åšå‡ºå„ç§ç»šä¸½çš„æ•ˆæœ,ç”¨äºæ»¡è¶³äº§å“å„ç§å¥‡æ€ªçš„éœ€æ±‚(æˆ‘ä¸ºä»€ä¹ˆè¦ç”¨å¥‡æ€ªå‘¢ï¼Œå“ˆå“ˆå“ˆå“ˆ)ã€‚ è‡ªå®šä¹‰Viewè¦æŒæ¡çš„å†…å®¹è‡ªå®šä¹‰Viewä¸»è¦æ˜¯æŒæ¡ä»¥ä¸‹äº”ä¸ªå†…å®¹ï¼š ç»˜åˆ¶åŸç†: æŒæ¡onMeasure,onLayout,onDrawåŠç›¸å…³ç±»çš„ä½¿ç”¨ã€‚ äº‹ä»¶ä¼ é€’ï¼šæŒæ¡dispathTouchEvent(),onInterceptEvent(),onTouchEvent()ä¸‰è€…çš„ä¼ é€’é€»è¾‘. åŠ¨ç”»ï¼šå±æ€§åŠ¨ç”»ï¼Œç”¨äºå¯¹Viewè¿›è¡ŒåŠ¨ç”»æ“ä½œ ç›¸å…³æ‰‹åŠ¿ï¼šGestureDetectorï¼ŒVelocityTrackerç­‰ç±»çš„åº”ç”¨ æ»‘åŠ¨ï¼šæ»‘åŠ¨çš„ä¸‰ç§å®ç°æ–¹æ³•ï¼ŒScrollerçš„è¿ç”¨ è‡ªå®šä¹‰Viewçš„åŸºæœ¬çŸ¥è¯†è‡ªå®šä¹‰Viewçš„åˆ†ç±»1. ç›´æ¥ç»§æ‰¿Viewä¸»è¦ç”¨äºå®ç°ä¸€äº›ä¸è§„åˆ™çš„æ•ˆæœï¼Œä¸èƒ½é€šè¿‡ç°æœ‰æ§ä»¶æ‰©å±•çš„ä¸€äº›æ•ˆæœ 2. ç»§æ‰¿è‡ªviewGroupä¸»è¦æ˜¯ä¸ºäº†å®ç°è‡ªå®šä¹‰çš„å¸ƒå±€ï¼Œè¿™ä¸ªå¸ƒå±€é‡ŒåŒ…å«äº†ä¸€äº›ç‰¹å®šçš„æ§ä»¶ï¼Œå¾ˆåƒå‡ ä¸ªviewç»„åˆåœ¨ä¸€èµ· 3.ç»§æ‰¿ç‰¹å®šçš„viewä¸»è¦æ˜¯ä¸ºäº†æ‰©å±•å·²æœ‰viewçš„åŠŸèƒ½ï¼Œæ¯”å¦‚TextViewç­‰ 4.ç»§æ‰¿ç‰¹å®šçš„ViewGroupä¸ºäº†æ‰©å±•ç‰¹å®šçš„å¸ƒå±€ï¼Œæ¯”å¦‚LinearLayout è‡ªå®šä¹‰æ§ä»¶çš„æ„é€ å‡½æ•°å»ºç«‹ä¸€ä¸ªclassç±»ç»§æ‰¿è‡ªView,å®ç°å®ƒçš„æ‰€æœ‰çš„æ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨xmlä¸­ä½¿ç”¨çš„è‡ªå®šä¹‰Viewï¼Œä»¥ä¸‹æ˜¯å…³äºå®ƒçš„æ„é€ æ–¹æ³•çš„ä»£ç ï¼š123456789101112131415161718192021222324252627package com.jie.demo_01.View;import android.content.Context;import android.support.annotation.Nullable;import android.util.AttributeSet;import android.view.View;public class mView extends View &#123; public mView(Context context) &#123; //åœ¨ä»£ç ä¸­ç›´æ¥newå‡ºè¿™ä¸ªå®ä¾‹ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³• super(context); &#125; public mView(Context context, @Nullable AttributeSet attrs) &#123; //åœ¨xmlä¸­å®ç°ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼ˆæœªæŒ‡å®šstyleï¼‰ super(context, attrs); &#125; public mView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123; //ä¸ºviewæŒ‡å®šäº†ä¸€ä¸ªstyle super(context, attrs, defStyleAttr); &#125; public mView(Context context, @Nullable AttributeSet attrs, int defStyleAttr, int defStyleRes) &#123; //api&gt;21æ—¶è°ƒç”¨ï¼Œä¸€èˆ¬ä¸ç”¨å®ç° super(context, attrs, defStyleAttr, defStyleRes); &#125;&#125; å…³äºæ„é€ å‡½æ•°ä¸­å‚æ•°çš„å«ä¹‰ï¼š AttributeSet set: å±æ€§å€¼çš„é›†åˆ. int[] attrs: æˆ‘ä»¬è‡ªå®šä¹‰å±æ€§é›†åˆåœ¨Rç±»ä¸­ç”Ÿæˆçš„intå‹æ•°ç»„.è¿™ä¸ªæ•°ç»„ä¸­åŒ…å«äº†è‡ªå®šä¹‰å±æ€§çš„èµ„æºID. int defStyleAttr: è¿™æ˜¯å½“å‰Themeä¸­çš„åŒ…å«çš„ä¸€ä¸ªæŒ‡å‘styleçš„å¼•ç”¨.å½“æˆ‘ä»¬æ²¡æœ‰ç»™è‡ªå®šä¹‰Viewè®¾ç½®declare-styleableèµ„æºé›†åˆæ—¶,é»˜è®¤ä»è¿™ä¸ªé›†åˆé‡Œé¢æŸ¥æ‰¾å¸ƒå±€æ–‡ä»¶ä¸­é…ç½®å±æ€§å€¼.ä¼ å…¥0è¡¨ç¤ºä¸å‘è¯¥defStyleAtträ¸­æŸ¥æ‰¾é»˜è®¤å€¼. int defStyleRes: è¿™ä¸ªä¹Ÿæ˜¯ä¸€ä¸ªæŒ‡å‘Styleçš„èµ„æºID,ä½†æ˜¯ä»…åœ¨defStyleAtträ¸º0æˆ–è€…defStyleAtträ¸ä¸º0ä½†Themeä¸­æ²¡æœ‰ä¸ºdefStyleAttrå±æ€§èµ‹å€¼æ—¶èµ·ä½œç”¨. å±æ€§èµ‹å€¼ä¼˜å…ˆçº§æ¬¡åºè¡¨:åœ¨å¸ƒå±€xmlä¸­ç›´æ¥å®šä¹‰ &gt; åœ¨å¸ƒå±€xmlä¸­é€šè¿‡styleå®šä¹‰ &gt; è‡ªå®šä¹‰Viewæ‰€åœ¨çš„Activityçš„Themeä¸­æŒ‡å®šstyleå¼•ç”¨ &gt; æ„é€ å‡½æ•°ä¸­defStyleResæŒ‡å®šçš„é»˜è®¤å€¼ è‡ªå®šä¹‰viewçš„xmlèµ‹å€¼æˆ‘ä»¬ç»å¸¸å¯ä»¥çœ‹åˆ°ä½¿ç”¨xmlçš„å±æ€§å¯ä»¥ä¸ºviewè¿›è¡Œå„ç§èµ‹å€¼,é‚£ä¹ˆæ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Œå¦‚å›¾ï¼Œåœ¨valuesç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªattrs.xmlçš„æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š12345&lt;resources&gt; &lt;declare-styleable name="mView"&gt; &lt;attr name="mview_color" format="color"/&gt; &lt;/declare-styleable&gt;&lt;/resources&gt; æˆ‘åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªmview_colorå±æ€§ï¼Œç”¨äºå®šä¹‰é¢œè‰²å€¼ï¼Œformatä»£è¡¨å±æ€§çš„æ ¼å¼ï¼Œæœ‰è®¸å¤šï¼Œè¯»è€…æŸ¥é˜…æ–‡æ¡£å³å¯äº†è§£ã€‚ æ¥ä¸‹æ¥,æˆ‘åœ¨Viewä¸­åšå¦‚ä¸‹å¤„ç†ï¼š123456789101112131415161718public class mView extends View &#123; int defultColor = 0xFFFFFF6; int mColor; public mView(Context context) &#123; this(context,null); &#125; public mView(Context context, @Nullable AttributeSet attrs) &#123; this(context, attrs,0); &#125; public mView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123; super(context, attrs, defStyleAttr); TypedArray t = context.obtainStyledAttributes(attrs, R.styleable.mView); mColor = t.getColor(R.styleable.mView_mview_color,defultColor); t.recycle(); //è®°å¾—å›æ”¶ &#125;&#125; ä½¿ç”¨TypedArrayæ¥è§£ææˆ‘ä»¬å®šä¹‰çš„å±æ€§,æ¥ç€å°±èµ‹å€¼ç»™æˆ‘ä»¬çš„å˜é‡ï¼Œæœ€åå›æ”¶ï¼Œè¿™æ ·è§£æå·¥ä½œå°±å®Œæˆäº† æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨xmlä¸­ä½¿ç”¨æˆ‘ä»¬çš„View:123456789101112131415&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" //ä¸ºäº†ä½¿ç”¨è‡ªå®šä¹‰å±æ€§ï¼Œå¿…é¡»ä½œæ­¤å£°æ˜ï¼Œappå¯ä»¥æ¢æˆå…¶ä»–çš„åå­— xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" tools:context="com.jie.demo_01.MainActivity"&gt; &lt;com.jie.demo_01.View.mView android:layout_width="match_parent" android:layout_height="100dp" app:mview_color="@color/colorAccent" //å£°æ˜æˆ‘ä»¬çš„è‡ªå®šä¹‰å±æ€§ /&gt;&lt;/LinearLayout&gt; è‡ªå®šä¹‰viewçš„ç»˜åˆ¶å±æ€§å·²ç»å®šä¹‰å¥½äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•ä½¿ç”¨äº†ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬é‡å†™å®ƒçš„onDrawæ–¹æ³•ï¼š123456789101112131415161718192021222324252627282930public class mView extends View &#123; int defultColor = 0xFFFFFF6; int mColor; private Paint mPaint = new Paint(Paint.ANTI_ALIAS_FLAG); public mView(Context context) &#123; this(context,null); &#125; public mView(Context context, @Nullable AttributeSet attrs) &#123; this(context, attrs,0); &#125; public mView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123; super(context, attrs, defStyleAttr); TypedArray t = context.obtainStyledAttributes(attrs, R.styleable.mView); mColor = t.getColor(R.styleable.mView_mview_color,defultColor); t.recycle(); //è®°å¾—å›æ”¶ init(); &#125; private void init() &#123; mPaint.setColor(mColor); &#125; @Override protected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); canvas.drawCircle(200,200,100,mPaint); //ç»˜åˆ¶ä¸€ä¸ªä½äº200ï¼Œ200å¤„çš„åŠå¾„ä¸º100çš„åœ† &#125;&#125; onDrawæ–¹æ³•æ˜¯viewç»˜åˆ¶å›¾å½¢å›¾åƒçš„åœ°æ–¹ï¼Œé€šè¿‡ç”»å¸ƒï¼ˆcanvasï¼‰å’Œç”»ç¬”ï¼ˆpaintï¼‰æ¥çµæ´»çš„ç»˜åˆ¶å„ç§å›¾å½¢ï¼Œè¿™ä¸¤ä¸ªç±»æ‰€åŒ…å«çš„æ–¹æ³•å¤šè€Œå…¨ï¼Œè¯»è€…å¯ä»¥å¤šé˜…è¯»æ–‡æ¡£æ¥ç»ƒä¹ ç»˜åˆ¶å„ç§å›¾å½¢,ä»£ç è¿è¡Œå¦‚å›¾æ‰€ç¤ºï¼š è‡ªå®šä¹‰Viewçš„æ³¨æ„äº‹é¡¹ä¸Šé¢çš„è‡ªå®šä¹‰viewå¹¶ä¸æ˜¯ä¸€ä¸ªæ ‡å‡†çš„è‡ªå®šä¹‰view,æ ‡å‡†çš„è‡ªå®šä¹‰viewè¿˜åº”è¯¥åŒ…å«onMeasureå’ŒonLayoutçš„å¤„ç†ï¼Œè®©å…¶æ”¯æŒwrap_contentã€‚ è¿™é‡Œè¦æ³¨æ„äº†ï¼š ç›´æ¥ç»§æ‰¿viewæˆ–è€…viewgroupçš„æ§ä»¶ä¸æ”¯æŒwrap_content,éœ€è¦åœ¨onMeasureä¸­è¿›è¡Œç‰¹æ®Šçš„å¤„ç†æ‰èƒ½è¾¾åˆ°é¢„æœŸçš„æ•ˆæœ å¦‚æœæœ‰å¿…è¦çš„è¯ï¼Œéœ€è¦åœ¨drawæ–¹æ³•ä¸­å¤„ç†paddingï¼Œä½¿viewæ§ä»¶çš„paddingç”Ÿæ•ˆï¼Œå¦åˆ™paddingæ˜¯æ— æ•ˆçš„ å°½é‡ä¸åœ¨viewä¸­ä½¿ç”¨handler,å› ä¸ºviewæœ¬èº«è‡ªå¸¦äº†postæ–¹æ³• å¦‚æœåœ¨viewä¸­æœ‰çº¿ç¨‹æˆ–è€…åŠ¨ç”»ï¼Œè¦åŠæ—¶å…³é—­ï¼Œå…³é—­çš„æ—¶æœºæ˜¯onDetachedFromWindowæ–¹æ³•ï¼Œå½“åŒ…å«æ­¤viewçš„Activityé€€å‡ºæˆ–è€…viewè¢«removeæ‰æ—¶ï¼Œæ­¤æ–¹æ³•ä¼šè¢«è°ƒç”¨ ä¸è¦å†onDrawæ–¹æ³•ä¸­ä½œåˆå§‹åŒ–æ“ä½œï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•ä¼šç»˜åˆ¶å¤šæ¬¡ï¼Œä¼šäº§ç”Ÿå¾ˆå¤šä¸å¿…è¦çš„å¼€é”€ å½“Viewæœ‰æ»‘åŠ¨åµŒå¥—çš„æƒ…å†µï¼Œè¦å¤„ç†å¥½æ»‘åŠ¨å†²çª]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
        <category>å®‰å“Viewä½“ç³»</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®‰å“IPCæœºåˆ¶:AIDLé€šä¿¡çš„ä½¿ç”¨å’Œç†è§£]]></title>
    <url>%2F%E5%AE%89%E5%8D%93IPC%E6%9C%BA%E5%88%B6-AIDL%E9%80%9A%E4%BF%A1%E7%9A%84%E4%BD%BF%E7%94%A8%E5%92%8C%E7%90%86%E8%A7%A3.html</url>
    <content type="text"><![CDATA[ä½¿ç”¨æƒ…æ™¯è™½ç„¶Messengerå¯¹AIDLåšäº†å°è£…ä½¿å…¶å˜å¾—æ›´æ˜“ç”¨ï¼Œä½†Messengeråªèƒ½ä¸€ä¸ªä¸€ä¸ªçš„å¤„ç†æ¥æ”¶çš„æ•°æ®,å½“æœ‰å¤§é‡å¹¶å‘çš„æ•°æ®æ¶Œå…¥æ—¶ï¼ŒMessengerå°±æ˜¾å¾—ä¸é‚£ä¹ˆåˆé€‚äº†,å¹¶ä¸”Messengeråªèƒ½ç”¨æ¥ä¼ é€’æ¶ˆæ¯ï¼Œå¦‚æœéœ€è¦è°ƒç”¨è·¨è¿›ç¨‹çš„æ–¹æ³•æ€ä¹ˆåŠå‘¢ï¼Œè¿™æ˜¯ï¼ŒAIDLå°±æ´¾ä¸Šç”¨åœºäº†ã€‚ ä½¿ç”¨æ–¹æ³•é¦–å…ˆåˆ›å»ºä¸€ä¸ªAIDLæ–‡ä»¶,åœ¨é‡Œé¢å£°æ˜ä¸€äº›éœ€è¦ç”¨åˆ°çš„æ–¹æ³•æ¥å£ï¼Œæ³¨æ„ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®ç±»å‹åœ¨AIDLä¸­éƒ½èƒ½ä½¿ç”¨ï¼ŒAIDLèƒ½å¤Ÿä½¿ç”¨çš„æ•°æ®ç±»å‹å¦‚ä¸‹: åŸºæœ¬æ•°æ®ç±»å‹ String,CharSequence ArrayList,é‡Œé¢åŒ…å«çš„å…ƒç´ å¿…é¡»æ”¯æŒAIDL HashMap,é‡Œé¢åŒ…å«çš„keyå’Œvalueå¿…é¡»è¢«AIDLæ”¯æŒ Parcelable,æ‰€æœ‰å®ç°äº†Parcelableæ¥å£çš„å¯¹è±¡ AIDLæ¥å£æœ¬èº«ä¹Ÿæ”¯æŒ 123456789// IBookManager.aidlpackage com.jie.demo_01;import com.jie.demo_01.Book;// Declare any non-default types here with import statementsinterface IBookManager &#123; List&lt;Book&gt; getBookList(); void addBook(in Book book);&#125; å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘åœ¨é‡Œé¢å¼•å…¥äº†Bookå®ä½“ç±»ï¼ŒæŒ‰ç…§AIDLçš„è§„åˆ™ï¼Œæ˜¯éœ€è¦å†åˆ›å»ºä¸€ä¸ªBook.aidlæ–‡ä»¶çš„ï¼Œå¹¶ä¸”éœ€è¦æ‰‹åŠ¨å°†å¼•å…¥è·¯å¾„å¯¼å…¥123// Book.aidl.aidlpackage com.jie.demo_01;parcelable Book; éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒAIDLä¸­æ¯ä¸ªå®ç°äº†Parcelableæ¥å£çš„ç±»éƒ½éœ€è¦æŒ‰ç…§è¿™ç§æ–¹å¼åˆ›å»ºç›¸åº”çš„æ–‡ä»¶å¹¶ä¸”ç”³æ˜è¯¥ç±»ä¸ºParcelableï¼Œå¹¶ä¸”ï¼ŒAIDLä¸­é™¤äº†åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå…¶ä»–çš„å‚æ•°éƒ½å¿…é¡»æ ‡ä¸Šæ–¹å‘ï¼š in è¡¨ç¤ºè¾“å…¥å‹çš„å‚æ•° out è¡¨ç¤ºè¾“å‡ºå‹çš„å‚æ•° inout è¡¨ç¤ºè¾“å…¥è¾“å‡ºå‹å‚æ•°å¹¶ä¸”AIDLä¸æ”¯æŒå£°æ˜é™æ€å˜é‡ã€‚ ä¸‹é¢æ˜¯è¿œç¨‹æœåŠ¡ç«¯çš„å®ç°:123456789101112131415161718192021222324252627282930313233343536373839404142package com.jie.demo_01;import android.app.Service;import android.content.Intent;import android.os.Binder;import android.os.IBinder;import android.os.RemoteException;import android.support.annotation.Nullable;import java.util.List;import java.util.concurrent.CopyOnWriteArrayList;public class mService extends Service &#123; private CopyOnWriteArrayList&lt;Book&gt; mBookList = new CopyOnWriteArrayList&lt;&gt;(); //æ”¯æŒå¹¶å‘è¯»å†™çš„ä¸€ä¸ªç±»ï¼ŒéArraylist private Binder mbinder = new IBookManager.Stub() &#123; @Override public List&lt;Book&gt; getBookList() throws RemoteException &#123; return mBookList; &#125; @Override public void addBook(Book book) throws RemoteException &#123; mBookList.add(book); &#125; &#125;; @Nullable @Override public IBinder onBind(Intent intent) &#123; return mbinder; &#125; @Override public void onCreate() &#123; super.onCreate(); mBookList.add(new Book(1,"Kotlinå®æˆ˜")); mBookList.add(new Book(2,"ç¼–ç¨‹ç ç‘")); mBookList.add(new Book(3,"Javaæ•°æ®ä¸ç»“æ„ç®—æ³•è§£æ")); &#125;&#125; æœåŠ¡ç«¯çš„å®ç°æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯é€šè¿‡IBookManager.Stubæ¥è·å–Binderå¯¹è±¡å¹¶å®ç°å®šä¹‰çš„æ–¹æ³•,æœ€ååœ¨onBindä¸­ç»‘å®š`Binderå¯¹è±¡,å…¶ä¸­ï¼ŒIBookManagerè¿™ä¸ªç±»æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä½äºgenç›®å½•çš„aidlæ–‡ä»¶å¤¹ä¸­,å…³äºè¯¥ç±»ç¨åå†åšåˆ†æã€‚ ä»¥ä¸‹æ˜¯å®¢æˆ·ç«¯çš„å®ç°,ä¹Ÿæ¯”è¾ƒç®€å•:123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051package com.jie.demo_01;import android.content.ComponentName;import android.content.Intent;import android.content.ServiceConnection;import android.os.Bundle;import android.os.IBinder;import android.os.RemoteException;import android.support.v7.app.AppCompatActivity;import android.util.Log;import java.util.List;public class MainActivity extends AppCompatActivity &#123; private ServiceConnection mConnection = new ServiceConnection() &#123; //Ibindç›‘å¬ï¼Œæ³¨æ„ç»‘å®šæ˜¯å¼‚æ­¥çš„ @Override public void onServiceConnected(ComponentName componentName, IBinder iBinder) &#123; //å½“ä¸Serviceå»ºç«‹è¿æ¥æ—¶è°ƒç”¨ IBookManager manager = IBookManager.Stub.asInterface(iBinder); //è·å–AIDLç®¡ç†ç±» //å¾—åˆ°æ•°æ® try &#123; List&lt;Book&gt; bookList = manager.getBookList(); //è¿™é‡Œå®é™…ä¸Šå°±æ˜¯è°ƒç”¨äº†Binderä¸­çš„æ–¹æ³• Log.i("hj","ä»æœåŠ¡ç«¯è·å–çš„é›†åˆå¤§å°:"+bookList.size()); if (bookList.size()&gt;0)&#123; Log.i("hj","ç¬¬ä¸€ä¸ªä¹¦åæ˜¯:"+bookList.get(0).bookName); &#125; &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; &#125; @Override public void onServiceDisconnected(ComponentName componentName) &#123; //ä¸Serviceæ„å¤–ä¸­æ–­æ—¶è°ƒç”¨ &#125; &#125;; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Intent intent = new Intent(MainActivity.this,mService.class); bindService(intent,mConnection,BIND_AUTO_CREATE); &#125; @Override protected void onDestroy() &#123; unbindService(mConnection); super.onDestroy(); &#125;&#125; è¿è¡Œåæ‰“å°å¦‚ä¸‹ï¼š1212-09 17:05:46.447 19690-19690/? I/hj: ä»æœåŠ¡ç«¯è·å–çš„é›†åˆå¤§å°:312-09 17:05:46.448 19690-19690/? I/hj: ç¬¬ä¸€ä¸ªä¹¦åæ˜¯:Kotlinå®æˆ˜ è¿è¡ŒåŸç†æ˜¯é€šè¿‡IBookManager.Stub.asInterfaceæ–¹æ³•è·å–åˆ°IBookManager,ä»è€Œè°ƒç”¨é‡Œé¢çš„æ–¹æ³•æ¥å®ç°æ•°æ®çš„ä¼ é€’ä¸æ–¹æ³•ä¹‹é—´çš„è°ƒç”¨ï¼Œæ³¨æ„ï¼Œè¿™äº›æ–¹æ³•éƒ½æ˜¯è¿è¡Œåœ¨UIçº¿ç¨‹ä¸­çš„ï¼Œæ‰€ä»¥ä¸èƒ½æœ‰è€—æ—¶çš„æ“ä½œï¼Œå¦‚æœæœ‰è€—æ—¶çš„æ“ä½œï¼Œåº”è¯¥æ–°å¼€å¯ä¸€ä¸ªçº¿ç¨‹æ¥è§£å†³ã€‚ è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæœ‰ç±»ä¼¼äºè®¢é˜…è€…çš„å®ç°ï¼Œåœ¨è¿›ç¨‹é€šä¿¡ä¸­ï¼Œä¸èƒ½ç®€å•çš„ç”¨Listæ¥ç®¡ç†æ¥å£ï¼Œå› ä¸ºè¿›ç¨‹ä¸­çš„å¯¹è±¡ä¼ è¾“åå…¶å®å˜æˆäº†ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œé‚£ä¹ˆè®¢é˜…å’Œå–æ¶ˆè®¢é˜…å°†ä¼šå¤±æ•ˆï¼Œå› æ­¤ï¼Œç³»ç»Ÿæä¾›äº†ä¸€ä¸ªå«RemoteCallbackListçš„æ¥å£ä¸“é—¨ç”¨æ¥ç®¡ç†è·¨è¿›ç¨‹çš„æ¥å£ï¼Œå®ƒçš„ä½¿ç”¨ä¹Ÿå¾ˆç®€å•ï¼š beginBroadcast()æ–¹æ³•ä¼šè¿”å›è¯¥ç±»é‡Œæ‰€æœ‰é›†åˆçš„å¤§å° getBroadcastItem(int position) è¿”å›æŒ‡å®šçš„item finishBroadcast() ç»“æŸéå† é€šè¿‡ä»¥ä¸Šä¸‰ä¸ªæ–¹æ³•å¯ä»¥å¾ªç¯éå†è®¢é˜…è€…æ¥å£æ¥è¾¾åˆ°å–æ¶ˆè®¢é˜…çš„ç›®çš„ã€‚æ³¨æ„beginBroadcastå’ŒfinishBroadcastå¿…é¡»é…å¯¹ä½¿ç”¨ IBookManager ç±»åˆ†æé€šè¿‡ä»¥ä¸Šçš„AIDLå®ç°ï¼Œæˆ‘ä»¬å‘ç°äº†IBookManagerç±»èµ·åˆ°äº†åˆ¶å…³é‡è¦çš„ä½œç”¨,æ‰€ä»¥æˆ‘ä»¬æ¥æ·±å…¥è§‚å¯Ÿä¸€ä¸‹è¯¥ç±»ï¼Œç†è§£äº†è¯¥ç±»æœ‰åŠ©äºæˆ‘ä»¬æ›´å¥½çš„ä½¿ç”¨AIDL.ä»¥ä¸‹æ˜¯è¯¥ç±»çš„æºç ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133/* * This file is auto-generated. DO NOT MODIFY. * Original file: D:\\MyWork\\Studio_Work\\demo_01\\app\\src\\main\\aidl\\com\\jie\\demo_01\\IBookManager.aidl */package com.jie.demo_01;// Declare any non-default types here with import statementspublic interface IBookManager extends android.os.IInterface &#123; /** * Local-side IPC implementation stub class. */ public static abstract class Stub extends android.os.Binder implements com.jie.demo_01.IBookManager &#123; private static final java.lang.String DESCRIPTOR = "com.jie.demo_01.IBookManager"; /** * Construct the stub at attach it to the interface. */ public Stub() &#123; this.attachInterface(this, DESCRIPTOR); &#125; /** * Cast an IBinder object into an com.jie.demo_01.IBookManager interface, * generating a proxy if needed. */ public static com.jie.demo_01.IBookManager asInterface(android.os.IBinder obj) &#123; if ((obj == null)) &#123; return null; &#125; android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR); if (((iin != null) &amp;&amp; (iin instanceof com.jie.demo_01.IBookManager))) &#123; return ((com.jie.demo_01.IBookManager) iin); &#125; return new com.jie.demo_01.IBookManager.Stub.Proxy(obj); &#125; @Override public android.os.IBinder asBinder() &#123; return this; &#125; @Override public boolean onTransact(int code, android.os.Parcel data, android.os.Parcel reply, int flags) throws android.os.RemoteException &#123; switch (code) &#123; case INTERFACE_TRANSACTION: &#123; reply.writeString(DESCRIPTOR); return true; &#125; case TRANSACTION_getBookList: &#123; data.enforceInterface(DESCRIPTOR); java.util.List&lt;com.jie.demo_01.Book&gt; _result = this.getBookList(); reply.writeNoException(); reply.writeTypedList(_result); return true; &#125; case TRANSACTION_addBook: &#123; data.enforceInterface(DESCRIPTOR); com.jie.demo_01.Book _arg0; if ((0 != data.readInt())) &#123; _arg0 = com.jie.demo_01.Book.CREATOR.createFromParcel(data); &#125; else &#123; _arg0 = null; &#125; this.addBook(_arg0); reply.writeNoException(); return true; &#125; &#125; return super.onTransact(code, data, reply, flags); &#125; private static class Proxy implements com.jie.demo_01.IBookManager &#123; private android.os.IBinder mRemote; Proxy(android.os.IBinder remote) &#123; mRemote = remote; &#125; @Override public android.os.IBinder asBinder() &#123; return mRemote; &#125; public java.lang.String getInterfaceDescriptor() &#123; return DESCRIPTOR; &#125; @Override public java.util.List&lt;com.jie.demo_01.Book&gt; getBookList() throws android.os.RemoteException &#123; android.os.Parcel _data = android.os.Parcel.obtain(); android.os.Parcel _reply = android.os.Parcel.obtain(); java.util.List&lt;com.jie.demo_01.Book&gt; _result; try &#123; _data.writeInterfaceToken(DESCRIPTOR); mRemote.transact(Stub.TRANSACTION_getBookList, _data, _reply, 0); _reply.readException(); _result = _reply.createTypedArrayList(com.jie.demo_01.Book.CREATOR); &#125; finally &#123; _reply.recycle(); _data.recycle(); &#125; return _result; &#125; @Override public void addBook(com.jie.demo_01.Book book) throws android.os.RemoteException &#123; android.os.Parcel _data = android.os.Parcel.obtain(); android.os.Parcel _reply = android.os.Parcel.obtain(); try &#123; _data.writeInterfaceToken(DESCRIPTOR); if ((book != null)) &#123; _data.writeInt(1); book.writeToParcel(_data, 0); &#125; else &#123; _data.writeInt(0); &#125; mRemote.transact(Stub.TRANSACTION_addBook, _data, _reply, 0); _reply.readException(); &#125; finally &#123; _reply.recycle(); _data.recycle(); &#125; &#125; &#125; static final int TRANSACTION_getBookList = (android.os.IBinder.FIRST_CALL_TRANSACTION + 0); static final int TRANSACTION_addBook = (android.os.IBinder.FIRST_CALL_TRANSACTION + 1); &#125; public java.util.List&lt;com.jie.demo_01.Book&gt; getBookList() throws android.os.RemoteException; public void addBook(com.jie.demo_01.Book book) throws android.os.RemoteException;&#125; å¯ä»¥çœ‹åˆ°è¯¥ç±»çš„ç»“æ„è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„,é¦–å…ˆï¼Œå®ƒç”³æ˜äº†getBookListå’ŒaddBookä¸¤ä¸ªæ–¹æ³•ï¼Œæ˜¾ç„¶è¿™æ˜¯æˆ‘åœ¨aidlæ¥å£ä¸­ç”³æ˜çš„æ–¹æ³•ï¼Œæ¥ç€ï¼Œè¿˜ç”³æ˜äº†ä¸¤ä¸ªintå‹çš„id,TRANSACTION_getBookList å’ŒTRANSACTION_addBookï¼Œè¿™ä¸¤ä¸ªidæ˜¯ä¸ºäº†åœ¨transactè¿‡ç¨‹ä¸­åŒºåˆ†å®¢æˆ·ç«¯è¯·æ±‚çš„æ˜¯å“ªä¸ªæ–¹æ³•ï¼Œæ¥ç€ï¼Œå®ƒç”³æ˜äº†ä¸€ä¸ªå†…éƒ¨ç±»Stub,å®ƒæ˜¯ä¸€ä¸ªBinderç±»ï¼Œæ¥ç€è¿˜ç”³æ˜äº†ä¸€ä¸ªStubçš„å†…éƒ¨ä»£ç†ç±»ï¼Œä»¥ä¸Šå°±æ˜¯è¯¥ç±»çš„ç»“æ„ã€‚ä¸‹é¢è¯¦ç»†ä»‹ç»ä¸€ä¸‹å„ä¸ªæ–¹æ³•çš„ä½œç”¨ é¦–å…ˆæ˜¯Stub ç±»çš„æ–¹æ³•ï¼š asInterface(android.os.IBinder obj)ä¼ å…¥ä¸€ä¸ªBinderå¯¹è±¡ï¼Œè½¬æ¢æˆå®¢æˆ·ç«¯æ‰€éœ€è¦çš„AIDLæ¥å£ç±»å‹çš„å¯¹è±¡ï¼Œè¿™ç§è½¬æ¢æ˜¯åŒºåˆ†è¿›ç¨‹çš„ï¼Œå¦‚æœæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æ˜¯åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•ä¼šè¿”å›Stubå¯¹è±¡æœ¬èº«ï¼Œå¦‚æœæ˜¯ä¸¤ä¸ªè¿›ç¨‹ï¼Œé‚£ä¹ˆä¼šè¿”å›Stub.proxyå¯¹è±¡ã€‚ adBinderè¿”å›Binderå¯¹è±¡. onTransactï¼ˆ(int code, android.os.Parcel data, android.os.Parcel reply, int flagsï¼‰è¯¥æ–¹æ³•æ˜¯è¿”å›ä¸€ä¸ªbooleanå¯¹è±¡ï¼Œè¿è¡Œåœ¨Binderçº¿ç¨‹æ± ä¸­ï¼Œå½“å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼Œè¿œç¨‹ä¼šé€šè¿‡ç³»ç»Ÿåº•å±‚å°è£…åç”±æ­¤æ–¹æ³•å¤„ç†ã€‚codeå‚æ•°å¯ä»¥ç¡®å®šå®¢æˆ·ç«¯è¯·æ±‚çš„æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Œdataä¸­èƒ½å–å‡ºç›®æ ‡çš„å‚æ•°ï¼Œç„¶åæ‰§è¡Œç›®æ ‡çš„æ–¹æ³•ï¼Œå½“æ‰§è¡Œå®Œæ¯•åï¼Œå°±å‘replyä¸­å†™å…¥è¿”å›å€¼ï¼ˆå¦‚æœæœ‰è¿”å›å€¼çš„è¯ï¼‰ï¼Œè€Œè¿”å›çš„booleanå¯¹è±¡ï¼Œå¦‚æœä¸ºfalse,é‚£ä¹ˆå®¢æˆ·ç«¯ä¼šè¯·æ±‚å¤±è´¥ï¼Œå› æ­¤å¯ä»¥é€šè¿‡è¿™ä¸ªè¿”å›å€¼åšæƒé™éªŒè¯ã€‚ Proxyä¸­çš„æ–¹æ³•ï¼š getBookListæ­¤æ–¹æ³•è¿è¡Œåœ¨å®¢æˆ·ç«¯ï¼Œå½“å®¢æˆ·ç«¯è¿œç¨‹è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œå®ƒä¼šåˆ›å»ºè¯¥æ–¹æ³•æ‰€éœ€è¦çš„è¾“å…¥å‹Parcelå¯¹è±¡data,è¾“å‡ºå‹Parcelå¯¹è±¡,_replyå’Œè¿”å›å€¼å¯¹è±¡List,ç„¶åå°†è¯¥æ–¹æ³•çš„å‚æ•°ä¿¡æ¯å†™å…¥_dataä¸­ï¼ˆå¦‚æœæœ‰å‚æ•°çš„è¯ï¼‰ï¼›æ¥ç€è°ƒç”¨transactæ–¹æ³•æ¥å‘èµ·è¯·æ±‚ï¼ŒåŒæ—¶å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œç„¶åæœåŠ¡ç«¯çš„onTransatctæ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œç›´åˆ°è¿œç¨‹è°ƒç”¨è¿”å›ï¼Œå½“å‰çº¿ç¨‹ç»§ç»­æ‰§è¡Œï¼Œå¹¶ä»_replyä¸­å–å‡ºè¿œç¨‹è°ƒç”¨è¿‡ç¨‹çš„è¿”å›ç»“æœï¼Œæœ€åè¿”å›_replyæ•°æ®ã€‚ addBookåŒgetBookListä¸€æ ·ï¼Œå› ä¸ºæ²¡æœ‰è¿”å›å€¼ï¼Œæ‰€ä»¥ä¸éœ€è¦ä»_replyä¸­å–å€¼ æ•´ä½“æ¥è¯´æ•´ä¸ªç±»è¿˜æ˜¯æ˜“äºç†è§£çš„ï¼Œå¤§å¤šå…¶å®éƒ½æ˜¯ååº•å±‚çš„å®ç°,éœ€è¦æ³¨æ„çš„æ˜¯,å®¢æˆ·ç«¯é€šè¿‡æ¥å£æ–¹æ³•å‘èµ·è¯·æ±‚æ—¶ï¼Œå½“å‰çº¿ç¨‹ä¼šè¢«æŒ‚èµ·ç›´åˆ°æœåŠ¡ç«¯è¿”å›æ•°æ®ï¼Œå› æ­¤ï¼Œå¦‚æœä¸€ä¸ªè¿œç¨‹çš„æ–¹æ³•éå¸¸è€—æ—¶ï¼Œé‚£ä¹ˆå°±ä¸èƒ½åœ¨ä¸»çº¿ç¨‹ä¸­å‘èµ·è¯·æ±‚ï¼Œéœ€è¦å¦å¼€ä¸€ä¸ªçº¿ç¨‹ã€‚]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
        <category>å®‰å“IPCæœºåˆ¶</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®‰å“IPCæœºåˆ¶:ä½¿ç”¨Messengeré€šä¿¡]]></title>
    <url>%2F%E5%AE%89%E5%8D%93IPC%E6%9C%BA%E5%88%B6-%E4%BD%BF%E7%94%A8Messenger%E9%80%9A%E4%BF%A1.html</url>
    <content type="text"><![CDATA[MessengeråŸç†Messengerçš„åº•å±‚å®ç°æ˜¯AILDï¼Œå®ƒæ˜¯ä¸€ä¸ªMessageçš„è½½ä½“ï¼Œé€šè¿‡å®ƒå¯ä»¥åœ¨ä¸åŒè¿›ç¨‹é—´ä¼ é€’messageå¯¹è±¡,ä»è€Œå®ç°æ•°æ®ä¼ é€’ ä½¿ç”¨ä»£ç ç¤ºä¾‹ï¼šé¦–å…ˆåˆ›å»ºä¸€ä¸ªServiceï¼Œè®©å®ƒè¿è¡Œåœ¨ä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹ä¸­123&lt;service android:name=".mService" android:process=":remote" /&gt; ç„¶åå†æ¥çœ‹æœåŠ¡ç«¯12345678910111213141516171819202122232425262728293031323334public class mService extends Service &#123; private final Messenger messenger = new Messenger(new messengerHandler()); private static class messengerHandler extends Handler &#123; @Override public void handleMessage(Message msg) &#123; switch (msg.what) &#123; case Constants.MSG_FROM_CLIENT: String clientMsg = msg.getData().getString("msg"); //æ¥æ”¶å®¢æˆ·ç«¯çš„æ¶ˆæ¯ Log.i("hj","ä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„æ¶ˆæ¯:"+clientMsg); Messenger messenger = msg.replyTo; //è·å–å®¢æˆ·ç«¯å‘æ¥çš„Messenger Message replyMessage = Message.obtain(null,Constants.MSG_FROM_SERVICE); //åˆ›å»ºä¸€ä¸ªæ–°çš„Messageå¯¹è±¡ Bundle bundle = new Bundle(); bundle.putString("reply", "å·²æ”¶åˆ°å®¢æˆ·ç«¯çš„æ¶ˆæ¯ï¼Œç¨åå›å¤~"); replyMessage.setData(bundle); try &#123; messenger.send(replyMessage); //å‘é€æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; break; default: super.handleMessage(msg); &#125; &#125; &#125; @Nullable @Override public IBinder onBind(Intent intent) &#123; return messenger.getBinder(); &#125;&#125; åˆ›å»ºä¸€ä¸ªHandlerå¹¶ä¸”ä¼ å…¥åˆ°Messengerå¯¹è±¡ä¸­,é€šè¿‡Handleræ¥æ¥æ”¶Messageå¯¹è±¡å‘æ¥çš„æ¶ˆæ¯,å¹¶ä¸”åœ¨Serviceçš„onBindä¸­è¿”å›è¿™ä¸ªMessagerå¯¹è±¡åº•å±‚çš„Binderã€‚éšåæˆ‘åˆé€šè¿‡msg.replyToæ–¹æ³•è·å–åˆ°ä»å®¢æˆ·ç«¯å‘æ¥çš„Messengerå¯¹è±¡ï¼Œç”¨äºå›å¤æ¶ˆæ¯ç»™å®¢æˆ·ç«¯,æœ€åè°ƒç”¨sendæ–¹æ³•å‘å‡ºæ¶ˆæ¯ï¼Œè¿™æ ·å°±å®Œæˆäº†æ¶ˆæ¯çš„æ¥æ”¶ä¸å›å¤ï¼Œæ¥ä¸‹æ¥å†çœ‹å®¢æˆ·ç«¯çš„å®ç°12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970package com.jie.demo_01;import android.content.ComponentName;import android.content.Intent;import android.content.ServiceConnection;import android.os.Bundle;import android.os.Handler;import android.os.IBinder;import android.os.Message;import android.os.Messenger;import android.os.RemoteException;import android.support.v7.app.AppCompatActivity;import android.util.Log;public class MainActivity extends AppCompatActivity &#123; private Messenger messenger; //å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯çš„messenger private ServiceConnection mConnection = new ServiceConnection() &#123; //Ibindç›‘å¬ï¼Œæ³¨æ„ç»‘å®šæ˜¯å¼‚æ­¥çš„ @Override public void onServiceConnected(ComponentName componentName, IBinder iBinder) &#123; //å½“ä¸Serviceå»ºç«‹è¿æ¥æ—¶è°ƒç”¨ messenger = new Messenger(iBinder); Message message = Message.obtain(null,Constants.MSG_FROM_CLIENT); Bundle bundle = new Bundle(); bundle.putString("msg","Serviceå…„å¼Ÿåœ¨å—ï¼Œæ˜¯å¦å·²æ”¶åˆ°å›å¤"); message.setData(bundle); message.replyTo = replyMessager; //æ³¨æ„è¿™ä¸€å¥ï¼Œå°†å®¢æˆ·ç«¯ç”¨äºæ¥å—æ¶ˆæ¯çš„Messagerå¯¹è±¡ä¼ é€’ç»™Service try &#123; messenger.send(message); &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; &#125; @Override public void onServiceDisconnected(ComponentName componentName) &#123; //ä¸Serviceæ„å¤–ä¸­æ–­æ—¶è°ƒç”¨ &#125; &#125;; private Messenger replyMessager = new Messenger(new GetReplyMessenger()); //å®¢æˆ·ç«¯æ¥æ”¶æ¶ˆæ¯çš„messenger private static class GetReplyMessenger extends Handler&#123; @Override public void handleMessage(Message msg) &#123; switch (msg.what)&#123; case Constants.MSG_FROM_SERVICE: String reply = msg.getData().getString("reply"); Log.i("hj","ä»Serviceæ¥æ”¶åˆ°çš„æ¶ˆæ¯:"+reply); break; default: super.handleMessage(msg); break; &#125; &#125; &#125; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Intent intent = new Intent(MainActivity.this,mService.class); bindService(intent,mConnection,BIND_AUTO_CREATE); &#125; @Override protected void onDestroy() &#123; unbindService(mConnection); super.onDestroy(); &#125;&#125; é¦–å…ˆæ˜¯ç»‘å®šä¸€ä¸ªServiceï¼Œæ¥ä¸‹æ¥åœ¨ç»‘å®šç›‘å¬ä¸­åˆ›å»ºä¸€ä¸ªMessagerå¯¹è±¡,é€šè¿‡Messagerå°±å¯ä»¥å‘æ¶ˆæ¯ç»™æœåŠ¡ç«¯äº†,æ³¨æ„ï¼Œæˆ‘åœ¨è¿™é‡Œé€šè¿‡replyToå‘é€äº†ä¸€ä¸ªæ–°çš„Messagerå¯¹è±¡ç»™æœåŠ¡ç«¯ï¼Œè¿™æ ·æœåŠ¡ç«¯å°±å¯ä»¥å›å¤æ¶ˆæ¯ç»™å®¢æˆ·ç«¯äº†ï¼Œå®¢æˆ·ç«¯ä¹Ÿæ˜¯é€šè¿‡Handleræ¥æ¥æ”¶æ¶ˆæ¯çš„ã€‚ è¿è¡Œç»“æœå¦‚ä¸‹ï¼š112-09 11:16:07.733 7900-7900/com.jie.demo_01:remote I/hj: ä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„æ¶ˆæ¯:Serviceå…„å¼Ÿåœ¨å—ï¼Œæ˜¯å¦å·²æ”¶åˆ°å›å¤ 112-09 11:16:07.753 7871-7871/com.jie.demo_01 I/hj: ä»Serviceæ¥æ”¶åˆ°çš„æ¶ˆæ¯:å·²æ”¶åˆ°å®¢æˆ·ç«¯çš„æ¶ˆæ¯ï¼Œç¨åå›å¤~ å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªä¸åŒè¿›ç¨‹ä¹‹é—´é€šä¿¡æˆåŠŸäº†]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
        <category>å®‰å“IPCæœºåˆ¶</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®‰å“IPCæœºåˆ¶ï¼šä½¿ç”¨æ–‡ä»¶å…±äº«]]></title>
    <url>%2F%E5%AE%89%E5%8D%93IPC%E6%9C%BA%E5%88%B6%EF%BC%9A%E4%BD%BF%E7%94%A8%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB.html</url>
    <content type="text"><![CDATA[åŸç†é€šè¿‡ä¸¤ä¸ªè¿›ç¨‹é—´è¯»/å†™åŒä¸€ä¸ªæ–‡ä»¶æ¥äº¤æ¢æ•°æ®ç¤ºä¾‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768package com.jie.demo_01;import android.content.Intent;import android.os.Bundle;import android.os.Environment;import android.support.v7.app.AppCompatActivity;import android.view.View;import java.io.File;import java.io.FileOutputStream;import java.io.IOException;import java.io.ObjectOutputStream;public class MainActivity extends AppCompatActivity &#123; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); &#125; @Override protected void onResume() &#123; super.onResume(); initWriteToFile(); &#125; //ç‚¹å‡»è·³è½¬åˆ°SecondActivity public void start(View v)&#123; startActivity(new Intent(MainActivity.this,SecondActivity.class)); &#125; private void initWriteToFile()&#123; new Thread()&#123; @Override public void run() &#123; User user = new User(); user.userName = &quot;Hello World&quot;; File file = new File(getDiskCacheDir()); ObjectOutputStream oos = null; try &#123; oos = new ObjectOutputStream(new FileOutputStream(file)); oos.writeObject(user); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125;finally &#123; try &#123; if (oos!=null) oos.close(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125;.start(); &#125; public String getDiskCacheDir() &#123; String cachePath = null; if (Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState()) || !Environment.isExternalStorageRemovable()) &#123; cachePath = getExternalCacheDir().getPath()+&quot;/cache.txt&quot;; &#125; else &#123; cachePath = getCacheDir().getPath()+&quot;/cache.txt&quot;; &#125; return cachePath; &#125;&#125; SecondActivityä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859package com.jie.demo_01;import android.os.Bundle;import android.os.Environment;import android.support.v7.app.AppCompatActivity;import android.util.Log;import java.io.File;import java.io.FileInputStream;import java.io.IOException;import java.io.ObjectInputStream;public class SecondActivity extends AppCompatActivity &#123; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); &#125; @Override protected void onResume() &#123; super.onResume(); getCacheFromFile(); &#125; private void getCacheFromFile ()&#123; new Thread()&#123; @Override public void run() &#123; User user = null; File file = new File(getDiskCacheDir()); if (file.exists())&#123; ObjectInputStream ois = null; try &#123; ois = new ObjectInputStream(new FileInputStream(file)); user = (User) ois.readObject(); Log.i(&quot;TAG&quot;,user.userName); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; catch (ClassNotFoundException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125;.start(); &#125; public String getDiskCacheDir() &#123; String cachePath = null; if (Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState()) || !Environment.isExternalStorageRemovable()) &#123; cachePath = getExternalCacheDir().getPath()+&quot;/cache.txt&quot;; &#125; else &#123; cachePath = getCacheDir().getPath()+&quot;/cache.txt&quot;; &#125; return cachePath; &#125;&#125; è¿è¡Œåï¼Œæ‰“å°å‡ºæ—¥å¿—ï¼š112-08 13:13:30.372 17706-17723/com.jie.demo_01.remote I/TAG: Hello World æ–‡ä»¶ä¼ å€¼æˆåŠŸ æ–‡ä»¶ä¼ å€¼å¹¶æ²¡æœ‰å…·ä½“çš„è¦æ±‚ï¼Œä¸ç®¡æ˜¯é€šè¿‡txt,xml,ç­‰ç­‰éƒ½å¯ä»¥ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ–‡ä»¶çš„å¹¶å‘é—®é¢˜ï¼Œè¦é¿å…è·å–æ–‡ä»¶å€¼å¾—æ—¶å€™åŒæ—¶å»ä¿®æ”¹æ–‡ä»¶ï¼Œè¿™æ ·ä¼šé€ æˆæ•°æ®çš„æ··ä¹±ã€‚]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
        <category>å®‰å“IPCæœºåˆ¶</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®‰å“IPCæœºåˆ¶ï¼šBundleæ•°æ®ä¼ é€’]]></title>
    <url>%2F%E5%AE%89%E5%8D%93IPC%E6%9C%BA%E5%88%B6%EF%BC%9ABundle%E6%95%B0%E6%8D%AE%E4%BC%A0%E9%80%92.html</url>
    <content type="text"><![CDATA[åºåˆ—åŒ–ä¸ååºåˆ—åŒ–è¦å®ç°è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œåºåˆ—åŒ–æ˜¯é€šä¿¡çš„åŸºç¡€ï¼Œæ‰€ä»¥å…ˆè¦äº†è§£ä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–å®‰å“å®ç°åºåˆ—åŒ–æœ‰ä¸¤ç§æ–¹å¼ï¼š1. å®ç°Serializableæ¥å£ï¼Œä½¿ç”¨ç›¸å½“ç®€å•ï¼Œè¿™ä¸ªæ˜¯JAVAæä¾›çš„æ–¹æ³•ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯,è¯¥æ¥å£æœ‰ä¸€ä¸ªserialVersionUIDå‚æ•°ï¼š1private static final long serialVersionUID = 1L ; å¯ä»¥é€‰æ‹©ä¸å®ç°ï¼Œä¾æ—§å¯ä»¥åºåˆ—åŒ–ï¼Œä½†æ˜¯ä¼šå¯¹ååºåˆ—åŒ–äº§ç”Ÿå½±å“ï¼Œå¦‚æœåœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ç±»å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™ã€‚AndroidStudioé»˜è®¤ä¸æ£€æŸ¥serialVersionUIDçš„å®ç°ï¼Œå› æ­¤ï¼Œå¯ä»¥æ‰‹åŠ¨å¼€å¯å®ƒï¼Œè¿™æ ·ç³»ç»Ÿå°±ä¼šè‡ªåŠ¨å¸®ä½ å®ç°serialVersionUIDã€‚å¼€å¯æ–¹æ³•ï¼šSettings-&gt;Editor-&gt;Inspections-&gt;serialization issues-&gt;Serializable class without â€˜serialVersionUIDâ€™ å‹¾ä¸Šç¡®è®¤å°±å¯ä»¥ åºåˆ—åŒ–å¯¹è±¡ä¹Ÿéå¸¸ç®€å•ï¼Œé€šè¿‡ObjectOutputStreamå’ŒObjectInputStreamå³å¯è½»æ¾å®ç° 2.å®ç°Parcelableæ¥å£,è¿™æ˜¯Androidæä¾›çš„æ–¹æ³•ï¼Œå®ç°è¯¥æ¥å£ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¸®ä½ å®ç°éœ€è¦çš„ä»£ç ï¼ŒAndroidä¸­æ¨èä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå› ä¸ºæ•ˆç‡æ¯”Serializableé«˜ï¼ŒSerializableéœ€è¦è¿›è¡Œå¤§é‡çš„I/Oæ“ä½œã€‚ä»¥ä¸‹æ˜¯å®Œæ•´å®ç°å®ä¾‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738public class User implements Parcelable &#123; public int userId; public String userName; public boolean isMale; public Book book; protected User(Parcel in) &#123; userId = in.readInt(); userName = in.readString(); isMale = in.readByte() != 0; book = in.readParcelable(Book.class.getClassLoader()); &#125; public static final Creator&lt;User&gt; CREATOR = new Creator&lt;User&gt;() &#123; @Override public User createFromParcel(Parcel in) &#123; return new User(in); &#125; @Override public User[] newArray(int size) &#123; return new User[size]; &#125; &#125;; @Override public int describeContents() &#123; return 0; &#125; @Override public void writeToParcel(Parcel parcel, int i) &#123; parcel.writeInt(userId); parcel.writeString(userName); parcel.writeByte((byte) (isMale ? 1 : 0)); parcel.writeParcelable(book, i); &#125;&#125; æ–¹æ³•è¯¦è§£è§ä¸‹è¡¨ï¼š æ–¹æ³• åŠŸèƒ½ æ ‡è®°ä½ createFromParce(Parcel in)l ä»åºåˆ—åŒ–çš„å¯¹è±¡ä¸­åˆ›å»ºåŸå§‹å¯¹è±¡ newArray åˆ›å»ºæŒ‡å®šé•¿åº¦çš„åŸå§‹å¯¹è±¡æ•°ç»„ User(Parcel in) ä»åºåˆ—åŒ–çš„å¯¹è±¡ä¸­åˆ›å»ºåŸå§‹å¯¹è±¡ writeToParcel(Parcel parcel, int i) å°†å½“å‰å¯¹è±¡å†™å…¥åºåˆ—åŒ–ç»“æ„ä¸­,å…¶ä¸­ iæœ‰ä¸¤ç§å€¼ï¼Œ1ä»£è¡¨å½“å‰å¯¹è±¡éœ€è¦ä½œä¸ºè¿”å›å€¼è¿”å›ï¼Œä¸èƒ½ç«‹å³é‡Šæ”¾èµ„æºï¼Œ PARCELABLE_WRITE_VALUE describeContents è¿”å›å½“å‰å¯¹è±¡çš„å†…å®¹æè¿°ï¼Œå¦‚æœå«æœ‰æ–‡ä»¶æ‰«æç¬¦ï¼Œè¿”å›1ï¼ˆå‚è§å³ä¾§æ ‡è®°ä½ï¼‰ï¼Œå¦åˆ™è¿”å›0 CONTENTS_FILE_DESCRIPTOR å®ç°äº†åºåˆ—åŒ–ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„é€šè¿‡Intentå‘é€Bundle,è¿™æ˜¯ä¸€ç§ç®€å•çš„è¿›ç¨‹é—´é€šä¿¡çš„æ–¹æ³•12345Bundle bundle = new Bundle(); bundle.putParcelable(&quot;User&quot;,new User()); Intent intent = new Intent(MainActivity.this, SecondActivity.class); intent.putExtra(&quot;data&quot;,bundle); startActivity(intent);]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
        <category>å®‰å“IPCæœºåˆ¶</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®‰å“IPCæœºåˆ¶:å¤šè¿›ç¨‹]]></title>
    <url>%2F%E5%AE%89%E5%8D%93IPC%E6%9C%BA%E5%88%B6-%E5%A4%9A%E8%BF%9B%E7%A8%8B.html</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯IPC IPCæ˜¯æŒ‡è¿›ç¨‹é—´é€šä¿¡æˆ–è€…è·¨è¿›ç¨‹é€šä¿¡ï¼ŒæŒ‡ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´äº¤æ¢æ•°æ®çš„è¿‡ç¨‹ã€‚è€ŒIPCä½¿ç”¨çš„åœºæ™¯å¾€å¾€æ˜¯åœ¨å¤šè¿›ç¨‹ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚ Androidå¼€å¯å¤šè¿›ç¨‹ é€šè¿‡ç»™ActivityæŒ‡å®šandroid:processå±æ€§æ¥å¼€å¯å¤šè¿›ç¨‹æ¨¡å¼,å¦‚ä¸‹ç¤ºä¾‹ï¼Œ123456789101112131415161718192021&lt;application android:allowBackup=&quot;true&quot; android:icon=&quot;@mipmap/ic_launcher&quot; android:label=&quot;@string/app_name&quot; android:roundIcon=&quot;@mipmap/ic_launcher_round&quot; android:supportsRtl=&quot;true&quot; android:theme=&quot;@style/AppTheme&quot;&gt; &lt;activity android:name=&quot;.MainActivity&quot;&gt; &lt;intent-filter&gt; &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt; &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt; &lt;/intent-filter&gt; &lt;/activity&gt; &lt;activity android:name=&quot;.ThirdActivity&quot; android:process=&quot;:remote&quot; /&gt; &lt;activity android:name=&quot;.SecondActivity&quot; android:process=&quot;com.jie.demo_01.remote&quot; /&gt; &lt;/application&gt; ç¤ºä¾‹ä¸­å®ç°äº†ä¸¤ç§ä¸åŒçš„å†™æ³•ï¼Œè¿™ä¸¤ç§å†™æ³•æ˜¯æœ‰åŒºåˆ«çš„,å½“ThirdActivityå¯åŠ¨ï¼Œç³»ç»Ÿä¼šå•ç‹¬å¼€å¯ä¸€ä¸ªå«com.jie.demo_01:remoteçš„è¿›ç¨‹(com.jie.demo_01ä¸ºåŒ…å),å½“å¯åŠ¨SecondActivity,ç³»ç»Ÿä¼šå•ç‹¬å¼€å¯ä¸€ä¸ªå«com.jie.demo_01.remoteçš„è¿›ç¨‹ï¼Œå…¶ä¸­ï¼Œâ€œï¼šâ€ä»£è¡¨è¦åœ¨å½“å‰è¿›ç¨‹åå‰é¢åŠ ä¸Šå½“å‰çš„åŒ…åï¼Œå¹¶ä¸”ä»£è¡¨æ­¤è¿›ç¨‹ä¸ºç§æœ‰è¿›ç¨‹ï¼Œå…¶ä»–åº”ç”¨ä¸èƒ½å’Œå®ƒè·‘åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œè€Œæ²¡æœ‰â€ï¼šâ€çš„ä¸ºå…¨å±€è¿›ç¨‹ã€‚SecondActivityçš„è¿™ç§å†™æ³•ï¼Œæ˜¯ä¸€ç§å®Œæ•´çš„å‘½åæ–¹å¼ï¼Œä¸ä¼šé™„åŠ åŒ…åä¿¡æ¯ã€‚ å¼€å¯å¤šè¿›ç¨‹çš„ä¸€äº›å‘å½“ä¸€ä¸ªActivityå•ç‹¬å¼€å¯äº†ä¸€ä¸ªè¿›ç¨‹ï¼Œé‚£ä¹ˆè¿™ä¸ªActivityå°±ä¸èƒ½å’Œåˆ«çš„è¿›ç¨‹çš„Activityå…±äº«æ•°æ®äº†ï¼Œåªèƒ½é€šè¿‡IPCæœºåˆ¶æ¥ä¼ é€’æ•°æ®ã€‚ ä¾‹å¦‚æˆ‘ç”³æ˜äº†ä¸€ä¸ªé™æ€å˜é‡ Userid = 1;æˆ‘åœ¨MainActivityä¸­æŠŠå®ƒæ”¹ä¸ºäº†2ï¼Œæˆ‘åœ¨SecondActivityä¸­å¼€å¯äº†ä¸€ä¸ªè¿›ç¨‹ï¼Œæˆ‘è·å–è¿™ä¸ªUseridï¼Œä½ ä¼šå‘ç°Useridè¿˜æ˜¯1ï¼Œè¿™æ˜¯å› ä¸ºAndroidä¼šä¸ºæ¯ä¸€ä¸ªè¿›ç¨‹åˆ†é…ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œä¸åŒçš„è™šæ‹Ÿæœºåœ¨å†…å­˜åˆ†é…ä¸Šä¼šæœ‰ä¸åŒçš„åœ°å€ç©ºé—´ï¼Œæ‰€ä»¥Useridä¼šåœ¨ä¸åŒçš„è™šæ‹Ÿæœºä¸Šäº§ç”Ÿä¸åŒçš„å‰¯æœ¬ï¼Œå¹¶ä¸”å‰¯æœ¬ä¹‹é—´æ˜¯äº’ä¸å¹²æ‰°çš„,æˆ‘åœ¨MainActivityä¸­æŠŠå®ƒæ”¹ä¸º2ï¼Œåœ¨SecondActivityä¸­çš„å‰¯æœ¬æ˜¯ä¸ä¼šå˜å¾—,å¯ä»¥ç†è§£ä¸ºåˆæ–°å¼€å¯äº†ä¸€ä¸ªåº”ç”¨ï¼Œæ‰€ä»¥ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¤šè¿›ç¨‹ä¹‹é—´ä¼šå­˜åœ¨ä¸‹åˆ—ä¸€äº›é—®é¢˜ï¼š é™æ€æˆå‘˜å’Œå•ä¾‹æ¨¡å¼æ— æ•ˆ çº¿ç¨‹åŒæ­¥æœºåˆ¶å¤±æ•ˆ SharedPreferencesçš„å­˜å‚¨ç»“æœå˜å¾—ä¸å†å¯é  Applicationä¼šå¤šæ¬¡åˆ›å»º ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œç³»ç»Ÿå¼•å…¥äº†IPCæœºåˆ¶ï¼Œç”¨äºåœ¨è¿›ç¨‹é—´å…±äº«å’Œä¼ é€’æ•°æ®ï¼ŒIPCçš„æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š ä½¿ç”¨Bundle ä½¿ç”¨æ–‡ä»¶å…±äº« ä½¿ç”¨Messenger ä½¿ç”¨AIDL å…¶ä¸­Messengeråº•å±‚å…¶å®ä½¿ç”¨çš„AILDï¼ŒAIDLå…¶å®æ˜¯ä¾é Binder,ä¸‹ä¸€ç« å°†è¯¦ç»†ä»‹ç»è¿™å‡ ç§æ–¹æ³•ã€‚]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
        <category>å®‰å“IPCæœºåˆ¶</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Activityçš„ç”Ÿå‘½å‘¨æœŸå’Œå¯åŠ¨æ¨¡å¼]]></title>
    <url>%2FActivity%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%92%8C%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[æ­¤ç³»åˆ—æ–‡ç« ä¸ºè¿›é˜¶ç±»æ–‡ç« ,å¿«é¤ç±»è®°å½•æ–‡,ç”¨äºè‡ªå·±å®‰å“çŸ¥è¯†ç‚¹çš„å¤ä¹  å…¸å‹æƒ…å†µç”Ÿå‘½å‘¨æœŸ onCreate() :Activityè¢«åˆ›å»º onRestart() : æ­£åœ¨é‡æ–°å¯åŠ¨ã€‚è°ƒç”¨åœºæ™¯ï¼šå½“å‰Activityä»ä¸å¯è§åˆ°å˜ä¸ºå¯è§çŠ¶æ€ onStart(): Activityæ­£åœ¨å¯åŠ¨,æ­¤æ—¶Activityå·²ç»å¯è§ï¼Œä½†è¿˜ä¸èƒ½å’Œç”¨æˆ·äº¤äº’ onResume() :æ­¤æ—¶Activityå·²ç»å¯è§å¹¶å¼€å§‹æ´»åŠ¨ onPause() :Activityæ­£åœ¨åœæ­¢ï¼Œå¦‚æœæ˜¯ä»æ­¤Activityé€€åˆ°ä¸Šä¸€ä¸ªActivity,é‚£ä¹ˆä¼šå…ˆæ‰§è¡Œæ­¤Activityçš„onPause,å†æ‰§è¡Œä¸Šä¸€ä¸ªActivityçš„onResume,æ‰€ä»¥æ­¤æ–¹æ³•ä¸èƒ½æ‰§è¡Œè€—æ—¶çš„æ“ä½œï¼Œä¸ç„¶ä¼šå½±å“æ–°Activityçš„æ˜¾ç¤º onStop() : Activityå³å°†åœæ­¢,ç´§æ¥ç€onPauseåé¢æ‰§è¡Œ onDestroy() : Activityå³å°†é”€æ¯,åœ¨è¿™é‡Œä¸»è¦åšä¸€äº›èµ„æºçš„é‡Šæ”¾å®Œæ•´çš„å¯åŠ¨æµç¨‹æ˜¯ä»ä¸Šåˆ°ä¸‹,æœ‰å‡ ä¸ªå…·ä½“æƒ…å†µè¯´æ˜:1)ç¬¬ä¸€æ¬¡å¯åŠ¨ä¸€ä¸ªæ–°çš„Activity: onCreate-&gt;onStart-&gt;onResume2)å†æ¬¡æ‰“å¼€ä¸€ä¸ªActivityæˆ–è€…åˆ‡æ¢åˆ°æ¡Œé¢ï¼šonPause -&gt;onStop (æ³¨ï¼šå¦‚æœæ–°çš„Activityæ˜¯ç”¨çš„é€æ˜ä¸»é¢˜,é‚£ä¹ˆä¸ä¼šå›è°ƒonStop)3) å†æ¬¡å›åˆ°æ­¤Activityï¼šonRestar -&gt;onStart -&gt;onResume4)é€€å‡ºæ­¤Activity (finishæ‰)ï¼šonPause -&gt;onStop -&gt;onDestroty å¼‚å¸¸æƒ…å†µç”Ÿå‘½å‘¨æœŸèµ„æºç›¸å…³çš„ç³»ç»Ÿé…ç½®å‘ç”Ÿäº†æ”¹å˜å¯¼è‡´Activityè¢«æ€æ­»å¹¶é‡æ–°åˆ›å»ºå‘ç”Ÿæ­¤ç§æƒ…å†µæœ€å…¸å‹çš„å°±æ˜¯æ¨ªç«–å±çš„åˆ‡æ¢,å› ä¸ºç³»ç»Ÿä¼šå»æ‹¿ä¸¤å¼ ä¸åŒçš„å›¾ç‰‡ï¼Œè¿™æ—¶ï¼ŒActivityå°±ä¼šé‡æ–°åˆ›å»º,å®ƒçš„onPause,onStop,onDestroyéƒ½ä¼šè¢«è°ƒç”¨,åŒæ—¶å› ä¸ºActivityæ˜¯åœ¨å¼‚å¸¸æƒ…å†µä¸‹ç»ˆæ­¢çš„,æ‰€ä»¥ç³»ç»Ÿä¼šè°ƒç”¨onSaveInstanceStateæ¥ä¿å­˜å½“å‰Activityçš„çŠ¶æ€ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨onStopæ–¹æ³•ä¹‹å‰è°ƒç”¨ã€‚å½“Activityåˆ›å»ºå®Œæˆ,ç³»ç»Ÿä¼šè°ƒç”¨onRestoreInstanceStateï¼Œå¯ä»¥ä»è¿™ä¸ªæ–¹æ³•é‡Œæ‹¿åˆ°bundleå¯¹è±¡å¹¶æ¢å¤Activityçš„çŠ¶æ€ èµ„æºä¸è¶³å¯¼è‡´Activityè¢«æ€æ­»æ­¤ç§æƒ…å†µå’Œç¬¬ä¸€ç±»å·®ä¸å¤šï¼Œéƒ½å¯ä»¥é€šè¿‡ä»¥ä¸Šä¸¤ç§æ–¹æ³•æ¥æ¢å¤æ•°æ® æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä¸è®©Activityé‡æ–°åˆ›å»º,é€šè¿‡åœ¨æ¸…å•æ–‡ä»¶ä¸­æŒ‡å®šActivityçš„configChangeså±æ€§,é€šè¿‡è¿™äº›å±æ€§,å¯ä»¥è®©æˆ‘ä»¬åœ¨ç‰¹å®šåœºæ™¯ä¸‹Activityä¸ä¼šè¢«é‡æ–°åˆ›å»º,æ­¤æ—¶ï¼Œå¦‚æœæˆ‘ä»¬è¿›è¡Œäº†ç‰¹æ®Šçš„æ“ä½œ,Activityä¼šè°ƒç”¨onConfigurationChangedæ–¹æ³• Activityçš„å¯åŠ¨æ¨¡å¼1)standardï¼š é»˜è®¤æ¨¡å¼ï¼Œæ¯æ¬¡éƒ½æ‰“å¼€ä¸€ä¸ªæ–°çš„Activity,ä¾‹å¦‚ABCDå››ä¸ªActivity,Aæ˜¯æœ€åº•çš„Activity,Dæ˜¯å½“å‰çš„æ ˆé¡¶Activity,é€šè¿‡Då¯åŠ¨Dï¼Œæ­¤æ—¶æ ˆä¸­çš„Activityå°±ä¼šå˜æˆABCDD2ï¼‰singleTopï¼š æ ˆé¡¶å¤ç”¨æ¨¡å¼ï¼Œä¾‹å¦‚ABCDå››ä¸ªActivity,ç”¨Då¯åŠ¨D,æ ˆä¸­çš„Activityè¿˜æ˜¯ABCDï¼ŒDè¢«å¤ç”¨äº†,å¹¶ä¸”Dä¸ä¼šå†æ¬¡è°ƒç”¨onCreateï¼Œè€Œæ˜¯ä¼šè°ƒç”¨onNewIntent3)singleTask: æ ˆå†…å¤ç”¨æ¨¡å¼,ä¾‹å¦‚ABCD,é€šè¿‡Då¯åŠ¨Bï¼Œæ ˆä¸­çš„Activityä¸ºï¼šACDB,Bä¸ä¼šè¢«é‡æ–°åˆ›å»º,å¹¶ä¸”Bä¼šæ”¾å…¥åˆ°æ ˆé¡¶,å¦‚æœæ˜¯é€šè¿‡Då¯åŠ¨Eï¼Œé‚£ä¸ªæ ˆä¸­Activcityä¸ºABCDE,å› ä¸ºEåœ¨æ ˆä¸­æ²¡æœ‰ï¼Œç³»ç»Ÿä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚å¤ç”¨çš„Activityä¾æ—§ä¼šè°ƒç”¨onNewInternt4) å•å®ä¾‹æ¨¡å¼ï¼Œå¯ä»¥ç†è§£ä¸ºåŠ å¼ºç‰ˆçš„singTask.æ­¤ç§æ¨¡å¼ä¸ä½†æ‹¥æœ‰singTaskçš„å…¨éƒ¨ç‰¹æ€§ï¼Œè€Œä¸”æ˜¯å•ç‹¬çš„ä½äºä¸€ä¸ªä»»åŠ¡æ ˆä¸­ï¼Œä¾‹å¦‚Aæ˜¯æ­¤ç§æ¨¡å¼ï¼Œé‚£ä¸ªç³»ç»Ÿä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ä»»åŠ¡æ ˆï¼Œé‚£ä¹ˆç”±äºæ ˆçš„å¤ç”¨ç‰¹æ€§ï¼Œåç»­çš„è¯·æ±‚éƒ½ä¸ä¼šé‡æ–°åˆ›å»ºæ–°çš„Activityï¼Œé™¤éè¢«ç³»ç»Ÿé”€æ¯äº† å¯åŠ¨æ¨¡å¼çš„è®¾ç½®1ï¼‰é€šè¿‡æ¸…å•æ–‡ä»¶çš„launchModeå±æ€§è®¾ç½®2ï¼‰é€šè¿‡Intentè®¾ç½®æ ‡å¿—ä½æ¥æŒ‡å®š1234Intent intent = new Intent();intent.setClass(A.this,B.class);intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);startActivity(intent); ä¸¤è€…çš„åŒºåˆ«:ç¬¬äºŒç§çš„ä¼˜å…ˆçº§ä¼šé«˜äºç¬¬ä¸€ç§ï¼Œç¬¬ä¸€ç§æ— æ³•è®¾ç½®FLAG_ACTIVITY_CLEAR_TOPæ ‡è¯†,ç¬¬äºŒç§æ— æ³•ä¸ºActivityæŒ‡å®šsingleInstanceæ¨¡å¼ã€‚ Activityçš„FlagsFLAG_ACTIVITY_NEW_TASKsingleTaskæ¨¡å¼FLAG_ACTIVITY_SINGLE_TOPsingleTopæ¨¡å¼FLAG_ACTIVITY_CLEAR_TOPè®¾ç½®äº†æ­¤æ¨¡å¼ï¼Œå¦‚æœæ˜¯singleTaskæ¨¡å¼å¯åŠ¨,é‚£ä¹ˆå°±ä¼šè°ƒç”¨onNewIntentï¼Œå¦‚æœæ˜¯standardæ¨¡å¼å¯åŠ¨,é‚£ä¹ˆä½äºæ­¤Activityæ ˆä¸Šçš„æ‰€æœ‰Activityéƒ½è¦å‡ºæ ˆFLAG_ACTIVITY_EXCLUDE_FROM_RECENTSå…·æœ‰è¿™ä¸ªæ ‡è®°çš„Activityä¸ä¼šå‡ºç°åœ¨åˆ—è¡¨ä¸­,ç­‰åŒäºxmlä¸­çš„excludeFromRecents=true;]]></content>
      <categories>
        <category>AndroidåŸºç¡€è¿›é˜¶</category>
        <category>å®‰å“Activity</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœ‰å“ªäº›é€ç»™å¹´è½»äººçš„å»ºè®®æˆ–é“ç†ï¼Ÿ]]></title>
    <url>%2F%E6%9C%89%E5%93%AA%E4%BA%9B%E9%80%81%E7%BB%99%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E5%BB%BA%E8%AE%AE%E6%88%96%E9%81%93%E7%90%86%EF%BC%9F.html</url>
    <content type="text"><![CDATA[åºè¨€ï¼šè¿™ç¯‡æ–‡ç« ï¼Œå†™ç»™ä½ ä»¬ï¼Œä¹Ÿå†™ç»™æˆ‘è‡ªå·±ï¼Œæˆ‘è‡ªå·±ä¼šç»å¸¸é˜…è¯»è¿™ç¯‡æ–‡ç« æ¥æ¿€åŠ±è‡ªå·±ï¼Œæ¯å½“è‡ªå·±èŒ«ç„¶ï¼Œæ— æªï¼Œä¸çŸ¥é“è¯¥å¹²å˜›æ—¶ï¼Œæˆ‘éƒ½ä¼šè¯»ä¸€éï¼Œè¿™æ ·æˆ‘çš„è„‘æµ·å°±ä¼šè‡ªåŠ¨ç»™è‡ªå·±ç½—åˆ—å‡ºä¸€äº›äº‹æƒ…æ¥åšï¼Œå“ˆå“ˆå“ˆã€‚å¸Œæœ›å¯¹é˜…è¯»è¿™ç¯‡æ–‡ç« çš„ä½ ä¼šæœ‰å¯å‘,æˆ‘ç›¸ä¿¡æœªæ¥çš„ä½ ä¸€å®šä¼šæ„Ÿè°¢ç°åœ¨è¿™ä¹ˆåŠªåŠ›çš„è‡ªå·±ï¼ å­¦ä¹ å¾ˆé‡è¦ï¼å­¦ä¹ å¾ˆé‡è¦ï¼å­¦ä¹ å¾ˆé‡è¦ï¼ çŸ¥è¯†æˆ–è€…æŠ€èƒ½è¿™ç§ä¸œè¥¿ï¼Œå­¦åˆ°äº†å°±è·Ÿä½ ä¸€è¾ˆå­ï¼Œä¸ç®¡å·¥ä½œæˆ–æ—¶ç©ºè·¨åº¦å¤šå¤§ï¼Œæ–°çŸ¥å’ŒæŠ€èƒ½éƒ½èƒ½æ’ä¸Šç”¨åœºï¼Œè¯·ä¸è¦æ„Ÿå¹æ—¶å…‰å·²é€ï¼Œå­¦ä¹ ä¸æ˜“ï¼Œäººå®¶è€æ¥è€ƒç ”çš„ï¼Œç”šæ˜¯80å²å­¦ç¼–ç¨‹çš„éƒ½æœ‰ï¼Œè¯·ä¸è¦ä¸ºä½ çš„æ‡’æƒ°æ‰¾å€Ÿå£ã€‚ ä¹ æƒ¯å¾ˆé‡è¦ï¼ æœ‰äººæ€»æ˜¯å’Œæˆ‘ä»¬è¯´ï¼Œè¦å…»æˆå¥½çš„ä¹ æƒ¯ã€‚å¯æ²¡äººè·Ÿæˆ‘è¯´é‡è¦åˆ°æ·±åº¦å½±å“è‡ªå·±ç”Ÿæ´»ã€äººç”Ÿé€‰æ‹©å’Œç”Ÿå‘½è´¨é‡çš„ç¨‹åº¦ã€‚å› ä¸ºå‡ ä¹å¤§å¤šæ•°äººï¼Œæ¯æ—¶æ¯åˆ»éƒ½ç”Ÿæ´»åœ¨å½¢å½¢è‰²è‰²çš„æ€ç»´ä¹ æƒ¯ã€ç”Ÿæ´»ä¹ æƒ¯ä¸­ï¼Œæ¯”å¦‚å¥èº«ã€è·‘æ­¥ã€é˜…è¯»ã€è¡¨è¾¾ã€å†™ä½œã€æ²Ÿé€šã€å­¦ä¹ ç­‰ç­‰ï¼Œæ‰€æœ‰å½±å“æˆ‘ä»¬ç”Ÿæ´»å·¥ä½œç»“æœçš„å…¨æ˜¯è¿™äº›ä¹ æƒ¯ã€‚æˆ‘ä»¬å…»æˆä¹ æƒ¯ï¼Œç„¶åä¹ æƒ¯å…»æˆæˆ‘ä»¬ã€‚ å­¦ä¼šå­¦ä¹ ä»–äººä¼˜ç§€çš„å“è´¨å›´å‰¿å¼å­¦ä¹ ï¼Œä¹Ÿå°±æ˜¯å¸æ˜Ÿå¤§æ³•ï¼Œé€šè¿‡è§‚å¯Ÿå¯¹æ–¹çš„æ²Ÿé€šã€æ¼”è®²ã€å†™ä½œæ–¹å¼ï¼Œä»è€Œå­¦ä¹ ä»–ä»¬çš„æ€ç»´æ–¹å¼ã€å­¦ä¹ ä»–ä»¬èº«ä¸Šæœ€ä¼˜ç§€çš„æ€ç»´ä¹ æƒ¯,å½“ä½ ä»¬æŠŠä¼˜ç§€çš„äººèº«ä¸Šä¼˜ç§€çš„å“è´¨å­¦ä¹ ä¸‹æ¥ï¼Œè¿™å°±æ˜¯æˆåŠŸï¼ çœŸè¯šå’Œè¯šä¿¡çœŸè¯šæ˜¯é¢†å¯¼åŠ›çš„çœŸè°›ï¼Œè¯šä¿¡æ˜¯å•†ä¸šçš„çœŸè°›ï¼Œæ¯ä¸ªäººçš„å¹´è–ªã€é¢†å¯¼èƒ½åŠ›ã€å•†ä¸šæˆå°±å…¨éƒ¨éƒ½å¯ä»¥ä»è¿™ä¸¤ä¸ªè¯æ±‡é‡Œè¯ é‡Š,å½“ä½ è‡ªå·±åšè€æ¿ä½ å°±ä¼šè§‰å¾—è¿™ä¸¤ä¸ªå“è´¨æ˜¯å¤šä¹ˆçš„é‡è¦äº†ã€‚ è¦å¤šé™ªé™ªå®¶äººå¹´è½»äººå¯èƒ½å¿ƒé‡Œæƒ³å¾—æ›´å¤šçš„æ˜¯å¹¸ç¦ç”Ÿæ´»ï¼Œä½†çˆ¶æ¯çš„å¹´çºªï¼Œä»–ä»¬å¹´é¾„è¶Šå¤§ï¼Œè¶Šè¦å»é¢ä¸´ç¦»å¼€è¿™ä¸€ä¸»é¢˜ï¼Œä»–ä»¬æ‹…å¿ƒè¢«ä¸–ç•ŒæŠ›å¼ƒï¼Œæ‹…å¿ƒè‡ªå·±åœ¨å„¿å¥³ç”Ÿæ´»ä¸­æ‰®æ¼”ä¸äº†ä»€ä¹ˆé‡è¦ä»·å€¼ï¼Œç‰¹åˆ«æ¸´æœ›å›é¦ˆã€å…³æ³¨å’Œå°Šé‡ï¼Œä¸ç®¡å¤šå¿™ï¼Œèƒ½å¤šæ‰“ä¸€ä¸ªç”µè¯å°±å¤šæ‰“ä¸€ä¸ªç”µè¯ï¼Œèƒ½å¤šåœ¨ä¸€èµ·åƒé¡¿é¥­ï¼Œå°±å¤šåœ¨ä¸€èµ·åƒé¡¿é¥­ï¼Œèƒ½æ»¡è¶³ä»–ä»¬æƒ³è¦çš„ï¼Œä¸ç®¡å¤§å°ï¼Œå°½é‡å»æ»¡è¶³ã€‚å¯èƒ½ä½ æ²¡å¯Ÿè§‰çš„æ˜¯ï¼Œéšç€ä½ çš„é€æ¸æˆé•¿ï¼Œä½ çš„çˆ¶æ¯æ­£é€¼è¿‘æ­»äº¡ï¼ ä¸è¦ç†¬å¤œç¡çœ å…¶å®çœŸæ­£å†³å®šäº†ç”Ÿå‘½çš„æ•ˆç‡ã€‚å› ä¸ºç¡çœ å†³å®šç€ç¬¬äºŒå¤©çš„å¿ƒæƒ…ã€çŠ¶æ€ã€ä¸“æ³¨åº¦ç­‰ï¼Œè€Œå¿ƒæƒ…ã€çŠ¶æ€ã€ä¸“æ³¨åº¦ç›´æ¥å½±å“ç»“æœï¼Œæˆ‘ä»¬çš„ç°åœ¨å°±æ˜¯ç”±å¤§å¤§å°å°çš„è¿™äº›ç»“æœæ„æˆçš„ã€‚æ‰€ä»¥ç¡ä¸ªå¥½è§‰å¯èƒ½æ˜¯è®©ç”Ÿæ´»å˜å¾—æ›´å¥½çš„æœ€å¤§çš„æ·å¾„ã€‚ä¸è¦ç›¸ä¿¡ä»€ä¹ˆç‹—è¡€æˆåŠŸå‰§ç»å¸¸ç†¬å¤œå°±èƒ½æˆåŠŸï¼ŒæˆåŠŸæ˜¯è®²ç©¶æ•ˆç‡çš„ã€‚ ä¿æŒè‡ªæˆ‘ï¼Œä¸æ–­å®Œå–„ä¿æŒè‡ªæˆ‘ï¼Œå¹¶ä¸æ–­å˜å¾—æ›´å¥½ï¼Œå…¶å®åœ¨ä¸€æ®µæ„Ÿæƒ…é‡Œï¼Œè¿œæ¯”å§”æ›²æ±‚å…¨ï¼Œä¸€å‘³åœ°å® æººå¯¹æ–¹ï¼Œæ›´é‡è¦ã€‚ä¿æŒè‡ªæˆ‘å¯ä»¥æµ‹è¯•å‡ºå’Œå¯¹æ–¹æ˜¯å¦åˆæ‹ï¼Œä¸æ–­å˜å¾—æ›´å¥½ï¼Œå¯ä»¥è®©æ„Ÿæƒ…æ›´æ·±åˆ»è€ŒæŒä¹…ã€‚åƒä¸‡ä¸è¦å› ä¸ºå­¤ç‹¬ã€æ— åŠ©ã€çˆ¶æ¯é€¼è¿«ã€ä¸ªäººé¢å­ã€ç„¦è™‘ç­‰åŸå› ä»“ä¿ƒåœ°é€‰æ‹©ä¸€ä¸ªäººã€‚è¿™ä¸ªäººæ˜¯è‡ªå·±ç”Ÿå‘½çš„ä¸€éƒ¨åˆ†ï¼Œå¯¹è‡ªå·±æ–½åŠ ç€æ— ä»¥å¤åŠ åœ°å½±å“ï¼Œæ‰€ä»¥è°¨æ…ç‚¹ï¼Œå³ä¾¿å•èº«éƒ½æ¯”é”™è¯¯å¥½å¾ˆå¤šã€‚ ç”¨æ„Ÿå®˜å»å‘ç°æ›´ç¾å¥½çš„ä¸–ç•Œåˆ©ç”¨æ‰€æœ‰çš„æ„Ÿå®˜å»ä½“éªŒå‘¨é­çš„ä¸–ç•Œæ˜¯é‚£ä¹ˆé‡è¦ï¼Œåˆ»æ„å‘ç°ç”Ÿæ´»çš„ç¾ï¼Œå‘ç°ç»†å¾®å¤„çš„ä¸åŒï¼Œä¼šç»™è‡ªå·±å¸¦æ¥å¾ˆå¤šå°æƒŠå–œ æ¥ä¸‹æ¥èŠèŠèŒåœºå‘å±•çš„,äººè¦èˆå¾—æŠ•èµ„è‡ªå·±ï¼Œè¿™æ ·ä½ æ‰ä¼šè¶Šæ¥è¶Šå€¼é’± ä¸è¦è®©ä¸“ä¸šé™åˆ¶ä½ çš„é€‰æ‹©è®¸å¤šäººæˆ–è®¸éƒ½æ˜¯ä¸€äº›åˆšåˆšæ­¥å…¥ç¤¾ä¼šçš„å­¦ç”Ÿï¼Œå­¦ç”Ÿæ€ç»´çš„ä¸€å¤§å±€é™å°±æ˜¯è§‰å¾—æ‰¾å·¥ä½œåº”è¯¥ä¸“ä¸šè¦å¯¹å£ï¼Œå®é™…ä¸Šä»æˆ‘ä¸ªäººçš„è§‚å¯Ÿæ¥çœ‹ï¼Œå¤§å­¦æ¯•ä¸šåï¼ŒåŒå­¦ä¸­åå€’æ˜¯ä»äº‹æœ¬ä¸“ä¸šçš„å±äºå°ä¼—ï¼Œæˆ‘è§‰å¾—é€ æˆè¿™ä¸ªç°è±¡çš„åŸå› æœ‰ï¼šï¼ˆ1ï¼‰ä¸€èˆ¬æ¥è¯´ï¼Œå¡«é«˜è€ƒå¿—æ„¿çš„æ—¶å€™ï¼Œä½ æŠ¥çš„ä¸“ä¸šæœªæ¥åˆ°åº•èƒ½åšä»€ä¹ˆå·¥ä½œï¼Œä½ çš„çˆ¶æ¯å¦‚æœä¸å¤ªäº†è§£çš„è¯ï¼Œä½ å¿…å®šä¹Ÿä¸å¤ªäº†è§£ï¼Œå†µä¸”å¾ˆå¤šå­¦ç”ŸæŠ¥çš„ä¸“ä¸šéƒ½æ˜¯é‚£ç§æ‰€è°“çš„çƒ­é—¨ä¸“ä¸šï¼Œæˆ–è€…çˆ¶æ¯ç»™é€‰çš„ï¼Œæˆ–è€…çˆ¶æ¯ä»äº‹çš„ä¸“ä¸šï¼›ï¼ˆ2ï¼‰ä¸Šå¤§å­¦åï¼ŒçœŸæ­£çš„å­¦äº†ä¸“ä¸šè¯¾åï¼Œä½ å¾ˆæœ‰å¯èƒ½å¹¶ä¸æ„Ÿå…´è¶£ï¼Œæˆ–è€…å¹¶ä¸æ“…é•¿ï¼›ï¼ˆ3ï¼‰é™¤äº†å°‘æ•°å¯¹ä¸“ä¸šçŸ¥è¯†è¦æ±‚è¾ƒé«˜çš„ç†å·¥ç§‘ä¸“ä¸šï¼Œå¤§éƒ¨åˆ†ä¸“ä¸šæ¯•ä¸šåå»å…¬å¸å®ä¹ å®Œå…¨å¯ä»¥ææ˜ç™½å·¥ä½œæµç¨‹ã€‚æ‰€ä»¥é™¤äº†é˜ŸæŠ€æœ¯è¦æ±‚è¾ƒé«˜çš„ç†å·¥ç§‘èŒä½ï¼Œå…¶ä»–å¤§å¤šæ•°èŒä½ï¼Œæ¯•ä¸šå»å…¬å¸ï¼Œé€šè¿‡å®é™…å·¥ä½œä¸­å­¦ä¹ ï¼Œæ˜¯å®Œå…¨å¯ä»¥çš„ï¼Œåªè¦ä½ åšäº†æ„Ÿå…´è¶£ï¼Œå¹¶ä¸”æ“…é•¿çš„å·¥ä½œï¼Œå·¥ä½œæŠ€èƒ½éƒ½æ˜¯å­¦çš„å¾ˆå¿«çš„ï¼Œè€Œä¸”åœ¨å…¬å¸é‡Œä½ ä¸æ‡‚çš„é—®é¢˜å¯ä»¥ç›´æ¥é—®èµ„å†è€çš„å‘˜å·¥ï¼Œæ¯”ä½ è‡ªå·±åœ¨å­¦æ ¡é‡Œä¸Šè¯¾æ•ˆç‡é«˜å¤šäº†ï¼Œæˆ‘æœ¬ç§‘å­¦è®¡ç®—æœºçš„ï¼Œç­é‡ŒåŒå­¦æœ‰ä»äº‹åª’ä½“çš„ï¼Œé‡‘èçš„ï¼Œå‡ºç‰ˆç¤¾çš„ï¼Œæˆ¿åœ°äº§çš„ï¼Œè€ƒå…¬åŠ¡å‘˜çš„ï¼Œè¿˜æœ‰ç»å•†çš„ï¼Œåæ­£å¹²å•¥çš„éƒ½æœ‰ï¼Œåªè¦æ˜¯ä½ æ„Ÿå…´è¶£çš„ï¼Œå¹¶ä¸”è§‰å¾—è‡ªå·±èƒ½åšå¥½çš„èŒä½ï¼Œå¤§å¯ä»¥ä¸€è¯•ã€‚ ä¸è¦æ€•çŠ¯é”™ï¼Œå¹´è½»æ²¡æœ‰å¤±è´¥ç½‘ä¸Šå¾ˆå¤šäººè¯´è¿‡è¦æ‰¾è‡ªå·±æ“…é•¿çš„å·¥ä½œï¼Œä½†æ˜¯é—®é¢˜æ˜¯ï¼Œä¸€ä»½å·¥ä½œä½ æ²¡å¹²ä¹‹å‰ï¼Œå¾ˆéš¾çŸ¥é“è‡ªå·±åˆ°åº•æ˜¯å¦æ“…é•¿ï¼Œé‚£è¿™ä»½æ“…é•¿çš„å·¥ä½œæˆ–è¡Œä¸šè¦æ€ä¹ˆæ‰¾å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼šå¤šå»å°è¯•ä¸åŒçš„èŒä¸šã€‚å¤§å­¦åˆšæ¯•ä¸šä¸€ä¸¤å¹´ï¼Œå¾ˆæœ‰å¯èƒ½ä½ ç›®å‰ä»äº‹çš„å·¥ä½œå¹¶ä¸æ˜¯ä½ å–œæ¬¢çš„ï¼Œä¹Ÿä¸æ˜¯ä½ ä¸€è¾ˆå­åªèƒ½å¹²è¿™ä¸ªï¼Œå¦‚æœå¹²çš„ä¸å¼€å¿ƒï¼Œå¹¶ä¸”åœ¨å…¬å¸é‡Œå¹²çš„ä¹Ÿä¸ç®—å‡ºè‰²ï¼Œé‚£ä¹ˆï¼Œå¾ˆå¯èƒ½å°±æ˜¯ä½ ä¸æ“…é•¿è¿™ä¸ªè¡Œä¸šï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä»—ç€ä½ å¹´è½»ï¼Œä½ å¤§å¯ä»¥è¾èŒè½¬è¡Œï¼Œ30å²ä¹‹å‰ä½ çš„è½¬è¡Œæˆæœ¬æ˜¯å¾ˆä½çš„ï¼Œå› ä¸ºä½ å¹´è½»ï¼Œå¤§éƒ¨åˆ†å…¬å¸éƒ½ä¼šç»™ä½ ä¸€ä¸ªé¢è¯•çš„æœºä¼šï¼Œç­‰ä½ è¿‡äº†30å²å†æƒ³è½¬è¡Œï¼Œä¹Ÿä¸æ˜¯ä¸å¯èƒ½ï¼Œä½†æ˜¯éš¾åº¦æ¯”20å‡ å²çš„æ—¶å€™ä¼šé«˜å‡ ä¸ªé‡çº§ï¼šï¼ˆ1ï¼‰ä»å…¬å¸çš„è§’åº¦æ¥çœ‹ï¼Œå…¬å¸æ›´çˆ±åŸ¹å…»å¹´è½»äººï¼›ï¼ˆ2ï¼‰30å²å¾ˆå¯èƒ½ç»“å©šäº†ï¼Œä¸Šæœ‰è€ï¼Œä¸‹æœ‰å°ï¼Œè½¬è¡Œçš„é£é™©ç‰¹åˆ«çš„é«˜ï¼Œå°±æ˜¯æ‰¾1ä¸ªæœˆå·¥ä½œï¼Œå¾ˆå¤šå®¶åº­çš„æˆ¿è´·å°±è¦æ–­ä¾›äº†ï¼Œå¯¼è‡´è¿™ä¸ªå¹´çºªå³ä½¿æƒ³è½¬è¡Œï¼Œéœ€è¦è€ƒè™‘çš„å› ç´ ä¹Ÿä¼šå¤šå¾ˆå¤šã€‚æ‰€ä»¥ï¼Œæœ€å¥½çš„é€‰æ‹©å°±æ˜¯åœ¨ä½ çš„25-30å²ä¹‹é—´è¿™5å¹´é‡Œï¼Œæ‰¾åˆ°ä½ æ“…é•¿çš„è¡Œä¸šæˆ–é¢†åŸŸï¼Œè¿™5å¹´å†…ä½ å¹²çš„ä¸çˆ½å°½å¯ä»¥æ¢ï¼Œä½†æ˜¯æœ€å¥½åœ¨30å²ä¹‹å‰æ‰¾åˆ°è‡ªå·±èƒ½åšä¸€ç”Ÿçš„èŒä¸šï¼Œå¹¶ä¸”ç¨³å®šä¸‹æ¥ã€‚ å¥½å¥½åˆ©ç”¨ä¸‹ç­çš„æ—¶é—´ï¼Œ5å¹´åä¼šç»™ä½ å¸¦æ¥å·¨å¤§çš„æ”¹å˜20-25å²çš„å¹´è½»äººï¼Œå¦‚æœæŒ‡æœ›ä¸ä¸Šçˆ¶æ¯ï¼Œåªèƒ½é è‡ªå·±å¥‹æ–—çš„è¯ï¼Œè¯´éš¾å¬ç‚¹ï¼Œä½ éšåçš„å‡ å¹´æ˜¯ä¸åº”è¯¥æœ‰è¿‡å¤šçš„å¨±ä¹ç”Ÿæ´»çš„ã€‚é“ç†å¾ˆç®€å•ï¼Œåœ¨ä½ æ²¡æœ‰è¿‡å¤šçš„å¥½çš„é€‰æ‹©çš„æ—¶å€™ï¼Œå¥½å¥½å·¥ä½œï¼Œå‡èŒåŠ è–ªæ˜¯ä½ èƒ½åšåˆ°çš„é£é™©æœ€å°çš„é€‰æ‹©ï¼ˆåˆ›ä¸šé£é™©å¤ªé«˜ï¼Œä¸é€‚åˆæ™®é€šäººï¼‰ï¼Œè€Œå†³å®šä½ å‡èŒåŠ è–ªçš„å…³é”®å°±æ˜¯ä½ çš„å·¥ä½œæŠ€èƒ½ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³30å²æ··ä¸ªä¸€å®˜åŠèŒå½“ä¸ªå°ä¸»ç®¡ï¼Œä¸æƒ³å†å½“æ™®é€šæ‰“å·¥ä»”ï¼Œé‚£ä¹ˆï¼Œæœ‰æ•ˆçš„åˆ©ç”¨ä¸‹ç­æ—¶é—´å¥½å¥½çš„ç»™è‡ªå·±å……ç”µæ˜¯ä½ å¿…é¡»è¦åšçš„ã€‚è€Œç°ä»£ç¤¾ä¼šæ¯ä¸ªäººç™½å¤©å¾—ä¸Šè‡³å°‘å…«å°æ—¶çš„ç­ï¼ˆä¸åŠ ç­çš„ä¼ä¸šçœŸæ˜¯è‰¯å¿ƒï¼‰ï¼Œå³ä½¿ä½ æœ‰å¹¸åœ¨ä¸€å®¶ä¸åŠ ç­çš„ä¼ä¸šå·¥ä½œï¼Œæ™šä¸Šä¸‹ç­æŒ¤åœ°é“/å…¬äº¤åˆ°å®¶åƒå®Œé¥­ï¼Œæ´—å®Œæ¾¡ä¹‹åï¼Œæ€ä¹ˆç€ä¹Ÿå¾—8ç‚¹äº†ï¼Œå¦‚æœä½ 12ç‚¹ç¡çš„è¯ï¼ˆåŸºæœ¬å·²æ˜¯æé™ï¼Œå†æ™šç¡ä¼šå½±å“ç™½å¤©çš„å·¥ä½œï¼‰ï¼Œä½ ä¸€å¤©ä¸­æœ‰æ•ˆçš„è¿ç»­å­¦ä¹ æ—¶é—´å°±æ˜¯4å°æ—¶ï¼ˆè¿™æ˜¯æ¯”è¾ƒä¹è§‚çš„ä¼°è®¡ï¼Œè¿˜æœ‰å¾ˆå¤šäººé€šå‹¤æ—¶é—´å°±å¾—1ä¸ªå¤šå°æ—¶ï¼Œæ‰€ä»¥èƒ½æœ‰4ä¸ªå°æ—¶çš„å­¦ä¹ æ—¶é—´çš„äººçœŸæ˜¯å¾ˆå¹¸è¿ï¼‰ï¼Œ4å°æ—¶ï¼Œä¹ä¸€çœ‹ä¸å°‘äº†ï¼Œä½†æ˜¯å®é™…ç”¨èµ·æ¥ï¼Œå‡æ‰ä¸­é—´ä¼‘æ¯ä¸€ä¸‹çš„æ—¶é—´ï¼Œä½ å°±ä¼šå‘ç°ï¼Œæ˜¯å¾ˆç´§å‡‘çš„ï¼Œè€Œä¸”ä¸€æ—¦å¼€å§‹å†³å®šæ™šä¸Šå­¦ä¹ ï¼ŒåŸºæœ¬å°±ä¸èƒ½éš”ä¸‰å·®äº”çš„å’Œæœ‹å‹å‡ºå»æµªäº†ï¼Œå› ä¸ºå°±æ€•ä¸€å‡ºå»ï¼Œæ‰“ç ´äº†å­¦ä¹ æƒ¯æ€§ï¼Œå¿ƒå°±æ•£äº†ï¼Œæ— å¿ƒå†è€å¿ƒå­¦ä¹ ä¸‹å»äº†ï¼Œæ‰€ä»¥å¦‚æœä½ å†³å®šç»™è‡ªå·±å……ç”µï¼Œå‡ ä¹ä¹Ÿå°±å¯ä»¥å‘Šåˆ«å¨±ä¹ç”Ÿæ´»äº†ï¼Œè™½ç„¶è¿™æ ·çš„ç”Ÿæ´»å¾ˆè‹¦ï¼Œä½†æ˜¯äººç”Ÿæ˜¯éœ€è¦è§„åˆ’çš„ï¼Œè‹¥å¹²å¹´åï¼Œä½ åº”è¯¥æ„Ÿè°¢æ›¾ç»é‚£ä¹ˆçš„åŠªåŠ›çš„è‡ªå·±ã€‚ä¸€è¾ˆå­å¾ˆé•¿ï¼Œ25å²æ˜¯ä½ æ’­ç§çš„æ—¶å€™ï¼Œä¸ºçš„æ˜¯æœªæ¥çš„æ”¶è·ã€‚ å¯¹å·¥ä½œçš„çˆ±å¥½æœ€é‡è¦çˆ±å¥½æ˜¯æœ€é‡è¦çš„ï¼Œä½ ä¸çˆ±çš„å·¥ä½œå†èµšé’±ä½ ä¹Ÿä¼šå¿§éƒç—‡çš„ï¼Œåˆ°æ—¶å€™æ¯å¤©èµ·åºŠéƒ½æ²¡åŠ¨åŠ›ï¼Œæ¯•ç«Ÿå·¥ä½œæ˜¯åŠè¾ˆå­çš„äº‹æƒ…ã€‚ å®šåˆ¶è‡ªå·±çš„èŒä¸šå‘å±•è®¡åˆ’,æ˜ç¡®è‡ªå·±è¦çš„æ˜¯ä»€ä¹ˆæå‰ç»™è‡ªå·±å®šå¥½è®¡åˆ’ï¼Œé¿å…è®©è‡ªå·±åƒä¸€ä¸ªæ— å¤´è‹è‡èˆ¬åˆ°å¤„ä¹±é£ï¼Œæ˜ç¡®è‡ªå·±æƒ³è¦çš„æ˜¯ä»€ä¹ˆï¼Œè¯¥å¦‚ä½•å»åŠªåŠ›ï¼Œå¯¹è‡ªå·±çš„è´¢äº§ä¹Ÿè¦æœ‰è§„åˆ’ï¼Œå¤šé˜…è¯»ä¸€äº›å…³äºé‡‘èç†è´¢ç±»çš„ä¹¦ç±ã€‚ æœ€åï¼Œå†æ¥ä¸€ä¸ªæ¯’é¸¡æ±¤æ€»ç»“ è¿™æ˜¯ä¸€ä¸ªå¸¦æ¯’çš„æ€»ç»“åœ¨å¹´è½»çš„æ—¶å€™ï¼Œå³ä½¿ä½ çŸ¥é“å†å¤šâ€œäººç”Ÿçš„é“ç†â€ï¼Œå³ä½¿ä½ ä¸‹äº†å†å¤§çš„å†³å¿ƒï¼Œå³ä½¿ä½ åšäº†å†å‘¨å¯†çš„è®¡åˆ’ã€‚ä½ è¿˜æ˜¯å¯èƒ½ä¸€äº‹æ— æˆã€‚å› ä¸ºä½ å¹¶æ²¡æœ‰åšæŒä¸‹æ¥,é“ç†ä½ éƒ½æ‡‚ï¼Œè¦å¹²ä»€ä¹ˆäº‹å„¿ä¹Ÿéƒ½çŸ¥é“ï¼Œä¸ºä»€ä¹ˆä½ åšä¸åˆ°ï¼Ÿæœ‰è°è®¤çœŸæƒ³è¿‡? æˆ‘ä»¬ä¹‹æ‰€ä»¥åšä¸åˆ°ï¼Œæ˜¯å› ä¸ºå¤§éƒ¨åˆ†äººï¼Œéƒ½æ— æ³•æŠŠè‡ªå·±çœ¼å‰çš„äº‹æˆ–å³å°†è¦åšçš„äº‹ï¼Œå’Œä»Šåçš„æ”¶ç›Šè”ç³»èµ·æ¥,å› ä¸ºä½ åšæŒäº†ä¸€ä¸ªæœˆå,ä½ å¯èƒ½å°±ä¼šæƒ³ï¼Œæˆ‘è¿™æ ·åšçœŸçš„æœ‰ç”¨å—ï¼Ÿè¿™æ—¶ä½ å°±ä¼šå½·å¾¨ï¼Œç”šè‡³æƒŠæï¼Œæ¯•ç«Ÿï¼Œéš”å±±çš„é‡‘å­ä¸å¦‚é“œ:æˆ‘åˆä¸é å†™ä½œåƒé¥­,çœ‹é‚£ä¹ˆå¤šä¹¦æœ‰ä»€ä¹ˆç”¨å‘¢?ä¸€ä¸ªæœˆå°±é‚£ä¹ˆç‚¹é’±,ç†è´¢æœ‰ä»€ä¹ˆç”¨å‘¢?å·²ç»é•¿é‚£æ ·äº†,å¥èº«æœ‰ä»€ä¹ˆç”¨å‘¢?æˆ‘åˆä¸æƒ³å‡ºå›½ã€ä¸è€ƒå¤–äº¤éƒ¨ã€ä¸å»å¤–ä¼,ä½ è®©æˆ‘åŠªåŠ›æ‰“å¡å­¦è‹±è¯­ä¸æ˜¯æç¬‘å—?â€¦â€¦â€¦äººå¾€å¾€å°±æ˜¯è¿™æ ·,äº‹åˆ°ä¸´å¤´æ‰ä¼šæƒ³åˆ°è¦æŠ±ä½›è„šã€‚é‚£ä¹ˆå¦‚ä½•æ‰èƒ½å»åšæŒï¼Œå…¶å®æˆ‘ä¹Ÿæ²¡ä»€ä¹ˆæ–¹æ³•å¯è¨€ï¼Œé“ç†ä½ éƒ½æ‡‚äº†ï¼Œåšä¸ä¸åšéƒ½æ˜¯ä½ çš„ä¸€å¿µä¹‹é—´,æˆ‘åªèƒ½å‘Šè¯‰ä½ ä¸€ä¸ªé“ç†éœ€è¦ä½ ä»¬è‡ªå·±å»æ‚Ÿï¼š ä½ è¦è®©ä½ æ‰€æœ‰åšçš„äº‹æƒ…ï¼Œéšç€æ—¶é—´å‘å±•äº§ç”Ÿå˜åŒ– ä½ éœ€è¦çš„åªæ˜¯åœ¨å¹´è½»çš„æ—¶å€™å¤šç”¨æ—¶é—´åšèµ„æœ¬ï¼Œå»ä¸ºæœªæ¥åšæŠ•èµ„.å°±èƒ½åœ¨æœªæ¥å–å¾—æ”¶ç›Šåï¼Œä¹°ä¸‹æ›´é‡è¦çš„æ—¶é—´ã€‚äººçš„ä¸€ç”Ÿå¾ˆå®è´µï¼Œé…’è¶³é¥­é¥±ä¹‹ä½™ï¼Œä¸å¦¨å¤šæƒ³æƒ³ï¼Œåšç‚¹ä»€ä¹ˆæ›´æœ‰ç”¨çš„äº‹ï¼Œæ‰èƒ½åœ¨é˜¶å±‚å›ºåŒ–ä¹‹å‰å°½é‡å¾€ä¸Šå¤šè¹¦ä¸€ä¸¤ä¸ªå°é˜¶ å› ä¸ºï¼Œç›¸å¯¹äºä½ ä»Šåçš„æ¯ä¸€å¤©ï¼Œç°åœ¨çš„ä½ éƒ½æ˜¯æœ€å¹´è½»çš„ä½ ã€‚å¥½æ–‡é“¾æ¥ï¼š ã€ä¹ æƒ¯ã€‘ä½ åŸ¹å…»ä¹ æƒ¯çš„æ–¹æ³•å¯èƒ½æ˜¯ä¸ªå‡æ–¹æ³• ä½ çš„æ‰€è°“æˆç†Ÿï¼Œä¸è¿‡æ˜¯ç²¾ç¥æ—©è¡° â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“å¸Œæœ›ç”Ÿæ´»å–„å¾…å¦‚æ­¤åŠªåŠ›çš„ä½ â¤â€”â€”â€”â€”â€”â€”â€”â€”â€”-]]></content>
      <categories>
        <category>æ„Ÿæ‚Ÿ</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•å°†ä¸ªäººåŸŸåä¸githubç»‘å®š]]></title>
    <url>%2F%E5%A6%82%E4%BD%95%E5%B0%86%E4%B8%AA%E4%BA%BA%E5%9F%9F%E5%90%8D%E4%B8%8Egithub%E7%BB%91%E5%AE%9A.html</url>
    <content type="text"><![CDATA[è´­ä¹°ä¸ªäººåŸŸåä¾‹å¦‚æˆ‘çš„æ˜¯åœ¨é˜¿é‡Œäº‘ä¸‡ç½‘è´­ä¹°çš„,ç‚¹å‡»è¿›å…¥åŸŸååˆ—è¡¨,ç‚¹å‡»è§£æ,ä¼šå‡ºç°ä¸€ä¸ªæ·»åŠ è§£ææŒ‰é’®ï¼Œç‚¹å¼€æœ‰è®°å½•ç±»å‹ï¼Œä¸»æœºè®°å½•ï¼Œè§£æçº¿è·¯ï¼Œè®°å½•å€¼ï¼ŒTTLå€¼äº”ä¸ªé€‰é¡¹ä¾æ¬¡å¡«å†™ï¼š è®°å½•ç±»å‹ï¼šA ä¸»æœºè®°å½•ï¼šwww è§£æçº¿è·¯ï¼šä¸ç”¨é€‰ï¼Œå°±ç”¨é»˜è®¤ è®°å½•å€¼ï¼šå¡«å†™ä½ çš„githubç½‘å€çš„ip,å¯ä»¥ç”¨ipæŸ¥è¯¢æˆ–pingæŸ¥åˆ°ï¼Œä¸€èˆ¬éƒ½æ˜¯151å¼€å¤´ã€‚ TTLå€¼ï¼šä¸ç”¨ç®¡ï¼Œé»˜è®¤10åˆ†é’Ÿã€‚ å¡«å†™å®Œæ¯•åå°±å¯ä»¥å…³é—­é¡µé¢äº† Githubé…ç½®åœ¨ä½ çš„ioç½‘ç«™æœ¬åœ°ä»“åº“ä¸­æ–°å»ºä¸€ä¸ªCHAME(æ³¨æ„éƒ½è¦å¤§å†™)æ–‡ä»¶ï¼Œæ²¡æœ‰åç¼€ï¼Œæ‰“å¼€ç¼–è¾‘ï¼Œå°†ä½ çš„åŸŸåæ·»åŠ è¿›å…¥ï¼Œä¾‹å¦‚æˆ‘çš„å°±æ˜¯www.huangjie.name,ä¿å­˜ï¼Œå…³é—­,å°†æ–‡ä»¶æäº¤åˆ°è¿œç¨‹ä»“åº“,è¿™æ—¶githubåº”è¯¥ä¼šå‘ä¸€å°é‚®ä»¶ç»™ä½ ä»£è¡¨é…ç½®æˆåŠŸï¼Œæ›´æ”¹ä¸ä¼šç«‹å³ç”Ÿæ•ˆï¼Œä¸€èˆ¬10åˆ†é’Ÿå·¦å³ å¦‚æœä½ æ˜¯ç”¨çš„hexoï¼Œå¯ä»¥å°†CHAMEæ–‡ä»¶å»ºç«‹åœ¨sourceæ–‡ä»¶å¤¹ä¸­ï¼Œè¿™æ ·é€šè¿‡Hexoæäº¤åˆ°githubä¸ä¼šè¢«è¦†ç›–]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoåšå®¢ä½¿ç”¨å¿ƒå¾—]]></title>
    <url>%2Fhello-world.html</url>
    <content type="text"><![CDATA[æ¬¢è¿æ¥åˆ°é»„æ°çš„ä¸ªäººåšå®¢ï¼Œè¿™æ˜¯æˆ‘å†™å…¥çš„ç¬¬ä¸€ç¯‡åšæ–‡,æ­¤åšå®¢å¹³å°é‡‡ç”¨ Hexo + githubPagesæ­å»ºè€Œæˆ,æ­å»ºæ—¥æœŸï¼š2017/11/29ã€‚è¿™ç¯‡åšå®¢å°†æŒç»­è®°å½•hexoä½¿ç”¨è¿‡ç¨‹ä¸­çš„ä¸€äº›é—®é¢˜ å¼•è¨€è®°å½•ä¸€äº›è‡ªå·±æ­å»ºçš„å‚è€ƒèµ„æ–™ http://blog.haoji.me/build-blog-website-by-hexo-github.html?from=xa https://hexo.io/zh-cn/docs/generating.html http://blog.csdn.net/poem_of_sunshine/article/details/2936978 http://blog.sunnyxx.com/2014/02/27/hexo_startup/ å¸¸ç”¨å‘½ä»¤è¿›å…¥é¡¹ç›®ä¸»ç»“æ„ï¼Œä½¿ç”¨git bashæ‰§è¡Œå‘½ä»¤ ç›‘å¬æ–‡ä»¶å˜åŠ¨ $ hexo g å¼€å¯æœ¬åœ°æœåŠ¡ $ hexo s ï¼Œå¼€å¯ååœ¨æµè§ˆå™¨è¾“å…¥http://localhost:4000 å³å¯è®¿é—® æäº¤ä»£ç  $ hexo d ï¼Œéœ€è¦é…ç½®deploy åœ¨ä¸»é¡¹ç›®ç›®å½•ä¸‹æœ‰ä¸ª_config.yml,ä¸ºå…¨å±€é…ç½®æ–‡ä»¶,åœ¨themesæ–‡ä»¶å¤¹é‡Œï¼Œå­˜æ”¾ç€ç½‘ç«™ä½¿ç”¨çš„ä¸»é¢˜æ–‡ä»¶ï¼Œæ‰“å¼€ä¸»é¢˜æ–‡ä»¶å¤¹ï¼Œé‡Œé¢ä¹Ÿæœ‰ä¸ª_config.ymlï¼Œä¸ºä¸»é¢˜é…ç½®æ–‡ä»¶ï¼Œä¸ä¸»é¢˜ç›¸å…³çš„åœ¨è¿™é‡Œé…ç½®ï¼Œæˆ‘ç°åœ¨é‡‡ç”¨çš„æ˜¯Nextä¸»é¢˜ é‡åˆ°çš„é—®é¢˜ä¸€.é¦–é¡µçš„æ–‡ç« å†…å®¹å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œæ²¡æœ‰â€œé˜…è¯»å…¨æ–‡â€?è§£å†³åŠæ³•æœ‰ä¸¤ç§æ–¹æ³• ç¬¬ä¸€ç§ï¼šåœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶é‡Œ(themes/next/_config.yml)ç”¨ç¼–è¾‘å™¨æ‰“å¼€ï¼Œæ‰¾åˆ°12345# Automatically Excerpt. Not recommend.# Please use &lt;!-- more --&gt; in the post to control excerpt accurately.auto_excerpt: enable: false length: 150 å°† enableï¼šfalse æ”¹ä¸ºtrueå°±è¡Œäº†ï¼Œåé¢çš„length:150ä»£è¡¨æ˜¾ç¤ºçš„æ–‡æœ¬å­—æ•°ã€‚ ç¬¬äºŒç§ï¼šç›´æ¥åœ¨ç¼–è¾‘çš„.mdæ–‡ä»¶é‡Œå°†è¦é¢„è§ˆçš„æ–‡å­—åé¢åŠ ä¸Š&lt;!--more--&gt;,è¿™æ ·ä¹‹å‰çš„å°±æ˜¯é¢„è§ˆçš„æ–‡å­—,åé¢çš„å°±ä¸ä¼šæ˜¾ç¤ºäº† äºŒ.å¦‚ä½•å°†README.mdæ–‡ä»¶ä¼ åˆ°githubè€Œä¸è¢«ç¼–è¯‘æˆhtmlåœ¨Hexoç›®å½•çš„sourceç›®å½•åœ¨å»ºç«‹ä¸€ä¸ªREADME.mdæ–‡ä»¶,ä¿®æ”¹Hexoç›®å½•çš„_config.ymlé…ç½®,æ‰¾åˆ° skip_renderå‚æ•°è®¾ç½®,åé¢åŠ ä¸Š README.md,å…³é—­ä¿å­˜,ä¹‹åç¼–è¯‘å°±ä¸ä¼šæ¸²æŸ“README.mdè¿™ä¸ªæ–‡ä»¶äº† ä¸‰.ç™¾åº¦æœç´¢å¼•æ“ä¸èƒ½æ”¶å½•è‡ªå·±çš„ç½‘ç«™åœ°å€åŸå› æ˜¯githubå±è”½äº†ç™¾åº¦çš„spiderçˆ¬è™«,å¯¼è‡´ç™¾åº¦ä¸èƒ½æ”¶å½•,è§£å†³åŠæ³•æ˜¯ä½¿ç”¨codingæ¥æ‰˜ç®¡å›½å†…çš„æµé‡è®¿é—®,å…·ä½“çš„æ–¹æ³•å¯ä»¥å‚è€ƒè¿™ç¯‡åšæ–‡:hexoé«˜é˜¶æ•™ç¨‹ï¼šæƒ³è®©ä½ çš„åšå®¢è¢«æ›´å¤šçš„äººåœ¨æœç´¢å¼•æ“ä¸­æœåˆ°å—ï¼Ÿ å†™ä½œæŠ€å·§è®°å½•ä¸€.å¦‚ä½•å°†mdæ–‡ä»¶ä»¥æ—¶é—´å‘½å åœ¨_config.ymlä¸­æ‰¾åˆ°new_post_name,ä¿®æ”¹åç§°ä¸º:year-:month-:day-:title.md,è¿™æ ·åˆ›å»ºçš„æ–‡ä»¶å°±ä¼šä»¥ç”µè„‘æ—¶é—´å‘½åï¼Œä½¿ç”¨æ—¶é—´å‘½åå¯ä»¥æ›´æ–¹ä¾¿çš„ç®¡ç†æ–‡ç« ]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆ†ç±»]]></title>
    <url>%2Fcategories%2Findex.html</url>
    <content type="text"></content>
  </entry>
  <entry>
    <title></title>
    <url>%2Fabout%2Findex.html</url>
    <content type="text"><![CDATA[About Me Android å°ç”Ÿä¸€æšï¼Œè½»å¾®å¼ºè¿«ç—‡æ‚£è€…ï¼Œéå¤„å¥³åº§ï¼Œå¿ å®è°·ç²‰å…¼æœç²‰ï¼Œå–œæ¬¢çœ‹ä¹¦å¬æ­Œæ—…æ¸¸,å–œæ¬¢ç ”ç©¶å„ç§æ–°æŠ€æœ¯~~ è”ç³»æˆ‘: Email(QQ): jay@huangjie.name Github : Jay-huangjie QQ: 289223562 CSDN: _æ°å“¥ ç®€ä¹¦:æˆ‘æ˜¯é»„æ•™ä¸»å•Š]]></content>
  </entry>
  <entry>
    <title><![CDATA[tags]]></title>
    <url>%2Ftags%2Findex.html</url>
    <content type="text"></content>
  </entry>
</search>
